# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "bluecoatdirector"
			"[observer][name]" => "Blue Coat Director"
			"[observer][type]" => "Configuration Management"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: <messageid>[<hfld1>]: <!payload:messageid>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<message>(?<messageid>[^\[]*)\[(?<hfld1>[^\]]*)\]:[\s]+(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: <messageid>: <!payload:messageid>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<message>(?<messageid>[^:]*):[\s]+(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: <hfld1><hfld2><hfld3><hfld4><messageid>[<hfld5>]: <!payload:messageid>
	# Parsing error: Couldn't parse because of 2 adjacent fields like <fld1><fld2>
	# HEADER 0004
	# line in RSA: <hfld1><hfld2><hfld3><hfld4><messageid>: <!payload:messageid>
	# Parsing error: Couldn't parse because of 2 adjacent fields like <fld1><fld2>



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-bluecoatdirectormsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "cli" {
		# MESSAGE cli
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Processing command: <action>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Processing[\s]+command:[\s]+(?<action>.*)$" }
				id => "message-cli"
				add_field => {
					"[event][id]" => "cli"
					"[rsa][message][id1]" => "cli"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:01
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Processing command <action>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Processing[\s]+command[\s]+(?<action>.*)$" }
				id => "message-cli:01"
				add_field => {
					"[event][id]" => "cli:01"
					"[rsa][message][id1]" => "cli:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:02
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Leaving config mode
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Leaving[\s]+config[\s]+mode$" }
				id => "message-cli:02"
				add_field => {
				"event_description" => "Leaving config mode"
					"[event][id]" => "cli:02"
					"[rsa][message][id1]" => "cli:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:03
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Entering config mode
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Entering[\s]+config[\s]+mode$" }
				id => "message-cli:03"
				add_field => {
				"event_description" => "Entering config mode"
					"[event][id]" => "cli:03"
					"[rsa][message][id1]" => "cli:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:04
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: CLI exiting
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+CLI[\s]+exiting$" }
				id => "message-cli:04"
				add_field => {
				"event_description" => "CLI exiting"
					"[event][id]" => "cli:04"
					"[rsa][message][id1]" => "cli:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:05
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: CLI launched
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+CLI[\s]+launched$" }
				id => "message-cli:05"
				add_field => {
				"event_description" => "CLI launched"
					"[event][id]" => "cli:05"
					"[rsa][message][id1]" => "cli:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Automatically
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Automatically logged out due to keyboard inactivity.
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Automatically[\s]+logged[\s]+out[\s]+due[\s]+to[\s]+keyboard[\s]+inactivity\.$" }
				id => "message-Automatically"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"event_description" => "Automatically logged out due to keyboard inactivity"
					"[event][id]" => "Automatically"
					"[rsa][message][id1]" => "Automatically"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:06
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Entering enable mode
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Entering[\s]+enable[\s]+mode$" }
				id => "message-cli:06"
				add_field => {
				"event_description" => "Entering enable mode"
					"[event][id]" => "cli:06"
					"[rsa][message][id1]" => "cli:06"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:07
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Leaving enable mode
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Leaving[\s]+enable[\s]+mode$" }
				id => "message-cli:07"
				add_field => {
				"event_description" => "Leaving enable mode"
					"[event][id]" => "cli:07"
					"[rsa][message][id1]" => "cli:07"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Processing
		# line in RSA: <agent>[<process_id>]: <<-<fld20>.<severity>> { <username>@::<fld5>:<saddr> | <username>@<domain> }: Processing a secure command...
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<agent>[^\[]*)\[(?<process_id>[^\]]*)\]:[\s]+<\-(?<fld20>[^\.]*)\.(?<severity>[^>]*)>[\s]+([\s]*(?<username>[^@]*)@::(?<fld5>[^:]*):(?<saddr>[^\s]*)[\s]+|[\s]*(?<username>[^@]*)@(?<domain>[^\s]*)[\s]+):[\s]+Processing[\s]+a[\s]+secure[\s]+command\.\.\.$" }
				id => "message-Processing"
				add_field => {
				"event_description" => "Processing a secure command"
					"[event][id]" => "Processing"
					"[rsa][message][id1]" => "Processing"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE cli:pam
		# line in RSA: <agent>[<process_id>]: <fld21>(<fld1>:<fld2>): pam_putenv: <fld3>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: %{fld21}(%{fld1}:%{fld2}): pam_putenv: %{fld3}" }
				id => "message-cli:pam"
				add_field => {
				"event_description" => "bad variable"
					"[event][id]" => "cli:pam"
					"[rsa][message][id1]" => "cli:pam"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "schedulerd" {
		# MESSAGE schedulerd
		# line in RSA: <agent>: <<<fld20>.<severity>> Executing Job "<operation_id>" execution <fld6>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Executing Job \"%{operation_id}\" execution %{fld6}" }
				id => "message-schedulerd"
				add_field => {
					"[event][id]" => "schedulerd"
					"[rsa][message][id1]" => "schedulerd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE schedulerd:01
		# line in RSA: <agent>: <<<fld20>.<severity>> System time changed, recomputing job run times.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> System time changed, recomputing job run times." }
				id => "message-schedulerd:01"
				add_field => {
				"event_description" => "System time changed, recomputing job run times"
					"[event][id]" => "schedulerd:01"
					"[rsa][message][id1]" => "schedulerd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "configd" {
		# MESSAGE configd:Rotating
		# line in RSA: <agent>: <<<fld20>.<severity>> Rotating out backup file "<filename>" for device "<hostname>".
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Rotating out backup file \"%{filename}\" for device \"%{hostname}\"." }
				id => "message-configd:Rotating"
				add_field => {
					"[event][id]" => "configd:Rotating"
					"[rsa][message][id1]" => "configd:Rotating"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:Deleting
		# line in RSA: <agent>: <<<fld20>.<severity>> Deleting backup <filename> from device "<hostname>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Deleting backup %{filename} from device \"%{hostname}\"" }
				id => "message-configd:Deleting"
				add_field => {
					"[event][id]" => "configd:Deleting"
					"[rsa][message][id1]" => "configd:Deleting"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd
		# line in RSA: <agent>: <<<fld20>.<severity>> Device "<hostname>" completed command(s) <<<action>> ...
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device \"%{hostname}\" completed command(s) <%{action}> ..." }
				id => "message-configd"
				add_field => {
					"[event][id]" => "configd"
					"[rsa][message][id1]" => "configd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:01
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: Sending commands to Device <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: Sending commands to Device %{hostname}" }
				id => "message-configd:01"
				add_field => {
					"[event][id]" => "configd:01"
					"[rsa][message][id1]" => "configd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:11
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@<fld6>: Sending commands to Device <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@%{fld6}: Sending commands to Device %{hostname}" }
				id => "message-configd:11"
				add_field => {
					"[event][id]" => "configd:11"
					"[rsa][message][id1]" => "configd:11"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE file
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: command: <action> ;; CPL generated by Visual Policy Manager: <fld10> ;<fld11> ; <fld12> ; <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: command: %{action} ;; CPL generated by Visual Policy Manager: %{fld10} ;%{fld11} ; %{fld12} ; %{info}" }
				id => "message-file"
				add_field => {
				"event_description" => "This file is automatically generated"
					"[event][id]" => "file"
					"[rsa][message][id1]" => "file"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:02
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: command: <action>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: command: %{action}" }
				id => "message-configd:02"
				add_field => {
					"[event][id]" => "configd:02"
					"[rsa][message][id1]" => "configd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:22
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@<fld6>: command: <action>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@%{fld6}: command: %{action}" }
				id => "message-configd:22"
				add_field => {
					"[event][id]" => "configd:22"
					"[rsa][message][id1]" => "configd:22"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:03
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: Commands sent to Device <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: Commands sent to Device %{hostname}" }
				id => "message-configd:03"
				add_field => {
					"[event][id]" => "configd:03"
					"[rsa][message][id1]" => "configd:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:33
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@<fld6>: Commands sent to Device <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@%{fld6}: Commands sent to Device %{hostname}" }
				id => "message-configd:33"
				add_field => {
					"[event][id]" => "configd:33"
					"[rsa][message][id1]" => "configd:33"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Backup
		# line in RSA: <agent>: <<<fld20>.<severity>> Backup import command finished for all devices.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Backup import command finished for all devices." }
				id => "message-Backup"
				add_field => {
				"event_description" => "Backup import command finished for all devices"
					"[event][id]" => "Backup"
					"[rsa][message][id1]" => "Backup"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Beginning
		# line in RSA: <agent>: <<<fld20>.<severity>> Beginning to make backup of cache <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Beginning to make backup of cache %{hostname}" }
				id => "message-Beginning"
				add_field => {
				"event_description" => "Beginning to make backup of cache"
					"[event][id]" => "Beginning"
					"[rsa][message][id1]" => "Beginning"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Inputting
		# line in RSA: <agent>: <<<fld20>.<severity>> Inputting overlay <<<fld10>>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Inputting overlay <%{fld10}>" }
				id => "message-Inputting"
				add_field => {
				"event_description" => "Inputting overlay"
					"[event][id]" => "Inputting"
					"[rsa][message][id1]" => "Inputting"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Saved
		# line in RSA: <agent>: <<<fld20>.<severity>> Saved <info> to <filename>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Saved %{info} to %{filename}" }
				id => "message-Saved"
				add_field => {
					"[event][id]" => "Saved"
					"[rsa][message][id1]" => "Saved"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Importing
		# line in RSA: <agent>: <<<fld20>.<severity>> Importing overlay <<<fld25>> from <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Importing overlay <%{fld25}> from %{hostname}" }
				id => "message-Importing"
				add_field => {
					"[event][id]" => "Importing"
					"[rsa][message][id1]" => "Importing"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Overlay
		# line in RSA: <agent>: <<<fld20>.<severity>> Overlay "<fld25>" imported from device "<hostname>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Overlay \"%{fld25}\" imported from device \"%{hostname}\"" }
				id => "message-Overlay"
				add_field => {
					"[event][id]" => "Overlay"
					"[rsa][message][id1]" => "Overlay"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Executed
		# line in RSA: <agent>: <<<fld20>.<severity>> Executed the last created overlay. The filename is <filename>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Executed the last created overlay. The filename is %{filename}" }
				id => "message-Executed"
				add_field => {
					"[event][id]" => "Executed"
					"[rsa][message][id1]" => "Executed"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Configuration
		# line in RSA: <agent>: <<<fld20>.<severity>> Configuration system online
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Configuration system online" }
				id => "message-Configuration"
				add_field => {
				"event_description" => "Configuration system online"
					"[event][id]" => "Configuration"
					"[rsa][message][id1]" => "Configuration"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Create
		# line in RSA: <agent>: <<<fld20>.<severity>> CREATE <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> CREATE %{info}" }
				id => "message-Create"
				add_field => {
				"event_description" => "Table creation"
					"[event][id]" => "Create"
					"[rsa][message][id1]" => "Create"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Loaded
		# line in RSA: <agent>: <<<fld20>.<severity>> Loaded config file initial
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Loaded config file initial" }
				id => "message-Loaded"
				add_field => {
				"event_description" => "Loaded config file initial"
					"[event][id]" => "Loaded"
					"[rsa][message][id1]" => "Loaded"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Setting
		# line in RSA: <agent>: <<<fld20>.<severity>> Setting set-reply timeout to <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Setting set-reply timeout to %{fld1}" }
				id => "message-Setting"
				add_field => {
				"event_description" => "Setting set-reply timeout"
					"[event][id]" => "Setting"
					"[rsa][message][id1]" => "Setting"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE CCD
		# line in RSA: <agent>: <<<fld20>.<severity>> CCD lost connection to device "<hostname>": <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> CCD lost connection to device \"%{hostname}\": %{event_description}" }
				id => "message-CCD"
				add_field => {
					"[event][id]" => "CCD"
					"[rsa][message][id1]" => "CCD"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Device
		# line in RSA: <agent>: <<<fld20>.<severity>> Device "<hostname>" is now online.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device \"%{hostname}\" is now online." }
				id => "message-Device"
				add_field => {
					"[event][id]" => "Device"
					"[rsa][message][id1]" => "Device"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Output
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: <fld9> Output for device "<hostname>" <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: %{fld9} Output for device \"%{hostname}\" %{fld10}" }
				id => "message-Output"
				add_field => {
					"[event][id]" => "Output"
					"[rsa][message][id1]" => "Output"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ssh
		# line in RSA: <agent>: <<<fld20>.<severity>> (ssh) <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> (ssh) %{event_description}" }
				id => "message-ssh"
				add_field => {
					"[event][id]" => "ssh"
					"[rsa][message][id1]" => "ssh"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Applying
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: Applying overlay <<<fld10>> to group <group_object>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: Applying overlay <%{fld10}> to group %{group_object}" }
				id => "message-Applying"
				add_field => {
				"event_description" => "Applying overlay to group"
					"[event][id]" => "Applying"
					"[rsa][message][id1]" => "Applying"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE Applying:01
		# line in RSA: <agent>: <<<fld20>.<severity>> <username>@::<fld5>:<saddr>-<fld6>: Applying overlay <<<fld10>> to cache <hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{username}@::%{fld5}:%{saddr}-%{fld6}: Applying overlay <%{fld10}> to cache %{hostname}" }
				id => "message-Applying:01"
				add_field => {
				"event_description" => "Applying overlay to cache"
					"[event][id]" => "Applying:01"
					"[rsa][message][id1]" => "Applying:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:backup
		# line in RSA: <agent>: <<<fld20>.<severity>> Backup complete for device "<hostname>". ID <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Backup complete for device \"%{hostname}\". ID %{fld10}" }
				id => "message-configd:backup"
				add_field => {
				"event_description" => "Backup complete for device"
					"[event][id]" => "configd:backup"
					"[rsa][message][id1]" => "configd:backup"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE file:01
		# line in RSA: <agent>: <<<fld20>.<severity>> Device "<hostname>" completed command(s) <action> ;; CPL generated by Visual Policy Manager: <fld10> ;<fld11> ; <fld12> ; <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device \"%{hostname}\" completed command(s) %{action} ;; CPL generated by Visual Policy Manager: %{fld10} ;%{fld11} ; %{fld12} ; %{info}" }
				id => "message-file:01"
				add_field => {
				"event_description" => "This file is automatically generated"
					"[event][id]" => "file:01"
					"[rsa][message][id1]" => "file:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:connection
		# line in RSA: <agent>: <<<fld20>.<severity>> read: Connection reset by peer
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> read: Connection reset by peer" }
				id => "message-configd:connection"
				add_field => {
				"event_description" => "Connection reset by peer"
					"[event][id]" => "configd:connection"
					"[rsa][message][id1]" => "configd:connection"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE configd:failed
		# line in RSA: <agent>: <<<fld20>.<severity>> <info> failed
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{info} failed" }
				id => "message-configd:failed"
				add_field => {
				"event_description" => "cd session read failed"
					"[event][id]" => "configd:failed"
					"[rsa][message][id1]" => "configd:failed"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId44
	# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> Querying content system for job results.
	else if [logstash][msgparser][id] == "msgParserId44" {
		dissect {
			mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> Querying content system for job results." }
			id => "msgParserId44"
			add_field => {
				"event_description" => "Querying content system for job results"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "heartbeat" {
		# MESSAGE heartbeat
		# line in RSA: <agent>: <<<fld20>.<severity>> Processing command: <action>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Processing command: %{action}" }
				id => "message-heartbeat"
				add_field => {
					"[event][id]" => "heartbeat"
					"[rsa][message][id1]" => "heartbeat"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE heartbeat:01
		# line in RSA: <agent>: <<<fld20>.<severity>> The HB command is <action>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> The HB command is %{action}" }
				id => "message-heartbeat:01"
				add_field => {
					"[event][id]" => "heartbeat:01"
					"[rsa][message][id1]" => "heartbeat:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE heartbeat:02
		# line in RSA: <agent>: <<<fld20>.<severity>> director heartbeat client exiting.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> director heartbeat client exiting." }
				id => "message-heartbeat:02"
				add_field => {
				"event_description" => "director heartbeat client exiting"
					"[event][id]" => "heartbeat:02"
					"[rsa][message][id1]" => "heartbeat:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE heartbeat:03
		# line in RSA: <agent>: <<<fld20>.<severity>> director heartbeat client launched.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> director heartbeat client launched." }
				id => "message-heartbeat:03"
				add_field => {
				"event_description" => "director heartbeat client launched"
					"[event][id]" => "heartbeat:03"
					"[rsa][message][id1]" => "heartbeat:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE heartbeat:crit1
		# line in RSA: <agent>: <<<fld20>.<severity>> <filename>: undefined symbol: <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> %{filename}: undefined symbol: %{info}" }
				id => "message-heartbeat:crit1"
				add_field => {
				"event_description" => "undefined symbol"
					"[event][id]" => "heartbeat:crit1"
					"[rsa][message][id1]" => "heartbeat:crit1"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE heartbeat:crit2
		# line in RSA: <agent>: <<<fld20>.<severity>> connect: <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> connect: %{fld1}" }
				id => "message-heartbeat:crit2"
				add_field => {
				"event_description" => "No such file or directory"
					"[event][id]" => "heartbeat:crit2"
					"[rsa][message][id1]" => "heartbeat:crit2"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "runner" {
		# MESSAGE runner
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> Job "<operation_id>" execution <fld6> command <fld7>: "<action>". Output <fld9>: <result>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> Job \"%{operation_id}\" execution %{fld6} command %{fld7}: \"%{action}\". Output %{fld9}: %{result}" }
				id => "message-runner"
				add_field => {
					"[event][id]" => "runner"
					"[rsa][message][id1]" => "runner"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE runner:01
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> Processing command: <action>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> Processing command: %{action}" }
				id => "message-runner:01"
				add_field => {
					"[event][id]" => "runner:01"
					"[rsa][message][id1]" => "runner:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE runner:02
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> Job "<operation_id>" execution <fld6> finished running.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> Job \"%{operation_id}\" execution %{fld6} finished running." }
				id => "message-runner:02"
				add_field => {
					"[event][id]" => "runner:02"
					"[rsa][message][id1]" => "runner:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE runner:crit1
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> Failed to exec <filename>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> Failed to exec %{filename}" }
				id => "message-runner:crit1"
				add_field => {
					"[event][id]" => "runner:crit1"
					"[rsa][message][id1]" => "runner:crit1"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE runner:crit2
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> File reading failed
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> File reading failed" }
				id => "message-runner:crit2"
				add_field => {
				"event_description" => "File reading failed"
					"[event][id]" => "runner:crit2"
					"[rsa][message][id1]" => "runner:crit2"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "ccd" {
		# MESSAGE ccd
		# line in RSA: <agent>: <<<fld20>.<severity>> Device <hostname>: attempting connection using <fld6> on port: <fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device %{hostname}: attempting connection using %{fld6} on port: %{fld7}" }
				id => "message-ccd"
				add_field => {
					"[event][id]" => "ccd"
					"[rsa][message][id1]" => "ccd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:01
		# line in RSA: <agent>: <<<fld20>.<severity>> Device <hostname>: <event_description>, Reason <result>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device %{hostname}: %{event_description}, Reason %{result}" }
				id => "message-ccd:01"
				add_field => {
					"[event][id]" => "ccd:01"
					"[rsa][message][id1]" => "ccd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:03
		# line in RSA: <agent>: <<<fld20>.<severity>> Device <hostname>: couldn't match the response <<<event_description>>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device %{hostname}: couldn't match the response <%{event_description}>" }
				id => "message-ccd:03"
				add_field => {
					"[event][id]" => "ccd:03"
					"[rsa][message][id1]" => "ccd:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:04
		# line in RSA: <agent>: <<<fld20>.<severity>> Device <hostname>: Did not get echo for the command <<<action>>for past <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device %{hostname}: Did not get echo for the command <%{action}>for past %{fld10}" }
				id => "message-ccd:04"
				add_field => {
					"[event][id]" => "ccd:04"
					"[rsa][message][id1]" => "ccd:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:02
		# line in RSA: <agent>: <<<fld20>.<severity>> Device <hostname>: <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device %{hostname}: %{info}" }
				id => "message-ccd:02"
				add_field => {
				"event_description" => "info on device connection"
					"[event][id]" => "ccd:02"
					"[rsa][message][id1]" => "ccd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:05
		# line in RSA: <agent>: <<<fld20>.<severity>> write to <fld1> pipe : <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> write to %{fld1} pipe : %{info}" }
				id => "message-ccd:05"
				add_field => {
				"event_description" => "write to ssh pipe"
					"[event][id]" => "ccd:05"
					"[rsa][message][id1]" => "ccd:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:06
		# line in RSA: <agent>: <<<fld20>.<severity>> ccd_handle_read_failure(), <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> ccd_handle_read_failure(), %{info}" }
				id => "message-ccd:06"
				add_field => {
				"event_description" => "ccd handle read failure"
					"[event][id]" => "ccd:06"
					"[rsa][message][id1]" => "ccd:06"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:07
		# line in RSA: <agent>: <<<fld20>.<severity>> Device Communication Daemon online
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device Communication Daemon online" }
				id => "message-ccd:07"
				add_field => {
				"event_description" => "device communication daemon online"
					"[event][id]" => "ccd:07"
					"[rsa][message][id1]" => "ccd:07"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ccd:08
		# line in RSA: <agent>: <<<fld20>.<severity>> System memory is: <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> System memory is: %{fld1}" }
				id => "message-ccd:08"
				add_field => {
				"event_description" => "system memory size"
					"[event][id]" => "ccd:08"
					"[rsa][message][id1]" => "ccd:08"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "sshd" {
		# MESSAGE sshd
		# line in RSA: <agent>: <<<fld20>.<severity>> error: Bind to port <fld10> on <fld5> failed: <result>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> error: Bind to port %{fld10} on %{fld5} failed: %{result}" }
				id => "message-sshd"
				add_field => {
					"[event][id]" => "sshd"
					"[rsa][message][id1]" => "sshd"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE sshd:01
		# line in RSA: <agent>: bad username <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: bad username %{fld1}" }
				id => "message-sshd:01"
				add_field => {
				"event_description" => "bad username"
					"[event][id]" => "sshd:01"
					"[rsa][message][id1]" => "sshd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE sshd:02
		# line in RSA: <agent>[<process_id>]: <fld21>(<fld1>:<fld2>): authentication failure; <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: %{fld21}(%{fld1}:%{fld2}): authentication failure; %{info}" }
				id => "message-sshd:02"
				add_field => {
				"event_description" => "authentication failure"
					"[event][id]" => "sshd:02"
					"[rsa][message][id1]" => "sshd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE sshd:03
		# line in RSA: <agent>[<process_id>]: <fld21>(<fld1>:<fld2>): check pass; <fld3>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: %{fld21}(%{fld1}:%{fld2}): check pass; %{fld3}" }
				id => "message-sshd:03"
				add_field => {
				"event_description" => "check pass, user unknown"
					"[event][id]" => "sshd:03"
					"[rsa][message][id1]" => "sshd:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE sshd:04
		# line in RSA: <agent>[<process_id>]: PAM <fld1> more authentication failure; <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: PAM %{fld1} more authentication failure; %{info}" }
				id => "message-sshd:04"
				add_field => {
				"event_description" => "authentication failure"
					"[event][id]" => "sshd:04"
					"[rsa][message][id1]" => "sshd:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE sshd:pam
		# line in RSA: <agent>[<process_id>]: <fld21>(<fld1>:<fld2>): pam_putenv: <fld3>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: %{fld21}(%{fld1}:%{fld2}): pam_putenv: %{fld3}" }
				id => "message-sshd:pam"
				add_field => {
				"event_description" => "bad variable"
					"[event][id]" => "sshd:pam"
					"[rsa][message][id1]" => "sshd:pam"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "dmd" {
		# MESSAGE dmd
		# line in RSA: <agent>: <<<fld20>.<severity>> inserted device id = <hostname> and serial number = <fld6> into DB
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> inserted device id = %{hostname} and serial number = %{fld6} into DB" }
				id => "message-dmd"
				add_field => {
					"[event][id]" => "dmd"
					"[rsa][message][id1]" => "dmd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE dmd:01
		# line in RSA: <agent>: <<<fld20>.<severity>> Health state for metric"<hostname>" "<change_old>" changed to "<change_new>", reason: "<result>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Health state for metric\"%{hostname}\" \"%{change_old}\" changed to \"%{change_new}\", reason: \"%{result}\"" }
				id => "message-dmd:01"
				add_field => {
					"[event][id]" => "dmd:01"
					"[rsa][message][id1]" => "dmd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE dmd:11
		# line in RSA: <agent>: <<<fld20>.<severity>> Health state for group "<group_object>" changed from "<change_old>" to "<change_new>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Health state for group \"%{group_object}\" changed from \"%{change_old}\" to \"%{change_new}\"" }
				id => "message-dmd:11"
				add_field => {
					"[event][id]" => "dmd:11"
					"[rsa][message][id1]" => "dmd:11"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE dmd:02
		# line in RSA: <agent>: <<<fld20>.<severity>> Filter on (<fld5>) things. <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Filter on (%{fld5}) things. %{event_description}" }
				id => "message-dmd:02"
				add_field => {
					"[event][id]" => "dmd:02"
					"[rsa][message][id1]" => "dmd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE dmd:03
		# line in RSA: <agent>: <<<fld20>.<severity>> Device ID "<hostname>" error: <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> Device ID \"%{hostname}\" error: %{event_description}" }
				id => "message-dmd:03"
				add_field => {
					"[event][id]" => "dmd:03"
					"[rsa][message][id1]" => "dmd:03"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId75
	# line in RSA: <agent>: ALERT exited abnormally with <fld10>
	else if [logstash][msgparser][id] == "msgParserId75" {
		dissect {
			mapping => { "message" => "%{agent}: ALERT exited abnormally with %{fld10}" }
			id => "msgParserId75"
			add_field => {
				"event_description" => "ALERT exited abnormally"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "ntpd" {
		# MESSAGE ntpd
		# line in RSA: <agent>[<process_id>]: kernel time sync enabled <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: kernel time sync enabled %{fld10}" }
				id => "message-ntpd"
				add_field => {
				"event_description" => "kernel time sync enabled"
					"[event][id]" => "ntpd"
					"[rsa][message][id1]" => "ntpd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ntpd:01
		# line in RSA: <agent>[<process_id>]: time reset <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: time reset %{fld10}" }
				id => "message-ntpd:01"
				add_field => {
				"event_description" => "time reset"
					"[event][id]" => "ntpd:01"
					"[rsa][message][id1]" => "ntpd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ntpd:02
		# line in RSA: <agent>[<process_id>]: ntpd <fld10>-r <fld11>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: ntpd %{fld10}-r %{fld11}" }
				id => "message-ntpd:02"
				add_field => {
					"[event][id]" => "ntpd:02"
					"[rsa][message][id1]" => "ntpd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE ntpd:03
		# line in RSA: <agent>[<process_id>]: ntpd exiting on signal <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: ntpd exiting on signal %{fld10}" }
				id => "message-ntpd:03"
				add_field => {
				"event_description" => "ntpd exiting on signal"
					"[event][id]" => "ntpd:03"
					"[rsa][message][id1]" => "ntpd:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "pm" {
		# MESSAGE pm
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> ntpd will start in <fld10>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> ntpd will start in %{fld10}" }
				id => "message-pm"
				add_field => {
				"event_description" => "ntpd will start in few secs"
					"[event][id]" => "pm"
					"[rsa][message][id1]" => "pm"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE pm:01
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> ntpd started
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> ntpd started" }
				id => "message-pm:01"
				add_field => {
				"event_description" => "ntpd started"
					"[event][id]" => "pm:01"
					"[rsa][message][id1]" => "pm:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE pm:02
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> print_msg(), <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> print_msg(), %{info}" }
				id => "message-pm:02"
				add_field => {
				"event_description" => "print message"
					"[event][id]" => "pm:02"
					"[rsa][message][id1]" => "pm:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE pm:03
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> <info> started
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> %{info} started" }
				id => "message-pm:03"
				add_field => {
				"event_description" => "service started"
					"[event][id]" => "pm:03"
					"[rsa][message][id1]" => "pm:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE pm:04
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> <info> will start in <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> %{info} will start in %{fld1}" }
				id => "message-pm:04"
				add_field => {
				"event_description" => "service will start"
					"[event][id]" => "pm:04"
					"[rsa][message][id1]" => "pm:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE pm:05
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> check_license_validity(), <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> check_license_validity(), %{fld1}" }
				id => "message-pm:05"
				add_field => {
				"event_description" => "check license validity"
					"[event][id]" => "pm:05"
					"[rsa][message][id1]" => "pm:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE pm:06
		# line in RSA: <agent>[<process_id>]: <<<fld20>.<severity>> Connected to config daemon
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: <%{fld20}.%{severity}> Connected to config daemon" }
				id => "message-pm:06"
				add_field => {
				"event_description" => "connected to config daemon"
					"[event][id]" => "pm:06"
					"[rsa][message][id1]" => "pm:06"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "anacron" {
		# MESSAGE anacron
		# line in RSA: <agent>[<process_id>]: Updated timestamp for job <info> to <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: Updated timestamp for job %{info} to %{fld1}" }
				id => "message-anacron"
				add_field => {
				"event_description" => "updated timestamp"
					"[event][id]" => "anacron"
					"[rsa][message][id1]" => "anacron"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE anacron:01
		# line in RSA: <agent>[<process_id>]: Anacron <version> started on <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: Anacron %{version} started on %{fld1}" }
				id => "message-anacron:01"
				add_field => {
				"event_description" => "anacron started"
					"[event][id]" => "anacron:01"
					"[rsa][message][id1]" => "anacron:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE anacron:02
		# line in RSA: <agent>[<process_id>]: Normal exit <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: Normal exit %{fld1}" }
				id => "message-anacron:02"
				add_field => {
				"event_description" => "normal exit"
					"[event][id]" => "anacron:02"
					"[rsa][message][id1]" => "anacron:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "epmd" {
		# MESSAGE epmd
		# line in RSA: <agent>: epmd: invalid packet size (<fld1>)
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: epmd: invalid packet size (%{fld1})" }
				id => "message-epmd"
				add_field => {
				"event_description" => "invalid packet size"
					"[event][id]" => "epmd"
					"[rsa][message][id1]" => "epmd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE epmd:01
		# line in RSA: <agent>: epmd: got <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: epmd: got %{info}" }
				id => "message-epmd:01"
				add_field => {
					"[event][id]" => "epmd:01"
					"[rsa][message][id1]" => "epmd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE epmd:02
		# line in RSA: <agent>: epmd: epmd running <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: epmd: epmd running %{info}" }
				id => "message-epmd:02"
				add_field => {
					"[event][id]" => "epmd:02"
					"[rsa][message][id1]" => "epmd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "xinetd" {
		# MESSAGE xinetd
		# line in RSA: <agent>[<process_id>]: xinetd <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: xinetd %{event_description}" }
				id => "message-xinetd"
				add_field => {
					"[event][id]" => "xinetd"
					"[rsa][message][id1]" => "xinetd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE xinetd:01
		# line in RSA: <agent>[<process_id>]: Started working: <fld1> available services
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}[%{process_id}]: Started working: %{fld1} available services" }
				id => "message-xinetd:01"
				add_field => {
					"[event][id]" => "xinetd:01"
					"[rsa][message][id1]" => "xinetd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId95
	# line in RSA: <agent>[<process_id>]: Audit daemon rotating log files
	else if [logstash][msgparser][id] == "msgParserId95" {
		dissect {
			mapping => { "message" => "%{agent}[%{process_id}]: Audit daemon rotating log files" }
			id => "msgParserId95"
			add_field => {
				"event_description" => "Audit daemon rotating log files"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId96
	# line in RSA: <agent>: Reset file context <filename>: <fld1>
	else if [logstash][msgparser][id] == "msgParserId96" {
		dissect {
			mapping => { "message" => "%{agent}: Reset file context %{filename}: %{fld1}" }
			id => "msgParserId96"
			add_field => {
				"event_description" => "Reset file"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "authd" {
		# MESSAGE authd
		# line in RSA: <agent>: <<<fld20>.<severity>> handle_authd unknown message =<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> handle_authd unknown message =%{fld1}" }
				id => "message-authd"
				add_field => {
				"event_description" => "handle authd unknown message"
					"[event][id]" => "authd"
					"[rsa][message][id1]" => "authd"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE authd:01
		# line in RSA: <agent>: <<<fld20>.<severity>> authd_signal_handler(), <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> authd_signal_handler(), %{fld1}" }
				id => "message-authd:01"
				add_field => {
				"event_description" => "authd signal handler"
					"[event][id]" => "authd:01"
					"[rsa][message][id1]" => "authd:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE authd:02
		# line in RSA: <agent>: <<<fld20>.<severity>> authd_close(): <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> authd_close(): %{info}" }
				id => "message-authd:02"
				add_field => {
				"event_description" => "authd close"
					"[event][id]" => "authd:02"
					"[rsa][message][id1]" => "authd:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId100
	# line in RSA: <agent>: {WARNING|Warning}: <event_description>
	else if [logstash][msgparser][id] == "msgParserId100" {
		grok {
			match => { "message" => "^(?<agent>[^:]*):[\s]+(WARNING|Warning):[\s]+(?<event_description>.*)$" }
			id => "msgParserId100"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId101
	# line in RSA: <agent>[<process_id>]: shutting down <info>
	else if [logstash][msgparser][id] == "msgParserId101" {
		dissect {
			mapping => { "message" => "%{agent}[%{process_id}]: shutting down %{info}" }
			id => "msgParserId101"
			add_field => {
				"event_description" => "shutting down"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId102
	# line in RSA: <agent>: <<<fld20>.<severity>> cmd starting <fld1>
	else if [logstash][msgparser][id] == "msgParserId102" {
		dissect {
			mapping => { "message" => "%{agent}: <%{fld20}.%{severity}> cmd starting %{fld1}" }
			id => "msgParserId102"
			add_field => {
				"event_description" => "cmd starting"
				"[logstash][messagefound]" => true
			}
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-bluecoatdirectormsg.json"
#			template_name => "bluecoatdirector_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
