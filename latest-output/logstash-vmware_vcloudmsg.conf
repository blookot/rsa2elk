# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "vmware_vcloud"
			"[observer][name]" => "VMware vCloud Director"
			"[observer][type]" => "Configuration Management"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: <hdate> <htime>,<hfld1> | Event [id=<hfld2>, timestamp=<hfld3>, type=com/vmware/vcloud/event/<messageid>, <!payload:hdate>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<message>(?<hdate>[^\s]*)[\s]+(?<htime>[^,]*),(?<hfld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<hfld2>[^,]*),[\s]+timestamp=(?<hfld3>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<messageid>[^,]*),[\s]+(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-vmware_vcloudmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	# PARSER msgParserId0
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  org.description=<fld4>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  org.ldap.searchBase=<fld6>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  org.displayName=<fld8>,  currentContext.login.org.id=<fld9>,  org.enabled=<fld10>,  org.name=<fld11>,  entity.name=<obj_name>,  entity.id=<fld12>,  org.id=<fld13>,  currentContext.cell.uuid=<fld14>,  }]
	if [logstash][msgparser][id] == "msgParserId0" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+org\.description=(?<fld4>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+org\.ldap\.searchBase=(?<fld6>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+org\.displayName=(?<fld8>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+org\.enabled=(?<fld10>[^,]*),[\s]+org\.name=(?<fld11>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+org\.id=(?<fld13>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId0"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId1
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  org.enabled=<fld10>,  org.name=<fld11>,  entity.name=<obj_name>,  entity.id=<fld12>,  org.id=<fld13>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId1" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+org\.enabled=(?<fld10>[^,]*),[\s]+org\.name=(?<fld11>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+org\.id=(?<fld13>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId1"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId2
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  org.description=<fld4>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  org.ldap.searchBase=<fld6>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  org.displayName=<fld8>,  currentContext.login.org.id=<fld9>,  org.enabled=<fld10>,  org.name=<fld11>,  entity.name=<obj_name>,  entity.id=<fld12>,  org.id=<fld13>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId2" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+org\.description=(?<fld4>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+org\.ldap\.searchBase=(?<fld6>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+org\.displayName=(?<fld8>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+org\.enabled=(?<fld10>[^,]*),[\s]+org\.name=(?<fld11>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+org\.id=(?<fld13>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId2"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId3
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  user.name=<c_username>,  user.id=<fld22>,  user.org.id=<fld23>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  user.nameInSource=<fld24>,  }]
	else if [logstash][msgparser][id] == "msgParserId3" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+user\.name=(?<c_username>[^,]*),[\s]+user\.id=(?<fld22>[^,]*),[\s]+user\.org\.id=(?<fld23>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+user\.nameInSource=(?<fld24>[^,]*),[\s]+\}\]$" }
			id => "msgParserId3"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId4
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  user.id=<fld22>,  user.org.id=<fld23>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  user.nameInSource=<fld24>,  }]
	else if [logstash][msgparser][id] == "msgParserId4" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+user\.id=(?<fld22>[^,]*),[\s]+user\.org\.id=(?<fld23>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+user\.nameInSource=(?<fld24>[^,]*),[\s]+\}\]$" }
			id => "msgParserId4"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId5
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  user.name=<fld26>,  role.name=<user_role>,  role.id=<fld25>,  user.id=<fld22>,  currentContext.user.clientIpAddress=<daddr>,  user.org.id=<fld23>,  entity.name=<obj_name>,  entity.id=<fld12>,  role.description=<fld27>,  currentContext.cell.uuid=<fld14>,  user.nameInSource=<fld24>,  }]
	else if [logstash][msgparser][id] == "msgParserId5" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+user\.name=(?<fld26>[^,]*),[\s]+role\.name=(?<user_role>[^,]*),[\s]+role\.id=(?<fld25>[^,]*),[\s]+user\.id=(?<fld22>[^,]*),[\s]+currentContext\.user\.clientIpAddress=(?<daddr>[^,]*),[\s]+user\.org\.id=(?<fld23>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+role\.description=(?<fld27>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+user\.nameInSource=(?<fld24>[^,]*),[\s]+\}\]$" }
			id => "msgParserId5"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId6
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  user.name=<fld26>,  user.id=<fld22>,  user.org.id=<fld23>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  user.nameInSource=<fld24>,  }]
	else if [logstash][msgparser][id] == "msgParserId6" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+user\.name=(?<fld26>[^,]*),[\s]+user\.id=(?<fld22>[^,]*),[\s]+user\.org\.id=(?<fld23>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+user\.nameInSource=(?<fld24>[^,]*),[\s]+\}\]$" }
			id => "msgParserId6"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId7
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  vm.id=<fld21>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld12>,  }]
	else if [logstash][msgparser][id] == "msgParserId7" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vm\.id=(?<fld21>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+\}\]$" }
			id => "msgParserId7"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId8
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  vm.id=<fld21>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  vm.name=<fld31>,  vm.externalAddresses=<fld32>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  vm.externalPorts=<fld33>,  entity.name=<obj_name>,  vm.internalPorts=<fld34>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId8" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vm\.id=(?<fld21>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+vm\.name=(?<fld31>[^,]*),[\s]+vm\.externalAddresses=(?<fld32>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+vm\.externalPorts=(?<fld33>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+vm\.internalPorts=(?<fld34>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId8"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId9
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  vm.id=<fld21>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  vm.name=<fld31>,  vm.vapp.id=<fld32>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  vm.state=<fld33>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId9" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vm\.id=(?<fld21>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+vm\.name=(?<fld31>[^,]*),[\s]+vm\.vapp\.id=(?<fld32>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+vm\.state=(?<fld33>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId9"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId10
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  network.linkType=<fld27>,  network.description=<fld28>,  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  network.scopeType=<fld37>,  network.isIpScopeInherited=<fld38>,  entity.type=<obj_type>,  network.scopeId=<fld39>,  network.ipStart=<fld40>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  network.ipEnd=<fld41>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  entity.id=<fld12>,  network.id=<fld42>,  currentContext.cell.uuid=<fld14>,  network.name=<fld43>,  }]
	else if [logstash][msgparser][id] == "msgParserId10" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+network\.linkType=(?<fld27>[^,]*),[\s]+network\.description=(?<fld28>[^,]*),[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+network\.scopeType=(?<fld37>[^,]*),[\s]+network\.isIpScopeInherited=(?<fld38>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+network\.scopeId=(?<fld39>[^,]*),[\s]+network\.ipStart=(?<fld40>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+network\.ipEnd=(?<fld41>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+network\.id=(?<fld42>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+network\.name=(?<fld43>[^,]*),[\s]+\}\]$" }
			id => "msgParserId10"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId11
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  network.scopeType=<fld37>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  entity.id=<fld12>,  network.id=<fld42>,  currentContext.cell.uuid=<fld14>,  network.name=<fld43>,  }]
	else if [logstash][msgparser][id] == "msgParserId11" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+network\.scopeType=(?<fld37>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+network\.id=(?<fld42>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+network\.name=(?<fld43>[^,]*),[\s]+\}\]$" }
			id => "msgParserId11"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId12
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  network.linkType=<fld27>,  network.description=<fld28>,  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  network.scopeType=<fld37>,  network.isIpScopeInherited=<fld38>,  entity.type=<obj_type>,  network.scopeId=<fld39>,  network.ipStart=<fld40>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  network.ipEnd=<fld41>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  entity.id=<fld12>,  network.id=<fld42>,  currentContext.cell.uuid=<fld14>,  network.name=<fld43>,  network.linkLnetId=<fld44>,  }]
	else if [logstash][msgparser][id] == "msgParserId12" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+network\.linkType=(?<fld27>[^,]*),[\s]+network\.description=(?<fld28>[^,]*),[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+network\.scopeType=(?<fld37>[^,]*),[\s]+network\.isIpScopeInherited=(?<fld38>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+network\.scopeId=(?<fld39>[^,]*),[\s]+network\.ipStart=(?<fld40>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+network\.ipEnd=(?<fld41>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+network\.id=(?<fld42>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+network\.name=(?<fld43>[^,]*),[\s]+network\.linkLnetId=(?<fld44>[^,]*),[\s]+\}\]$" }
			id => "msgParserId12"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId13
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  network.realNetVcId=<fld45>,  network.scopeType=<fld37>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  network.realNetMoref=<fld46>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  network.shieldNetworkId=<fld49>,  entity.id=<fld12>,  network.id=<fld42>,  currentContext.cell.uuid=<fld14>,  network.name=<fld43>,  }]
	else if [logstash][msgparser][id] == "msgParserId13" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+network\.realNetVcId=(?<fld45>[^,]*),[\s]+network\.scopeType=(?<fld37>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+network\.realNetMoref=(?<fld46>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+network\.shieldNetworkId=(?<fld49>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+network\.id=(?<fld42>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+network\.name=(?<fld43>[^,]*),[\s]+\}\]$" }
			id => "msgParserId13"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId14
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  network.scopeType=<fld37>,  entity.type=<obj_type>,  network.unallocatedIpAddresses=<fld47>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  network.allocatedIpAddresses=<fld48>,  entity.id=<fld12>,  network.id=<fld42>,  currentContext.cell.uuid=<fld14>,  network.name=<fld43>,  }]
	else if [logstash][msgparser][id] == "msgParserId14" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+network\.scopeType=(?<fld37>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+network\.unallocatedIpAddresses=(?<fld47>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+network\.allocatedIpAddresses=(?<fld48>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+network\.id=(?<fld42>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+network\.name=(?<fld43>[^,]*),[\s]+\}\]$" }
			id => "msgParserId14"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId15
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  vdc.enabled=<fld46>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  vdc.name=<info>,  vdc.id=<fld47>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId15" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+vdc\.enabled=(?<fld46>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+vdc\.name=(?<info>[^,]*),[\s]+vdc\.id=(?<fld47>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId15"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId16
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  vdc.resourceGuaranteed=<fld45>,  currentContext.login.user.id=<fld5>,  vdc.cpuAllocationMhz=<fld46>,  vdc.allocationModel=<fld47>,  currentContext.org.id=<fld7>,  vdc.providerTag=<fld48>,  entity.name=<obj_name>,  vdc.description=<fld49>,  entity.id=<fld12>,  vdc.resourceGuaranteedCpu=<fld50>,  vdc.enabled=<fld51>,  currentContext.user.name=cloudadmin,  currentContext.success=true,  vdc.name=<fld52>,  vdc.id=<fld53>,  vdc.storageAllocationMb=<fld54>,  vdc.networksAllocated=<fld55>,  currentContext.login.org.id=<fld56>,  vdc.org.id=<fld17>,  vdc.memoryAllocationMb=<fld18>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId16" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vdc\.resourceGuaranteed=(?<fld45>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+vdc\.cpuAllocationMhz=(?<fld46>[^,]*),[\s]+vdc\.allocationModel=(?<fld47>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+vdc\.providerTag=(?<fld48>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+vdc\.description=(?<fld49>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+vdc\.resourceGuaranteedCpu=(?<fld50>[^,]*),[\s]+vdc\.enabled=(?<fld51>[^,]*),[\s]+currentContext\.user\.name=cloudadmin,[\s]+currentContext\.success=true,[\s]+vdc\.name=(?<fld52>[^,]*),[\s]+vdc\.id=(?<fld53>[^,]*),[\s]+vdc\.storageAllocationMb=(?<fld54>[^,]*),[\s]+vdc\.networksAllocated=(?<fld55>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld56>[^,]*),[\s]+vdc\.org\.id=(?<fld17>[^,]*),[\s]+vdc\.memoryAllocationMb=(?<fld18>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId16"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId17
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  vdc.resourceGuaranteed=<fld45>,  currentContext.login.user.id=<fld5>,  vdc.cpuAllocationMhz=<fld46>,  vdc.allocationModel=<fld47>,  currentContext.org.id=<fld7>,  vdc.providerTag=<fld48>,  entity.name=<obj_name>,  vdc.description=<fld49>,  entity.id=<fld12>,  vdc.resourceGuaranteedCpu=<fld50>,  vdc.enabled=<fld51>,  currentContext.user.name=<username>,  currentContext.success=<result>,  vdc.name=<fld52>,  vdc.id=<fld53>,  vdc.storageAllocationMb=<fld54>,  vdc.networksAllocated=<fld55>,  currentContext.login.org.id=<fld56>,  vdc.org.id=<fld17>,  vdc.memoryAllocationMb=<fld18>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId17" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vdc\.resourceGuaranteed=(?<fld45>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+vdc\.cpuAllocationMhz=(?<fld46>[^,]*),[\s]+vdc\.allocationModel=(?<fld47>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+vdc\.providerTag=(?<fld48>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+vdc\.description=(?<fld49>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+vdc\.resourceGuaranteedCpu=(?<fld50>[^,]*),[\s]+vdc\.enabled=(?<fld51>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+vdc\.name=(?<fld52>[^,]*),[\s]+vdc\.id=(?<fld53>[^,]*),[\s]+vdc\.storageAllocationMb=(?<fld54>[^,]*),[\s]+vdc\.networksAllocated=(?<fld55>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld56>[^,]*),[\s]+vdc\.org\.id=(?<fld17>[^,]*),[\s]+vdc\.memoryAllocationMb=(?<fld18>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId17"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId18
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  catalog.id=<fld4>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  catalog.name=<info>,  catalog.org.id=<fld43>,  catalog.published=<fld44>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId18" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+catalog\.id=(?<fld4>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+catalog\.name=(?<info>[^,]*),[\s]+catalog\.org\.id=(?<fld43>[^,]*),[\s]+catalog\.published=(?<fld44>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId18"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId19
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  vapp.description=<fld4>,  entity.type=<obj_type>,  vapp.id=<fld44>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  vapp.name=<info>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  vapp.vdc.id=<fld10>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId19" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+vapp\.description=(?<fld4>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vapp\.id=(?<fld44>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+vapp\.name=(?<info>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+vapp\.vdc\.id=(?<fld10>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId19"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId20
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  currentContext.success=<fld46>,  currentContext.login.org.id=<fld47>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld49>,  currentContext.org.id=<fld48>,  }]
	else if [logstash][msgparser][id] == "msgParserId20" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+currentContext\.success=(?<fld46>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld47>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+entity\.id=(?<fld49>[^,]*),[\s]+currentContext\.org\.id=(?<fld48>[^,]*),[\s]+\}\]$" }
			id => "msgParserId20"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId21
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.success=<result>,  currentContext.user.id=<fld3>,  currentContext.login.org.id=<fld4>,  entity.type=<obj_type>,  currentContext.user.clientIpAddress=<daddr>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  entity.name=<obj_name>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  currentContext.org.id=<fld44>,  }]
	else if [logstash][msgparser][id] == "msgParserId21" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld4>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.user\.clientIpAddress=(?<daddr>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+currentContext\.org\.id=(?<fld44>[^,]*),[\s]+\}\]$" }
			id => "msgParserId21"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId22
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  vc.url=<url>,  currentContext.user.id=<fld3>,  vc.id=<fld44>,  vc.name=<fld45>,  entity.type=<obj_type>,  vc.description=<fld46>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  vc.username=<fld51>,  entity.id=<fld12>,  vc.uuid=<fld13>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId22" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+vc\.url=(?<url>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+vc\.id=(?<fld44>[^,]*),[\s]+vc\.name=(?<fld45>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vc\.description=(?<fld46>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+vc\.username=(?<fld51>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+vc\.uuid=(?<fld13>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId22"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId23
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  vsm.vc.id=<fld49>,  vsm.ipAddress=<info>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  vsm.username=<fld51>,  entity.id=<fld12>,  vsm.id=<fld13>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId23" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+vsm\.vc\.id=(?<fld49>[^,]*),[\s]+vsm\.ipAddress=(?<info>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+vsm\.username=(?<fld51>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+vsm\.id=(?<fld13>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId23"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId24
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  vappTemplate.id=<fld4>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  vappTemplate.name=<fld6>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  currentContext.user.clientIpAddress=<daddr>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld12>,  }]
	else if [logstash][msgparser][id] == "msgParserId24" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+vappTemplate\.id=(?<fld4>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+vappTemplate\.name=(?<fld6>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+currentContext\.user\.clientIpAddress=(?<daddr>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+\}\]$" }
			id => "msgParserId24"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId25
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  currentContext.success=<result>,  currentContext.login.org.id=<fld44>,  entity.type=<obj_type>,  vappTemplate.storageAllocationMb=<fld45>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld12>,  currentContext.org.id=<fld34>,  }]
	else if [logstash][msgparser][id] == "msgParserId25" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld44>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vappTemplate\.storageAllocationMb=(?<fld45>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.org\.id=(?<fld34>[^,]*),[\s]+\}\]$" }
			id => "msgParserId25"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId26
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  media.type=<fld44>,  currentContext.user.id=<fld3>,  media.vdc.id=<fld4>,  entity.type=<obj_type>,  media.description=<fld46> ,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  media.sizeInBytes=<fld39>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  media.id=<fld37>,  currentContext.user.clientIpAddress=<daddr>,  entity.name=<obj_name>,  media.name=<fld24>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId26" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+media\.type=(?<fld44>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+media\.vdc\.id=(?<fld4>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+media\.description=(?<fld46>[^\s]*)[\s]+,[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+media\.sizeInBytes=(?<fld39>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+media\.id=(?<fld37>[^,]*),[\s]+currentContext\.user\.clientIpAddress=(?<daddr>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+media\.name=(?<fld24>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId26"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId27
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  media.id=<fld34>,  currentContext.user.clientIpAddress=<daddr>,  media.name=<fld19>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld12>,  }]
	else if [logstash][msgparser][id] == "msgParserId27" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+media\.id=(?<fld34>[^,]*),[\s]+currentContext\.user\.clientIpAddress=(?<daddr>[^,]*),[\s]+media\.name=(?<fld19>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+\}\]$" }
			id => "msgParserId27"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId28
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties=<fld11>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld12>,  catalogItem.id=<fld13>,  }]
	else if [logstash][msgparser][id] == "msgParserId28" {
		dissect {
			mapping => { "message" => "%{fld20},%{fld1} | Event [id=%{fld2}, timestamp=%{event_time_string}, type=com/vmware/vcloud/event/%{action}  properties=%{fld11},  entity.name=%{obj_name},  currentContext.cell.uuid=%{fld14},  entity.id=%{fld12},  catalogItem.id=%{fld13},  }]" }
			id => "msgParserId28"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId29
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  currentContext.user.id=<fld3>,  vc.id=<fld44>,  vc.name=<fld45>,  entity.type=<obj_type>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  currentContext.cell.uuid=<fld14>,  entity.id=<fld12>,  }]
	else if [logstash][msgparser][id] == "msgParserId29" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+vc\.id=(?<fld44>[^,]*),[\s]+vc\.name=(?<fld45>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+\}\]$" }
			id => "msgParserId29"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId30
	# line in RSA:  <fld20>,<fld1> | Event [id=<fld2>, timestamp=<event_time_string>, type=com/vmware/vcloud/event/<action>  properties={{  currentContext.org.name=<user_org>,  vc.url=<url>,  currentContext.user.id=<fld3>,  vc.id=<fld44>,  vc.name=<fld45>,  entity.type=<obj_type>,  vc.description=<fld46>,  currentContext.login.user.id=<fld5>,  currentContext.user.name=<username>,  currentContext.org.id=<fld7>,  currentContext.success=<result>,  currentContext.login.org.id=<fld9>,  entity.name=<obj_name>,  vc.username=<fld51>,  entity.id=<fld12>,  currentContext.cell.uuid=<fld14>,  }]
	else if [logstash][msgparser][id] == "msgParserId30" {
		grok {
			match => { "message" => "^[\s]*(?<fld20>[^,]*),(?<fld1>[^\s]*)[\s]+\|[\s]+Event[\s]+\[id=(?<fld2>[^,]*),[\s]+timestamp=(?<event_time_string>[^,]*),[\s]+type=com/vmware/vcloud/event/(?<action>[^\s]*)[\s]+properties=\{[\s]+currentContext\.org\.name=(?<user_org>[^,]*),[\s]+vc\.url=(?<url>[^,]*),[\s]+currentContext\.user\.id=(?<fld3>[^,]*),[\s]+vc\.id=(?<fld44>[^,]*),[\s]+vc\.name=(?<fld45>[^,]*),[\s]+entity\.type=(?<obj_type>[^,]*),[\s]+vc\.description=(?<fld46>[^,]*),[\s]+currentContext\.login\.user\.id=(?<fld5>[^,]*),[\s]+currentContext\.user\.name=(?<username>[^,]*),[\s]+currentContext\.org\.id=(?<fld7>[^,]*),[\s]+currentContext\.success=(?<result>[^,]*),[\s]+currentContext\.login\.org\.id=(?<fld9>[^,]*),[\s]+entity\.name=(?<obj_name>[^,]*),[\s]+vc\.username=(?<fld51>[^,]*),[\s]+entity\.id=(?<fld12>[^,]*),[\s]+currentContext\.cell\.uuid=(?<fld14>[^,]*),[\s]+\}\]$" }
			id => "msgParserId30"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-vmware_vcloudmsg.json"
#			template_name => "vmware_vcloud_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
