# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "sonicwall"
			"[observer][name]" => "Sonicwall-FW"
			"[observer][type]" => "Firewall"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: id=<hfld1> sn=<hserial_number> time="<date> <time>" fw=<hhostip> pri=<hseverity> c=<hcategory> m=<messageid> <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "id=%{hfld1} sn=%{hserial_number} time=\"%{date} %{time}\" fw=%{hhostip} pri=%{hseverity} c=%{hcategory} m=%{messageid} %{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: id=<hfld1> sn=<hserial_number> time="<date> <time>" fw=<hhostip> pri=<hseverity> <messageid>= <!payload:messageid>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^id=(?<hfld1>[^\s]*)[\s]+sn=(?<hserial_number>[^\s]*)[\s]+time=\"(?<date>[^\s]*)[\s]+(?<time>[^\"]*)\"[\s]+fw=(?<hhostip>[^\s]*)[\s]+pri=(?<hseverity>[^\s]*)[\s]+(?<message>(?<messageid>[^=]*)=[\s]+(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: id=<hfld1> sn=<hserial_number> time="<hdate> <htime>"  fw=<hhostip>  pri=<hseverity> c=<hcategory> m=<messageid> <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "id=%{hfld1} sn=%{hserial_number} time=\"%{hdate} %{htime}\"  fw=%{hhostip}  pri=%{hseverity} c=%{hcategory} m=%{messageid} %{message}" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0004
	# line in RSA: <hfld20> id=<hfld1> sn=<hserial_number> time="<hdate> <htime>" fw=<hhostip>  pri=<hseverity> c=<hcategory> m=<messageid> <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{hfld20} id=%{hfld1} sn=%{hserial_number} time=\"%{hdate} %{htime}\" fw=%{hhostip}  pri=%{hseverity} c=%{hcategory} m=%{messageid} %{message}" }
			id => "header-0004"
			add_field => {
				"[rsa][header][id]" => "0004"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_sonicwallmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	# PARSER msgParserId0
	# line in RSA: SonicWALL activated
	if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "SonicWALL activated" }
			id => "msgParserId0"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "5" {
		# MESSAGE 5
		# line in RSA: Log Cleared
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Log Cleared" }
				id => "message-5"
				add_field => {
					"[event][id]" => "5"
					"[rsa][message][id1]" => "5"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 5:01
		# line in RSA: msg="<msg>" n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}" }
				id => "message-5:01"
				add_field => {
					"[event][id]" => "5:01"
					"[rsa][message][id1]" => "5:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "6" {
		# MESSAGE 6
		# line in RSA: Log successfully sent via email
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Log successfully sent via email" }
				id => "message-6"
				add_field => {
					"[event][id]" => "6"
					"[rsa][message][id1]" => "6"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 6:01
		# line in RSA: msg="Log successfully sent via email" n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"Log successfully sent via email\" n=%{fld1}" }
				id => "message-6:01"
				add_field => {
					"[event][id]" => "6:01"
					"[rsa][message][id1]" => "6:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId5
	# line in RSA: Log full; deactivating SonicWALL
	else if [logstash][msgparser][id] == "msgParserId5" {
		dissect {
			mapping => { "message" => "Log full; deactivating SonicWALL" }
			id => "msgParserId5"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId6
	# line in RSA: New Filter list loaded
	else if [logstash][msgparser][id] == "msgParserId6" {
		dissect {
			mapping => { "message" => "New Filter list loaded" }
			id => "msgParserId6"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId7
	# line in RSA: No new Filter list available
	else if [logstash][msgparser][id] == "msgParserId7" {
		dissect {
			mapping => { "message" => "No new Filter list available" }
			id => "msgParserId7"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId8
	# line in RSA: Problem loading the Filter list; check Filter settings
	else if [logstash][msgparser][id] == "msgParserId8" {
		dissect {
			mapping => { "message" => "Problem loading the Filter list; check Filter settings" }
			id => "msgParserId8"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId9
	# line in RSA: Problem loading the Filter list; check your DNS server
	else if [logstash][msgparser][id] == "msgParserId9" {
		dissect {
			mapping => { "message" => "Problem loading the Filter list; check your DNS server" }
			id => "msgParserId9"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "12" {
		# MESSAGE 12
		# line in RSA: Problem sending log email; check log settings
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Problem sending log email; check log settings" }
				id => "message-12"
				add_field => {
					"[event][id]" => "12"
					"[rsa][message][id1]" => "12"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 12:01
		# line in RSA: msg="<msg>" n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}" }
				id => "message-12:01"
				add_field => {
					"[event][id]" => "12:01"
					"[rsa][message][id1]" => "12:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId11
	# line in RSA: Restarting SonicWALL; dumping log to email
	else if [logstash][msgparser][id] == "msgParserId11" {
		dissect {
			mapping => { "message" => "Restarting SonicWALL; dumping log to email" }
			id => "msgParserId11"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "14" {
		# MESSAGE 14
		# line in RSA: { msg="Web site access denied" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> dstname=<dhost> arg=<fld2> code=<icmpcode> | Web site blocked }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^([\s]*msg=\"Web[\s]+site[\s]+access[\s]+denied\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+dstname=(?<dhost>[^\s]*)[\s]+arg=(?<fld2>[^\s]*)[\s]+code=(?<icmpcode>[^\s]*)[\s]+|[\s]*Web[\s]+site[\s]+blocked[\s]+)$" }
				id => "message-14"
				add_field => {
				"action" => "Web site access denied"
					"[event][id]" => "14"
					"[rsa][message][id1]" => "14"
					"[event][categoryid]" => "1204020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 14:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> code= | <daddr>:<dport>:<dinterface> code= } <fld3> Category=<fld4> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+code=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+code=[\s]+)[\s]+(?<fld3>[^\s]*)[\s]+Category=(?<fld4>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-14:01"
				add_field => {
					"[event][id]" => "14:01"
					"[rsa][message][id1]" => "14:01"
					"[event][categoryid]" => "1204020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 14:02
		# line in RSA: msg="<msg>" app=<fld1> sess="<fld2>" n=<fld3> usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> dstname=<name> arg=<param> code=<resultcode> Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1} sess=\"%{fld2}\" n=%{fld3} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} dstname=%{name} arg=%{param} code=%{resultcode} Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-14:02"
				add_field => {
					"[event][id]" => "14:02"
					"[rsa][message][id1]" => "14:02"
					"[event][categoryid]" => "1204020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 14:03
		# line in RSA: msg="<msg>" app=<fld1>sess="<fld2>" n=<fld3>usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>dstname=<dhost>arg=<param>code=<resultcode>Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1}sess=\"%{fld2}\" n=%{fld3}usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}dstname=%{dhost}arg=%{param}code=%{resultcode}Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-14:03"
				add_field => {
					"[event][id]" => "14:03"
					"[rsa][message][id1]" => "14:03"
					"[event][categoryid]" => "1204020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 14:04
		# line in RSA: msg="<msg>" app=<fld1> sess="<fld2>" n=<fld3> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>:<dhost> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> dstname=<name> arg=<param> code=<resultcode> Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1} sess=\"%{fld2}\" n=%{fld3} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} dstname=%{name} arg=%{param} code=%{resultcode} Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-14:04"
				add_field => {
					"[event][id]" => "14:04"
					"[rsa][message][id1]" => "14:04"
					"[event][categoryid]" => "1204020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 14:05
		# line in RSA: msg="<msg>" app=<fld1> sess="<fld2>" n=<fld3> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr>dstMac=<dmacaddr> proto=<protocol> dstname=<dhost> arg=<param> code=<resultcode> Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1} sess=\"%{fld2}\" n=%{fld3} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} srcMac=%{smacaddr}dstMac=%{dmacaddr} proto=%{protocol} dstname=%{dhost} arg=%{param} code=%{resultcode} Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-14:05"
				add_field => {
					"[event][id]" => "14:05"
					"[rsa][message][id1]" => "14:05"
					"[event][categoryid]" => "1204020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId18
	# line in RSA: Newsgroup blocked
	else if [logstash][msgparser][id] == "msgParserId18" {
		dissect {
			mapping => { "message" => "Newsgroup blocked" }
			id => "msgParserId18"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId19
	# line in RSA: Web site accessed
	else if [logstash][msgparser][id] == "msgParserId19" {
		dissect {
			mapping => { "message" => "Web site accessed" }
			id => "msgParserId19"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId20
	# line in RSA: Newsgroup accessed
	else if [logstash][msgparser][id] == "msgParserId20" {
		dissect {
			mapping => { "message" => "Newsgroup accessed" }
			id => "msgParserId20"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId21
	# line in RSA: ActiveX blocked
	else if [logstash][msgparser][id] == "msgParserId21" {
		dissect {
			mapping => { "message" => "ActiveX blocked" }
			id => "msgParserId21"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId22
	# line in RSA: Java blocked
	else if [logstash][msgparser][id] == "msgParserId22" {
		dissect {
			mapping => { "message" => "Java blocked" }
			id => "msgParserId22"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId23
	# line in RSA: ActiveX or Java archive blocked
	else if [logstash][msgparser][id] == "msgParserId23" {
		dissect {
			mapping => { "message" => "ActiveX or Java archive blocked" }
			id => "msgParserId23"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId24
	# line in RSA: Cookie removed
	else if [logstash][msgparser][id] == "msgParserId24" {
		dissect {
			mapping => { "message" => "Cookie removed" }
			id => "msgParserId24"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId25
	# line in RSA: Ping of death blocked
	else if [logstash][msgparser][id] == "msgParserId25" {
		dissect {
			mapping => { "message" => "Ping of death blocked" }
			id => "msgParserId25"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "23" {
		# MESSAGE 23
		# line in RSA: IP spoof detected
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IP spoof detected" }
				id => "message-23"
				add_field => {
					"[event][id]" => "23"
					"[rsa][message][id1]" => "23"
					"[event][categoryid]" => "1002010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 23:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst={ <daddr>:<dport>:<dinterface> | <daddr> } { -  MAC address: | mac= } <smacaddr>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+([\s]*\-[\s]+MAC[\s]+address:[\s]+|[\s]*mac=[\s]+)[\s]+(?<smacaddr>.*)$" }
				id => "message-23:01"
				add_field => {
					"[event][id]" => "23:01"
					"[rsa][message][id1]" => "23:01"
					"[event][categoryid]" => "1002010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 23:02
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr> -  MAC address: <smacaddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr} -  MAC address: %{smacaddr}" }
				id => "message-23:02"
				add_field => {
					"[event][id]" => "23:02"
					"[rsa][message][id1]" => "23:02"
					"[event][categoryid]" => "1002010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 23:03
		# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst={ <daddr>:<dport>:<dinterface>:<dhost> srcMac= | <daddr>:<dport>:<dinterface> srcMac= } <smacaddr> dstMac=<dmacaddr> proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+srcMac=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=[\s]+)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>.*)$" }
				id => "message-23:03"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "23:03"
					"[rsa][message][id1]" => "23:03"
					"[event][categoryid]" => "1002010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "24" {
		# MESSAGE 24
		# line in RSA: Illegal LAN address in use
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Illegal LAN address in use" }
				id => "message-24"
				add_field => {
					"[event][id]" => "24"
					"[rsa][message][id1]" => "24"
					"[event][categoryid]" => "1805010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 24:01
		# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> note="<event_description>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} note=\"%{event_description}\"" }
				id => "message-24:01"
				add_field => {
					"[event][id]" => "24:01"
					"[rsa][message][id1]" => "24:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId31
	# line in RSA: Possible SYN flood attack
	else if [logstash][msgparser][id] == "msgParserId31" {
		dissect {
			mapping => { "message" => "Possible SYN flood attack" }
			id => "msgParserId31"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId32
	# line in RSA: Probable SYN flood attack
	else if [logstash][msgparser][id] == "msgParserId32" {
		dissect {
			mapping => { "message" => "Probable SYN flood attack" }
			id => "msgParserId32"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId33
	# line in RSA: Land Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId33" {
		dissect {
			mapping => { "message" => "Land Attack Dropped" }
			id => "msgParserId33"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "28" {
		# MESSAGE 28
		# line in RSA: Fragmented Packet Dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Fragmented Packet Dropped" }
				id => "message-28"
				add_field => {
					"[event][id]" => "28"
					"[rsa][message][id1]" => "28"
					"[event][categoryid]" => "1002010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 28:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol}" }
				id => "message-28:01"
				add_field => {
					"[event][id]" => "28:01"
					"[rsa][message][id1]" => "28:01"
					"[event][categoryid]" => "1002010000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "29" {
		# MESSAGE 29
		# line in RSA: Successful administrator login
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Successful administrator login" }
				id => "message-29"
				add_field => {
					"[event][id]" => "29"
					"[rsa][message][id1]" => "29"
					"[event][categoryid]" => "1302000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 29:01
		# line in RSA: msg="<action>" n=<fld1> usr=<username> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+usr=(?<username>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-29:01"
				add_field => {
					"[event][id]" => "29:01"
					"[rsa][message][id1]" => "29:01"
					"[event][categoryid]" => "1401050100"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "30" {
		# MESSAGE 30
		# line in RSA: Administrator login failed - incorrect password
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Administrator login failed - incorrect password" }
				id => "message-30"
				add_field => {
					"[event][id]" => "30"
					"[rsa][message][id1]" => "30"
					"[event][categoryid]" => "1401030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 30:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-30:01"
				add_field => {
					"[event][id]" => "30:01"
					"[rsa][message][id1]" => "30:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "31" {
		# MESSAGE 31
		# line in RSA: Successful user login
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Successful user login" }
				id => "message-31"
				add_field => {
					"[event][id]" => "31"
					"[rsa][message][id1]" => "31"
					"[event][categoryid]" => "1302000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 31:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-31:01"
				add_field => {
					"[event][id]" => "31:01"
					"[rsa][message][id1]" => "31:01"
					"[event][categoryid]" => "1302000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 31:02
		# line in RSA: msg="<msg>" dur=<duration> n=<fld1> usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost> proto=<protocol> note="<rulename>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" dur=%{duration} n=%{fld1} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost} proto=%{protocol} note=\"%{rulename}\" fw_action=\"%{action}\"" }
				id => "message-31:02"
				add_field => {
					"[event][id]" => "31:02"
					"[rsa][message][id1]" => "31:02"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 31:03
		# line in RSA: msg="<msg>" dur=<duration>n=<fld1>usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost>dst=<daddr>:<dport>:<dinterface>proto=<protocol>note="<rulename>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" dur=%{duration}n=%{fld1}usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost}dst=%{daddr}:%{dport}:%{dinterface}proto=%{protocol}note=\"%{rulename}\" fw_action=\"%{action}\"" }
				id => "message-31:03"
				add_field => {
					"[event][id]" => "31:03"
					"[rsa][message][id1]" => "31:03"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 31:04
		# line in RSA: msg="<msg>" dur=<duration> n=<fld1> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol> note="<rulename>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" dur=%{duration} n=%{fld1} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol} note=\"%{rulename}\" fw_action=\"%{action}\"" }
				id => "message-31:04"
				add_field => {
					"[event][id]" => "31:04"
					"[rsa][message][id1]" => "31:04"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "32" {
		# MESSAGE 32
		# line in RSA: User login failed - incorrect password
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "User login failed - incorrect password" }
				id => "message-32"
				add_field => {
					"[event][id]" => "32"
					"[rsa][message][id1]" => "32"
					"[event][categoryid]" => "1401030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 32:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-32:01"
				add_field => {
					"[event][id]" => "32:01"
					"[rsa][message][id1]" => "32:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "33" {
		# MESSAGE 33
		# line in RSA: Unknown user attempted to log in
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Unknown user attempted to log in" }
				id => "message-33"
				add_field => {
					"[event][id]" => "33"
					"[rsa][message][id1]" => "33"
					"[event][categoryid]" => "1301020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 33:01
		# line in RSA: msg="<action>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-33:01"
				add_field => {
					"[event][id]" => "33:01"
					"[rsa][message][id1]" => "33:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId47
	# line in RSA: Login screen timed out
	else if [logstash][msgparser][id] == "msgParserId47" {
		dissect {
			mapping => { "message" => "Login screen timed out" }
			id => "msgParserId47"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "35" {
		# MESSAGE 35
		# line in RSA: Attempted administrator login from WAN
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Attempted administrator login from WAN" }
				id => "message-35"
				add_field => {
					"[event][id]" => "35"
					"[rsa][message][id1]" => "35"
					"[event][categoryid]" => "1401040000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 35:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }  
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-35:01"
				add_field => {
					"[event][id]" => "35:01"
					"[rsa][message][id1]" => "35:01"
					"[event][categoryid]" => "1401050200"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "36" {
		# MESSAGE 36
		# line in RSA: TCP connection dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "TCP connection dropped" }
				id => "message-36"
				add_field => {
					"[event][id]" => "36"
					"[rsa][message][id1]" => "36"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 36:01
		# line in RSA: msg="<msg>" {app=<fld51> appName="<application>" n=<fld1>|n=<fld1>} src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> } {srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> fw_action="<action>" | rule=<rule> | proto=<protocol> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+(app=(?<fld51>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)|n=(?<fld1>[^\s]*))[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+(srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"[\s]+|[\s]*rule=(?<rule>[^\s]*)[\s]+|[\s]*proto=(?<protocol>[^\s]*)[\s]+)$" }
				id => "message-36:01"
				add_field => {
					"[event][id]" => "36:01"
					"[rsa][message][id1]" => "36:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 36:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } { rule=<rule> | proto=<protocol> } npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+([\s]*rule=(?<rule>[^\s]*)[\s]+|[\s]*proto=(?<protocol>[^\s]*)[\s]+)[\s]+npcs=(?<info>.*)$" }
				id => "message-36:02"
				add_field => {
					"[event][id]" => "36:02"
					"[rsa][message][id1]" => "36:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "37" {
		# MESSAGE 37
		# line in RSA: UDP packet dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "UDP packet dropped" }
				id => "message-37"
				add_field => {
					"[event][id]" => "37"
					"[rsa][message][id1]" => "37"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 37:01
		# line in RSA: msg="UDP packet dropped" {app=<fld51> appName="<application>" n=<fld1>|n=<fld1>} src=<saddr>:<sport>:<sinterface> dst=<daddr>:{<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr>|<dport> srcMac=<smacaddr> dstMac=<dmacaddr>|<dport>:<dinterface>} {proto=<protocol> fw_action="<fld3>" | rule=<rule>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"UDP[\s]+packet[\s]+dropped\"[\s]+(app=(?<fld51>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)|n=(?<fld1>[^\s]*))[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):((?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)|(?<dport>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)|(?<dport>[^:]*):(?<dinterface>[^\s]*))[\s]+(proto=(?<protocol>[^\s]*)[\s]+fw_action=\"(?<fld3>[^\"]*)\"[\s]+|[\s]*rule=(?<rule>.*))$" }
				id => "message-37:01"
				add_field => {
					"[event][id]" => "37:01"
					"[rsa][message][id1]" => "37:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 37:02
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr> rule=<rule>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr} rule=%{rule}" }
				id => "message-37:02"
				add_field => {
					"[event][id]" => "37:02"
					"[rsa][message][id1]" => "37:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 37:03
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> proto= | <daddr>:<dport>:<dinterface> proto= } <protocol> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=[\s]+)[\s]+(?<protocol>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-37:03"
				add_field => {
					"[event][id]" => "37:03"
					"[rsa][message][id1]" => "37:03"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 37:04
		# line in RSA: msg="<msg>" sess="<fld1>" n=<fld2> usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=\"%{fld1}\" n=%{fld2} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} fw_action=\"%{action}\"" }
				id => "message-37:04"
				add_field => {
					"[event][id]" => "37:04"
					"[rsa][message][id1]" => "37:04"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "38" {
		# MESSAGE 38
		# line in RSA: ICMP packet dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "ICMP packet dropped" }
				id => "message-38"
				add_field => {
					"[event][id]" => "38"
					"[rsa][message][id1]" => "38"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 38:01
		# line in RSA: msg="<msg>" n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> }  { type=<type> code=<code> | rule=<rule> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+([\s]*type=(?<type>[^\s]*)[\s]+code=(?<code>[^\s]*)[\s]+|[\s]*rule=(?<rule>[^\s]*)[\s]+)$" }
				id => "message-38:01"
				add_field => {
					"[event][id]" => "38:01"
					"[rsa][message][id1]" => "38:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 38:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> type= | <daddr>:<dport>:<dinterface> type= } <fld3> icmpCode=<fld4> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+type=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+type=[\s]+)[\s]+(?<fld3>[^\s]*)[\s]+icmpCode=(?<fld4>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-38:02"
				add_field => {
					"[event][id]" => "38:02"
					"[rsa][message][id1]" => "38:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 38:03
		# line in RSA: {msg="<event_description>" app=<fld2> appName="<application>"|msg="<event_description>"} n=<fld1> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface> srcMac=|dst=<daddr> srcMac=} <smacaddr> dstMac=<dmacaddr> proto=<protocol> type=<icmptype> icmpCode=<icmpcode> fw_action="<action>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld2>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|msg=\"(?<event_description>[^\"]*)\")[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|dst=(?<daddr>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+type=(?<icmptype>[^\s]*)[\s]+icmpCode=(?<icmpcode>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
				id => "message-38:03"
				add_field => {
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "38:03"
					"[rsa][message][id1]" => "38:03"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId62
	# line in RSA: PPTP packet dropped
	else if [logstash][msgparser][id] == "msgParserId62" {
		dissect {
			mapping => { "message" => "PPTP packet dropped" }
			id => "msgParserId62"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId63
	# line in RSA: IPSec packet dropped
	else if [logstash][msgparser][id] == "msgParserId63" {
		dissect {
			mapping => { "message" => "IPSec packet dropped" }
			id => "msgParserId63"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "41" {
		# MESSAGE 41:01
		# line in RSA: msg="<event_description>dropped" n=<fld1> src=<saddr>:<sport>:<sinterface>:<fld2> dst=<daddr>:<dport>:<dinterface>:<fld3>  note="IP Protocol: <dclass_counter1>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}dropped\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{fld2} dst=%{daddr}:%{dport}:%{dinterface}:%{fld3}  note=\"IP Protocol: %{dclass_counter1}\"" }
				id => "message-41:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "41:01"
					"[rsa][message][id1]" => "41:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 41:02
		# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr>:<stransport>:<sinterface> dst=<dtransaddr>:<dtransport>::<dinterface>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr}:%{stransport}:%{sinterface} dst=%{dtransaddr}:%{dtransport}::%{dinterface}" }
				id => "message-41:02"
				add_field => {
					"[event][id]" => "41:02"
					"[rsa][message][id1]" => "41:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 41:03
		# line in RSA: Unknown protocol dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Unknown protocol dropped" }
				id => "message-41:03"
				add_field => {
					"[event][id]" => "41:03"
					"[rsa][message][id1]" => "41:03"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId67
	# line in RSA: IPSec packet dropped; waiting for pending IPSec connection
	else if [logstash][msgparser][id] == "msgParserId67" {
		dissect {
			mapping => { "message" => "IPSec packet dropped; waiting for pending IPSec connection" }
			id => "msgParserId67"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId68
	# line in RSA: IPSec connection interrupt
	else if [logstash][msgparser][id] == "msgParserId68" {
		dissect {
			mapping => { "message" => "IPSec connection interrupt" }
			id => "msgParserId68"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId69
	# line in RSA: NAT could not remap incoming packet
	else if [logstash][msgparser][id] == "msgParserId69" {
		dissect {
			mapping => { "message" => "NAT could not remap incoming packet" }
			id => "msgParserId69"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "45" {
		# MESSAGE 45
		# line in RSA: ARP timeout
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "ARP timeout" }
				id => "message-45"
				add_field => {
					"[event][id]" => "45"
					"[rsa][message][id1]" => "45"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 45:01
		# line in RSA: msg="ARP timeout" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"ARP timeout\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-45:01"
				add_field => {
					"[event][id]" => "45:01"
					"[rsa][message][id1]" => "45:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 45:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src=<saddr> dst=<daddr> npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2} src=%{saddr} dst=%{daddr} npcs=%{info}" }
				id => "message-45:02"
				add_field => {
					"[event][id]" => "45:02"
					"[rsa][message][id1]" => "45:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "46" {
		# MESSAGE 46:01
		# line in RSA: msg="<event_description>dropped" n=<fld1> src=<saddr>:<sport>:<sinterface>:<fld2> dst=<daddr>:<dport>:<dinterface>:<fld3>  proto=<protocol>/<fld4>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}dropped\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{fld2} dst=%{daddr}:%{dport}:%{dinterface}:%{fld3}  proto=%{protocol}/%{fld4}" }
				id => "message-46:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "46:01"
					"[rsa][message][id1]" => "46:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 46:02
		# line in RSA: msg="Broadcast packet dropped" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"Broadcast packet dropped\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol}" }
				id => "message-46:02"
				add_field => {
					"[event][id]" => "46:02"
					"[rsa][message][id1]" => "46:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 46
		# line in RSA: Broadcast packet dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Broadcast packet dropped" }
				id => "message-46"
				add_field => {
					"[event][id]" => "46"
					"[rsa][message][id1]" => "46"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 46:03
		# line in RSA: msg="Broadcast packet dropped" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> proto= | <daddr>:<dport>:<dinterface> proto= } <protocol> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"Broadcast[\s]+packet[\s]+dropped\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=[\s]+)[\s]+(?<protocol>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-46:03"
				add_field => {
					"[event][id]" => "46:03"
					"[rsa][message][id1]" => "46:03"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId77
	# line in RSA: No ICMP redirect sent
	else if [logstash][msgparser][id] == "msgParserId77" {
		dissect {
			mapping => { "message" => "No ICMP redirect sent" }
			id => "msgParserId77"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId78
	# line in RSA: Out-of-order command packet dropped
	else if [logstash][msgparser][id] == "msgParserId78" {
		dissect {
			mapping => { "message" => "Out-of-order command packet dropped" }
			id => "msgParserId78"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId79
	# line in RSA: Failure to add data channel
	else if [logstash][msgparser][id] == "msgParserId79" {
		dissect {
			mapping => { "message" => "Failure to add data channel" }
			id => "msgParserId79"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId80
	# line in RSA: RealAudio decode failure
	else if [logstash][msgparser][id] == "msgParserId80" {
		dissect {
			mapping => { "message" => "RealAudio decode failure" }
			id => "msgParserId80"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId81
	# line in RSA: Duplicate packet dropped
	else if [logstash][msgparser][id] == "msgParserId81" {
		dissect {
			mapping => { "message" => "Duplicate packet dropped" }
			id => "msgParserId81"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId82
	# line in RSA: No HOST tag found in HTTP request
	else if [logstash][msgparser][id] == "msgParserId82" {
		dissect {
			mapping => { "message" => "No HOST tag found in HTTP request" }
			id => "msgParserId82"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId83
	# line in RSA: The cache is full; too many open connections; some will be dropped
	else if [logstash][msgparser][id] == "msgParserId83" {
		dissect {
			mapping => { "message" => "The cache is full; too many open connections; some will be dropped" }
			id => "msgParserId83"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId84
	# line in RSA: License exceeded: Connection dropped because too many IP addresses are in use on your LAN
	else if [logstash][msgparser][id] == "msgParserId84" {
		dissect {
			mapping => { "message" => "License exceeded: Connection dropped because too many IP addresses are in use on your LAN" }
			id => "msgParserId84"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId85
	# line in RSA: Access to Proxy Server Blocked
	else if [logstash][msgparser][id] == "msgParserId85" {
		dissect {
			mapping => { "message" => "Access to Proxy Server Blocked" }
			id => "msgParserId85"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId86
	# line in RSA: Diagnostic Code E
	else if [logstash][msgparser][id] == "msgParserId86" {
		dissect {
			mapping => { "message" => "Diagnostic Code E" }
			id => "msgParserId86"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId87
	# line in RSA: Dynamic IPSec client connected
	else if [logstash][msgparser][id] == "msgParserId87" {
		dissect {
			mapping => { "message" => "Dynamic IPSec client connected" }
			id => "msgParserId87"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "63" {
		# MESSAGE 63
		# line in RSA: IPSec packet too big
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IPSec packet too big" }
				id => "message-63"
				add_field => {
					"[event][id]" => "63"
					"[rsa][message][id1]" => "63"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 63:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-63:01"
				add_field => {
					"[event][id]" => "63:01"
					"[rsa][message][id1]" => "63:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId90
	# line in RSA: Diagnostic Code D
	else if [logstash][msgparser][id] == "msgParserId90" {
		dissect {
			mapping => { "message" => "Diagnostic Code D" }
			id => "msgParserId90"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId91
	# line in RSA: Illegal IPSec SPI
	else if [logstash][msgparser][id] == "msgParserId91" {
		dissect {
			mapping => { "message" => "Illegal IPSec SPI" }
			id => "msgParserId91"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId92
	# line in RSA: Unknown IPSec SPI
	else if [logstash][msgparser][id] == "msgParserId92" {
		dissect {
			mapping => { "message" => "Unknown IPSec SPI" }
			id => "msgParserId92"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "67" {
		# MESSAGE 67
		# line in RSA: IPSec Authentication Failed
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IPSec Authentication Failed" }
				id => "message-67"
				add_field => {
					"[event][id]" => "67"
					"[rsa][message][id1]" => "67"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 67:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+$" }
				id => "message-67:01"
				add_field => {
					"[event][id]" => "67:01"
					"[rsa][message][id1]" => "67:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId94
	# line in RSA: IPSec Decryption Failed
	else if [logstash][msgparser][id] == "msgParserId94" {
		dissect {
			mapping => { "message" => "IPSec Decryption Failed" }
			id => "msgParserId94"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId95
	# line in RSA: Incompatible IPSec Security Association
	else if [logstash][msgparser][id] == "msgParserId95" {
		dissect {
			mapping => { "message" => "Incompatible IPSec Security Association" }
			id => "msgParserId95"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "70" {
		# MESSAGE 70
		# line in RSA: IPSec packet from illegal host
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IPSec packet from illegal host" }
				id => "message-70"
				add_field => {
					"[event][id]" => "70"
					"[rsa][message][id1]" => "70"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 70:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> {dst=<daddr> | dstname=<name>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^\s]*)[\s]+(dst=(?<daddr>[^\s]*)[\s]+|[\s]*dstname=(?<name>.*))$" }
				id => "message-70:01"
				add_field => {
					"[event][id]" => "70:01"
					"[rsa][message][id1]" => "70:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "72" {
		# MESSAGE 72
		# line in RSA: NetBus Attack Dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "NetBus Attack Dropped" }
				id => "message-72"
				add_field => {
					"[event][id]" => "72"
					"[rsa][message][id1]" => "72"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 72:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}" }
				id => "message-72:01"
				add_field => {
					"[event][id]" => "72:01"
					"[rsa][message][id1]" => "72:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId100
	# line in RSA: Back Orifice Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId100" {
		dissect {
			mapping => { "message" => "Back Orifice Attack Dropped" }
			id => "msgParserId100"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId101
	# line in RSA: Net Spy Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId101" {
		dissect {
			mapping => { "message" => "Net Spy Attack Dropped" }
			id => "msgParserId101"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId102
	# line in RSA: Sub Seven Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId102" {
		dissect {
			mapping => { "message" => "Sub Seven Attack Dropped" }
			id => "msgParserId102"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId103
	# line in RSA: Ripper Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId103" {
		dissect {
			mapping => { "message" => "Ripper Attack Dropped" }
			id => "msgParserId103"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId104
	# line in RSA: Striker Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId104" {
		dissect {
			mapping => { "message" => "Striker Attack Dropped" }
			id => "msgParserId104"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId105
	# line in RSA: Senna Spy Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId105" {
		dissect {
			mapping => { "message" => "Senna Spy Attack Dropped" }
			id => "msgParserId105"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId106
	# line in RSA: Priority Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId106" {
		dissect {
			mapping => { "message" => "Priority Attack Dropped" }
			id => "msgParserId106"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId107
	# line in RSA: Ini Killer Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId107" {
		dissect {
			mapping => { "message" => "Ini Killer Attack Dropped" }
			id => "msgParserId107"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId108
	# line in RSA: Smurf Amplification Attack Dropped
	else if [logstash][msgparser][id] == "msgParserId108" {
		dissect {
			mapping => { "message" => "Smurf Amplification Attack Dropped" }
			id => "msgParserId108"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "82" {
		# MESSAGE 82
		# line in RSA: Possible Port Scan
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Possible Port Scan" }
				id => "message-82"
				add_field => {
					"[event][id]" => "82"
					"[rsa][message][id1]" => "82"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 82:02
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> note="<info>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} note=\"%{info}\"" }
				id => "message-82:02"
				add_field => {
					"[event][id]" => "82:02"
					"[rsa][message][id1]" => "82:02"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 82:03
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> note="<fld3>" npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} note=\"%{fld3}\" npcs=%{info}" }
				id => "message-82:03"
				add_field => {
					"[event][id]" => "82:03"
					"[rsa][message][id1]" => "82:03"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 82:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}" }
				id => "message-82:01"
				add_field => {
					"[event][id]" => "82:01"
					"[rsa][message][id1]" => "82:01"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "83" {
		# MESSAGE 83
		# line in RSA: Probable Port Scan
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Probable Port Scan" }
				id => "message-83"
				add_field => {
					"[event][id]" => "83"
					"[rsa][message][id1]" => "83"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 83:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}" }
				id => "message-83:01"
				add_field => {
					"[event][id]" => "83:01"
					"[rsa][message][id1]" => "83:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 83:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> note="<fld3>" npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} note=\"%{fld3}\" npcs=%{info}" }
				id => "message-83:02"
				add_field => {
					"[event][id]" => "83:02"
					"[rsa][message][id1]" => "83:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId113
	# line in RSA: { msg="Failed to resolve name" n=<fld1> dstname=<dhost> |  Failed to resolve name }
	else if [logstash][msgparser][id] == "msgParserId113" {
		grok {
			match => { "message" => "^([\s]*msg=\"Failed[\s]+to[\s]+resolve[\s]+name\"[\s]+n=(?<fld1>[^\s]*)[\s]+dstname=(?<dhost>[^\s]*)[\s]+|[\s]*Failed[\s]+to[\s]+resolve[\s]+name[\s]+)$" }
			id => "msgParserId113"
			add_field => {
				"action" => "Failed to resolve name"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "87" {
		# MESSAGE 87
		# line in RSA: IKE Responder: Accepting IPSec proposal
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IKE Responder: Accepting IPSec proposal" }
				id => "message-87"
				add_field => {
					"[event][id]" => "87"
					"[rsa][message][id1]" => "87"
					"[event][categoryid]" => "1605020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 87:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-87:01"
				add_field => {
					"[event][id]" => "87:01"
					"[rsa][message][id1]" => "87:01"
					"[event][categoryid]" => "1605020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "88" {
		# MESSAGE 88
		# line in RSA: IKE Responder: IPSec proposal not acceptable
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IKE Responder: IPSec proposal not acceptable" }
				id => "message-88"
				add_field => {
					"[event][id]" => "88"
					"[rsa][message][id1]" => "88"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 88:01
		# line in RSA: msg="<msg>" n=<fld> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld} src=%{saddr} dst=%{daddr}" }
				id => "message-88:01"
				add_field => {
					"[event][id]" => "88:01"
					"[rsa][message][id1]" => "88:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "89" {
		# MESSAGE 89
		# line in RSA: IKE negotiation complete. Adding IPSec SA
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IKE negotiation complete. Adding IPSec SA" }
				id => "message-89"
				add_field => {
					"[event][id]" => "89"
					"[rsa][message][id1]" => "89"
					"[event][categoryid]" => "1605020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 89:01
		# line in RSA: msg="<msg>" n=<fld1> {src=<saddr>:::<sinterface> dst=<daddr>:::<dinterface> | src=<saddr> dst=<daddr> dstname=<name>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+(src=(?<saddr>[^:]*):::(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):::(?<dinterface>[^\s]*)[\s]+|[\s]*src=(?<saddr>[^\s]*)[\s]+dst=(?<daddr>[^\s]*)[\s]+dstname=(?<name>.*))$" }
				id => "message-89:01"
				add_field => {
					"[event][id]" => "89:01"
					"[rsa][message][id1]" => "89:01"
					"[event][categoryid]" => "1605020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId119
	# line in RSA: Starting IKE negotiation
	else if [logstash][msgparser][id] == "msgParserId119" {
		dissect {
			mapping => { "message" => "Starting IKE negotiation" }
			id => "msgParserId119"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId120
	# line in RSA: Deleting IPSec SA for destination
	else if [logstash][msgparser][id] == "msgParserId120" {
		dissect {
			mapping => { "message" => "Deleting IPSec SA for destination" }
			id => "msgParserId120"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId121
	# line in RSA: Deleting IPSec SA
	else if [logstash][msgparser][id] == "msgParserId121" {
		dissect {
			mapping => { "message" => "Deleting IPSec SA" }
			id => "msgParserId121"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId122
	# line in RSA: Diagnostic Code A
	else if [logstash][msgparser][id] == "msgParserId122" {
		dissect {
			mapping => { "message" => "Diagnostic Code A" }
			id => "msgParserId122"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId123
	# line in RSA: Diagnostic Code B
	else if [logstash][msgparser][id] == "msgParserId123" {
		dissect {
			mapping => { "message" => "Diagnostic Code B" }
			id => "msgParserId123"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId124
	# line in RSA: Diagnostic Code C
	else if [logstash][msgparser][id] == "msgParserId124" {
		dissect {
			mapping => { "message" => "Diagnostic Code C" }
			id => "msgParserId124"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId125
	# line in RSA: Status
	else if [logstash][msgparser][id] == "msgParserId125" {
		dissect {
			mapping => { "message" => "Status" }
			id => "msgParserId125"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "97" {
		# MESSAGE 97
		# line in RSA: Web site hit
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Web site hit" }
				id => "message-97"
				add_field => {
					"[event][id]" => "97"
					"[rsa][message][id1]" => "97"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 97:01
		# line in RSA: n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> op=<fld> { rcvd=<rbytes> | sent=<sbytes> } { result=<result> dstname=<name> | dstname=<name> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+op=(?<fld>[^\s]*)[\s]+([\s]*rcvd=(?<rbytes>[^\s]*)[\s]+|[\s]*sent=(?<sbytes>[^\s]*)[\s]+)[\s]+([\s]*result=(?<result>[^\s]*)[\s]+dstname=(?<name>[^\s]*)[\s]+|[\s]*dstname=(?<name>[^\s]*)[\s]+)$" }
				id => "message-97:01"
				add_field => {
					"[event][id]" => "97:01"
					"[rsa][message][id1]" => "97:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 97:02
		# line in RSA: n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> op=<fld> result=<result>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+op=(?<fld>[^\s]*)[\s]+result=(?<result>.*)$" }
				id => "message-97:02"
				add_field => {
					"[event][id]" => "97:02"
					"[rsa][message][id1]" => "97:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 97:03
		# line in RSA: sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> op=<fld3> sent=<sbytes> rcvd=<rbytes> { result=<result> dstname=<name> | dstname=<name> } arg=<fld4> code=<fld5> Category="<category>" npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+op=(?<fld3>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+([\s]*result=(?<result>[^\s]*)[\s]+dstname=(?<name>[^\s]*)[\s]+|[\s]*dstname=(?<name>[^\s]*)[\s]+)[\s]+arg=(?<fld4>[^\s]*)[\s]+code=(?<fld5>[^\s]*)[\s]+Category=\"(?<category>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
				id => "message-97:03"
				add_field => {
					"[event][id]" => "97:03"
					"[rsa][message][id1]" => "97:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 97:04
		# line in RSA: sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> op=<fld3> { result=<result> dstname=<name> arg= | dstname=<name> arg= } <fld4> code=<fld5> Category="<category>" npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+op=(?<fld3>[^\s]*)[\s]+([\s]*result=(?<result>[^\s]*)[\s]+dstname=(?<name>[^\s]*)[\s]+arg=[\s]+|[\s]*dstname=(?<name>[^\s]*)[\s]+arg=[\s]+)[\s]+(?<fld4>[^\s]*)[\s]+code=(?<fld5>[^\s]*)[\s]+Category=\"(?<category>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
				id => "message-97:04"
				add_field => {
					"[event][id]" => "97:04"
					"[rsa][message][id1]" => "97:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 97:05
		# line in RSA: n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> op=<fld2> dstname=<name> arg=<fld3> code=<fld4> Category=<category>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+op=(?<fld2>[^\s]*)[\s]+dstname=(?<name>[^\s]*)[\s]+arg=(?<fld3>[^\s]*)[\s]+code=(?<fld4>[^\s]*)[\s]+Category=(?<category>.*)$" }
				id => "message-97:05"
				add_field => {
					"[event][id]" => "97:05"
					"[rsa][message][id1]" => "97:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 97:06
		# line in RSA: app=<fld1>sess="<fld2>" n=<fld3>usr="<username>" {src=<saddr>:<sport>:<sinterface>:<shost>dst=|src=<saddr>:<sport>:<sinterface>dst=}<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>sent=<sbytes>rcvd=<rbytes>dstname=<dhost>arg=<param>code=<resultcode>Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^app=(?<fld1>[^s]*)sess=\"(?<fld2>[^\"]*)\"[\s]+n=(?<fld3>[^u]*)usr=\"(?<username>[^\"]*)\"[\s]+(src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^d]*)dst=|src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=)(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^s]*)srcMac=(?<smacaddr>[^d]*)dstMac=(?<dmacaddr>[^p]*)proto=(?<protocol>[^s]*)sent=(?<sbytes>[^r]*)rcvd=(?<rbytes>[^d]*)dstname=(?<dhost>[^a]*)arg=(?<param>[^c]*)code=(?<resultcode>[^C]*)Category=\"(?<category>[^\"]*)\"[\s]+rule=\"(?<rule>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
				id => "message-97:06"
				add_field => {
					"[event][id]" => "97:06"
					"[rsa][message][id1]" => "97:06"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 97:07
		# line in RSA: app=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface>:<shost> {dst=<daddr>:<dport>:<dinterface>:<fld3> srcMac=|dst=<daddr>:<dport>:<dinterface> srcMac=}<smacaddr> dstMac=<dmacaddr> proto=<protocol> sent=<sbytes> rcvd=<rbytes> dstname=<dhost> arg=<param> code=<resultcode> Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^app=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<fld3>[^\s]*)[\s]+srcMac=|dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=)(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+dstname=(?<dhost>[^\s]*)[\s]+arg=(?<param>[^\s]*)[\s]+code=(?<resultcode>[^\s]*)[\s]+Category=\"(?<category>[^\"]*)\"[\s]+rule=\"(?<rule>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
				id => "message-97:07"
				add_field => {
					"[event][id]" => "97:07"
					"[rsa][message][id1]" => "97:07"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 97:08
		# line in RSA: app=<fld1>sess="<fld2>" n=<fld3>usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>sent=<sbytes>dstname=<dhost>arg=<param>code=<resultcode>Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "app=%{fld1}sess=\"%{fld2}\" n=%{fld3}usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}sent=%{sbytes}dstname=%{dhost}arg=%{param}code=%{resultcode}Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-97:08"
				add_field => {
					"[event][id]" => "97:08"
					"[rsa][message][id1]" => "97:08"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 97:09
		# line in RSA: app=<fld1>sess="<fld2>" n=<fld3>usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>sent=<sbytes>dstname=<dhost>arg=<param>code=<resultcode>Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "app=%{fld1}sess=\"%{fld2}\" n=%{fld3}usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}sent=%{sbytes}dstname=%{dhost}arg=%{param}code=%{resultcode}Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-97:09"
				add_field => {
					"[event][id]" => "97:09"
					"[rsa][message][id1]" => "97:09"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 97:10
		# line in RSA: app=<fld1>n=<fld2>src=<saddr>:<sport>:<sinterface>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>sent=<sbytes>rcvd=<rbytes>dstname=<dhost>arg=<param>code=<resultcode>Category="<category>" rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "app=%{fld1}n=%{fld2}src=%{saddr}:%{sport}:%{sinterface}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}sent=%{sbytes}rcvd=%{rbytes}dstname=%{dhost}arg=%{param}code=%{resultcode}Category=\"%{category}\" rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-97:10"
				add_field => {
					"[event][id]" => "97:10"
					"[rsa][message][id1]" => "97:10"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "98" {
		# MESSAGE 98
		# line in RSA: {msg="<event_description>" app=<fld2> appName="<application>"| msg="<event_description>"} n=<fld1> src=<saddr>:<sport>:<sinterface>:<shost> {dst=<daddr>:<dport>:<dinterface> dstMac=<dmacaddr>|dst=<daddr>:<dport>:<dinterface>:<dhost>}  {proto=<protocol> sent=<sbytes> fw_action="<action>"|proto=<protocol> sent=<sbytes> | proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld2>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|[\s]*msg=\"(?<event_description>[^\"]*)\")[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)|dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*))[\s]+(proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+|[\s]*proto=(?<protocol>.*))$" }
				id => "message-98"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Stop"
				"ec_theme" => "Communication"
				"action" => "Opened"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "98"
					"[rsa][message][id1]" => "98"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 98:07
		# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> dstMac=<dmacaddr> proto=<protocol>/<fld4> sent=<sbytes> rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} dstMac=%{dmacaddr} proto=%{protocol}/%{fld4} sent=%{sbytes} rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-98:07"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "98:07"
					"[rsa][message][id1]" => "98:07"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 98:01
		# line in RSA: {msg="<msg>" app=<fld2> sess="<fld3>"|msg="<msg>"} {n=<fld1> usr=<username>|n=<fld1>} src={<saddr>:<sport>:<sinterface>:<shost> dst=|<saddr>:<sport>:<sinterface>dst=|<saddr>dst=} {<daddr>:<dport>:<dinterface>:<dhost> | <daddr>:<dport>:<dinterface>| <daddr>} {dstMac=<dmacaddr> proto=<protocol> sent=<sbytes> fw_action="<action>"|dstMac=<dmacaddr> proto=<protocol> sent=<sbytes> |proto=<protocol> sent=<sbytes> rule="<rulename>" fw_action="<action>"|proto=<protocol> sent=<sbytes> fw_action="<action>"| proto=<protocol> sent=<sbytes>|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<msg>[^\"]*)\"[\s]+app=(?<fld2>[^\s]*)[\s]+sess=\"(?<fld3>[^\"]*)\"|msg=\"(?<msg>[^\"]*)\")[\s]+(n=(?<fld1>[^\s]*)[\s]+usr=(?<username>[^\s]*)|n=(?<fld1>[^\s]*))[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=|(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=|(?<saddr>[^d]*)dst=)[\s]+((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)|[\s]*(?<daddr>[^\s]*))[\s]+(dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+|proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rule=\"(?<rulename>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"|proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|[\s]*proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>.*)|proto=(?<protocol>.*))$" }
				id => "message-98:01"
				add_field => {
					"[event][id]" => "98:01"
					"[rsa][message][id1]" => "98:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 98:06
		# line in RSA: {msg="<event_description>" app=<fld2> appName="<application>" |msg="<event_description>" app=<fld2> | msg="<event_description>" sess=<fld2>} {n=<fld1> usr=<username> | n=<fld1> } src={ <saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> dstMac=<dmacaddr>|<daddr>:<dport>:<dinterface> dstMac=<dmacaddr> |<daddr>:<dport>:<dinterface>:<dhost> | <daddr>:<dport>:<dinterface>} proto=<protocol> {sent=<sbytes> rule="<rulename>" fw_action="<action>"|sent=<sbytes> rule="<rulename>" fw_action=<action>|sent=<sbytes> fw_action="<action>"|sent=<sbytes>|fw_action="<action>"}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld2>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"[\s]+|msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld2>[^\s]*)[\s]+|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+sess=(?<fld2>[^\s]*))[\s]+(n=(?<fld1>[^\s]*)[\s]+usr=(?<username>[^\s]*)[\s]+|[\s]*n=(?<fld1>[^\s]*)[\s]+)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*))[\s]+proto=(?<protocol>[^\s]*)[\s]+(sent=(?<sbytes>[^\s]*)[\s]+rule=\"(?<rulename>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"|sent=(?<sbytes>[^\s]*)[\s]+rule=\"(?<rulename>[^\"]*)\"[\s]+fw_action=(?<action>.*)|sent=(?<sbytes>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|sent=(?<sbytes>.*)|fw_action=\"(?<action>[^\"]*)\")$" }
				id => "message-98:06"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "98:06"
					"[rsa][message][id1]" => "98:06"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 98:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> usr=<username> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+usr=(?<username>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>.*)$" }
				id => "message-98:02"
				add_field => {
					"[event][id]" => "98:02"
					"[rsa][message][id1]" => "98:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 98:03
		# line in RSA: {Connection | msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(Connection[\s]+|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+)$" }
				id => "message-98:03"
				add_field => {
					"[event][id]" => "98:03"
					"[rsa][message][id1]" => "98:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 98:04
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> sent=<sbytes> vpnpolicy="<policyname>" npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+vpnpolicy=\"(?<policyname>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
				id => "message-98:04"
				add_field => {
					"[event][id]" => "98:04"
					"[rsa][message][id1]" => "98:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 98:05
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> sent=<sbytes> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-98:05"
				add_field => {
					"[event][id]" => "98:05"
					"[rsa][message][id1]" => "98:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId145
	# line in RSA: msg="<msg>" dur=<duration> n=<fld1> usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface> proto=<protocol> note="<rulename>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId145" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" dur=%{duration} n=%{fld1} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol} note=\"%{rulename}\" fw_action=\"%{action}\"" }
			id => "msgParserId145"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId146
	# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } note="<event_description>"
	else if [logstash][msgparser][id] == "msgParserId146" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+note=\"(?<event_description>[^\"]*)\"$" }
			id => "msgParserId146"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId147
	# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst={<daddr>:<dport>:<dinterface> srcMac=|<daddr> srcMac=} <smacaddr> dstMac=<dmacaddr> proto=<protocol> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId147" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|(?<daddr>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId147"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId148
	# line in RSA: Retransmitting DHCP DISCOVER.
	else if [logstash][msgparser][id] == "msgParserId148" {
		dissect {
			mapping => { "message" => "Retransmitting DHCP DISCOVER." }
			id => "msgParserId148"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId149
	# line in RSA: Retransmitting DHCP REQUEST (Requesting).
	else if [logstash][msgparser][id] == "msgParserId149" {
		dissect {
			mapping => { "message" => "Retransmitting DHCP REQUEST (Requesting)." }
			id => "msgParserId149"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId150
	# line in RSA: Retransmitting DHCP REQUEST (Renewing).
	else if [logstash][msgparser][id] == "msgParserId150" {
		dissect {
			mapping => { "message" => "Retransmitting DHCP REQUEST (Renewing)." }
			id => "msgParserId150"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId151
	# line in RSA: Retransmitting DHCP REQUEST (Rebinding).
	else if [logstash][msgparser][id] == "msgParserId151" {
		dissect {
			mapping => { "message" => "Retransmitting DHCP REQUEST (Rebinding)." }
			id => "msgParserId151"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId152
	# line in RSA: Retransmitting DHCP REQUEST (Rebooting).
	else if [logstash][msgparser][id] == "msgParserId152" {
		dissect {
			mapping => { "message" => "Retransmitting DHCP REQUEST (Rebooting)." }
			id => "msgParserId152"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId153
	# line in RSA: Retransmitting DHCP REQUEST (Verifying).
	else if [logstash][msgparser][id] == "msgParserId153" {
		dissect {
			mapping => { "message" => "Retransmitting DHCP REQUEST (Verifying)." }
			id => "msgParserId153"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId154
	# line in RSA: Sending DHCP DISCOVER.
	else if [logstash][msgparser][id] == "msgParserId154" {
		dissect {
			mapping => { "message" => "Sending DHCP DISCOVER." }
			id => "msgParserId154"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId155
	# line in RSA: DHCP Server not available. Did not get any DHCP OFFER.
	else if [logstash][msgparser][id] == "msgParserId155" {
		dissect {
			mapping => { "message" => "DHCP Server not available. Did not get any DHCP OFFER." }
			id => "msgParserId155"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId156
	# line in RSA: Got DHCP OFFER. Selecting.
	else if [logstash][msgparser][id] == "msgParserId156" {
		dissect {
			mapping => { "message" => "Got DHCP OFFER. Selecting." }
			id => "msgParserId156"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId157
	# line in RSA: Sending DHCP REQUEST.
	else if [logstash][msgparser][id] == "msgParserId157" {
		dissect {
			mapping => { "message" => "Sending DHCP REQUEST." }
			id => "msgParserId157"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId158
	# line in RSA: DHCP Client did not get DHCP ACK.
	else if [logstash][msgparser][id] == "msgParserId158" {
		dissect {
			mapping => { "message" => "DHCP Client did not get DHCP ACK." }
			id => "msgParserId158"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId159
	# line in RSA: DHCP Client got NACK.
	else if [logstash][msgparser][id] == "msgParserId159" {
		dissect {
			mapping => { "message" => "DHCP Client got NACK." }
			id => "msgParserId159"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "111" {
		# MESSAGE 111:01
		# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> dstname=<shost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} dstname=%{shost}" }
				id => "message-111:01"
				add_field => {
					"[event][id]" => "111:01"
					"[rsa][message][id1]" => "111:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 111
		# line in RSA: DHCP Client got ACK from server.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "DHCP Client got ACK from server." }
				id => "message-111"
				add_field => {
					"[event][id]" => "111"
					"[rsa][message][id1]" => "111"
					"[event][categoryid]" => "1605020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId162
	# line in RSA: DHCP Client is declining address offered by the server.
	else if [logstash][msgparser][id] == "msgParserId162" {
		dissect {
			mapping => { "message" => "DHCP Client is declining address offered by the server." }
			id => "msgParserId162"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId163
	# line in RSA: DHCP Client sending REQUEST and going to REBIND state.
	else if [logstash][msgparser][id] == "msgParserId163" {
		dissect {
			mapping => { "message" => "DHCP Client sending REQUEST and going to REBIND state." }
			id => "msgParserId163"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId164
	# line in RSA: DHCP Client sending REQUEST and going to RENEW state.
	else if [logstash][msgparser][id] == "msgParserId164" {
		dissect {
			mapping => { "message" => "DHCP Client sending REQUEST and going to RENEW state." }
			id => "msgParserId164"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "115" {
		# MESSAGE 115:01
		# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> dstname=<shost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} dstname=%{shost}" }
				id => "message-115:01"
				add_field => {
					"[event][id]" => "115:01"
					"[rsa][message][id1]" => "115:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 115
		# line in RSA: Sending DHCP REQUEST (Renewing).
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Sending DHCP REQUEST (Renewing)." }
				id => "message-115"
				add_field => {
					"[event][id]" => "115"
					"[rsa][message][id1]" => "115"
					"[event][categoryid]" => "1605020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId166
	# line in RSA: Sending DHCP REQUEST (Rebinding).
	else if [logstash][msgparser][id] == "msgParserId166" {
		dissect {
			mapping => { "message" => "Sending DHCP REQUEST (Rebinding)." }
			id => "msgParserId166"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId167
	# line in RSA: Sending DHCP REQUEST (Rebooting).
	else if [logstash][msgparser][id] == "msgParserId167" {
		dissect {
			mapping => { "message" => "Sending DHCP REQUEST (Rebooting)." }
			id => "msgParserId167"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId168
	# line in RSA: Sending DHCP REQUEST (Verifying).
	else if [logstash][msgparser][id] == "msgParserId168" {
		dissect {
			mapping => { "message" => "Sending DHCP REQUEST (Verifying)." }
			id => "msgParserId168"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId169
	# line in RSA: DHCP Client failed to verify and lease has expired. Go to INIT state.
	else if [logstash][msgparser][id] == "msgParserId169" {
		dissect {
			mapping => { "message" => "DHCP Client failed to verify and lease has expired. Go to INIT state." }
			id => "msgParserId169"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId170
	# line in RSA: DHCP Client failed to verify and lease is still valid. Go to BOUND state.
	else if [logstash][msgparser][id] == "msgParserId170" {
		dissect {
			mapping => { "message" => "DHCP Client failed to verify and lease is still valid. Go to BOUND state." }
			id => "msgParserId170"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId171
	# line in RSA: DHCP Client got a new IP address lease.
	else if [logstash][msgparser][id] == "msgParserId171" {
		dissect {
			mapping => { "message" => "DHCP Client got a new IP address lease." }
			id => "msgParserId171"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId172
	# line in RSA: Access attempt from host without Anti-Virus agent installed
	else if [logstash][msgparser][id] == "msgParserId172" {
		dissect {
			mapping => { "message" => "Access attempt from host without Anti-Virus agent installed" }
			id => "msgParserId172"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId173
	# line in RSA: Anti-Virus agent out-of-date on host
	else if [logstash][msgparser][id] == "msgParserId173" {
		dissect {
			mapping => { "message" => "Anti-Virus agent out-of-date on host" }
			id => "msgParserId173"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId174
	# line in RSA: Received AV Alert: %s
	else if [logstash][msgparser][id] == "msgParserId174" {
		dissect {
			mapping => { "message" => "Received AV Alert: %s" }
			id => "msgParserId174"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId175
	# line in RSA: Unused AV log entry.
	else if [logstash][msgparser][id] == "msgParserId175" {
		dissect {
			mapping => { "message" => "Unused AV log entry." }
			id => "msgParserId175"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId176
	# line in RSA: msg="<msg>" n=<fld1> srcV6=<saddr_v6> src=<saddr>:<sport>:<sinterface> dstV6=<daddr_v6> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> type=<icmptype> icmpCode=<icmpcode> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId176" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} srcV6=%{saddr_v6} src=%{saddr}:%{sport}:%{sinterface} dstV6=%{daddr_v6} dst=%{daddr}:%{dport}:%{dinterface} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} type=%{icmptype} icmpCode=%{icmpcode} fw_action=\"%{action}\"" }
			id => "msgParserId176"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId177
	# line in RSA: msg="<event_description>" n=<fld1> srcV6=<saddr_v6> src=<saddr>:<sport>:<sinterface> dstV6=<daddr_v6> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> type=<icmptype> icmpCode=<icmpcode> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId177" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} srcV6=%{saddr_v6} src=%{saddr}:%{sport}:%{sinterface} dstV6=%{daddr_v6} dst=%{daddr}:%{dport}:%{dinterface} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} type=%{icmptype} icmpCode=%{icmpcode} fw_action=\"%{action}\"" }
			id => "msgParserId177"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId178
	# line in RSA: msg="<msg>" n=<fld1> srcV6=<saddr_v6> src=<saddr>:<sport>:<sinterface> dstV6=<daddr_v6> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> type=<icmptype> icmpCode=<icmpcode> note="<rulename>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId178" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} srcV6=%{saddr_v6} src=%{saddr}:%{sport}:%{sinterface} dstV6=%{daddr_v6} dst=%{daddr}:%{dport}:%{dinterface} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} type=%{icmptype} icmpCode=%{icmpcode} note=\"%{rulename}\" fw_action=\"%{action}\"" }
			id => "msgParserId178"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId179
	# line in RSA: Starting PPPoE discovery
	else if [logstash][msgparser][id] == "msgParserId179" {
		dissect {
			mapping => { "message" => "Starting PPPoE discovery" }
			id => "msgParserId179"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId180
	# line in RSA: PPPoE LCP Link Up
	else if [logstash][msgparser][id] == "msgParserId180" {
		dissect {
			mapping => { "message" => "PPPoE LCP Link Up" }
			id => "msgParserId180"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId181
	# line in RSA: PPPoE LCP Link Down
	else if [logstash][msgparser][id] == "msgParserId181" {
		dissect {
			mapping => { "message" => "PPPoE LCP Link Down" }
			id => "msgParserId181"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId182
	# line in RSA: PPPoE  terminated
	else if [logstash][msgparser][id] == "msgParserId182" {
		dissect {
			mapping => { "message" => "PPPoE  terminated" }
			id => "msgParserId182"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId183
	# line in RSA: PPPoE Network Connected
	else if [logstash][msgparser][id] == "msgParserId183" {
		dissect {
			mapping => { "message" => "PPPoE Network Connected" }
			id => "msgParserId183"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId184
	# line in RSA: PPPoE Network Disconnected
	else if [logstash][msgparser][id] == "msgParserId184" {
		dissect {
			mapping => { "message" => "PPPoE Network Disconnected" }
			id => "msgParserId184"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId185
	# line in RSA: PPPoE discovery process complete
	else if [logstash][msgparser][id] == "msgParserId185" {
		dissect {
			mapping => { "message" => "PPPoE discovery process complete" }
			id => "msgParserId185"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId186
	# line in RSA: PPPoE starting CHAP Authentication
	else if [logstash][msgparser][id] == "msgParserId186" {
		dissect {
			mapping => { "message" => "PPPoE starting CHAP Authentication" }
			id => "msgParserId186"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId187
	# line in RSA: PPPoE starting PAP Authentication
	else if [logstash][msgparser][id] == "msgParserId187" {
		dissect {
			mapping => { "message" => "PPPoE starting PAP Authentication" }
			id => "msgParserId187"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId188
	# line in RSA: PPPoE CHAP Authentication Failed
	else if [logstash][msgparser][id] == "msgParserId188" {
		dissect {
			mapping => { "message" => "PPPoE CHAP Authentication Failed" }
			id => "msgParserId188"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId189
	# line in RSA: PPPoE PAP Authentication Failed
	else if [logstash][msgparser][id] == "msgParserId189" {
		dissect {
			mapping => { "message" => "PPPoE PAP Authentication Failed" }
			id => "msgParserId189"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId190
	# line in RSA: Wan IP Changed
	else if [logstash][msgparser][id] == "msgParserId190" {
		dissect {
			mapping => { "message" => "Wan IP Changed" }
			id => "msgParserId190"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId191
	# line in RSA: XAUTH Succeeded
	else if [logstash][msgparser][id] == "msgParserId191" {
		dissect {
			mapping => { "message" => "XAUTH Succeeded" }
			id => "msgParserId191"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "139" {
		# MESSAGE 139
		# line in RSA: XAUTH Failed
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "XAUTH Failed" }
				id => "message-139"
				add_field => {
					"[event][id]" => "139"
					"[rsa][message][id1]" => "139"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 139:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-139:01"
				add_field => {
					"[event][id]" => "139:01"
					"[rsa][message][id1]" => "139:01"
					"[event][categoryid]" => "1801020100"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId193
	# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
	else if [logstash][msgparser][id] == "msgParserId193" {
		grok {
			match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
			id => "msgParserId193"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId194
	# line in RSA: Primary firewall has transitioned to Active
	else if [logstash][msgparser][id] == "msgParserId194" {
		dissect {
			mapping => { "message" => "Primary firewall has transitioned to Active" }
			id => "msgParserId194"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId195
	# line in RSA: Backup firewall has transitioned to Active
	else if [logstash][msgparser][id] == "msgParserId195" {
		dissect {
			mapping => { "message" => "Backup firewall has transitioned to Active" }
			id => "msgParserId195"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId196
	# line in RSA: msg="<msg>" n=<fld1> srcV6=<saddr_v6> src=::<sinterface> dstV6=<daddr_v6> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> type=<icmptype> icmpCode=<icmpcode> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId196" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} srcV6=%{saddr_v6} src=::%{sinterface} dstV6=%{daddr_v6} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} type=%{icmptype} icmpCode=%{icmpcode} fw_action=\"%{action}\"" }
			id => "msgParserId196"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId197
	# line in RSA: Primary firewall has transitioned to Idle
	else if [logstash][msgparser][id] == "msgParserId197" {
		dissect {
			mapping => { "message" => "Primary firewall has transitioned to Idle" }
			id => "msgParserId197"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId198
	# line in RSA: Backup firewall has transitioned to Idle
	else if [logstash][msgparser][id] == "msgParserId198" {
		dissect {
			mapping => { "message" => "Backup firewall has transitioned to Idle" }
			id => "msgParserId198"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId199
	# line in RSA: Primary missed heartbeats from Active Backup: Primary going Active
	else if [logstash][msgparser][id] == "msgParserId199" {
		dissect {
			mapping => { "message" => "Primary missed heartbeats from Active Backup: Primary going Active" }
			id => "msgParserId199"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId200
	# line in RSA: Backup missed heartbeats from Active Primary: Backup going Active
	else if [logstash][msgparser][id] == "msgParserId200" {
		dissect {
			mapping => { "message" => "Backup missed heartbeats from Active Primary: Backup going Active" }
			id => "msgParserId200"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId201
	# line in RSA: Primary received error signal from Active Backup: Primary going Active
	else if [logstash][msgparser][id] == "msgParserId201" {
		dissect {
			mapping => { "message" => "Primary received error signal from Active Backup: Primary going Active" }
			id => "msgParserId201"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId202
	# line in RSA: msg="<msg>" n=<fld1> note="<rulename>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId202" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} note=\"%{rulename}\" fw_action=\"%{action}\"" }
			id => "msgParserId202"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId203
	# line in RSA: Backup received error signal from Active Primary: Backup going Active
	else if [logstash][msgparser][id] == "msgParserId203" {
		dissect {
			mapping => { "message" => "Backup received error signal from Active Primary: Backup going Active" }
			id => "msgParserId203"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId204
	# line in RSA: Backup firewall being preempted by Primary
	else if [logstash][msgparser][id] == "msgParserId204" {
		dissect {
			mapping => { "message" => "Backup firewall being preempted by Primary" }
			id => "msgParserId204"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId205
	# line in RSA: Primary firewall preempting Backup
	else if [logstash][msgparser][id] == "msgParserId205" {
		dissect {
			mapping => { "message" => "Primary firewall preempting Backup" }
			id => "msgParserId205"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId206
	# line in RSA: Active Backup detects Active Primary: Backup rebooting
	else if [logstash][msgparser][id] == "msgParserId206" {
		dissect {
			mapping => { "message" => "Active Backup detects Active Primary: Backup rebooting" }
			id => "msgParserId206"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId207
	# line in RSA: Imported HA hardware ID did not match this firewall
	else if [logstash][msgparser][id] == "msgParserId207" {
		dissect {
			mapping => { "message" => "Imported HA hardware ID did not match this firewall" }
			id => "msgParserId207"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId208
	# line in RSA: Received AV Alert: Your SonicWALL Network Anti-Virus subscription has expired. %s
	else if [logstash][msgparser][id] == "msgParserId208" {
		dissect {
			mapping => { "message" => "Received AV Alert: Your SonicWALL Network Anti-Virus subscription has expired. %s" }
			id => "msgParserId208"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId209
	# line in RSA: Primary received heartbeat from wrong source
	else if [logstash][msgparser][id] == "msgParserId209" {
		dissect {
			mapping => { "message" => "Primary received heartbeat from wrong source" }
			id => "msgParserId209"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId210
	# line in RSA: Backup received heartbeat from wrong source
	else if [logstash][msgparser][id] == "msgParserId210" {
		dissect {
			mapping => { "message" => "Backup received heartbeat from wrong source" }
			id => "msgParserId210"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "157" {
		# MESSAGE 157:01
		# line in RSA: msg="<msg>" n=<ntype> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype}" }
				id => "message-157:01"
				add_field => {
					"[event][id]" => "157:01"
					"[rsa][message][id1]" => "157:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 157
		# line in RSA: HA packet processing error
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "HA packet processing error" }
				id => "message-157"
				add_field => {
					"[event][id]" => "157"
					"[rsa][message][id1]" => "157"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId213
	# line in RSA: Heartbeat received from incompatible source
	else if [logstash][msgparser][id] == "msgParserId213" {
		dissect {
			mapping => { "message" => "Heartbeat received from incompatible source" }
			id => "msgParserId213"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId214
	# line in RSA: Diagnostic Code F
	else if [logstash][msgparser][id] == "msgParserId214" {
		dissect {
			mapping => { "message" => "Diagnostic Code F" }
			id => "msgParserId214"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId215
	# line in RSA: Forbidden E-mail attachment altered
	else if [logstash][msgparser][id] == "msgParserId215" {
		dissect {
			mapping => { "message" => "Forbidden E-mail attachment altered" }
			id => "msgParserId215"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId216
	# line in RSA: PPPoE PAP Authentication success.
	else if [logstash][msgparser][id] == "msgParserId216" {
		dissect {
			mapping => { "message" => "PPPoE PAP Authentication success." }
			id => "msgParserId216"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId217
	# line in RSA: PPPoE PAP Authentication Failed. Please verify PPPoE username and password
	else if [logstash][msgparser][id] == "msgParserId217" {
		dissect {
			mapping => { "message" => "PPPoE PAP Authentication Failed. Please verify PPPoE username and password" }
			id => "msgParserId217"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId218
	# line in RSA: Disconnecting PPPoE due to traffic timeout
	else if [logstash][msgparser][id] == "msgParserId218" {
		dissect {
			mapping => { "message" => "Disconnecting PPPoE due to traffic timeout" }
			id => "msgParserId218"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId219
	# line in RSA: No response from ISP Disconnecting PPPoE.
	else if [logstash][msgparser][id] == "msgParserId219" {
		dissect {
			mapping => { "message" => "No response from ISP Disconnecting PPPoE." }
			id => "msgParserId219"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId220
	# line in RSA: Backup going Active in preempt mode after reboot
	else if [logstash][msgparser][id] == "msgParserId220" {
		dissect {
			mapping => { "message" => "Backup going Active in preempt mode after reboot" }
			id => "msgParserId220"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId221
	# line in RSA: Denied TCP connection from LAN
	else if [logstash][msgparser][id] == "msgParserId221" {
		dissect {
			mapping => { "message" => "Denied TCP connection from LAN" }
			id => "msgParserId221"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId222
	# line in RSA: Denied UDP packet from LAN
	else if [logstash][msgparser][id] == "msgParserId222" {
		dissect {
			mapping => { "message" => "Denied UDP packet from LAN" }
			id => "msgParserId222"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId223
	# line in RSA: Denied ICMP packet from LAN
	else if [logstash][msgparser][id] == "msgParserId223" {
		dissect {
			mapping => { "message" => "Denied ICMP packet from LAN" }
			id => "msgParserId223"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId224
	# line in RSA: Firewall access from LAN
	else if [logstash][msgparser][id] == "msgParserId224" {
		dissect {
			mapping => { "message" => "Firewall access from LAN" }
			id => "msgParserId224"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId225
	# line in RSA: Received a path MTU icmp message from router/gateway
	else if [logstash][msgparser][id] == "msgParserId225" {
		dissect {
			mapping => { "message" => "Received a path MTU icmp message from router/gateway" }
			id => "msgParserId225"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "171" {
		# MESSAGE 171
		# line in RSA: Probable TCP FIN scan
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Probable TCP FIN scan" }
				id => "message-171"
				add_field => {
					"[event][id]" => "171"
					"[rsa][message][id1]" => "171"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 171:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport}" }
				id => "message-171:01"
				add_field => {
					"[event][id]" => "171:01"
					"[rsa][message][id1]" => "171:01"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 171:02
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>:<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}:%{dport}" }
				id => "message-171:02"
				add_field => {
					"[event][id]" => "171:02"
					"[rsa][message][id1]" => "171:02"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 171:03
		# line in RSA: msg="<msg>" note="<fld1>" sess=<fld2> n=<fld3> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+note=\"(?<fld1>[^\"]*)\"[\s]+sess=(?<fld2>[^\s]*)[\s]+n=(?<fld3>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-171:03"
				add_field => {
					"[event][id]" => "171:03"
					"[rsa][message][id1]" => "171:03"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "172" {
		# MESSAGE 172
		# line in RSA: Probable TCP XMAS scan
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Probable TCP XMAS scan" }
				id => "message-172"
				add_field => {
					"[event][id]" => "172"
					"[rsa][message][id1]" => "172"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 172:01
		# line in RSA: msg="<msg>" n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}" }
				id => "message-172:01"
				add_field => {
					"[event][id]" => "172:01"
					"[rsa][message][id1]" => "172:01"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId231
	# line in RSA: Probable TCP NULL scan
	else if [logstash][msgparser][id] == "msgParserId231" {
		dissect {
			mapping => { "message" => "Probable TCP NULL scan" }
			id => "msgParserId231"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "174" {
		# MESSAGE 174
		# line in RSA: IPSEC Replay Detected
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "IPSEC Replay Detected" }
				id => "message-174"
				add_field => {
					"[event][id]" => "174"
					"[rsa][message][id1]" => "174"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 174:01
		# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>.*)$" }
				id => "message-174:01"
				add_field => {
					"[event][id]" => "174:01"
					"[rsa][message][id1]" => "174:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 174:02
		# line in RSA: msg="<msg>" n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-174:02"
				add_field => {
					"[event][id]" => "174:02"
					"[rsa][message][id1]" => "174:02"
					"[event][categoryid]" => "1502010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 174:03
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> proto= | <daddr>:<dport>:<dinterface> proto= } <protocol> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=[\s]+)[\s]+(?<protocol>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-174:03"
				add_field => {
					"[event][id]" => "174:03"
					"[rsa][message][id1]" => "174:03"
					"[event][categoryid]" => "1502010000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "175" {
		# MESSAGE 175
		# line in RSA: TCP FIN packet dropped
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "TCP FIN packet dropped" }
				id => "message-175"
				add_field => {
					"[event][id]" => "175"
					"[rsa][message][id1]" => "175"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 175:01
		# line in RSA: msg="ICMP packet from LAN dropped" n=<fld1> src=<saddr> dst=<daddr> type=<type>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"ICMP packet from LAN dropped\" n=%{fld1} src=%{saddr} dst=%{daddr} type=%{type}" }
				id => "message-175:01"
				add_field => {
					"[event][id]" => "175:01"
					"[rsa][message][id1]" => "175:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 175:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src=<saddr> dst=<daddr> type=<type> icmpCode=<fld3> npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2} src=%{saddr} dst=%{daddr} type=%{type} icmpCode=%{fld3} npcs=%{info}" }
				id => "message-175:02"
				add_field => {
					"[event][id]" => "175:02"
					"[rsa][message][id1]" => "175:02"
					"[event][categoryid]" => "1001000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId238
	# line in RSA: Fraudulent Microsoft Certificate Blocked
	else if [logstash][msgparser][id] == "msgParserId238" {
		dissect {
			mapping => { "message" => "Fraudulent Microsoft Certificate Blocked" }
			id => "msgParserId238"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId99
	# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>
	else if [logstash][msgparser][id] == "msgParserId99" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}" }
			id => "msgParserId99"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId239
	# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> 
	else if [logstash][msgparser][id] == "msgParserId239" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport}" }
			id => "msgParserId239"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "180" {
		# MESSAGE 180
		# line in RSA: msg="<action>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-180"
				add_field => {
					"[event][id]" => "180"
					"[rsa][message][id1]" => "180"
					"[event][categoryid]" => "1001010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 180:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> note= | <daddr>:<dport>:<dinterface> note= } "<fld3>" npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+note=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=[\s]+)[\s]+\"(?<fld3>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
				id => "message-180:01"
				add_field => {
					"[event][id]" => "180:01"
					"[rsa][message][id1]" => "180:01"
					"[event][categoryid]" => "1001010000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "181" {
		# MESSAGE 181
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}" }
				id => "message-181"
				add_field => {
					"[event][id]" => "181"
					"[rsa][message][id1]" => "181"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 181:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-181:01"
				add_field => {
					"[event][id]" => "181:01"
					"[rsa][message][id1]" => "181:01"
					"[event][categoryid]" => "1103000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId243
	# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr> sport=<sport> dport=<dport> {sent=<sbytes> | rcvd=<rbytes>}
	else if [logstash][msgparser][id] == "msgParserId243" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^\s]*)[\s]+dst=(?<daddr>[^\s]*)[\s]+sport=(?<sport>[^\s]*)[\s]+dport=(?<dport>[^\s]*)[\s]+(sent=(?<sbytes>[^\s]*)[\s]+|[\s]*rcvd=(?<rbytes>.*))$" }
			id => "msgParserId243"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "196" {
		# MESSAGE 196
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<fld2> dst=<daddr>:<fld3> sport=<sport> dport=<dport> {sent=<sbytes> | rcvd=<rbytes>} cmd=<method>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<fld2>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<fld3>[^\s]*)[\s]+sport=(?<sport>[^\s]*)[\s]+dport=(?<dport>[^\s]*)[\s]+(sent=(?<sbytes>[^\s]*)[\s]+|[\s]*rcvd=(?<rbytes>[^\s]*))[\s]+cmd=(?<method>.*)$" }
				id => "message-196"
				add_field => {
					"[event][id]" => "196"
					"[rsa][message][id1]" => "196"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 196:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr> sport=<sport> dport=<dport> {sent=<sbytes> |rcvd=<rbytes>} cmd=<method>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^\s]*)[\s]+dst=(?<daddr>[^\s]*)[\s]+sport=(?<sport>[^\s]*)[\s]+dport=(?<dport>[^\s]*)[\s]+(sent=(?<sbytes>[^\s]*)[\s]+|rcvd=(?<rbytes>[^\s]*))[\s]+cmd=(?<method>.*)$" }
				id => "message-196:01"
				add_field => {
					"[event][id]" => "196:01"
					"[rsa][message][id1]" => "196:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "235" {
		# MESSAGE 235:02
		# line in RSA: msg="<action>" n=<fld> usr=<username> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" n=%{fld} usr=%{username} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol}" }
				id => "message-235:02"
				add_field => {
					"[event][id]" => "235:02"
					"[rsa][message][id1]" => "235:02"
					"[event][categoryid]" => "1401050100"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 235
		# line in RSA: msg="<action>" n=<fld> usr=<username> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+usr=(?<username>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-235"
				add_field => {
					"[event][id]" => "235"
					"[rsa][message][id1]" => "235"
					"[event][categoryid]" => "1401050100"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 235:01
		# line in RSA: msg="<action>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-235:01"
				add_field => {
					"[event][id]" => "235:01"
					"[rsa][message][id1]" => "235:01"
					"[event][categoryid]" => "1401050100"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId248
	# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr> dst=<dtransaddr>
	else if [logstash][msgparser][id] == "msgParserId248" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr} dst=%{dtransaddr}" }
			id => "msgParserId248"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId249
	# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr> dst=<dtransaddr>
	else if [logstash][msgparser][id] == "msgParserId249" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr} dst=%{dtransaddr}" }
			id => "msgParserId249"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "241" {
		# MESSAGE 241
		# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport}" }
				id => "message-241"
				add_field => {
					"[event][id]" => "241"
					"[rsa][message][id1]" => "241"
					"[event][categoryid]" => "1801000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 241:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-241:01"
				add_field => {
					"[event][id]" => "241:01"
					"[rsa][message][id1]" => "241:01"
					"[event][categoryid]" => "1801000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId251
	# line in RSA: msg="<msg>" n=<fld1> src={ <saddr>:<sport>:: | <saddr>:<sport> | <saddr> } dst={ <daddr>:<dport>:: | <daddr>:<dport> | <daddr> }
	else if [logstash][msgparser][id] == "msgParserId251" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*)::[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*)::[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
			id => "msgParserId251"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId89
	# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>
	else if [logstash][msgparser][id] == "msgParserId89" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
			id => "msgParserId89"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "261" {
		# MESSAGE 261:01
		# line in RSA: msg="<msg>" n=<fld1> usr=<username> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+usr=(?<username>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-261:01"
				add_field => {
					"[event][id]" => "261:01"
					"[rsa][message][id1]" => "261:01"
					"[event][categoryid]" => "1401070000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 261
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-261"
				add_field => {
					"[event][id]" => "261"
					"[rsa][message][id1]" => "261"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId252
	# line in RSA: msg="<msg>" n=<fld1> usr=<username> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
	else if [logstash][msgparser][id] == "msgParserId252" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+usr=(?<username>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
			id => "msgParserId252"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId253
	# line in RSA: msg="<msg>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
	else if [logstash][msgparser][id] == "msgParserId253" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
			id => "msgParserId253"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "353" {
		# MESSAGE 353:01
		# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport}" }
				id => "message-353:01"
				add_field => {
					"[event][id]" => "353:01"
					"[rsa][message][id1]" => "353:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 353
		# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr> dst=<dtransaddr> dstname=<shost> lifeSeconds=<misc>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr} dst=%{dtransaddr} dstname=%{shost} lifeSeconds=%{misc}\"" }
				id => "message-353"
				add_field => {
					"[event][id]" => "353"
					"[rsa][message][id1]" => "353"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId256
	# line in RSA: msg="<msg>" n=<ntype> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> dstname="<shost> lifeSeconds=<misc>"
	else if [logstash][msgparser][id] == "msgParserId256" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{ntype} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} dstname=\"%{shost} lifeSeconds=%{misc}\"" }
			id => "msgParserId256"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "355" {
		# MESSAGE 355
		# line in RSA: msg="<action>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport}" }
				id => "message-355"
				add_field => {
					"[event][id]" => "355"
					"[rsa][message][id1]" => "355"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 355:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-355:01"
				add_field => {
					"[event][id]" => "355:01"
					"[rsa][message][id1]" => "355:01"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId257
	# line in RSA: msg="<action>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport>
	else if [logstash][msgparser][id] == "msgParserId257" {
		dissect {
			mapping => { "message" => "msg=\"%{action}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport}" }
			id => "msgParserId257"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "357" {
		# MESSAGE 357
		# line in RSA: msg="<action>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport> dstname=<name> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport} dstname=%{name}" }
				id => "message-357"
				add_field => {
					"[event][id]" => "357"
					"[rsa][message][id1]" => "357"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 357:01
		# line in RSA: msg="<action>" n=<fld1> src=<saddr> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" n=%{fld1} src=%{saddr} dst=%{daddr}" }
				id => "message-357:01"
				add_field => {
					"[event][id]" => "357:01"
					"[rsa][message][id1]" => "357:01"
					"[event][categoryid]" => "1002020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "371" {
		# MESSAGE 371
		# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr> dst=<dtransaddr> dstname=<shost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr} dst=%{dtransaddr} dstname=%{shost}" }
				id => "message-371"
				add_field => {
					"[event][id]" => "371"
					"[rsa][message][id1]" => "371"
					"[event][categoryid]" => "1503000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 371:01
		# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr> note="<event_description>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr} note=\"%{event_description}\"" }
				id => "message-371:01"
				add_field => {
					"[event][id]" => "371:01"
					"[rsa][message][id1]" => "371:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId261
	# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr> {dstname=<name> | <space>}
	else if [logstash][msgparser][id] == "msgParserId261" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^\s]*)[\s]+dst=(?<daddr>[^\s]*)[\s]+(dstname=(?<name>[^\s]*)[\s]+|[\s]*(?<space>.*))$" }
			id => "msgParserId261"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId250
	# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport>
	else if [logstash][msgparser][id] == "msgParserId250" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport}" }
			id => "msgParserId250"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "441" {
		# MESSAGE 441
		# line in RSA: msg="<msg>" n=<fld> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-441"
				add_field => {
					"[event][id]" => "441"
					"[rsa][message][id1]" => "441"
					"[event][categoryid]" => "1502050000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 441:01
		# line in RSA: msg="<msg>" n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}" }
				id => "message-441:01"
				add_field => {
					"[event][id]" => "441:01"
					"[rsa][message][id1]" => "441:01"
					"[event][categoryid]" => "1001020000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId262
	# line in RSA: msg="<event_description>" {app=<fld1> appName="<application>"|app=<fld1>} n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId262" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+(app=(?<fld1>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|app=(?<fld1>[^\s]*))[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId262"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId263
	# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost>  note="MAC=<smacaddr> HostName:<hostname>"
	else if [logstash][msgparser][id] == "msgParserId263" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}  note=\"MAC=%{smacaddr} HostName:%{hostname}\"" }
			id => "msgParserId263"
			add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId264
	# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> }
	else if [logstash][msgparser][id] == "msgParserId264" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
			id => "msgParserId264"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "522" {
		# MESSAGE 522
		# line in RSA: msg="<msg>" n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-522"
				add_field => {
					"[event][id]" => "522"
					"[rsa][message][id1]" => "522"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 522:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> srcV6=<saddr_v6> src={ <saddr>:<sport>:<sinterface> | <saddr> } dstV6=<daddr_v6> dst={ <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+srcV6=(?<saddr_v6>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dstV6=(?<daddr_v6>[^\s]*)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-522:01"
				add_field => {
					"[event][id]" => "522:01"
					"[rsa][message][id1]" => "522:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 522:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface><shost> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> npcs=<info>
		# Parsing error: Couldn't parse because of 2 adjacent fields like <fld1><fld2>
	}
	# PARSER msgParserId234
	# line in RSA: msg="<msg>" n=<fld1> src={ <saddr>:<sport>:<sinterface> | <saddr> } dst={ <daddr>:<dport>:<dinterface> | <daddr> }
	else if [logstash][msgparser][id] == "msgParserId234" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+)[\s]+dst=([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
			id => "msgParserId234"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "524" {
		# MESSAGE 524
		# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } { proto=<protocol> | rule=<rule> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+([\s]*proto=(?<protocol>[^\s]*)[\s]+|[\s]*rule=(?<rule>[^\s]*)[\s]+)$" }
				id => "message-524"
				add_field => {
					"[event][id]" => "524"
					"[rsa][message][id1]" => "524"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 524:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } { proto=<protocol> npcs= | rule=<rule> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+([\s]*proto=(?<protocol>[^\s]*)[\s]+npcs=[\s]+|[\s]*rule=(?<rule>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-524:01"
				add_field => {
					"[event][id]" => "524:01"
					"[rsa][message][id1]" => "524:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 524:02
		# line in RSA: msg="<msg>" app=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol>{rule="<rule>" note="<rulename>"|rule="<rule>"} fw_action="<action>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+app=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^rr]*)(rule=\"(?<rule>[^\"]*)\"[\s]+note=\"(?<rulename>[^\"]*)\"|rule=\"(?<rule>[^\"]*)\")[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
				id => "message-524:02"
				add_field => {
					"[event][id]" => "524:02"
					"[rsa][message][id1]" => "524:02"
					"[event][categoryid]" => "1204020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "526" {
		# MESSAGE 526
		# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>.*)$" }
				id => "message-526"
				add_field => {
					"[event][id]" => "526"
					"[rsa][message][id1]" => "526"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 526:01
		# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= |<saddr>:<sport>:<sinterface>:<fld20> dst= |<saddr> dst= } {<daddr>:<dport>:<dinterface> | <daddr> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<fld20>[^\s]*)[\s]+dst=[\s]+|(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)$" }
				id => "message-526:01"
				add_field => {
					"[event][id]" => "526:01"
					"[rsa][message][id1]" => "526:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 526:02
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-526:02"
				add_field => {
					"[event][id]" => "526:02"
					"[rsa][message][id1]" => "526:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 526:03
		# line in RSA: msg="<msg>" app=<fld1> n=<fld2> usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1} n=%{fld2} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-526:03"
				add_field => {
					"[event][id]" => "526:03"
					"[rsa][message][id1]" => "526:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 526:04
		# line in RSA: msg="<msg>" app=<fld1>n=<fld2>src=<saddr>:<sport>:<sinterface>:<shost>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1}n=%{fld2}src=%{saddr}:%{sport}:%{sinterface}:%{shost}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-526:04"
				add_field => {
					"[event][id]" => "526:04"
					"[rsa][message][id1]" => "526:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 526:05
		# line in RSA: msg="<msg>" app=<fld1>n=<fld2>src=<saddr>:<sport>:<sinterface>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" app=%{fld1}n=%{fld2}src=%{saddr}:%{sport}:%{sinterface}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-526:05"
				add_field => {
					"[event][id]" => "526:05"
					"[rsa][message][id1]" => "526:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "537" {
		# MESSAGE 537:01
		# line in RSA: msg="<action>" f=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= | <saddr> dst= }{ <daddr>:<dport>:<dinterface>:<dhost> | <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> sent=<sbytes> { rcvd=<rbytes> vpnpolicy=<fld3> | rcvd=<rbytes> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+f=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+([\s]*rcvd=(?<rbytes>[^\s]*)[\s]+vpnpolicy=(?<fld3>[^\s]*)[\s]+|[\s]*rcvd=(?<rbytes>[^\s]*)[\s]+)$" }
				id => "message-537:01"
				add_field => {
					"[event][id]" => "537:01"
					"[rsa][message][id1]" => "537:01"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:02
		# line in RSA: msg="<action>" f=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= | <saddr> dst= }{ <daddr>:<dport>:<dinterface>:<dhost> | <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol> sent=<sbytes>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+f=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>.*)$" }
				id => "message-537:02"
				add_field => {
					"[event][id]" => "537:02"
					"[rsa][message][id1]" => "537:02"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:08
		# line in RSA: {msg="<event_description>" app=<fld51> appName="<application>"|msg="<event_description>" app=<fld51> sess="<fld4>" | msg="<event_description>" app=<fld51>|msg="<event_description>"}{n=<fld1> usr="<username>"|n=<fld1>}src={<saddr>:<sport>:<sinterface>:<shost>dst=|<saddr>:<sport>:<sinterface>dst=|<saddr>dst=}{<daddr>:<dport>:<dinterface>:<dhost> srcMac=| <daddr>:<dport>:<dinterface> srcMac=| <daddr>srcMac=} <smacaddr> {dstMac=<dmacaddr> proto=<protocol> | proto=<protocol>} {sent=<sbytes> rcvd=<rbytes> |sent=<sbytes>} {spkt=<fld3> rpkt=<fld6> cdur=<fld7> fw_action="<action>" |spkt=<fld3> rpkt=<fld6> cdur=<fld7> |spkt=<fld3> rpkt=<fld6> fw_action="<action>" |spkt=<fld3> cdur=<fld7> |spkt=<fld3>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+sess=\"(?<fld4>[^\"]*)\"[\s]+|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^nn]*)|msg=\"(?<event_description>[^\"]*)\")(n=(?<fld1>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"|n=(?<fld1>[^s]*))src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^d]*)dst=|(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=|(?<saddr>[^d]*)dst=)((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+srcMac=|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|[\s]*(?<daddr>[^s]*)srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+(dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+|[\s]*proto=(?<protocol>[^\s]*))[\s]+(sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+|sent=(?<sbytes>[^\s]*))[\s]+(spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld6>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"[\s]+|spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld6>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+|spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld6>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"[\s]+|spkt=(?<fld3>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+|spkt=(?<fld3>.*))$" }
				id => "message-537:08"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "537:08"
					"[rsa][message][id1]" => "537:08"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 537:09
		# line in RSA: {msg="<event_description>" app=<fld51> sess="<fld4>" |msg="<event_description>" app=<fld51> appName="<application>"| msg="<event_description>" app=<fld51>|msg="<event_description>"}{n=<fld1> usr="<username>"|n=<fld1>}src={<saddr>:<sport>:<sinterface>:<shost>dst=|<saddr>:<sport>:<sinterface>dst=|<saddr>dst=}{<daddr>:<dport>:<dinterface>:<dhost> dstMac=| <daddr>:<dport>:<dinterface> dstMac=| <daddr>dstMac=} <dmacaddr> proto=<protocol> {sent=<sbytes> rcvd=<rbytes> |sent=<sbytes>} { spkt=<fld3> cdur=<fld7> fw_action="<action>"|spkt=<fld3> rpkt=<fld6> cdur=<fld7> |spkt=<fld3> cdur=<fld7> | spkt=<fld3>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+sess=\"(?<fld4>[^\"]*)\"[\s]+|msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^nn]*)|msg=\"(?<event_description>[^\"]*)\")(n=(?<fld1>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"|n=(?<fld1>[^s]*))src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^d]*)dst=|(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=|(?<saddr>[^d]*)dst=)((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+dstMac=|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+dstMac=|[\s]*(?<daddr>[^d]*)dstMac=)[\s]+(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+(sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+|sent=(?<sbytes>[^\s]*))[\s]+([\s]*spkt=(?<fld3>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld6>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+|spkt=(?<fld3>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+|[\s]*spkt=(?<fld3>.*))$" }
				id => "message-537:09"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "537:09"
					"[rsa][message][id1]" => "537:09"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 537:07
		# line in RSA: {msg="<event_description>" app=<fld51> appName="<application>"| msg="<event_description>" app=<fld51> sess="<fld4>" | msg="<event_description>" app=<fld51>|msg="<event_description>"}{n=<fld1> usr="<username>"|n=<fld1>}src={<saddr>:<sport>:<sinterface>:<shost>dst=|<saddr>:<sport>:<sinterface>dst=|<saddr>dst=}{<daddr>:<dport>:<dinterface>:<dhost> | <daddr>:<dport>:<dinterface> | <daddr>} {srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> | srcMac=<smacaddr> proto=<protocol> |dstMac=<dmacaddr> proto=<protocol> | proto=<protocol>} {sent=<sbytes> rcvd=<rbytes> |sent=<sbytes>} { spkt=<fld3> cdur=<fld7> fw_action="<action>"|spkt=<fld3> rpkt=<fld6> cdur=<fld7> |spkt=<fld3> cdur=<fld7> | spkt=<fld3> fw_action="<action>"| spkt=<fld3>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+sess=\"(?<fld4>[^\"]*)\"[\s]+|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld51>[^nn]*)|msg=\"(?<event_description>[^\"]*)\")(n=(?<fld1>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"|n=(?<fld1>[^s]*))src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^d]*)dst=|(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=|(?<saddr>[^d]*)dst=)((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*))[\s]+(srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+|[\s]*srcMac=(?<smacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+|dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+|[\s]*proto=(?<protocol>[^\s]*))[\s]+(sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+|sent=(?<sbytes>[^\s]*))[\s]+([\s]*spkt=(?<fld3>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld6>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+|spkt=(?<fld3>[^\s]*)[\s]+cdur=(?<fld7>[^\s]*)[\s]+|[\s]*spkt=(?<fld3>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"|[\s]*spkt=(?<fld3>.*))$" }
				id => "message-537:07"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "537:07"
					"[rsa][message][id1]" => "537:07"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 537
		# line in RSA: {msg="<action>" app=<fld51> appName="<application>"|msg="<action>"} n=<fld1> src={ <saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= | <saddr> dst= }{ <daddr>:<dport>:<dinterface>:<dhost> proto=<protocol>|<daddr>:<dport>:<dinterface>: proto=<protocol>| <daddr>:<dport>:<dinterface> proto=<protocol>| <daddr> proto=<protocol>} {sent=<sbytes> rcvd=<rbytes> spkt=<fld3> rpkt=<fld4> cdur=<fld5> fw_action="<fld6>"|sent=<sbytes> rcvd=<rbytes> spkt=<fld3> rpkt=<fld4> fw_action="<fld5>"|sent=<sbytes> spkt=<fld3>fw_action="<fld4>"|sent=<sbytes>rcvd=<rbytes>|sent=<sbytes>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<action>[^\"]*)\"[\s]+app=(?<fld51>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"|msg=\"(?<action>[^\"]*)\")[\s]+n=(?<fld1>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):[\s]+proto=(?<protocol>[^\s]*)|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)|[\s]*(?<daddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*))[\s]+(sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld4>[^\s]*)[\s]+cdur=(?<fld5>[^\s]*)[\s]+fw_action=\"(?<fld6>[^\"]*)\"|sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld4>[^\s]*)[\s]+fw_action=\"(?<fld5>[^\"]*)\"|sent=(?<sbytes>[^\s]*)[\s]+spkt=(?<fld3>[^f]*)fw_action=\"(?<fld4>[^\"]*)\"|sent=(?<sbytes>[^r]*)rcvd=(?<rbytes>.*)|sent=(?<sbytes>.*))$" }
				id => "message-537"
				add_field => {
					"[event][id]" => "537"
					"[rsa][message][id1]" => "537"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:04
		# line in RSA: msg="<action>" sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface> dst= | <saddr> dst= }{ <daddr>:<dport>:<dinterface>:<dhost> proto= | <daddr>:<dport>:<dinterface> proto= | <daddr> proto= } <protocol> sent=<sbytes> rcvd=<rbytes> spkt=<fld3> rpkt=<fld4> cdur=<fld5> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+proto=[\s]+)[\s]+(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+spkt=(?<fld3>[^\s]*)[\s]+rpkt=(?<fld4>[^\s]*)[\s]+cdur=(?<fld5>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-537:04"
				add_field => {
					"[event][id]" => "537:04"
					"[rsa][message][id1]" => "537:04"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:05
		# line in RSA: msg="<action>" sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface> dst= | <saddr> dst= }{ <daddr>:<dport>:<dinterface>:<dhost> proto= | <daddr>:<dport>:<dinterface> proto= | <daddr> proto= } <protocol> sent=<sbytes> spkt=<fld3> { cdur=<fld4> appcat=<fld5> appid=<fld6> npcs= | cdur=<fld4> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+proto=[\s]+)[\s]+(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+spkt=(?<fld3>[^\s]*)[\s]+([\s]*cdur=(?<fld4>[^\s]*)[\s]+appcat=(?<fld5>[^\s]*)[\s]+appid=(?<fld6>[^\s]*)[\s]+npcs=[\s]+|[\s]*cdur=(?<fld4>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-537:05"
				add_field => {
					"[event][id]" => "537:05"
					"[rsa][message][id1]" => "537:05"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:10
		# line in RSA: msg="<event_description>" sess=<fld1> { n=<fld2> usr="<username>" | n=<fld2> } src={<saddr>:<sport>:<sinterface> dst=|<saddr> dst=}{<daddr>:<dport>:<dinterface>:<dhost> dstMac=|<daddr>:<dport>:<dinterface> dstMac=|<daddr> dstMac=} <dmacaddr> proto=<protocol> sent=<sbytes> rcvd=<rbytes> spkt=<fld10> rpkt=<fld11> { npcs=<info> | cdur=<fld12> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+([\s]*n=(?<fld2>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"[\s]+|[\s]*n=(?<fld2>[^\s]*)[\s]+)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=|(?<saddr>[^\s]*)[\s]+dst=)((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+dstMac=|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+dstMac=|(?<daddr>[^\s]*)[\s]+dstMac=)[\s]+(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+spkt=(?<fld10>[^\s]*)[\s]+rpkt=(?<fld11>[^\s]*)[\s]+([\s]*npcs=(?<info>[^\s]*)[\s]+|[\s]*cdur=(?<fld12>[^\s]*)[\s]+)$" }
				id => "message-537:10"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "537:10"
					"[rsa][message][id1]" => "537:10"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 537:03
		# line in RSA: msg="<action>" sess=<fld1> { n=<fld2> usr="<username>" | n=<fld2> } src={<saddr>:<sport>:<sinterface> dst=|<saddr> dst=}{<daddr>:<dport>:<dinterface>:<dhost> proto=|<daddr>:<dport>:<dinterface> proto=|<daddr> proto=} <protocol> sent=<sbytes> rcvd=<rbytes> spkt=<fld10> rpkt=<fld11> { npcs=<info> | cdur=<fld12> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+([\s]*n=(?<fld2>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"[\s]+|[\s]*n=(?<fld2>[^\s]*)[\s]+)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=|(?<saddr>[^\s]*)[\s]+dst=)((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=|(?<daddr>[^\s]*)[\s]+proto=)[\s]+(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+spkt=(?<fld10>[^\s]*)[\s]+rpkt=(?<fld11>[^\s]*)[\s]+([\s]*npcs=(?<info>[^\s]*)[\s]+|[\s]*cdur=(?<fld12>[^\s]*)[\s]+)$" }
				id => "message-537:03"
				add_field => {
					"[event][id]" => "537:03"
					"[rsa][message][id1]" => "537:03"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:06
		# line in RSA: msg="<action>" sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface> dst= | <saddr> dst= }{ <daddr>:<dport>:<dinterface>:<dhost> proto= | <daddr>:<dport>:<dinterface> proto= | <daddr> proto= } <protocol> sent=<sbytes> spkt=<fld3> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+proto=[\s]+)[\s]+(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+spkt=(?<fld3>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-537:06"
				add_field => {
					"[event][id]" => "537:06"
					"[rsa][message][id1]" => "537:06"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 537:11
		# line in RSA: msg="<event_description>" sess="<fld1>" n=<fld2>usr="<username>" src=<saddr>:<sport>:<sinterface>:<shost>dst=<daddr>:<dport>:<dinterface>:<dhost>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>sent=<sbytes>rcvd=<rbytes>spkt=<fld3>rpkt=<fld4>rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}\" sess=\"%{fld1}\" n=%{fld2}usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{shost}dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}sent=%{sbytes}rcvd=%{rbytes}spkt=%{fld3}rpkt=%{fld4}rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-537:11"
				add_field => {
				"event_description" => "Connection Closed"
					"[event][id]" => "537:11"
					"[rsa][message][id1]" => "537:11"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 537:12
		# line in RSA: msg="<event_description>" sess="<fld1>" n=<fld2> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>:<dhost> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> sent=<sbytes> rcvd=<rbytes> spkt=<fld3> rpkt=<fld4> rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}\" sess=\"%{fld1}\" n=%{fld2} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} sent=%{sbytes} rcvd=%{rbytes} spkt=%{fld3} rpkt=%{fld4} rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-537:12"
				add_field => {
				"event_description" => "Connection Closed"
					"[event][id]" => "537:12"
					"[rsa][message][id1]" => "537:12"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "597" {
		# MESSAGE 597:01
		# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost>  type=<icmptype> code=<icmpcode>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}  type=%{icmptype} code=%{icmpcode}" }
				id => "message-597:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Permit"
				"ec_theme" => "Communication"
				"action" => "allowed"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "597:01"
					"[rsa][message][id1]" => "597:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 597:02
		# line in RSA: msg=<msg> n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>  type=<icmptype> code=<icmpcode>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=%{msg} n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}  type=%{icmptype} code=%{icmpcode}" }
				id => "message-597:02"
				add_field => {
					"[event][id]" => "597:02"
					"[rsa][message][id1]" => "597:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 597:03
		# line in RSA: msg=<msg> sess=<fld1> n=<fld2> src={ <saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost>  npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=(?<msg>[^\s]*)[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-597:03"
				add_field => {
					"[event][id]" => "597:03"
					"[rsa][message][id1]" => "597:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "598" {
		# MESSAGE 598
		# line in RSA: msg=<msg> n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> type=<type> code=<code>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=%{msg} n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} type=%{type} code=%{code}" }
				id => "message-598"
				add_field => {
					"[event][id]" => "598"
					"[rsa][message][id1]" => "598"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 598:01
		# line in RSA: msg=<msg> sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst= { <daddr>:<dport>:<dinterface>:<dhost> type= | <daddr>:<dport>:<dinterface> type= } <type> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=(?<msg>[^\s]*)[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+type=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+type=[\s]+)[\s]+(?<type>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-598:01"
				add_field => {
					"[event][id]" => "598:01"
					"[rsa][message][id1]" => "598:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 598:02
		# line in RSA: msg=<msg> sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst= { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=(?<msg>[^\s]*)[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-598:02"
				add_field => {
					"[event][id]" => "598:02"
					"[rsa][message][id1]" => "598:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "602" {
		# MESSAGE 602:01
		# line in RSA: msg="<event_description>allowed" n=<fld1> src=<saddr>:<sport>:<sinterface>:<fld2> dst=<daddr>:<dport>:<dinterface>:<fld3>  proto=<protocol>/<fld4>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}allowed\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{fld2} dst=%{daddr}:%{dport}:%{dinterface}:%{fld3}  proto=%{protocol}/%{fld4}" }
				id => "message-602:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Permit"
				"ec_theme" => "Communication"
				"action" => "allowed"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "602:01"
					"[rsa][message][id1]" => "602:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 602:02
		# line in RSA: msg="<msg>" n=<fld1> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>.*)$" }
				id => "message-602:02"
				add_field => {
					"[event][id]" => "602:02"
					"[rsa][message][id1]" => "602:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 602:03
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+proto=(?<protocol>.*)$" }
				id => "message-602:03"
				add_field => {
					"[event][id]" => "602:03"
					"[rsa][message][id1]" => "602:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId296
	# line in RSA: msg="<event_description>" n=<fld2> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface> srcMac=|dst=<daddr>:<dport> srcMac=} <smacaddr> dstMac=<dmacaddr>proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId296" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|dst=(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^p]*)proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId296"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId297
	# line in RSA: msg="<msg>" sid=<sid> ipscat=<ipscat> {ipspri=<fld66> pktdatId=<fld11>|ipspri=<ipspri>} n=<fld1> src=<saddr>:{<sport>:<sinterface>|<sport>} dst=<daddr>:{<dport>:<dinterface> proto=<protocol> fw_action="<fld2>"|<dport>:<dinterface>|<dport>}
	else if [logstash][msgparser][id] == "msgParserId297" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sid=(?<sid>[^\s]*)[\s]+ipscat=(?<ipscat>[^\s]*)[\s]+(ipspri=(?<fld66>[^\s]*)[\s]+pktdatId=(?<fld11>[^\s]*)|ipspri=(?<ipspri>[^\s]*))[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):((?<sport>[^:]*):(?<sinterface>[^\s]*)|(?<sport>[^\s]*))[\s]+dst=(?<daddr>[^:]*):((?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+fw_action=\"(?<fld2>[^\"]*)\"|(?<dport>[^:]*):(?<dinterface>.*)|(?<dport>.*))$" }
			id => "msgParserId297"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "712" {
		# MESSAGE 712:02
		# line in RSA: msg="<action>" {app=<fld21> appName="<application>" n=<fld1>|n=<fld1>} src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> {srcMac=<smacaddr> dstMac=<dmacaddr>|srcMac=<smacaddr>} proto={<protocol>/<fld3>|<protocol>} fw_action=<fld51>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+(app=(?<fld21>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)|n=(?<fld1>[^\s]*))[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+(srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)|srcMac=(?<smacaddr>[^\s]*))[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=(?<fld51>.*)$" }
				id => "message-712:02"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "712:02"
					"[rsa][message][id1]" => "712:02"
					"[event][categoryid]" => "1001030500"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 712
		# line in RSA: msg="<action>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport}" }
				id => "message-712"
				add_field => {
					"[event][id]" => "712"
					"[rsa][message][id1]" => "712"
					"[event][categoryid]" => "1001030500"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 712:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> note= | <daddr>:<dport>:<dinterface> note= } "<fld3>" npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+note=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=[\s]+)[\s]+\"(?<fld3>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
				id => "message-712:01"
				add_field => {
					"[event][id]" => "712:01"
					"[rsa][message][id1]" => "712:01"
					"[event][categoryid]" => "1001030500"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "713" {
		# MESSAGE 713:01
		# line in RSA: msg="<event_description>dropped" n=<fld1> src=<saddr>:<sport>:<sinterface>:<fld2> dst=<daddr>:<dport>:<dinterface>:<fld3>  note=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}dropped\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{fld2} dst=%{daddr}:%{dport}:%{dinterface}:%{fld3}  note=%{info}" }
				id => "message-713:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "713:01"
					"[rsa][message][id1]" => "713:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 713:04
		# line in RSA: msg="<action>" {app=<fld21> appName="<application>" n=<fld1>|n=<fld1>} src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> {srcMac=<smacaddr> dstMac=<dmacaddr>|srcMac=<smacaddr>} proto={<protocol>/<fld3>|<protocol>} fw_action=<fld51>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<action>[^\"]*)\"[\s]+(app=(?<fld21>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)|n=(?<fld1>[^\s]*))[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+(srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)|srcMac=(?<smacaddr>[^\s]*))[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=(?<fld51>.*)$" }
				id => "message-713:04"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "713:04"
					"[rsa][message][id1]" => "713:04"
					"[event][categoryid]" => "1001030500"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 713:02
		# line in RSA: msg="<action>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport}" }
				id => "message-713:02"
				add_field => {
					"[event][id]" => "713:02"
					"[rsa][message][id1]" => "713:02"
					"[event][categoryid]" => "1001030500"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 713:03
		# line in RSA: msg="<event_description>dropped" sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> note="<action>" npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}dropped\" sess=%{fld1} n=%{fld2} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} note=\"%{action}\" npcs=%{info}" }
				id => "message-713:03"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "713:03"
					"[rsa][message][id1]" => "713:03"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "760" {
		# MESSAGE 760
		# line in RSA: msg="<event_description>dropped" n=<fld1> src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost>  note=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}dropped\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}  note=%{info}" }
				id => "message-760"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "760"
					"[rsa][message][id1]" => "760"
					"[event][categoryid]" => "1803020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 760:01
		# line in RSA: msg="<event_description>dropped" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> note= | <daddr>:<dport>:<dinterface> note= } <action> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<event_description>[^d]*)dropped\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+note=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=[\s]+)[\s]+(?<action>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-760:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "dropped"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "760:01"
					"[rsa][message][id1]" => "760:01"
					"[event][categoryid]" => "1803020000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId211
	# line in RSA: msg="<msg>" n=<ntype> 
	else if [logstash][msgparser][id] == "msgParserId211" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{ntype}" }
			id => "msgParserId211"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "860" {
		# MESSAGE 860
		# line in RSA: msg="<msg>" n=<ntype> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype}" }
				id => "message-860"
				add_field => {
					"[event][id]" => "860"
					"[rsa][message][id1]" => "860"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 860:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<ntype> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{ntype}" }
				id => "message-860:01"
				add_field => {
					"[event][id]" => "860:01"
					"[rsa][message][id1]" => "860:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "866" {
		# MESSAGE 866
		# line in RSA: msg="<msg>" {n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> fw_action="<action>" |n=<ntype> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+(n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+fw_action=\"(?<action>[^\"]*)\"[\s]+|n=(?<ntype>[^\s]*)[\s]+)$" }
				id => "message-866"
				add_field => {
					"[event][id]" => "866"
					"[rsa][message][id1]" => "866"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 866:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<ntype> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{ntype}" }
				id => "message-866:01"
				add_field => {
					"[event][id]" => "866:01"
					"[rsa][message][id1]" => "866:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "867" {
		# MESSAGE 867
		# line in RSA: msg="<msg>" n=<ntype> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{ntype}" }
				id => "message-867"
				add_field => {
					"[event][id]" => "867"
					"[rsa][message][id1]" => "867"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 867:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<ntype> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{ntype}" }
				id => "message-867:01"
				add_field => {
					"[event][id]" => "867:01"
					"[rsa][message][id1]" => "867:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "882" {
		# MESSAGE 882
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol}" }
				id => "message-882"
				add_field => {
					"[event][id]" => "882"
					"[rsa][message][id1]" => "882"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 882:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol> npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol} npcs=%{info}" }
				id => "message-882:01"
				add_field => {
					"[event][id]" => "882:01"
					"[rsa][message][id1]" => "882:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "888" {
		# MESSAGE 888
		# line in RSA: msg="<reason>;<action>" n=<fld1> src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{reason};%{action}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}" }
				id => "message-888"
				add_field => {
					"[event][id]" => "888"
					"[rsa][message][id1]" => "888"
					"[event][categoryid]" => "1801010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 888:01
		# line in RSA: msg="<reason>;<action>" sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> note=<fld3> npcs=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{reason};%{action}\" sess=%{fld1} n=%{fld2} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} note=%{fld3} npcs=%{info}" }
				id => "message-888:01"
				add_field => {
					"[event][id]" => "888:01"
					"[rsa][message][id1]" => "888:01"
					"[event][categoryid]" => "1801010000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId242
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
	else if [logstash][msgparser][id] == "msgParserId242" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
			id => "msgParserId242"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId308
	# line in RSA: msg="<event_description>" n=<fld2> {src=<saddr>:<sport>:<sinterface>:<shost> dst=|src=<saddr>:<sport>:<sinterface> dst=} {<daddr>:<dport>:<dinterface> srcMac=|<daddr>:<dport> srcMac=} <smacaddr> dstMac=<dmacaddr> proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId308" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+(src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=|src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=)[\s]+((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId308"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId309
	# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport>:<sinterface>:<host> dst=<dtransaddr>:<dtransport>:<dinterface>:<shost>
	else if [logstash][msgparser][id] == "msgParserId309" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport}:%{sinterface}:%{host} dst=%{dtransaddr}:%{dtransport}:%{dinterface}:%{shost}" }
			id => "msgParserId309"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "657" {
		# MESSAGE 657
		# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport>:<sinterface>:<host> dst=<dtransaddr>:<dtransport>:<dinterface>:<shost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport}:%{sinterface}:%{host} dst=%{dtransaddr}:%{dtransport}:%{dinterface}:%{shost}" }
				id => "message-657"
				add_field => {
					"[event][id]" => "657"
					"[rsa][message][id1]" => "657"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 657:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-657:01"
				add_field => {
					"[event][id]" => "657:01"
					"[rsa][message][id1]" => "657:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId310
	# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr> note="<event_description>"
	else if [logstash][msgparser][id] == "msgParserId310" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr} note=\"%{event_description}\"" }
			id => "msgParserId310"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId311
	# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> note="<event_description>"
	else if [logstash][msgparser][id] == "msgParserId311" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} note=\"%{event_description}\"" }
			id => "msgParserId311"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId312
	# line in RSA: msg="<msg>" n=<fld1>  usr=<username> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> note="<event_description>"
	else if [logstash][msgparser][id] == "msgParserId312" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}  usr=%{username} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} note=\"%{event_description}\"" }
			id => "msgParserId312"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId313
	# line in RSA: msg="<msg>" n=<fld1>  usr=<username> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> proto=<protocol>
	else if [logstash][msgparser][id] == "msgParserId313" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}  usr=%{username} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} proto=%{protocol}" }
			id => "msgParserId313"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId314
	# line in RSA: msg="<event_description>" sess="<fld1>" n=<fld2> usr="<username>" src=<saddr>:<sport>:<sinterface>:<fld3> dst=<daddr>:<dport>:<dinterface>:<fld4> note="<info>"
	else if [logstash][msgparser][id] == "msgParserId314" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" sess=\"%{fld1}\" n=%{fld2} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface}:%{fld3} dst=%{daddr}:%{dport}:%{dinterface}:%{fld4} note=\"%{info}\"" }
			id => "msgParserId314"
			add_field => {
				"ec_subject" => "NetworkComm"
				"ec_theme" => "Communication"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "998" {
		# MESSAGE 998
		# line in RSA: msg="<msg>" n=<fld1>  usr=<username> src=<stransaddr>:<stransport> dst=<dtransaddr>:<dtransport> note="<event_description>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1}  usr=%{username} src=%{stransaddr}:%{stransport} dst=%{dtransaddr}:%{dtransport} note=\"%{event_description}\"" }
				id => "message-998"
				add_field => {
					"[event][id]" => "998"
					"[rsa][message][id1]" => "998"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 998:01
		# line in RSA: msg="<msg>" sess="<fld1>" dur=<duration> n=<fld3> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol> note="<rulename>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=\"%{fld1}\" dur=%{duration} n=%{fld3} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol} note=\"%{rulename}\" fw_action=\"%{action}\"" }
				id => "message-998:01"
				add_field => {
					"[event][id]" => "998:01"
					"[rsa][message][id1]" => "998:01"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId316
	# line in RSA: msg="<msg>" <space> n=<fld1>
	else if [logstash][msgparser][id] == "msgParserId316" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" %{space} n=%{fld1}" }
			id => "msgParserId316"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId317
	# line in RSA: msg="<msg>" n=<fld1> src=<saddr> dst=<daddr> note="<event_description>"
	else if [logstash][msgparser][id] == "msgParserId317" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr} dst=%{daddr} note=\"%{event_description}\"" }
			id => "msgParserId317"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "267" {
		# MESSAGE 267:01
		# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>|dst=<daddr>} srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> note="<fld3>" fw_action="<action>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^\s]*)|dst=(?<daddr>[^\s]*))[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+note=\"(?<fld3>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
				id => "message-267:01"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "267:01"
					"[rsa][message][id1]" => "267:01"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 267
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}" }
				id => "message-267"
				add_field => {
					"[event][id]" => "267"
					"[rsa][message][id1]" => "267"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId320
	# line in RSA: msg="<msg>" n=<fld1> src=<stransaddr>:<stransport> dst=<dtransaddr> proto=<protocol>
	else if [logstash][msgparser][id] == "msgParserId320" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{stransaddr}:%{stransport} dst=%{dtransaddr} proto=%{protocol}" }
			id => "msgParserId320"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId321
	# line in RSA: msg="<msg>" sess="<fld1>" dur=<duration> n=<fld2> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId321" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" sess=\"%{fld1}\" dur=%{duration} n=%{fld2} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} fw_action=\"%{action}\"" }
			id => "msgParserId321"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId322
	# line in RSA: msg="<msg>" af_polid=<fld1> af_policy="<fld2>" af_type="<fld3>" af_service="<fld4>" af_action="<fld5>"  n=<fld6> src=<stransaddr>:<stransport>:<sinterface>:<shost> dst=<dtransaddr>:<dtransport>:<dinterface>:<dhost>
	else if [logstash][msgparser][id] == "msgParserId322" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" af_polid=%{fld1} af_policy=\"%{fld2}\" af_type=\"%{fld3}\" af_service=\"%{fld4}\" af_action=\"%{fld5}\"  n=%{fld6} src=%{stransaddr}:%{stransport}:%{sinterface}:%{shost} dst=%{dtransaddr}:%{dtransport}:%{dinterface}:%{dhost}" }
			id => "msgParserId322"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId323
	# line in RSA: msg="<msg>" n=<fld1> if=<fld2> ucastRx=<fld3> bcastRx=<fld4> bytesRx=<rbytes> ucastTx=<fld5> bcastTx=<fld6> bytesTx=<sbytes>
	else if [logstash][msgparser][id] == "msgParserId323" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} if=%{fld2} ucastRx=%{fld3} bcastRx=%{fld4} bytesRx=%{rbytes} ucastTx=%{fld5} bcastTx=%{fld6} bytesTx=%{sbytes}" }
			id => "msgParserId323"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "809" {
		# MESSAGE 809
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface> fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface} fw_action=\"%{action}\"" }
				id => "message-809"
				add_field => {
					"[event][id]" => "809"
					"[rsa][message][id1]" => "809"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 809:01
		# line in RSA: msg="<msg>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} fw_action=\"%{action}\"" }
				id => "message-809:01"
				add_field => {
					"[event][id]" => "809:01"
					"[rsa][message][id1]" => "809:01"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId326
	# line in RSA: msg="<event_description>" n=<fld1> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId326" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} fw_action=\"%{action}\"" }
			id => "msgParserId326"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId327
	# line in RSA: msg="<event_description>" sess="<fld1>" dur=<duration> n=<fld2> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId327" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+sess=\"(?<fld1>[^\"]*)\"[\s]+dur=(?<duration>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId327"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId328
	# line in RSA: msg="<event_description>" sid=<sid> spycat=<fld1> spypri=<fld2> pktdatId=<fld3> n=<fld4> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto={<protocol>/<fld5>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId328" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+sid=(?<sid>[^\s]*)[\s]+spycat=(?<fld1>[^\s]*)[\s]+spypri=(?<fld2>[^\s]*)[\s]+pktdatId=(?<fld3>[^\s]*)[\s]+n=(?<fld4>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld5>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId328"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId329
	# line in RSA: msg="<event_description>" n=<fld1> srcV6=<saddr_v6> src=<saddr>:<sport>:<sinterface> dstV6=<daddr_v6> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId329" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} srcV6=%{saddr_v6} src=%{saddr}:%{sport}:%{sinterface} dstV6=%{daddr_v6} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} fw_action=\"%{action}\"" }
			id => "msgParserId329"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "1195" {
		# MESSAGE 1195
		# line in RSA: n=<fld1> fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "n=%{fld1} fw_action=\"%{action}\"" }
				id => "message-1195"
				add_field => {
					"[event][id]" => "1195"
					"[rsa][message][id1]" => "1195"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 1195:01
		# line in RSA: msg="<event_description>" n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1}" }
				id => "message-1195:01"
				add_field => {
					"[event][id]" => "1195:01"
					"[rsa][message][id1]" => "1195:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{date} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId332
	# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport> dst=<daddr>:<dport> note="<fld3>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId332" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} src=%{saddr}:%{sport} dst=%{daddr}:%{dport} note=\"%{fld3}\" fw_action=\"%{action}\"" }
			id => "msgParserId332"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "1154" {
		# MESSAGE 1154
		# line in RSA: msg="<msg>" sid=<sid> appcat=<fld1> appid=<fld2> n=<fld3> src=<stransaddr>:<stransport>:<sinterface>:<shost> dst=<dtransaddr>:<dtransport>:<dinterface>:<dhost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sid=%{sid} appcat=%{fld1} appid=%{fld2} n=%{fld3} src=%{stransaddr}:%{stransport}:%{sinterface}:%{shost} dst=%{dtransaddr}:%{dtransport}:%{dinterface}:%{dhost}" }
				id => "message-1154"
				add_field => {
					"[event][id]" => "1154"
					"[rsa][message][id1]" => "1154"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1154:01
		# line in RSA: msg="<msg>" sid=<sid> appcat=<fld1> appid=<fld2> n=<fld3> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sid=(?<sid>[^\s]*)[\s]+appcat=(?<fld1>[^\s]*)[\s]+appid=(?<fld2>[^\s]*)[\s]+n=(?<fld3>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-1154:01"
				add_field => {
					"[event][id]" => "1154:01"
					"[rsa][message][id1]" => "1154:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1154:02
		# line in RSA: msg="<msg>" sid=<sid> appcat="<fld1>" appid<fld2> catid=<fld3> sess="<fld4>" n=<fld5> usr="<username>" src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sid=%{sid} appcat=\"%{fld1}\" appid%{fld2} catid=%{fld3} sess=\"%{fld4}\" n=%{fld5} usr=\"%{username}\" src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-1154:02"
				add_field => {
					"[event][id]" => "1154:02"
					"[rsa][message][id1]" => "1154:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 1154:03
		# line in RSA: msg="<msg>" sid=<sid> appcat="<fld1>" appid=<fld2> catid=<fld3> n=<fld4> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface>:<dhost> srcMac=|dst=<daddr>:<dport>:<dinterface> srcMac=}<smacaddr> dstMac=<dmacaddr> proto=<protocol> rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sid=(?<sid>[^\s]*)[\s]+appcat=\"(?<fld1>[^\"]*)\"[\s]+appid=(?<fld2>[^\s]*)[\s]+catid=(?<fld3>[^\s]*)[\s]+n=(?<fld4>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+srcMac=|dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=)(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+rule=\"(?<rule>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
				id => "message-1154:03"
				add_field => {
					"[event][id]" => "1154:03"
					"[rsa][message][id1]" => "1154:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId337
	# line in RSA: msg="<msg>" src=<stransaddr> dst=<dtransaddr> <result>
	else if [logstash][msgparser][id] == "msgParserId337" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" src=%{stransaddr} dst=%{dtransaddr} %{result}" }
			id => "msgParserId337"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId338
	# line in RSA: src=<stransaddr> dst=<dtransaddr> <msg>
	else if [logstash][msgparser][id] == "msgParserId338" {
		dissect {
			mapping => { "message" => "src=%{stransaddr} dst=%{dtransaddr} %{msg}" }
			id => "msgParserId338"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId339
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface> | <daddr> } { proto=<protocol> | rule=<rule> }
	else if [logstash][msgparser][id] == "msgParserId339" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+|[\s]*(?<daddr>[^\s]*)[\s]+)[\s]+([\s]*proto=(?<protocol>[^\s]*)[\s]+|[\s]*rule=(?<rule>[^\s]*)[\s]+)$" }
			id => "msgParserId339"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId340
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } { <daddr>:<dport>:<dinterface>:<dhost> note= | <daddr>:<dport>:<dinterface> note= } "<fld3> Protocol:<protocol>" npcs=<info>
	else if [logstash][msgparser][id] == "msgParserId340" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+note=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=[\s]+)[\s]+\"(?<fld3>[^\s]*)[\s]+Protocol:(?<protocol>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
			id => "msgParserId340"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "1199" {
		# MESSAGE 1199
		# line in RSA: msg="<msg>" note="<fld3> sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } <daddr>:<dport>:<dinterface> npcs=<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+note=\"(?<fld3>[^\s]*)[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=(?<info>.*)$" }
				id => "message-1199"
				add_field => {
					"[event][id]" => "1199"
					"[rsa][message][id1]" => "1199"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1199:01
		# line in RSA: msg="Responder from country blocked: Responder IP:<fld1>Country Name:<location_country>" n=<fld2>src=<saddr>:<sport>:<sinterface>dst=<daddr>:<dport>:<dinterface>:<dhost>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"Responder from country blocked: Responder IP:%{fld1}Country Name:%{location_country}\" n=%{fld2}src=%{saddr}:%{sport}:%{sinterface}dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-1199:01"
				add_field => {
					"[event][id]" => "1199:01"
					"[rsa][message][id1]" => "1199:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 1199:02
		# line in RSA: msg="Responder from country blocked: Responder IP:<fld1>Country Name:<location_country>" n=<fld2>src=<saddr>:<sport>:<sinterface>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>rule="<rule>" fw_action="<action>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"Responder from country blocked: Responder IP:%{fld1}Country Name:%{location_country}\" n=%{fld2}src=%{saddr}:%{sport}:%{sinterface}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}rule=\"%{rule}\" fw_action=\"%{action}\"" }
				id => "message-1199:02"
				add_field => {
					"[event][id]" => "1199:02"
					"[rsa][message][id1]" => "1199:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "1155" {
		# MESSAGE 1155
		# line in RSA: msg="<msg>" sid=<sid> appcat=<fld1> appid=<fld2> catid=<fld3> sess=<fld4> n=<fld5> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sid=(?<sid>[^\s]*)[\s]+appcat=(?<fld1>[^\s]*)[\s]+appid=(?<fld2>[^\s]*)[\s]+catid=(?<fld3>[^\s]*)[\s]+sess=(?<fld4>[^\s]*)[\s]+n=(?<fld5>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-1155"
				add_field => {
					"[event][id]" => "1155"
					"[rsa][message][id1]" => "1155"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1155:01
		# line in RSA: msg="<action>" sid=<sid> appcat=<fld1> appid=<fld2> n=<fld3> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface>:<dhost>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{action}\" sid=%{sid} appcat=%{fld1} appid=%{fld2} n=%{fld3} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost}" }
				id => "message-1155:01"
				add_field => {
					"[event][id]" => "1155:01"
					"[rsa][message][id1]" => "1155:01"
					"[event][categoryid]" => "1801030000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId346
	# line in RSA: msg="<msg>" note="<fld3>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr> dst= } <daddr>:<dport>:<dinterface> npcs=<info>
	else if [logstash][msgparser][id] == "msgParserId346" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+note=\"(?<fld3>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=(?<info>.*)$" }
			id => "msgParserId346"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId347
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface> dst= | <saddr> dst= } <daddr>:<dport>:<dinterface> npcs=<info>
	else if [logstash][msgparser][id] == "msgParserId347" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+dst=[\s]+)[\s]+(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=(?<info>.*)$" }
			id => "msgParserId347"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId241
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> note= | <daddr>:<dport>:<dinterface> note= } "<fld3>" npcs=<info>
	else if [logstash][msgparser][id] == "msgParserId241" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+note=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=[\s]+)[\s]+\"(?<fld3>[^\"]*)\"[\s]+npcs=(?<info>.*)$" }
			id => "msgParserId241"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId348
	# line in RSA: msg="<msg>" sess="<fld1>" dur=<duration> n=<fld2> usr="<username>" src=<saddr>::<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol> note="<rulename>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId348" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" sess=\"%{fld1}\" dur=%{duration} n=%{fld2} usr=\"%{username}\" src=%{saddr}::%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol} note=\"%{rulename}\" fw_action=\"%{action}\"" }
			id => "msgParserId348"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "1201" {
		# MESSAGE 1201
		# line in RSA: msg="<msg>" note="<fld3>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+note=\"(?<fld3>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-1201"
				add_field => {
					"[event][id]" => "1201"
					"[rsa][message][id1]" => "1201"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1201:01
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src={<saddr>:<sport>:<sinterface>:<shost> dst= | <saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>:<dhost> npcs= | <daddr>:<dport>:<dinterface> npcs= } <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+npcs=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+npcs=[\s]+)[\s]+(?<info>.*)$" }
				id => "message-1201:01"
				add_field => {
					"[event][id]" => "1201:01"
					"[rsa][message][id1]" => "1201:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId350
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2>
	else if [logstash][msgparser][id] == "msgParserId350" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2}" }
			id => "msgParserId350"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "1153" {
		# MESSAGE 1153
		# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface>:<dhost> proto=<protocol> rcvd=<rbytes> note="<info>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"%{msg}\" sess=%{fld1} n=%{fld2} src=%{saddr}:%{sport}:%{sinterface}:%{shost} dst=%{daddr}:%{dport}:%{dinterface}:%{dhost} proto=%{protocol} rcvd=%{rbytes} note=\"%{info}\"" }
				id => "message-1153"
				add_field => {
					"[event][id]" => "1153"
					"[rsa][message][id1]" => "1153"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1153:01
		# line in RSA: {msg="<event_description>" app=<fld1> sess=<fld2>| msg="<event_description>" sess=<fld2> | msg="<event_description>"} n=<fld3> usr="<username>" src={ <saddr>:<sport>:<sinterface>:<shost> dst= |<saddr>:<sport>:<sinterface> dst= } { <daddr>:<dport>:<dinterface>srcMac= | <daddr>:<dport>srcMac= | <daddr>srcMac= } <smacaddr> dstMac=<dmacaddr> proto=<protocol> { sent=<sbytes>rcvd=<rbytes> | type=<fld4> icmpCode=<fld5> rcvd=<rbytes> | rcvd=<rbytes> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld1>[^\s]*)[\s]+sess=(?<fld2>[^\s]*)|[\s]*msg=\"(?<event_description>[^\"]*)\"[\s]+sess=(?<fld2>[^\s]*)[\s]+|[\s]*msg=\"(?<event_description>[^\"]*)\")[\s]+n=(?<fld3>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"[\s]+src=([\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=[\s]+|(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=[\s]+)[\s]+([\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^s]*)srcMac=[\s]+|[\s]*(?<daddr>[^:]*):(?<dport>[^s]*)srcMac=[\s]+|[\s]*(?<daddr>[^s]*)srcMac=[\s]+)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+([\s]*sent=(?<sbytes>[^r]*)rcvd=(?<rbytes>[^\s]*)[\s]+|[\s]*type=(?<fld4>[^\s]*)[\s]+icmpCode=(?<fld5>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+|[\s]*rcvd=(?<rbytes>[^\s]*)[\s]+)$" }
				id => "message-1153:01"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "1153:01"
					"[rsa][message][id1]" => "1153:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 1153:02
		# line in RSA: msg="<event_description>" {app=<fld1> n=<fld2> | n=<fld2>} src=<saddr>:<sport>:<sinterface>:<shost> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> sent=<sbytes> rcvd=<rbytes> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+(app=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+|[\s]*n=(?<fld2>[^\s]*))[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=(?<protocol>[^\s]*)[\s]+sent=(?<sbytes>[^\s]*)[\s]+rcvd=(?<rbytes>[^\s]*)[\s]+$" }
				id => "message-1153:02"
				add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "1153:02"
					"[rsa][message][id1]" => "1153:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId354
	# line in RSA: msg="<msg>"<space>n=<fld1>
	else if [logstash][msgparser][id] == "msgParserId354" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\"%{space}n=%{fld1}" }
			id => "msgParserId354"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId355
	# line in RSA: msg="<event_description>" n=<fld2>{ src=<saddr>:<sport>:<sinterface> dst=|src=<saddr>:<sport> dst=} {<daddr>:<dport>:<dinterface> note=|<daddr>:<dport> note=} "<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId355" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\ss]*)([\s]*src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=|src=(?<saddr>[^:]*):(?<sport>[^\s]*)[\s]+dst=)[\s]+((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=|(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+note=)[\s]+\"(?<info>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId355"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId356
	# line in RSA: msg="<event_description>" n=<fld2> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface> note=|dst=<daddr>:<dport> note=} "<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId356" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+note=|dst=(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+note=)[\s]+\"(?<info>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId356"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId357
	# line in RSA: msg="<msg>"<space>n=<fld1> note="<info>"
	else if [logstash][msgparser][id] == "msgParserId357" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\"%{space}n=%{fld1} note=\"%{info}\"" }
			id => "msgParserId357"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId358
	# line in RSA: msg="<msg>" n=<fld1> srcV6=<saddr_v6> src=<saddr>:<sport>:<sinterface> dstV6=<daddr_v6> dst=<daddr>:<dport> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId358" {
		dissect {
			mapping => { "message" => "msg=\"%{msg}\" n=%{fld1} srcV6=%{saddr_v6} src=%{saddr}:%{sport}:%{sinterface} dstV6=%{daddr_v6} dst=%{daddr}:%{dport} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} fw_action=\"%{action}\"" }
			id => "msgParserId358"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "1079" {
		# MESSAGE 1079
		# line in RSA: msg="User<username>{login|logout}"{dur=<duration><space>n=<fld1>|sess="<fld2>" n=<fld1> |n=<fld1>}
		# Parsing error: Couldn't parse because of 2 adjacent fields like <fld1><fld2>
		# MESSAGE 1079:01
		# line in RSA: msg="Client<username>is assigned IP:<hostip>" <space> n=<fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"Client%{username}is assigned IP:%{hostip}\" %{space} n=%{fld1}" }
				id => "message-1079:01"
				add_field => {
					"[event][id]" => "1079:01"
					"[rsa][message][id1]" => "1079:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 1079:02
		# line in RSA: msg="destination for <daddr> is not allowed by access control" n=<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"destination for %{daddr} is not allowed by access control\" n=%{fld2}" }
				id => "message-1079:02"
				add_field => {
				"event_description" => "destination is not allowed by access control"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "1079:02"
					"[rsa][message][id1]" => "1079:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE 1079:03
		# line in RSA: msg="SSLVPN Client <username> matched device profile Default Device Profile for Windows" n=<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "msg=\"SSLVPN Client %{username} matched device profile Default Device Profile for Windows\" n=%{fld2}" }
				id => "message-1079:03"
				add_field => {
				"event_description" => "SSLVPN Client matched device profile Default Device Profile for Windows"
				"hostip" => "%{hhostip}"
				"id" => "%{hid}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
					"[event][id]" => "1079:03"
					"[rsa][message][id1]" => "1079:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId363
	# line in RSA: msg="<msg>" sess=<fld1> n=<fld2> usr="<username>" src= {<saddr>:<sport>:<sinterface>:<shost> dst=| <saddr>:<sport>:<sinterface> dst=} {<daddr>:<dport>:<dinterface>:<dhost> proto=| <daddr>:<dport>:<dinterface> proto=} <protocol>
	else if [logstash][msgparser][id] == "msgParserId363" {
		grok {
			match => { "message" => "^msg=\"(?<msg>[^\"]*)\"[\s]+sess=(?<fld1>[^\s]*)[\s]+n=(?<fld2>[^\s]*)[\s]+usr=\"(?<username>[^\"]*)\"[\s]+src=[\s]+((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^:]*):(?<shost>[^\s]*)[\s]+dst=|[\s]*(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=)[\s]+((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)[\s]+proto=|[\s]*(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+proto=)[\s]+(?<protocol>.*)$" }
			id => "msgParserId363"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId364
	# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport> srcMac=<smacaddr> dstMac=<dmacaddr> proto=<protocol> note="<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId364" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport} srcMac=%{smacaddr} dstMac=%{dmacaddr} proto=%{protocol} note=\"%{info}\" fw_action=\"%{action}\"" }
			id => "msgParserId364"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId365
	# line in RSA: msg="<event_description>" n=<fld2>src=<saddr>:<sport>:<sinterface>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto={<protocol>/<fld3>|<protocol>}fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId365" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^s]*)src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^s]*)srcMac=(?<smacaddr>[^d]*)dstMac=(?<dmacaddr>[^p]*)proto=((?<protocol>[^/]*)/(?<fld3>[^f]*)|(?<protocol>[^f]*))fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId365"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId366
	# line in RSA: msg="<event_description>" n=<fld2> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface> srcMac=|dst=<daddr>:<dport> srcMac=} <smacaddr> dstMac=<dmacaddr>proto={<protocol>/<fld3>|<protocol>}fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId366" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|dst=(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^p]*)proto=((?<protocol>[^/]*)/(?<fld3>[^f]*)|(?<protocol>[^f]*))fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId366"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId367
	# line in RSA: msg="<event_description>" n=<fld2> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface> srcMac=|dst=<daddr>:<dport> srcMac=} <smacaddr> dstMac=<dmacaddr> proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId367" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|dst=(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId367"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId368
	# line in RSA: msg="<event_description>" n=<fld2> {src=<saddr>:<sport>:<sinterface> dst=|src=<saddr>:<sport>: dst=} {<daddr>:<dport>:<dinterface> srcMac=|<daddr>:<dport> srcMac=} <smacaddr> dstMac=<dmacaddr> proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId368" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+(src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dst=|src=(?<saddr>[^:]*):(?<sport>[^:]*):[\s]+dst=)[\s]+((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=|(?<daddr>[^:]*):(?<dport>[^\s]*)[\s]+srcMac=)[\s]+(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId368"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId369
	# line in RSA: pktdatId=<fld1>pktdatNum="<fld2>" pktdatEnc="<fld3>" n=<fld4>src={<saddr>:<sport>:<sinterface>dst=|<saddr>:<sport>dst=}{<daddr>:<dport>:<dinterface>:<dhost>|<daddr>:<dport>:<dinterface>|<daddr>:<dport>}
	else if [logstash][msgparser][id] == "msgParserId369" {
		grok {
			match => { "message" => "^pktdatId=(?<fld1>[^p]*)pktdatNum=\"(?<fld2>[^\"]*)\"[\s]+pktdatEnc=\"(?<fld3>[^\"]*)\"[\s]+n=(?<fld4>[^s]*)src=((?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=|(?<saddr>[^:]*):(?<sport>[^d]*)dst=)((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>.*)|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>.*)|(?<daddr>[^:]*):(?<dport>.*))$" }
			id => "msgParserId369"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId370
	# line in RSA: msg="<event_description>" app=<fld1>appName="<application>" n=<fld2>src=<saddr>:<sport>:<sinterface>dst=<daddr>:<dport>:<dinterface>srcMac=<smacaddr>dstMac=<dmacaddr>proto=<protocol>fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId370" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" app=%{fld1}appName=\"%{application}\" n=%{fld2}src=%{saddr}:%{sport}:%{sinterface}dst=%{daddr}:%{dport}:%{dinterface}srcMac=%{smacaddr}dstMac=%{dmacaddr}proto=%{protocol}fw_action=\"%{action}\"" }
			id => "msgParserId370"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId371
	# line in RSA: msg="<event_description>" n=<fld2>note="<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId371" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld2}note=\"%{info}\" fw_action=\"%{action}\"" }
			id => "msgParserId371"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId372
	# line in RSA: msg="<event_description>" app=<fld2>appName="<application>" n=<fld3>src=<saddr>:<sport>:<sinterface>dst={<daddr>:<dport>:<dinterface>:<dhost>srcMac=|<daddr>:<dport>:<dinterface>srcMac=}<smacaddr>dstMac=<dmacaddr>proto=<protocol>fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId372" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld2>[^a]*)appName=\"(?<application>[^\"]*)\"[\s]+n=(?<fld3>[^s]*)src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^d]*)dst=((?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^s]*)srcMac=|(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^s]*)srcMac=)(?<smacaddr>[^d]*)dstMac=(?<dmacaddr>[^p]*)proto=(?<protocol>[^f]*)fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId372"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId373
	# line in RSA: m=<id1>msg="<event_description>" n=<fld2>if=<interface>ucastRx=<fld3>bcastRx=<fld4>bytesRx=<rbytes>ucastTx=<fld5>bcastTx=<fld6>bytesTx=<sbytes>
	else if [logstash][msgparser][id] == "msgParserId373" {
		dissect {
			mapping => { "message" => "m=%{id1}msg=\"%{event_description}\" n=%{fld2}if=%{interface}ucastRx=%{fld3}bcastRx=%{fld4}bytesRx=%{rbytes}ucastTx=%{fld5}bcastTx=%{fld6}bytesTx=%{sbytes}" }
			id => "msgParserId373"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId374
	# line in RSA: msg="<event_description>" n=<fld1>note="<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId374" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1}note=\"%{info}\" fw_action=\"%{action}\"" }
			id => "msgParserId374"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId375
	# line in RSA: msg="<event_description>" sid=<sid> ipscat="<fld3>" ipspri=<fld4>  pktdatId=<fld5> n=<fld6> src=<saddr>:<sport>:<sinterface> dst=<daddr>:<dport>:<dinterface> proto=<protocol> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId375" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" sid=%{sid} ipscat=\"%{fld3}\" ipspri=%{fld4}  pktdatId=%{fld5} n=%{fld6} src=%{saddr}:%{sport}:%{sinterface} dst=%{daddr}:%{dport}:%{dinterface} proto=%{protocol} fw_action=\"%{action}\"" }
			id => "msgParserId375"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId376
	# line in RSA: msg="<event_description>" n=<fld1> fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId376" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} fw_action=\"%{action}\"" }
			id => "msgParserId376"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId377
	# line in RSA: msg="<event_description>" n=<fld1> note="<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId377" {
		dissect {
			mapping => { "message" => "msg=\"%{event_description}\" n=%{fld1} note=\"%{info}\" fw_action=\"%{action}\"" }
			id => "msgParserId377"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId378
	# line in RSA: msg="<event_description>" n=<fld1> src=<saddr>:<sport>:<sinterface> {dst=<daddr>:<dport>:<dinterface>:<dhost>|dst=<daddr>:<dport>:<dinterface>} note="<info>" fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId378" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+n=(?<fld1>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+(dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^:]*):(?<dhost>[^\s]*)|dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*))[\s]+note=\"(?<info>[^\"]*)\"[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId378"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId379
	# line in RSA: msg="<event_description>" app=<fld1> appName="<application>" n=<fld2> srcV6=<saddr_v6> src=<saddr>:<sport>:<sinterface> dstV6=<daddr_v6> dst=<daddr>:<dport>:<dinterface> srcMac=<smacaddr> dstMac=<dmacaddr> proto={<protocol>/<fld3>|<protocol>} fw_action="<action>"
	else if [logstash][msgparser][id] == "msgParserId379" {
		grok {
			match => { "message" => "^msg=\"(?<event_description>[^\"]*)\"[\s]+app=(?<fld1>[^\s]*)[\s]+appName=\"(?<application>[^\"]*)\"[\s]+n=(?<fld2>[^\s]*)[\s]+srcV6=(?<saddr_v6>[^\s]*)[\s]+src=(?<saddr>[^:]*):(?<sport>[^:]*):(?<sinterface>[^\s]*)[\s]+dstV6=(?<daddr_v6>[^\s]*)[\s]+dst=(?<daddr>[^:]*):(?<dport>[^:]*):(?<dinterface>[^\s]*)[\s]+srcMac=(?<smacaddr>[^\s]*)[\s]+dstMac=(?<dmacaddr>[^\s]*)[\s]+proto=((?<protocol>[^/]*)/(?<fld3>[^\s]*)|(?<protocol>[^\s]*))[\s]+fw_action=\"(?<action>[^\"]*)\"$" }
			id => "msgParserId379"
			add_field => {
				"hostip" => "%{hhostip}"
				"id" => "%{hfld1}"
				"serial_number" => "%{hserial_number}"
				"category" => "%{hcategory}"
				"severity" => "%{hseverity}"
				"[logstash][fullDateTimeString]" => "%{date} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_sonicwallmsg.json"
#			template_name => "sonicwall_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
