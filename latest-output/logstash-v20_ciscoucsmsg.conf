# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "ciscoucs"
			"[observer][name]" => "Cisco UCS Manager"
			"[observer][type]" => "Configuration Management"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: : <hyear> <hmonth> <hday> <htime>: %<hfld1>-<hlevel>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => ": %{hyear} %{hmonth} %{hday} %{htime}: %%{hfld1}-%{hlevel}-%{messageid}: %{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: : <hyear> <hmonth> <hday> <htime>: %<hfld1>-<hfld2>-<hlevel>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => ": %{hyear} %{hmonth} %{hday} %{htime}: %%{hfld1}-%{hfld2}-%{hlevel}-%{messageid}: %{message}" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_ciscoucsmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "AUDIT" {
		# MESSAGE AUDIT
		# line in RSA: [session][<fld1>][creation][<fld2>] <fld3>: local user <username> logged in from <saddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[session][%{fld1}][creation][%{fld2}] %{fld3}: local user %{username} logged in from %{saddr}" }
				id => "message-AUDIT"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"event_description" => "local user logged in"
					"[event][id]" => "AUDIT"
					"[rsa][message][id1]" => "AUDIT"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AUDIT:01
		# line in RSA: [session][<fld1>][deletion][<fld2>] <fld3>: user <username> terminated session id <sessionid>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[session][%{fld1}][deletion][%{fld2}] %{fld3}: user %{username} terminated session id %{sessionid}" }
				id => "message-AUDIT:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"event_description" => "user terminated session"
					"[event][id]" => "AUDIT:01"
					"[rsa][message][id1]" => "AUDIT:01"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId2
	# line in RSA: Service "<service>" in vdc <info> started with PID(<process_id>).
	else if [logstash][msgparser][id] == "msgParserId2" {
		dissect {
			mapping => { "message" => "Service \"%{service}\" in vdc %{info} started with PID(%{process_id})." }
			id => "msgParserId2"
			add_field => {
				"event_description" => "Service started"
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId3
	# line in RSA: "<service>" (PID <process_id>) has successfully exited with exit code <result>.
	else if [logstash][msgparser][id] == "msgParserId3" {
		dissect {
			mapping => { "message" => "\"%{service}\" (PID %{process_id}) has successfully exited with exit code %{result}." }
			id => "msgParserId3"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId4
	# line in RSA: Service "<service>" heartbeat loss <fld5> ,max <fld6> .
	else if [logstash][msgparser][id] == "msgParserId4" {
		dissect {
			mapping => { "message" => "Service \"%{service}\" heartbeat loss %{fld5} ,max %{fld6} ." }
			id => "msgParserId4"
			add_field => {
				"event_description" => "Heartbeat loss"
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "AAA_ACCOUNTING_MESSAGE" {
		# MESSAGE AAA_ACCOUNTING_MESSAGE:start
		# line in RSA: start:<terminal>_<hostip>:<username>:
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "start:%{terminal}_%{hostip}:%{username}:" }
				id => "message-AAA_ACCOUNTING_MESSAGE:start"
				add_field => {
				"action" => "start"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:start"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:start"
					"[event][categoryid]" => "1602000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:update:01
		# line in RSA: update:<terminal>_<hostip>:<username>:terminal length <fld5>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "update:%{terminal}_%{hostip}:%{username}:terminal length %{fld5}" }
				id => "message-AAA_ACCOUNTING_MESSAGE:update:01"
				add_field => {
				"event_description" => "Update terminal length"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:update:01"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:update:01"
					"[event][categoryid]" => "1602000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:update:02
		# line in RSA: update:<terminal>_<hostip>:<username>:terminal session-timeout <fld5>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "update:%{terminal}_%{hostip}:%{username}:terminal session-timeout %{fld5}" }
				id => "message-AAA_ACCOUNTING_MESSAGE:update:02"
				add_field => {
				"event_description" => "Update terminal session-timeout"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:update:02"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:update:02"
					"[event][categoryid]" => "1602000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:update:03
		# line in RSA: update:port-<portname>::npv traffic-map server-interface <interface> external-interface
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "update:port-%{portname}::npv traffic-map server-interface %{interface} external-interface" }
				id => "message-AAA_ACCOUNTING_MESSAGE:update:03"
				add_field => {
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:update:03"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:update:03"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:update:04
		# line in RSA: update:<portname>::Interface <interface> description updated to server <device>, <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "update:%{portname}::Interface %{interface} description updated to server %{device}, %{fld1}" }
				id => "message-AAA_ACCOUNTING_MESSAGE:update:04"
				add_field => {
				"event_description" => "Update interface description"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:update:04"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:update:04"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:update:05
		# line in RSA: update:<terminal>_<hostip>:<username>:scope system
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "update:%{terminal}_%{hostip}:%{username}:scope system" }
				id => "message-AAA_ACCOUNTING_MESSAGE:update:05"
				add_field => {
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:update:05"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:update:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:update:06
		# line in RSA: update:<fld22>::enabled <network_service>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "update:%{fld22}::enabled %{network_service}" }
				id => "message-AAA_ACCOUNTING_MESSAGE:update:06"
				add_field => {
				"event_description" => "enabled telnet"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:update:06"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:update:06"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:stop:01
		# line in RSA: stop:<terminal>_<hostip>:<username>:shell terminated gracefully
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "stop:%{terminal}_%{hostip}:%{username}:shell terminated gracefully" }
				id => "message-AAA_ACCOUNTING_MESSAGE:stop:01"
				add_field => {
				"event_description" => "Shell terminated gracefully"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:stop:01"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:stop:01"
					"[event][categoryid]" => "1602010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE AAA_ACCOUNTING_MESSAGE:stop:02
		# line in RSA: stop:<terminal>_<hostip>:<username>:shell terminated because of telnet closed
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "stop:%{terminal}_%{hostip}:%{username}:shell terminated because of telnet closed" }
				id => "message-AAA_ACCOUNTING_MESSAGE:stop:02"
				add_field => {
				"event_description" => "Shell terminated because of telnet closed"
					"[event][id]" => "AAA_ACCOUNTING_MESSAGE:stop:02"
					"[rsa][message][id1]" => "AAA_ACCOUNTING_MESSAGE:stop:02"
					"[event][categoryid]" => "1602000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "SYSTEM_MSG" {
		# MESSAGE SYSTEM_MSG:01
		# line in RSA: <action>: <protocol> pid=<process_id> from=::ffff:<saddr> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action}: %{protocol} pid=%{process_id} from=::ffff:%{saddr} - %{info}" }
				id => "message-SYSTEM_MSG:01"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:01"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:02
		# line in RSA: <action>: <protocol> pid=<process_id> from=<saddr_v6> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action}: %{protocol} pid=%{process_id} from=%{saddr_v6} - %{info}" }
				id => "message-SYSTEM_MSG:02"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:02"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:03
		# line in RSA: <directory> line <fld22>: <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{directory} line %{fld22}: %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:03"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:03"
					"[rsa][message][id1]" => "SYSTEM_MSG:03"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:04
		# line in RSA: (<authmethod>) <event_description> for user <username> by <administrator>(uid=<uid>) - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "(%{authmethod}) %{event_description} for user %{username} by %{administrator}(uid=%{uid}) - %{info}" }
				id => "message-SYSTEM_MSG:04"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
					"[event][id]" => "SYSTEM_MSG:04"
					"[rsa][message][id1]" => "SYSTEM_MSG:04"
					"[event][categoryid]" => "1302010200"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:05
		# line in RSA: (<authmethod>) <event_description> for user <username> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "(%{authmethod}) %{event_description} for user %{username} - %{info}" }
				id => "message-SYSTEM_MSG:05"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
					"[event][id]" => "SYSTEM_MSG:05"
					"[rsa][message][id1]" => "SYSTEM_MSG:05"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:06
		# line in RSA: error: Could not load host key: <directory> - <info> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "error: Could not load host key: %{directory} - %{info}" }
				id => "message-SYSTEM_MSG:06"
				add_field => {
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Could not load host key:"
					"[event][id]" => "SYSTEM_MSG:06"
					"[rsa][message][id1]" => "SYSTEM_MSG:06"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:07
		# line in RSA: (<authmethod>) authentication failure; logname=<fld22> uid=<uid> euid=<fld23> tty=<fld24> ruser=<fld25> rhost=<fld26>  user=<username> - <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "(%{authmethod}) authentication failure; logname=%{fld22} uid=%{uid} euid=%{fld23} tty=%{fld24} ruser=%{fld25} rhost=%{fld26}  user=%{username} - %{fld1}" }
				id => "message-SYSTEM_MSG:07"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
					"[event][id]" => "SYSTEM_MSG:07"
					"[rsa][message][id1]" => "SYSTEM_MSG:07"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:08
		# line in RSA: (<authmethod>) check pass; user unknown - <fld1>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "(%{authmethod}) check pass; user unknown - %{fld1}" }
				id => "message-SYSTEM_MSG:08"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:08"
					"[rsa][message][id1]" => "SYSTEM_MSG:08"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:09
		# line in RSA: (<authmethod>) auth <event_description> for [<username>] - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "(%{authmethod}) auth %{event_description} for [%{username}] - %{info}" }
				id => "message-SYSTEM_MSG:09"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
					"[event][id]" => "SYSTEM_MSG:09"
					"[rsa][message][id1]" => "SYSTEM_MSG:09"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:10
		# line in RSA: <username> : TTY=<terminal> ; PWD=<directory> ; USER=<c_username> ; COMMAND=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{username} : TTY=%{terminal} ; PWD=%{directory} ; USER=%{c_username} ; COMMAND=%{info}" }
				id => "message-SYSTEM_MSG:10"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:10"
					"[rsa][message][id1]" => "SYSTEM_MSG:10"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:11
		# line in RSA: readjusting service <network_service> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "readjusting service %{network_service} - %{info}" }
				id => "message-SYSTEM_MSG:11"
				add_field => {
				"event_description" => "readjusting service"
					"[event][id]" => "SYSTEM_MSG:11"
					"[rsa][message][id1]" => "SYSTEM_MSG:11"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:12
		# line in RSA: Reconfigured: new=<fld22> old=<fld23> dropped=<fld24> (services) - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Reconfigured: new=%{fld22} old=%{fld23} dropped=%{fld24} (services) - %{info}" }
				id => "message-SYSTEM_MSG:12"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:12"
					"[rsa][message][id1]" => "SYSTEM_MSG:12"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:13
		# line in RSA: Starting reconfiguration - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Starting reconfiguration - %{info}" }
				id => "message-SYSTEM_MSG:13"
				add_field => {
				"event_description" => "Starting reconfiguration"
					"[event][id]" => "SYSTEM_MSG:13"
					"[rsa][message][id1]" => "SYSTEM_MSG:13"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:14
		# line in RSA: [<severity>][<resultcode>][<event_time_string>]<event_description>  - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[%{severity}][%{resultcode}][%{event_time_string}]%{event_description}  - %{info}" }
				id => "message-SYSTEM_MSG:14"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:14"
					"[rsa][message][id1]" => "SYSTEM_MSG:14"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:error:01
		# line in RSA: error: PAM: <event_description> for <username> from <saddr> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "error: PAM: %{event_description} for %{username} from %{saddr} - %{info}" }
				id => "message-SYSTEM_MSG:error:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
					"[event][id]" => "SYSTEM_MSG:error:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:error:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:error:02
		# line in RSA: error: <fld21>:<fld22> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "error: %{fld21}:%{fld22} - %{info}" }
				id => "message-SYSTEM_MSG:error:02"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:error:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:error:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Failed:01
		# line in RSA: Failed keyboard-interactive/pam for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Failed keyboard-interactive/pam for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Failed:01"
				add_field => {
				"ec_subject" => "User"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
					"[event][id]" => "SYSTEM_MSG:Failed:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:Failed:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Failed:02
		# line in RSA: Failed none for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Failed none for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Failed:02"
				add_field => {
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
					"[event][id]" => "SYSTEM_MSG:Failed:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:Failed:02"
					"[event][categoryid]" => "1303000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Received
		# line in RSA: Received disconnect from <saddr>: <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Received disconnect from %{saddr}: %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:Received"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:Received"
					"[rsa][message][id1]" => "SYSTEM_MSG:Received"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Connection:01
		# line in RSA: Connection from <saddr> port <sport> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Connection from %{saddr} port %{sport} - %{info}" }
				id => "message-SYSTEM_MSG:Connection:01"
				add_field => {
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"event_description" => "Connection"
					"[event][id]" => "SYSTEM_MSG:Connection:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:Connection:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Connection:02
		# line in RSA: Connection closed by <saddr> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Connection closed by %{saddr} - %{info}" }
				id => "message-SYSTEM_MSG:Connection:02"
				add_field => {
				"ec_activity" => "Logoff"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"event_description" => "Connection closed"
					"[event][id]" => "SYSTEM_MSG:Connection:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:Connection:02"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Postponed:01
		# line in RSA: Postponed keyboard-interactive for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Postponed keyboard-interactive for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Postponed:01"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:Postponed:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:Postponed:01"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Postponed:02
		# line in RSA: Postponed keyboard-interactive/pam for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Postponed keyboard-interactive/pam for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Postponed:02"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:Postponed:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:Postponed:02"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Postponed:03
		# line in RSA: Postponed publickey for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Postponed publickey for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Postponed:03"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:Postponed:03"
					"[rsa][message][id1]" => "SYSTEM_MSG:Postponed:03"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Accepted:01
		# line in RSA: Accepted keyboard-interactive/pam for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Accepted keyboard-interactive/pam for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Accepted:01"
				add_field => {
				"ec_subject" => "User"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
					"[event][id]" => "SYSTEM_MSG:Accepted:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:Accepted:01"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Accepted:02
		# line in RSA: Accepted publickey for <username> from <saddr> port <sport> <protocol> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Accepted publickey for %{username} from %{saddr} port %{sport} %{protocol} - %{info}" }
				id => "message-SYSTEM_MSG:Accepted:02"
				add_field => {
				"ec_subject" => "User"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
					"[event][id]" => "SYSTEM_MSG:Accepted:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:Accepted:02"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:lastlog:01
		# line in RSA: lastlog_filetype: Couldn't stat <filename>: No such file or directory - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "lastlog_filetype: Couldn't stat %{filename}: No such file or directory - %{info}" }
				id => "message-SYSTEM_MSG:lastlog:01"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:lastlog:01"
					"[rsa][message][id1]" => "SYSTEM_MSG:lastlog:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:lastlog:02
		# line in RSA: lastlog_openseek: <filename> is not a file or directory! - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "lastlog_openseek: %{filename} is not a file or directory! - %{info}" }
				id => "message-SYSTEM_MSG:lastlog:02"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:lastlog:02"
					"[rsa][message][id1]" => "SYSTEM_MSG:lastlog:02"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:Closing
		# line in RSA: Closing connection to <saddr> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Closing connection to %{saddr} - %{info}" }
				id => "message-SYSTEM_MSG:Closing"
				add_field => {
				"ec_activity" => "Logoff"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"event_description" => "Closing connection"
					"[event][id]" => "SYSTEM_MSG:Closing"
					"[rsa][message][id1]" => "SYSTEM_MSG:Closing"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:WARNING
		# line in RSA: WARNING: <filename> does not exist, using fixed modulus - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "WARNING: %{filename} does not exist, using fixed modulus - %{info}" }
				id => "message-SYSTEM_MSG:WARNING"
				add_field => {
				"event_description" => "File does not exist"
					"[event][id]" => "SYSTEM_MSG:WARNING"
					"[rsa][message][id1]" => "SYSTEM_MSG:WARNING"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:15
		# line in RSA: input_userauth_request: invalid user <username> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "input_userauth_request: invalid user %{username} - %{info}" }
				id => "message-SYSTEM_MSG:15"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Invalid user"
					"[event][id]" => "SYSTEM_MSG:15"
					"[rsa][message][id1]" => "SYSTEM_MSG:15"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:16
		# line in RSA: Invalid user <username> from <saddr> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Invalid user %{username} from %{saddr} - %{info}" }
				id => "message-SYSTEM_MSG:16"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Invalid user"
					"[event][id]" => "SYSTEM_MSG:16"
					"[rsa][message][id1]" => "SYSTEM_MSG:16"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:authentication
		# line in RSA: authentication failed - sshd[<info>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "authentication failed - sshd[%{info}]" }
				id => "message-SYSTEM_MSG:authentication"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "authentication failed"
					"[event][id]" => "SYSTEM_MSG:authentication"
					"[rsa][message][id1]" => "SYSTEM_MSG:authentication"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:17
		# line in RSA: check_tty:<event_description>- <network_service>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "check_tty:%{event_description}- %{network_service}" }
				id => "message-SYSTEM_MSG:17"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:17"
					"[rsa][message][id1]" => "SYSTEM_MSG:17"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:18
		# line in RSA: <event_description> pam session - <network_service>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_description} pam session - %{network_service}" }
				id => "message-SYSTEM_MSG:18"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:18"
					"[rsa][message][id1]" => "SYSTEM_MSG:18"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:19
		# line in RSA: authentication failed - <network_service>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "authentication failed - %{network_service}" }
				id => "message-SYSTEM_MSG:19"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "authentication failed"
					"[event][id]" => "SYSTEM_MSG:19"
					"[rsa][message][id1]" => "SYSTEM_MSG:19"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:20
		# line in RSA: [F0206][<severity>] <device> is unreachable - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0206][%{severity}] %{device} is unreachable - %{info}" }
				id => "message-SYSTEM_MSG:20"
				add_field => {
				"event_description" => "Unreachable"
					"[event][id]" => "SYSTEM_MSG:20"
					"[rsa][message][id1]" => "SYSTEM_MSG:20"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:21
		# line in RSA: [F0314][<severity>] <device> (service profile: <fld1>) discovery: failed - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0314][%{severity}] %{device} (service profile: %{fld1}) discovery: failed - %{info}" }
				id => "message-SYSTEM_MSG:21"
				add_field => {
				"event_description" => "Server discovery failed"
					"[event][id]" => "SYSTEM_MSG:21"
					"[rsa][message][id1]" => "SYSTEM_MSG:21"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:22
		# line in RSA: [F0209][<severity>] <device> link state: down - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0209][%{severity}] %{device} link state: down - %{info}" }
				id => "message-SYSTEM_MSG:22"
				add_field => {
				"event_description" => "link state: down"
					"[event][id]" => "SYSTEM_MSG:22"
					"[rsa][message][id1]" => "SYSTEM_MSG:22"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:23
		# line in RSA: [F0395][<severity>] <device> speed: upper-non-critical - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0395][%{severity}] %{device} speed: upper-non-critical - %{info}" }
				id => "message-SYSTEM_MSG:23"
				add_field => {
				"event_description" => "speed: upper-non-critical"
					"[event][id]" => "SYSTEM_MSG:23"
					"[rsa][message][id1]" => "SYSTEM_MSG:23"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:24
		# line in RSA: [F0455][<severity>] <device>, <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0455][%{severity}] %{device}, %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:24"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:24"
					"[rsa][message][id1]" => "SYSTEM_MSG:24"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:25
		# line in RSA: [F0429][<severity>] <device>, <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0429][%{severity}] %{device}, %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:25"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:25"
					"[rsa][message][id1]" => "SYSTEM_MSG:25"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:26
		# line in RSA: [F0452][<severity>] <device>, <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0452][%{severity}] %{device}, %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:26"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:26"
					"[rsa][message][id1]" => "SYSTEM_MSG:26"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:27
		# line in RSA: [F0451][<severity>] <device>, <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0451][%{severity}] %{device}, %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:27"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:27"
					"[rsa][message][id1]" => "SYSTEM_MSG:27"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:28
		# line in RSA: [F0320][<severity>] <device> (service profile: <fld1>) has an <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0320][%{severity}] %{device} (service profile: %{fld1}) has an %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:28"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:28"
					"[rsa][message][id1]" => "SYSTEM_MSG:28"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:29
		# line in RSA: [F0424][<severity>] Possible loss of CMOS settings: <device> is lower-critical - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0424][%{severity}] Possible loss of CMOS settings: %{device} is lower-critical - %{info}" }
				id => "message-SYSTEM_MSG:29"
				add_field => {
				"event_description" => "CMOS battery voltage is lower-critical"
					"[event][id]" => "SYSTEM_MSG:29"
					"[rsa][message][id1]" => "SYSTEM_MSG:29"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:30
		# line in RSA: [F0373][<severity>] <device> operability: <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0373][%{severity}] %{device} operability: %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:30"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:30"
					"[rsa][message][id1]" => "SYSTEM_MSG:30"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:31
		# line in RSA: [F0480][<severity>] <device> operability: <event_description> - <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "[F0480][%{severity}] %{device} operability: %{event_description} - %{info}" }
				id => "message-SYSTEM_MSG:31"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:31"
					"[rsa][message][id1]" => "SYSTEM_MSG:31"
					"[event][categoryid]" => "1603010000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:32
		# line in RSA:  FELL OFF INPUT-rules: IN=<fld1> OUT=<fld2> MAC=<fld3> - <fld4>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "FELL OFF INPUT-rules: IN=%{fld1} OUT=%{fld2} MAC=%{fld3} - %{fld4}" }
				id => "message-SYSTEM_MSG:32"
				add_field => {
					"[event][id]" => "SYSTEM_MSG:32"
					"[rsa][message][id1]" => "SYSTEM_MSG:32"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:33
		# line in RSA:  <severity>: SSH2_MSG_KEXINIT <action> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: SSH2_MSG_KEXINIT %{action} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:33"
				add_field => {
				"agent" => "sshd"
				"event_description" => "SSH2_MSG_KEXINIT"
					"[event][id]" => "SYSTEM_MSG:33"
					"[rsa][message][id1]" => "SYSTEM_MSG:33"
					"[event][categoryid]" => "1302010200"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:35
		# line in RSA:  <severity>: Client protocol version <protocol_detail>; client software version <version> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: Client protocol version %{protocol_detail}; client software version %{version} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:35"
				add_field => {
				"agent" => "sshd"
					"[event][id]" => "SYSTEM_MSG:35"
					"[rsa][message][id1]" => "SYSTEM_MSG:35"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:36
		# line in RSA:  <severity>: no match: <version> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: no match: %{version} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:36"
				add_field => {
				"agent" => "sshd"
				"event_description" => "no match"
					"[event][id]" => "SYSTEM_MSG:36"
					"[rsa][message][id1]" => "SYSTEM_MSG:36"
					"[event][categoryid]" => "1303000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:37
		# line in RSA:  <severity>: Enabling compatibility mode for protocol <protocol_detail> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: Enabling compatibility mode for protocol %{protocol_detail} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:37"
				add_field => {
				"agent" => "sshd"
				"event_description" => "Enabling compatibility mode for protocol"
					"[event][id]" => "SYSTEM_MSG:37"
					"[rsa][message][id1]" => "SYSTEM_MSG:37"
					"[event][categoryid]" => "1701060000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:38
		# line in RSA:  <severity>: Local version string <version> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: Local version string %{version} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:38"
				add_field => {
				"agent" => "sshd"
					"[event][id]" => "SYSTEM_MSG:38"
					"[rsa][message][id1]" => "SYSTEM_MSG:38"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:39
		# line in RSA:  <severity>: fd <fld1> is <fld2> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: fd %{fld1} is %{fld2} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:39"
				add_field => {
				"agent" => "sshd"
					"[event][id]" => "SYSTEM_MSG:39"
					"[rsa][message][id1]" => "SYSTEM_MSG:39"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:40
		# line in RSA: UCSM_SESSION_LOCALES -  - httpd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "UCSM_SESSION_LOCALES -  - httpd[%{process_id}]" }
				id => "message-SYSTEM_MSG:40"
				add_field => {
				"agent" => "httpd"
				"event_description" => "UCSM_SESSION_LOCALES"
					"[event][id]" => "SYSTEM_MSG:40"
					"[rsa][message][id1]" => "SYSTEM_MSG:40"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM_MSG:34
		# line in RSA:  <severity>: <event_description>: <encryption_type> - sshd[<process_id>]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{severity}: %{event_description}: %{encryption_type} - sshd[%{process_id}]" }
				id => "message-SYSTEM_MSG:34"
				add_field => {
				"agent" => "sshd"
					"[event][id]" => "SYSTEM_MSG:34"
					"[rsa][message][id1]" => "SYSTEM_MSG:34"
					"[event][categoryid]" => "1302010200"
					"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId71
	# line in RSA: <fld22> FLOGI is received on server interface <interface> with <info> pwwn <pwwn> nwwn <nwwn>
	else if [logstash][msgparser][id] == "msgParserId71" {
		dissect {
			mapping => { "message" => "%{fld22} FLOGI is received on server interface %{interface} with %{info} pwwn %{pwwn} nwwn %{nwwn}" }
			id => "msgParserId71"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId72
	# line in RSA:  <fld22> LS_ACC is sent on server interface <interface> to <info>
	else if [logstash][msgparser][id] == "msgParserId72" {
		dissect {
			mapping => { "message" => "%{fld22} LS_ACC is sent on server interface %{interface} to %{info}" }
			id => "msgParserId72"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId73
	# line in RSA: mac address <macaddr> on vlan <vlan> is aged out
	else if [logstash][msgparser][id] == "msgParserId73" {
		dissect {
			mapping => { "message" => "mac address %{macaddr} on vlan %{vlan} is aged out" }
			id => "msgParserId73"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId74
	# line in RSA: Server Added - Chassis ID <fld22> Port ID <fld23> on local port <network_port> 
	else if [logstash][msgparser][id] == "msgParserId74" {
		dissect {
			mapping => { "message" => "Server Added - Chassis ID %{fld22} Port ID %{fld23} on local port %{network_port}" }
			id => "msgParserId74"
			add_field => {
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId75
	# line in RSA: Server Removed - Chassis ID <fld22> Port ID <fld23> on local port <network_port> 
	else if [logstash][msgparser][id] == "msgParserId75" {
		dissect {
			mapping => { "message" => "Server Removed - Chassis ID %{fld22} Port ID %{fld23} on local port %{network_port}" }
			id => "msgParserId75"
			add_field => {
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}
	# PARSER msgParserId76
	# line in RSA: [<operation_id>][<severity>][<info>][<device>] <event_description>
	else if [logstash][msgparser][id] == "msgParserId76" {
		dissect {
			mapping => { "message" => "[%{operation_id}][%{severity}][%{info}][%{device}] %{event_description}" }
			id => "msgParserId76"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hyear} %{hmonth} %{hday} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy MMM d H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_ciscoucsmsg.json"
#			template_name => "ciscoucs_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
