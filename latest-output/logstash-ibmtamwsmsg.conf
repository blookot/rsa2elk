# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "ibmtamws"
			"[observer][name]" => "IBM TAM WebSEAL"
			"[observer][type]" => "Access Control"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %IBMTAMWS: Date=<hfld1>^^Eventid=<messageid>^^<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%IBMTAMWS:[\s]+Date=(?<message>(?<hfld1>[^\^]*)\^\^Eventid=(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %IBMTAMWS-<hfld1>: <hfld2> - <hfld3> [<hfld4>] "<messageid> <!payload:hfld2>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%IBMTAMWS\-(?<hfld1>[^:]*):[\s]+(?<message>(?<hfld2>[^\s]*)[\s]+\-[\s]+(?<hfld3>[^\s]*)[\s]+\[(?<hfld4>[^\]]*)\][\s]+\"(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %IBMTAMWS-<hfld1>: <hfld2> - <hfld3> <hfld4> <hfld5> "<messageid> <!payload:hfld2>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%IBMTAMWS\-(?<hfld1>[^:]*):[\s]+(?<message>(?<hfld2>[^\s]*)[\s]+\-[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^\s]*)[\s]+(?<hfld5>[^\s]*)[\s]+\"(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0004
	# line in RSA: <hfld1> <hostname> <hfld3> <hfld4> - - <messageid>|<!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{hfld1} %{hostname} %{hfld3} %{hfld4} - - %{messageid}|%{message}" }
			id => "header-0004"
			add_field => {
				"[rsa][header][id]" => "0004"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-ibmtamwsmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "GET" {
		# MESSAGE GET
		# line in RSA: <saddr> - <username> [<fld3> <timezone>] "<web_method> <url> <fld6>" <resultcode> <rbytes>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} - %{username} [%{fld3} %{timezone}] \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
				id => "message-GET"
				add_field => {
					"[event][id]" => "GET"
					"[rsa][message][id1]" => "GET"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
			}
		}
		# MESSAGE GET:01
		# line in RSA: <saddr> - <username> <fld3> <timezone> "<web_method> <url> <fld6>" <resultcode> <rbytes>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} - %{username} %{fld3} %{timezone} \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
				id => "message-GET:01"
				add_field => {
					"[event][id]" => "GET:01"
					"[rsa][message][id1]" => "GET:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "POST" {
		# MESSAGE POST
		# line in RSA: <saddr> - <username> [<fld3> <timezone>] "<web_method> <url> <fld6>" <resultcode> <rbytes>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} - %{username} [%{fld3} %{timezone}] \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
				id => "message-POST"
				add_field => {
					"[event][id]" => "POST"
					"[rsa][message][id1]" => "POST"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
			}
		}
		# MESSAGE POST:01
		# line in RSA: <saddr> - <username> <fld3> <timezone> "<web_method> <url> <fld6>" <resultcode> <rbytes>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} - %{username} %{fld3} %{timezone} \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
				id => "message-POST:01"
				add_field => {
					"[event][id]" => "POST:01"
					"[rsa][message][id1]" => "POST:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "HEAD" {
		# MESSAGE HEAD
		# line in RSA: <saddr> - <username> [<fld3> <timezone>] "<web_method> <url> <fld6>" <resultcode> <rbytes>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} - %{username} [%{fld3} %{timezone}] \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
				id => "message-HEAD"
				add_field => {
					"[event][id]" => "HEAD"
					"[rsa][message][id1]" => "HEAD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
			}
		}
		# MESSAGE HEAD:01
		# line in RSA: <saddr> - <username> <fld3> <timezone> "<web_method> <url> <fld6>" <resultcode> <rbytes>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} - %{username} %{fld3} %{timezone} \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
				id => "message-HEAD:01"
				add_field => {
					"[event][id]" => "HEAD:01"
					"[rsa][message][id1]" => "HEAD:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId0
	# line in RSA: <saddr> - <username> [<fld3> <timezone>] "<web_method> <url> <fld6>" <resultcode> <rbytes>
	else if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "%{saddr} - %{username} [%{fld3} %{timezone}] \"%{web_method} %{url} %{fld6}\" %{resultcode} %{rbytes}" }
			id => "msgParserId0"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "101" {
		# MESSAGE 101:Success
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=0^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=0^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-101:Success"
				add_field => {
				"action" => "Login"
				"disposition" => "Success"
					"[event][id]" => "101:Success"
					"[rsa][message][id1]" => "101:Success"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 101:Failure
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=1^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=1^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-101:Failure"
				add_field => {
				"action" => "Login"
				"disposition" => "Failure"
					"[event][id]" => "101:Failure"
					"[rsa][message][id1]" => "101:Failure"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 101
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-101"
				add_field => {
				"action" => "Login"
					"[event][id]" => "101"
					"[rsa][message][id1]" => "101"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId5
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId5" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId5"
			add_field => {
				"action" => "Password change"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId6
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId6" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId6"
			add_field => {
				"action" => "Logout"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "104" {
		# MESSAGE 104:Success
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=0^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=0^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-104:Success"
				add_field => {
				"action" => "Authenticate"
				"disposition" => "Success"
					"[event][id]" => "104:Success"
					"[rsa][message][id1]" => "104:Success"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 104:Failure
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=1^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=1^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-104:Failure"
				add_field => {
				"action" => "Authenticate"
				"disposition" => "Failure"
					"[event][id]" => "104:Failure"
					"[rsa][message][id1]" => "104:Failure"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 104
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-104"
				add_field => {
				"action" => "Authenticate"
					"[event][id]" => "104"
					"[rsa][message][id1]" => "104"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId10
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId10" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId10"
			add_field => {
				"action" => "Step-up"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "106" {
		# MESSAGE 106:Success
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=0^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=0^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-106:Success"
				add_field => {
				"action" => "Re-authentication"
				"disposition" => "Success"
					"[event][id]" => "106:Success"
					"[rsa][message][id1]" => "106:Success"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 106:Failure
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=1^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=1^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-106:Failure"
				add_field => {
				"action" => "Re-authentication"
				"disposition" => "Failure"
					"[event][id]" => "106:Failure"
					"[rsa][message][id1]" => "106:Failure"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 106
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-106"
				add_field => {
				"action" => "Re-authentication"
					"[event][id]" => "106"
					"[rsa][message][id1]" => "106"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId14
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId14" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId14"
			add_field => {
				"action" => "Credentials refresh"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "108" {
		# MESSAGE 108:Success
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=0^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=0^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-108:Success"
				add_field => {
				"action" => "Authorization check"
				"disposition" => "Success"
					"[event][id]" => "108:Success"
					"[rsa][message][id1]" => "108:Success"
					"[event][categoryid]" => "1302000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 108:Failure
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=1^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=1^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-108:Failure"
				add_field => {
				"action" => "Authorization check"
				"disposition" => "Failure"
					"[event][id]" => "108:Failure"
					"[rsa][message][id1]" => "108:Failure"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 108
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-108"
				add_field => {
				"action" => "Authorization check"
					"[event][id]" => "108"
					"[rsa][message][id1]" => "108"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "109" {
		# MESSAGE 109
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-109"
				add_field => {
				"action" => "Resource Access"
					"[event][id]" => "109"
					"[rsa][message][id1]" => "109"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 109:01
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}" }
				id => "message-109:01"
				add_field => {
					"[event][id]" => "109:01"
					"[rsa][message][id1]" => "109:01"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId20
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId20" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId20"
			add_field => {
				"action" => "Get credentials"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId21
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId21" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId21"
			add_field => {
				"action" => "Modify credentials/combine credentials"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId22
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId22" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId22"
			add_field => {
				"action" => "Get credentials from pac"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId23
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId23" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId23"
			add_field => {
				"action" => "Get pac"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId24
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId24" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId24"
			add_field => {
				"action" => "Get entitlements"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId25
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId25" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId25"
			add_field => {
				"action" => "Runtime start"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId26
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId26" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId26"
			add_field => {
				"action" => "Runtime stop"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId27
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId27" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId27"
			add_field => {
				"action" => "Runtime audit start"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId28
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId28" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId28"
			add_field => {
				"action" => "Runtime audit stop"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId29
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId29" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId29"
			add_field => {
				"action" => "Runtime audit level change"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId30
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId30" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId30"
			add_field => {
				"action" => "Runtime statistic"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId31
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId31" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId31"
			add_field => {
				"action" => "Runtime heartbeat up"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId32
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId32" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId32"
			add_field => {
				"action" => "Runtime heartbeat down"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId33
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId33" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId33"
			add_field => {
				"action" => "Runtime lost contact"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId34
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId34" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId34"
			add_field => {
				"action" => "Runtime contact restored"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId35
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId35" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId35"
			add_field => {
				"action" => "Runtime monitor"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "126" {
		# MESSAGE 126:Success
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=0^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=0^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-126:Success"
				add_field => {
				"action" => "Switch User Login"
				"disposition" => "Success"
					"[event][id]" => "126:Success"
					"[rsa][message][id1]" => "126:Success"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 126:Failure
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=1^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=1^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-126:Failure"
				add_field => {
				"action" => "Switch User Login"
				"disposition" => "Failure"
					"[event][id]" => "126:Failure"
					"[rsa][message][id1]" => "126:Failure"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
		# MESSAGE 126
		# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
				id => "message-126"
				add_field => {
				"action" => "Switch User Login"
					"[event][id]" => "126"
					"[rsa][message][id1]" => "126"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId39
	# line in RSA: <fld1>.<fld2>^^Eventid=<fld3>^^Outcome=<fld7>^^Reason=<result>^^Blade=<event_source>^^Instance=<instance>^^Component=<category>^^Action=<event_type>^^Location=<hostname>^^Principal=<username>^^name_in_rgy=<src_dn>^^Session_id=<sessionid>^^User_Location=<saddr>^^Resource=<obj_type>^^Object=<obj_name>^^Auth_Type=<authmethod>^^Term_reason=<info>^^Audit_event=<event_state>
	else if [logstash][msgparser][id] == "msgParserId39" {
		dissect {
			mapping => { "message" => "%{fld1}.%{fld2}^^Eventid=%{fld3}^^Outcome=%{fld7}^^Reason=%{result}^^Blade=%{event_source}^^Instance=%{instance}^^Component=%{category}^^Action=%{event_type}^^Location=%{hostname}^^Principal=%{username}^^name_in_rgy=%{src_dn}^^Session_id=%{sessionid}^^User_Location=%{saddr}^^Resource=%{obj_type}^^Object=%{obj_name}^^Auth_Type=%{authmethod}^^Term_reason=%{info}^^Audit_event=%{event_state}" }
			id => "msgParserId39"
			add_field => {
				"action" => "Switch-user logout"
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d-HH:m:s" ] }
		}
	}
	# PARSER msgParserId40
	# line in RSA: client-ip=<saddr>|server-ip=<daddr>|client-logname=<fld1>|remote-user=<username>|time=<fld2>|port=<port>|protocol=<protocol>|request-method=<web_method>|response-status=<resultcode>|url=<url>|bytes=<rbytes>|remote-host=<hostip>|request=<fld4>
	else if [logstash][msgparser][id] == "msgParserId40" {
		dissect {
			mapping => { "message" => "client-ip=%{saddr}|server-ip=%{daddr}|client-logname=%{fld1}|remote-user=%{username}|time=%{fld2}|port=%{port}|protocol=%{protocol}|request-method=%{web_method}|response-status=%{resultcode}|url=%{url}|bytes=%{rbytes}|remote-host=%{hostip}|request=%{fld4}" }
			id => "msgParserId40"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:HH:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}

# Enrich events using VALUEMAP
filter {
	translate {
		field => "[fld7]"
		destination => "[disposition]"
		dictionary => {
			"0" => "Success"
			"1" => "Failure"
			"2" => "Pending"
			"3" => "Unknown"
		}
		fallback => ""
		override => true
	}
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-ibmtamwsmsg.json"
#			template_name => "ibmtamws_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
