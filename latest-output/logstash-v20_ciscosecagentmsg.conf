# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "ciscosecagent"
			"[observer][name]" => "Cisco Security Agent"
			"[observer][type]" => "IPS"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0007
	# line in RSA: %CSA: <hevent_id>^^<hdate> <htime>^^<messageid>^^<!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CSA: %{hevent_id}^^%{hdate} %{htime}^^%{messageid}^^%{message}" }
			id => "header-0007"
			add_field => {
				"[rsa][header][id]" => "0007"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0006
	# line in RSA: %CSA: <hdate> <htime>^^<messageid>^^<!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CSA: %{hdate} %{htime}^^%{messageid}^^%{message}" }
			id => "header-0006"
			add_field => {
				"[rsa][header][id]" => "0006"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0004
	# line in RSA: %CSA-<level>-<hfld99>: <hfld1>," <hdatetime> ", <hhostid>," <shost> "," <hhostip> "," <hproduct> ",<hlevel>," <msgIdPart1> <msgIdPart2> <msgIdPart3> <msgIdPart4> ",<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CSA\-(?<level>[^\-]*)\-(?<hfld99>[^:]*):[\s]+(?<message>(?<hfld1>[^,]*),\"[\s]+(?<hdatetime>[^\s]*)[\s]+\",[\s]+(?<hhostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hhostip>[^\s]*)[\s]+\",\"[\s]+(?<hproduct>[^\s]*)[\s]+\",(?<hlevel>[^,]*),\"[\s]+(?<msgIdPart1>[^\s]*)[\s]+(?<msgIdPart2>[^\s]*)[\s]+(?<msgIdPart3>[^\s]*)[\s]+(?<msgIdPart4>[^\s]*)[\s]+\",(?<payload>.*))$" }
			id => "header-0004"
			add_field => {
				"[rsa][header][id]" => "0004"
				"[rsa][message][id2]" => "%{msgIdPart1}_%{msgIdPart2}_%{msgIdPart3}_%{msgIdPart4}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %CSA-<level>-<hfld99>: <hfld1>," <hdatetime> ", <hhostid>," <shost> "," <hhostip> "," <hproduct> ",<hlevel>," <msgIdPart1> <msgIdPart2> <msgIdPart3> ",<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CSA\-(?<level>[^\-]*)\-(?<hfld99>[^:]*):[\s]+(?<message>(?<hfld1>[^,]*),\"[\s]+(?<hdatetime>[^\s]*)[\s]+\",[\s]+(?<hhostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hhostip>[^\s]*)[\s]+\",\"[\s]+(?<hproduct>[^\s]*)[\s]+\",(?<hlevel>[^,]*),\"[\s]+(?<msgIdPart1>[^\s]*)[\s]+(?<msgIdPart2>[^\s]*)[\s]+(?<msgIdPart3>[^\s]*)[\s]+\",(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{msgIdPart1}_%{msgIdPart2}_%{msgIdPart3}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %CSA-<level>-<hfld99>: <hfld1>," <hdatetime> ", <hhostid>," <shost> "," <hhostip> "," <hproduct> ",<hlevel>," <msgIdPart1> <msgIdPart2> ",<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CSA\-(?<level>[^\-]*)\-(?<hfld99>[^:]*):[\s]+(?<message>(?<hfld1>[^,]*),\"[\s]+(?<hdatetime>[^\s]*)[\s]+\",[\s]+(?<hhostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hhostip>[^\s]*)[\s]+\",\"[\s]+(?<hproduct>[^\s]*)[\s]+\",(?<hlevel>[^,]*),\"[\s]+(?<msgIdPart1>[^\s]*)[\s]+(?<msgIdPart2>[^\s]*)[\s]+\",(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{msgIdPart1}_%{msgIdPart2}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0001
	# line in RSA: %CSA-<level>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CSA-%{level}-%{messageid}: %{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0005
	# line in RSA: <month> <day> <year> <time> %CSA-<level>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{month} %{day} %{year} %{time} %CSA-%{level}-%{messageid}: %{message}" }
			id => "header-0005"
			add_field => {
				"[rsa][header][id]" => "0005"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_ciscosecagentmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	# PARSER msgParserId0
	# line in RSA:  <fld1>," <datetime> ", <fld3>," <shost> "," <hostip> "," <version> ",<level>," <event_source> "," <rulename> ",<fld32>," <fld11> "," <fld12> "," <fld13> "," <fld14> ",<fld15>,<fld16>,<fld17>," <fld18> ",<policy_id>," <fld20> ",{ " <fld21> " | <fld21> }," <fld22> "
	if [logstash][msgparser][id] == "msgParserId0" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld3>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<version>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<fld32>[^,]*),\"[\s]+(?<fld11>[^\s]*)[\s]+\",\"[\s]+(?<fld12>[^\s]*)[\s]+\",\"[\s]+(?<fld13>[^\s]*)[\s]+\",\"[\s]+(?<fld14>[^\s]*)[\s]+\",(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),\"[\s]+(?<fld18>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<fld20>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<fld21>[^\s]*)[\s]+\"[\s]+|[\s]*(?<fld21>[^\s]*)[\s]+),\"[\s]+(?<fld22>[^\s]*)[\s]+\"$" }
			id => "msgParserId0"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{datetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId1
	# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> "," <event_description> ",<fld32>," <resource> "," <filename> "," <fld13> "," <fld14> ",<fld15>,<fld16>,<fld17>," <fld18> ",<policy_id>," <fld20> ",{ " <fld21> " | <fld21> }," <username> "
	else if [logstash][msgparser][id] == "msgParserId1" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<fld13>[^\s]*)[\s]+\",\"[\s]+(?<fld14>[^\s]*)[\s]+\",(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),\"[\s]+(?<fld18>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<fld20>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<fld21>[^\s]*)[\s]+\"[\s]+|[\s]*(?<fld21>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
			id => "msgParserId1"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{datetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId2
	# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <version> ",<level>," <event_source> "," <result> ",<fld32>," <resource> "," <filename> "," <fld13> "," <fld14> ",<fld15>,<fld16>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <fld36> " | <fld36> }," <username> "
	else if [logstash][msgparser][id] == "msgParserId2" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<version>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"[\s]+(?<result>[^\s]*)[\s]+\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<fld13>[^\s]*)[\s]+\",\"[\s]+(?<fld14>[^\s]*)[\s]+\",(?<fld15>[^,]*),(?<fld16>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<fld36>[^\s]*)[\s]+\"[\s]+|[\s]*(?<fld36>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
			id => "msgParserId2"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{datetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	# PARSER msgParserId3
	# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> "," <event_description> ",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
	else if [logstash][msgparser][id] == "msgParserId3" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
			id => "msgParserId3"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{datetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "Network_shield" {
		# MESSAGE Network_shield:01
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> "," <fld35>. Reason: <event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"[\s]+(?<fld35>[^\.]*)\.[\s]+Reason:[\s]+(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_shield:01"
				add_field => {
					"[event][id]" => "Network_shield:01"
					"[rsa][message][id1]" => "Network_shield:01"
					"[event][categoryid]" => "1802000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Network_shield
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_shield"
				add_field => {
					"[event][id]" => "Network_shield"
					"[rsa][message][id1]" => "Network_shield"
					"[event][categoryid]" => "1802000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Registry_access_control" {
		# MESSAGE Registry_access_control:01
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to access the registry key  <fld82>. <action>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+the[\s]+registry[\s]+key[\s]+(?<fld82>[^\.]*)\.[\s]+(?<action>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Registry_access_control:01"
				add_field => {
					"[event][id]" => "Registry_access_control:01"
					"[rsa][message][id1]" => "Registry_access_control:01"
					"[event][categoryid]" => "1001010000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registry_access_control
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Registry_access_control"
				add_field => {
					"[event][id]" => "Registry_access_control"
					"[rsa][message][id1]" => "Registry_access_control"
					"[event][categoryid]" => "1001010000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId5
	# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
	else if [logstash][msgparser][id] == "msgParserId5" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
			id => "msgParserId5"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{datetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "COM_component_access_control" {
		# MESSAGE COM_component_access_control:01
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process  <fld81> attempted to access the COM component <fld82>. <action>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<fld81>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+the[\s]+COM[\s]+component[\s]+(?<fld82>[^\.]*)\.[\s]+(?<action>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-COM_component_access_control:01"
				add_field => {
					"[event][id]" => "COM_component_access_control:01"
					"[rsa][message][id1]" => "COM_component_access_control:01"
					"[event][categoryid]" => "1001030000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE COM_component_access_control
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-COM_component_access_control"
				add_field => {
					"[event][id]" => "COM_component_access_control"
					"[rsa][message][id1]" => "COM_component_access_control"
					"[event][categoryid]" => "1001030000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Clipboard_access_control" {
		# MESSAGE Clipboard_access_control:02
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <event_computer> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to read clipboard data written by process <fld82> The operation was denied.",<fld83>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <event_description> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<event_computer>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+read[\s]+clipboard[\s]+data[\s]+written[\s]+by[\s]+process[\s]+(?<fld82>[^\s]*)[\s]+The[\s]+operation[\s]+was[\s]+denied\.\",(?<fld83>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Clipboard_access_control:02"
				add_field => {
					"[event][id]" => "Clipboard_access_control:02"
					"[rsa][message][id1]" => "Clipboard_access_control:02"
					"[event][categoryid]" => "1501040000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Clipboard_access_control:01
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <event_computer> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to read clipboard data written by process <fld82> <action>",<fld83>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <event_description> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<event_computer>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+read[\s]+clipboard[\s]+data[\s]+written[\s]+by[\s]+process[\s]+(?<fld82>[^\s]*)[\s]+(?<action>[^\"]*)\",(?<fld83>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Clipboard_access_control:01"
				add_field => {
					"[event][id]" => "Clipboard_access_control:01"
					"[rsa][message][id1]" => "Clipboard_access_control:01"
					"[event][categoryid]" => "1501000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Clipboard_access_control
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <event_computer> "," <hostip> "," <fld31> ",<level>," <event_source> ","<info>",<fld83>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <event_description> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<event_computer>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<info>[^\"]*)\",(?<fld83>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Clipboard_access_control"
				add_field => {
					"[event][id]" => "Clipboard_access_control"
					"[rsa][message][id1]" => "Clipboard_access_control"
					"[event][categoryid]" => "1501000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Network_access_control" {
		# MESSAGE Network_access_control:04
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to accept a connection as a server on UDP port <fld84> from <fld85> using interface <sinterface>. The operation would have been denied.",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+accept[\s]+a[\s]+connection[\s]+as[\s]+a[\s]+server[\s]+on[\s]+UDP[\s]+port[\s]+(?<fld84>[^\s]*)[\s]+from[\s]+(?<fld85>[^\s]*)[\s]+using[\s]+interface[\s]+(?<sinterface>[^\.]*)\.[\s]+The[\s]+operation[\s]+would[\s]+have[\s]+been[\s]+denied\.\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_access_control:04"
				add_field => {
					"[event][id]" => "Network_access_control:04"
					"[rsa][message][id1]" => "Network_access_control:04"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Network_access_control:03
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to accept a connection as a server on UDP port <fld84> from <fld85> using interface <sinterface>. <action>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+accept[\s]+a[\s]+connection[\s]+as[\s]+a[\s]+server[\s]+on[\s]+UDP[\s]+port[\s]+(?<fld84>[^\s]*)[\s]+from[\s]+(?<fld85>[^\s]*)[\s]+using[\s]+interface[\s]+(?<sinterface>[^\.]*)\.[\s]+(?<action>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_access_control:03"
				add_field => {
					"[event][id]" => "Network_access_control:03"
					"[rsa][message][id1]" => "Network_access_control:03"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Network_access_control:02
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to initiate a connection as a client on UDP port <fld84> to <fld85> using interface <sinterface>. The operation would have been denied.",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+initiate[\s]+a[\s]+connection[\s]+as[\s]+a[\s]+client[\s]+on[\s]+UDP[\s]+port[\s]+(?<fld84>[^\s]*)[\s]+to[\s]+(?<fld85>[^\s]*)[\s]+using[\s]+interface[\s]+(?<sinterface>[^\.]*)\.[\s]+The[\s]+operation[\s]+would[\s]+have[\s]+been[\s]+denied\.\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_access_control:02"
				add_field => {
					"[event][id]" => "Network_access_control:02"
					"[rsa][message][id1]" => "Network_access_control:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Network_access_control:01
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to initiate a connection as a client on UDP port <fld84> to <fld85> using interface <sinterface>. <action>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+initiate[\s]+a[\s]+connection[\s]+as[\s]+a[\s]+client[\s]+on[\s]+UDP[\s]+port[\s]+(?<fld84>[^\s]*)[\s]+to[\s]+(?<fld85>[^\s]*)[\s]+using[\s]+interface[\s]+(?<sinterface>[^\.]*)\.[\s]+(?<action>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_access_control:01"
				add_field => {
					"[event][id]" => "Network_access_control:01"
					"[rsa][message][id1]" => "Network_access_control:01"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Network_access_control
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Network_access_control"
				add_field => {
					"[event][id]" => "Network_access_control"
					"[rsa][message][id1]" => "Network_access_control"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Application_control" {
		# MESSAGE Application_control:02
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The current application <fld81> attempted to execute the new application <fld82>. <info>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+current[\s]+application[\s]+(?<fld81>[^\s]*)[\s]+attempted[\s]+to[\s]+execute[\s]+the[\s]+new[\s]+application[\s]+(?<fld82>[^\.]*)\.[\s]+(?<info>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Application_control:02"
				add_field => {
					"[event][id]" => "Application_control:02"
					"[rsa][message][id1]" => "Application_control:02"
					"[event][categoryid]" => "1001030000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Application_control:01
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to access a resource which would have resulted in the user being asked the following question: <action>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+a[\s]+resource[\s]+which[\s]+would[\s]+have[\s]+resulted[\s]+in[\s]+the[\s]+user[\s]+being[\s]+asked[\s]+the[\s]+following[\s]+question:[\s]+(?<action>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Application_control:01"
				add_field => {
					"[event][id]" => "Application_control:01"
					"[rsa][message][id1]" => "Application_control:01"
					"[event][categoryid]" => "1001030000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Application_control
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Application_control"
				add_field => {
					"[event][id]" => "Application_control"
					"[rsa][message][id1]" => "Application_control"
					"[event][categoryid]" => "1001030000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Scan_event_log" {
		# MESSAGE Scan_event_log:04
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <event_computer> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to access <fld82>. This caused a data scan, resulting in the content tag <data_type>being applied to this file. <action>",<fld83>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,{ 64 | 65 | 400 | 405 | 417 | 420 }," <event_description> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<event_computer>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+(?<fld82>[^\.]*)\.[\s]+This[\s]+caused[\s]+a[\s]+data[\s]+scan,[\s]+resulting[\s]+in[\s]+the[\s]+content[\s]+tag[\s]+(?<data_type>[^b]*)being[\s]+applied[\s]+to[\s]+this[\s]+file\.[\s]+(?<action>[^\"]*)\",(?<fld83>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),([\s]*64[\s]+|[\s]*65[\s]+|[\s]*400[\s]+|[\s]*405[\s]+|[\s]*417[\s]+|[\s]*420[\s]+),\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Scan_event_log:04"
				add_field => {
					"[event][id]" => "Scan_event_log:04"
					"[rsa][message][id1]" => "Scan_event_log:04"
					"[event][categoryid]" => "1501000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Scan_event_log:02
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <event_computer> "," <hostip> "," <fld31> ",<severity>," <event_source> ","The process <process> attempted to access a resource which resulted in the user being shown the following notification: '<fld82>' <action>",<fld83>," <fld34> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,301," <info> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<event_computer>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<severity>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+a[\s]+resource[\s]+which[\s]+resulted[\s]+in[\s]+the[\s]+user[\s]+being[\s]+shown[\s]+the[\s]+following[\s]+notification:[\s]+'(?<fld82>[^']*)'[\s]+(?<action>[^\"]*)\",(?<fld83>[^,]*),\"[\s]+(?<fld34>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),301,\"[\s]+(?<info>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Scan_event_log:02"
				add_field => {
					"[event][id]" => "Scan_event_log:02"
					"[rsa][message][id1]" => "Scan_event_log:02"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Scan_event_log
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-Scan_event_log"
				add_field => {
					"[event][id]" => "Scan_event_log"
					"[rsa][message][id1]" => "Scan_event_log"
					"[event][categoryid]" => "1614000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "File_access_control" {
		# MESSAGE File_access_control:04
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <fld37> "," <hostip> "," <fld31> ",<severity>," <event_source> ","The process <process> attempted to access <obj_name>. <space> The attempted access was a <accesses>. The file content matches <<Virus:<name>>. <action>",<fld83>," <fld34> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <info> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<fld37>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<severity>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+(?<obj_name>[^\.]*)\.[\s]+(?<space>[^\s]*)[\s]+The[\s]+attempted[\s]+access[\s]+was[\s]+a[\s]+(?<accesses>[^\.]*)\.[\s]+The[\s]+file[\s]+content[\s]+matches[\s]+<Virus:(?<name>[^>]*)>\.[\s]+(?<action>[^\"]*)\",(?<fld83>[^,]*),\"[\s]+(?<fld34>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<info>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-File_access_control:04"
				add_field => {
				"obj_type" => "file"
					"[event][id]" => "File_access_control:04"
					"[rsa][message][id1]" => "File_access_control:04"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE File_access_control:03
		# line in RSA:  <fld1>," <datetime> ", <fld2>," <event_computer> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to access <obj_name>. <space> { The attempted access was a <accesses>. The file content matches <data_type>. | The file content matches <data_type>. The attempted access was a <accesses>. } <action>",<fld83>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <event_description> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<fld2>[^,]*),\"[\s]+(?<event_computer>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+(?<obj_name>[^\.]*)\.[\s]+(?<space>[^\s]*)[\s]+([\s]*The[\s]+attempted[\s]+access[\s]+was[\s]+a[\s]+(?<accesses>[^\.]*)\.[\s]+The[\s]+file[\s]+content[\s]+matches[\s]+(?<data_type>[^\.]*)\.[\s]+|[\s]*The[\s]+file[\s]+content[\s]+matches[\s]+(?<data_type>[^\.]*)\.[\s]+The[\s]+attempted[\s]+access[\s]+was[\s]+a[\s]+(?<accesses>[^\.]*)\.[\s]+)[\s]+(?<action>[^\"]*)\",(?<fld83>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<event_description>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-File_access_control:03"
				add_field => {
				"obj_type" => "file"
					"[event][id]" => "File_access_control:03"
					"[rsa][message][id1]" => "File_access_control:03"
					"[event][categoryid]" => "1501000000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE File_access_control:02
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","The process <process> attempted to access <obj_name>. <space> The attempted access was a <accesses>. <info>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"The[\s]+process[\s]+(?<process>[^\s]*)[\s]+attempted[\s]+to[\s]+access[\s]+(?<obj_name>[^\.]*)\.[\s]+(?<space>[^\s]*)[\s]+The[\s]+attempted[\s]+access[\s]+was[\s]+a[\s]+(?<accesses>[^\.]*)\.[\s]+(?<info>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-File_access_control:02"
				add_field => {
				"obj_type" => "file"
				"event_description" => "The process tried to access the specified resource. This action was taken as per the Policy indicated"
					"[event][id]" => "File_access_control:02"
					"[rsa][message][id1]" => "File_access_control:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE File_access_control
		# line in RSA:  <fld1>," <datetime> ", <hostid>," <shost> "," <hostip> "," <fld31> ",<level>," <event_source> ","<event_description>",<fld32>," <resource> "," <filename> "," <saddr> "," <daddr> ",<sport>,<dport>,<rule>," <rulename> ",<policy_id>," <policyname> ",{ " <disposition> " | <disposition> }," <username> "
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^,]*),\"[\s]+(?<datetime>[^\s]*)[\s]+\",[\s]+(?<hostid>[^,]*),\"[\s]+(?<shost>[^\s]*)[\s]+\",\"[\s]+(?<hostip>[^\s]*)[\s]+\",\"[\s]+(?<fld31>[^\s]*)[\s]+\",(?<level>[^,]*),\"[\s]+(?<event_source>[^\s]*)[\s]+\",\"(?<event_description>[^\"]*)\",(?<fld32>[^,]*),\"[\s]+(?<resource>[^\s]*)[\s]+\",\"[\s]+(?<filename>[^\s]*)[\s]+\",\"[\s]+(?<saddr>[^\s]*)[\s]+\",\"[\s]+(?<daddr>[^\s]*)[\s]+\",(?<sport>[^,]*),(?<dport>[^,]*),(?<rule>[^,]*),\"[\s]+(?<rulename>[^\s]*)[\s]+\",(?<policy_id>[^,]*),\"[\s]+(?<policyname>[^\s]*)[\s]+\",([\s]*\"[\s]+(?<disposition>[^\s]*)[\s]+\"[\s]+|[\s]*(?<disposition>[^\s]*)[\s]+),\"[\s]+(?<username>[^\s]*)[\s]+\"$" }
				id => "message-File_access_control"
				add_field => {
					"[event][id]" => "File_access_control"
					"[rsa][message][id1]" => "File_access_control"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{datetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Networkshield" {
		# MESSAGE Networkshield
		# line in RSA:  <event_source>^^Network Shield: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network Shield: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkshield"
				add_field => {
					"[event][id]" => "Networkshield"
					"[rsa][message][id1]" => "Networkshield"
					"[event][categoryid]" => "1802000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkshield:01
		# line in RSA:  <event_source>^^Audit: Network Shield: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Network Shield: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkshield:01"
				add_field => {
					"[event][id]" => "Networkshield:01"
					"[rsa][message][id1]" => "Networkshield:01"
					"[event][categoryid]" => "1802000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkshield:02
		# line in RSA:  <event_source>^^Agent software: policy not fully enforced^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: policy not fully enforced^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkshield:02"
				add_field => {
					"[event][id]" => "Networkshield:02"
					"[rsa][message][id1]" => "Networkshield:02"
					"[event][categoryid]" => "1802000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Networkaccesscontrol" {
		# MESSAGE Networkaccesscontrol
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol"
				add_field => {
					"[event][id]" => "Networkaccesscontrol"
					"[rsa][message][id1]" => "Networkaccesscontrol"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:01
		# line in RSA:  <event_source>^^Network access control: Allow action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network access control: Allow action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:01"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:01"
					"[rsa][message][id1]" => "Networkaccesscontrol:01"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:02
		# line in RSA:  <event_source>^^Network access control: Terminate action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network access control: Terminate action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:02"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:02"
					"[rsa][message][id1]" => "Networkaccesscontrol:02"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:03
		# line in RSA:  <event_source>^^Network access control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network access control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:03"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:03"
					"[rsa][message][id1]" => "Networkaccesscontrol:03"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:04
		# line in RSA:  <event_source>^^Audit: Network access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Network access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:04"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:04"
					"[rsa][message][id1]" => "Networkaccesscontrol:04"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:05
		# line in RSA:  <event_source>^^Network access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:05"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:05"
					"[rsa][message][id1]" => "Networkaccesscontrol:05"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:06
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:06"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:06"
					"[rsa][message][id1]" => "Networkaccesscontrol:06"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Networkaccesscontrol:07
		# line in RSA:  <event_source>^^Audit: Network access control: Terminate action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Network access control: Terminate action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Networkaccesscontrol:07"
				add_field => {
					"[event][id]" => "Networkaccesscontrol:07"
					"[rsa][message][id1]" => "Networkaccesscontrol:07"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Agentservicecontrol" {
		# MESSAGE Agentservicecontrol
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Agentservicecontrol"
				add_field => {
					"[event][id]" => "Agentservicecontrol"
					"[rsa][message][id1]" => "Agentservicecontrol"
					"[event][categoryid]" => "1704030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Agentservicecontrol:01
		# line in RSA:  <event_source>^^Audit: Agent service control: Modification: Denied action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Agent service control: Modification: Denied action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Agentservicecontrol:01"
				add_field => {
					"[event][id]" => "Agentservicecontrol:01"
					"[rsa][message][id1]" => "Agentservicecontrol:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Agentservicecontrol:02
		# line in RSA:  <event_source>^^Agent service control: Modification: Denied action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent service control: Modification: Denied action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Agentservicecontrol:02"
				add_field => {
					"[event][id]" => "Agentservicecontrol:02"
					"[rsa][message][id1]" => "Agentservicecontrol:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Agentservicecontrol:03
		# line in RSA:  <event_source>^^Agent service control: Stop Security: Denied action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent service control: Stop Security: Denied action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Agentservicecontrol:03"
				add_field => {
					"[event][id]" => "Agentservicecontrol:03"
					"[rsa][message][id1]" => "Agentservicecontrol:03"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Agentservicecontrol:04
		# line in RSA:  <event_source>^^Audit: Agent service control: Stop Security: Denied action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Agent service control: Stop Security: Denied action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Agentservicecontrol:04"
				add_field => {
					"[event][id]" => "Agentservicecontrol:04"
					"[rsa][message][id1]" => "Agentservicecontrol:04"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Administrative" {
		# MESSAGE Administrative
		# line in RSA:  <event_source>^^Administrator login successful^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Administrator login successful^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
					"[event][id]" => "Administrative"
					"[rsa][message][id1]" => "Administrative"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:01
		# line in RSA:  <event_source>^^Administrator login invalid^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Administrator login invalid^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
					"[event][id]" => "Administrative:01"
					"[rsa][message][id1]" => "Administrative:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:02
		# line in RSA:  <event_source>^^Agent software: Minidump taken^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: Minidump taken^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:02"
				add_field => {
					"[event][id]" => "Administrative:02"
					"[rsa][message][id1]" => "Administrative:02"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:03
		# line in RSA:  <event_source>^^Administrator logout^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Administrator logout^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:03"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"ec_theme" => "ALM"
					"[event][id]" => "Administrative:03"
					"[rsa][message][id1]" => "Administrative:03"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:04
		# line in RSA:  <event_source>^^Analysis (Deployment): Data Management^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Analysis (Deployment): Data Management^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:04"
				add_field => {
					"[event][id]" => "Administrative:04"
					"[rsa][message][id1]" => "Administrative:04"
					"[event][categoryid]" => "1401000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:05
		# line in RSA:  <event_source>^^Administrator session timed out^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Administrator session timed out^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:05"
				add_field => {
					"[event][id]" => "Administrative:05"
					"[rsa][message][id1]" => "Administrative:05"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:06
		# line in RSA:  <event_source>^^Agent software: logging: temporarily decreased^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: logging: temporarily decreased^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:06"
				add_field => {
					"[event][id]" => "Administrative:06"
					"[rsa][message][id1]" => "Administrative:06"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:07
		# line in RSA:  <event_source>^^Management Center: Hosts not actively polling found^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Management Center: Hosts not actively polling found^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:07"
				add_field => {
					"[event][id]" => "Administrative:07"
					"[rsa][message][id1]" => "Administrative:07"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:08
		# line in RSA:  <event_source>^^Agent software: logging: temporarily disabled^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: logging: temporarily disabled^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:08"
				add_field => {
					"[event][id]" => "Administrative:08"
					"[rsa][message][id1]" => "Administrative:08"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:09
		# line in RSA:  <event_source>^^Disk space warning^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Disk space warning^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:09"
				add_field => {
					"[event][id]" => "Administrative:09"
					"[rsa][message][id1]" => "Administrative:09"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:10
		# line in RSA:  <event_source>^^Agent software: warning: Failed to hook^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: warning: Failed to hook^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:10"
				add_field => {
					"[event][id]" => "Administrative:10"
					"[rsa][message][id1]" => "Administrative:10"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:11
		# line in RSA:  <event_source>^^Infected file is restored^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Infected file is restored^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:11"
				add_field => {
					"[event][id]" => "Administrative:11"
					"[rsa][message][id1]" => "Administrative:11"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:12
		# line in RSA:  <event_source>^^Agent software: error: rule resubmit limit exceeded^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: error: rule resubmit limit exceeded^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:12"
				add_field => {
					"[event][id]" => "Administrative:12"
					"[rsa][message][id1]" => "Administrative:12"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:13
		# line in RSA:  <event_source>^^Agent software: error: Process exception^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: error: Process exception^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:13"
				add_field => {
					"[event][id]" => "Administrative:13"
					"[rsa][message][id1]" => "Administrative:13"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:14
		# line in RSA:  <event_source>^^Management Center: Event storage: Purge complete^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Management Center: Event storage: Purge complete^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:14"
				add_field => {
					"[event][id]" => "Administrative:14"
					"[rsa][message][id1]" => "Administrative:14"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:15
		# line in RSA:  <event_source>^^Management Center: Host managing task complete^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Management Center: Host managing task complete^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:15"
				add_field => {
					"[event][id]" => "Administrative:15"
					"[rsa][message][id1]" => "Administrative:15"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:16
		# line in RSA:  <event_source>^^Kernel protection: Module changed^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Kernel protection: Module changed^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:16"
				add_field => {
					"[event][id]" => "Administrative:16"
					"[rsa][message][id1]" => "Administrative:16"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:17
		# line in RSA:  <event_source>^^Management Center: Registration with old rule template^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Management Center: Registration with old rule template^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:17"
				add_field => {
					"[event][id]" => "Administrative:17"
					"[rsa][message][id1]" => "Administrative:17"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:18
		# line in RSA:  <event_source>^^Agent software: error: failed to compile rule program^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: error: failed to compile rule program^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:18"
				add_field => {
					"[event][id]" => "Administrative:18"
					"[rsa][message][id1]" => "Administrative:18"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:19
		# line in RSA:  <event_source>^^(null)^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^(null)^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:19"
				add_field => {
					"[event][id]" => "Administrative:19"
					"[rsa][message][id1]" => "Administrative:19"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:20
		# line in RSA:  <event_source>^^Global event correlation: Suspected Virus detected^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Global event correlation: Suspected Virus detected^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:20"
				add_field => {
					"[event][id]" => "Administrative:20"
					"[rsa][message][id1]" => "Administrative:20"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:21
		# line in RSA:  <event_source>^^Agent software: policy not fully enforced^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Agent software: policy not fully enforced^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:21"
				add_field => {
					"[event][id]" => "Administrative:21"
					"[rsa][message][id1]" => "Administrative:21"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:22
		# line in RSA:  <event_source>^^Kernel protection: modification: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Kernel protection: modification: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:22"
				add_field => {
					"[event][id]" => "Administrative:22"
					"[rsa][message][id1]" => "Administrative:22"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:23
		# line in RSA:  <event_source>^^Kernel protection: modification: SET or Process action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Kernel protection: modification: SET or Process action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:23"
				add_field => {
					"[event][id]" => "Administrative:23"
					"[rsa][message][id1]" => "Administrative:23"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:24
		# line in RSA:  <event_source>^^Registry access control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Registry access control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:24"
				add_field => {
					"[event][id]" => "Administrative:24"
					"[rsa][message][id1]" => "Administrative:24"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:25
		# line in RSA:  <event_source>^^File access control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^File access control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:25"
				add_field => {
					"[event][id]" => "Administrative:25"
					"[rsa][message][id1]" => "Administrative:25"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:26
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:26"
				add_field => {
					"[event][id]" => "Administrative:26"
					"[rsa][message][id1]" => "Administrative:26"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:27
		# line in RSA:  <event_source>^^Audit: Network access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Network access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:27"
				add_field => {
					"[event][id]" => "Administrative:27"
					"[rsa][message][id1]" => "Administrative:27"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:28
		# line in RSA:  <event_source>^^Application control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Application control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:28"
				add_field => {
					"[event][id]" => "Administrative:28"
					"[rsa][message][id1]" => "Administrative:28"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:29
		# line in RSA:  <event_source>^^Network access control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network access control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:29"
				add_field => {
					"[event][id]" => "Administrative:29"
					"[rsa][message][id1]" => "Administrative:29"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:30
		# line in RSA:  <event_source>^^Audit: System API: Code injection: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Code injection: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:30"
				add_field => {
					"[event][id]" => "Administrative:30"
					"[rsa][message][id1]" => "Administrative:30"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:31
		# line in RSA:  <event_source>^^System API: Code injection: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Code injection: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:31"
				add_field => {
					"[event][id]" => "Administrative:31"
					"[rsa][message][id1]" => "Administrative:31"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:32
		# line in RSA:  <event_source>^^Audit: Network Shield: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Network Shield: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:32"
				add_field => {
					"[event][id]" => "Administrative:32"
					"[rsa][message][id1]" => "Administrative:32"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Administrative:33
		# line in RSA:  <event_source>^^System API: Access physical memory: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Access physical memory: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Administrative:33"
				add_field => {
					"[event][id]" => "Administrative:33"
					"[rsa][message][id1]" => "Administrative:33"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId66
	# line in RSA:  <event_source>^^Sniffer and protocol detection: Unknown Protocol Component^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
	else if [logstash][msgparser][id] == "msgParserId66" {
		dissect {
			mapping => { "message" => "%{event_source}^^Sniffer and protocol detection: Unknown Protocol Component^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
			id => "msgParserId66"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "SystemAPIcontrol" {
		# MESSAGE SystemAPIcontrol
		# line in RSA:  <event_source>^^System API: Code injection: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Code injection: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol"
				add_field => {
					"[event][id]" => "SystemAPIcontrol"
					"[rsa][message][id1]" => "SystemAPIcontrol"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:01
		# line in RSA:  <event_source>^^System API: Keystroke capture: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Keystroke capture: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:01"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:01"
					"[rsa][message][id1]" => "SystemAPIcontrol:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:02
		# line in RSA:  <event_source>^^System API: Modify memory: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Modify memory: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:02"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:02"
					"[rsa][message][id1]" => "SystemAPIcontrol:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:03
		# line in RSA:  <event_source>^^Audit: System API: Modify memory: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Modify memory: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:03"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:03"
					"[rsa][message][id1]" => "SystemAPIcontrol:03"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:04
		# line in RSA:  <event_source>^^Audit: System API: Keystroke capture: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Keystroke capture: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:04"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:04"
					"[rsa][message][id1]" => "SystemAPIcontrol:04"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:05
		# line in RSA:  <event_source>^^Audit: System API: Code injection: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Code injection: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:05"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:05"
					"[rsa][message][id1]" => "SystemAPIcontrol:05"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:06
		# line in RSA:  <event_source>^^Audit: System API: Exception handling: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Exception handling: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:06"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:06"
					"[rsa][message][id1]" => "SystemAPIcontrol:06"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:07
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:07"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:07"
					"[rsa][message][id1]" => "SystemAPIcontrol:07"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:08
		# line in RSA:  <event_source>^^System API: Access physical memory: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Access physical memory: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:08"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:08"
					"[rsa][message][id1]" => "SystemAPIcontrol:08"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:09
		# line in RSA:  <event_source>^^System API: Media input: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Media input: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:09"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:09"
					"[rsa][message][id1]" => "SystemAPIcontrol:09"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:10
		# line in RSA:  <event_source>^^System API: Code injection: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Code injection: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:10"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:10"
					"[rsa][message][id1]" => "SystemAPIcontrol:10"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:11
		# line in RSA:  <event_source>^^System API: Media input: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Media input: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:11"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:11"
					"[rsa][message][id1]" => "SystemAPIcontrol:11"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:12
		# line in RSA:  <event_source>^^Audit: System API: Media input: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Media input: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:12"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:12"
					"[rsa][message][id1]" => "SystemAPIcontrol:12"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:13
		# line in RSA:  <event_source>^^Audit: System API: Modifiable code: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: System API: Modifiable code: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:13"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:13"
					"[rsa][message][id1]" => "SystemAPIcontrol:13"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:14
		# line in RSA:  <event_source>^^System API: Keystroke capture: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Keystroke capture: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:14"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:14"
					"[rsa][message][id1]" => "SystemAPIcontrol:14"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:15
		# line in RSA:  <event_source>^^System API: Modify memory: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Modify memory: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:15"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:15"
					"[rsa][message][id1]" => "SystemAPIcontrol:15"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:16
		# line in RSA:  <event_source>^^System API: Exception handling: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^System API: Exception handling: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:16"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:16"
					"[rsa][message][id1]" => "SystemAPIcontrol:16"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE SystemAPIcontrol:17
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-SystemAPIcontrol:17"
				add_field => {
					"[event][id]" => "SystemAPIcontrol:17"
					"[rsa][message][id1]" => "SystemAPIcontrol:17"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Registryaccesscontrol" {
		# MESSAGE Registryaccesscontrol
		# line in RSA:  <event_source>^^Registry access control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Registry access control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol"
				add_field => {
					"[event][id]" => "Registryaccesscontrol"
					"[rsa][message][id1]" => "Registryaccesscontrol"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:01
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:01"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:01"
					"[rsa][message][id1]" => "Registryaccesscontrol:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:02
		# line in RSA:  <event_source>^^Audit: Registry access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Registry access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:02"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:02"
					"[rsa][message][id1]" => "Registryaccesscontrol:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:03
		# line in RSA:  <event_source>^^Registry access control: Terminate action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Registry access control: Terminate action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:03"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:03"
					"[rsa][message][id1]" => "Registryaccesscontrol:03"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:04
		# line in RSA:  <event_source>^^Registry access control: SET or Process action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Registry access control: SET or Process action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:04"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:04"
					"[rsa][message][id1]" => "Registryaccesscontrol:04"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:05
		# line in RSA:  <event_source>^^Audit: Registry access control: Terminate action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Registry access control: Terminate action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:05"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:05"
					"[rsa][message][id1]" => "Registryaccesscontrol:05"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:06
		# line in RSA:  <event_source>^^Registry access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Registry access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:06"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:06"
					"[rsa][message][id1]" => "Registryaccesscontrol:06"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Registryaccesscontrol:07
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Registryaccesscontrol:07"
				add_field => {
					"[event][id]" => "Registryaccesscontrol:07"
					"[rsa][message][id1]" => "Registryaccesscontrol:07"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Fileaccesscontrol" {
		# MESSAGE Fileaccesscontrol
		# line in RSA:  <event_source>^^File access control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^File access control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Fileaccesscontrol"
				add_field => {
					"[event][id]" => "Fileaccesscontrol"
					"[rsa][message][id1]" => "Fileaccesscontrol"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Fileaccesscontrol:01
		# line in RSA:  <event_source>^^Audit: File access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: File access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Fileaccesscontrol:01"
				add_field => {
					"[event][id]" => "Fileaccesscontrol:01"
					"[rsa][message][id1]" => "Fileaccesscontrol:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Fileaccesscontrol:02
		# line in RSA:  <event_source>^^File access control: SET or Process action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^File access control: SET or Process action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Fileaccesscontrol:02"
				add_field => {
					"[event][id]" => "Fileaccesscontrol:02"
					"[rsa][message][id1]" => "Fileaccesscontrol:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Fileaccesscontrol:03
		# line in RSA:  <event_source>^^File access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^File access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Fileaccesscontrol:03"
				add_field => {
					"[event][id]" => "Fileaccesscontrol:03"
					"[rsa][message][id1]" => "Fileaccesscontrol:03"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Fileaccesscontrol:04
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Fileaccesscontrol:04"
				add_field => {
					"[event][id]" => "Fileaccesscontrol:04"
					"[rsa][message][id1]" => "Fileaccesscontrol:04"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Fileaccesscontrol:05
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Fileaccesscontrol:05"
				add_field => {
					"[event][id]" => "Fileaccesscontrol:05"
					"[rsa][message][id1]" => "Fileaccesscontrol:05"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Applicationcontrol" {
		# MESSAGE Applicationcontrol
		# line in RSA:  <event_source>^^Application control: SET or Process action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Application control: SET or Process action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol"
				add_field => {
					"[event][id]" => "Applicationcontrol"
					"[rsa][message][id1]" => "Applicationcontrol"
					"[event][categoryid]" => "1001030000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Applicationcontrol:01
		# line in RSA:  <event_source>^^Application control: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Application control: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol:01"
				add_field => {
					"[event][id]" => "Applicationcontrol:01"
					"[rsa][message][id1]" => "Applicationcontrol:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Applicationcontrol:02
		# line in RSA:  <event_source>^^Audit: Application Control: Denied action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Application Control: Denied action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol:02"
				add_field => {
					"[event][id]" => "Applicationcontrol:02"
					"[rsa][message][id1]" => "Applicationcontrol:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Applicationcontrol:03
		# line in RSA:  <event_source>^^Application Control: Denied action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Application Control: Denied action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol:03"
				add_field => {
					"[event][id]" => "Applicationcontrol:03"
					"[rsa][message][id1]" => "Applicationcontrol:03"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Applicationcontrol:04
		# line in RSA:  <event_source>^^Application control: Terminate action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Application control: Terminate action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol:04"
				add_field => {
					"[event][id]" => "Applicationcontrol:04"
					"[rsa][message][id1]" => "Applicationcontrol:04"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Applicationcontrol:05
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol:05"
				add_field => {
					"[event][id]" => "Applicationcontrol:05"
					"[rsa][message][id1]" => "Applicationcontrol:05"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Applicationcontrol:06
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Applicationcontrol:06"
				add_field => {
					"[event][id]" => "Applicationcontrol:06"
					"[rsa][message][id1]" => "Applicationcontrol:06"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "COMcomponentaccesscontrol" {
		# MESSAGE COMcomponentaccesscontrol
		# line in RSA:  <event_source>^^Audit: COM component access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: COM component access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-COMcomponentaccesscontrol"
				add_field => {
					"[event][id]" => "COMcomponentaccesscontrol"
					"[rsa][message][id1]" => "COMcomponentaccesscontrol"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE COMcomponentaccesscontrol:01
		# line in RSA:  <event_source>^^COM component access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^COM component access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-COMcomponentaccesscontrol:01"
				add_field => {
					"[event][id]" => "COMcomponentaccesscontrol:01"
					"[rsa][message][id1]" => "COMcomponentaccesscontrol:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE COMcomponentaccesscontrol:02
		# line in RSA:  <event_source>^^Audit: Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-COMcomponentaccesscontrol:02"
				add_field => {
					"[event][id]" => "COMcomponentaccesscontrol:02"
					"[rsa][message][id1]" => "COMcomponentaccesscontrol:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE COMcomponentaccesscontrol:03
		# line in RSA:  <event_source>^^Access Control: Query action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Access Control: Query action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-COMcomponentaccesscontrol:03"
				add_field => {
					"[event][id]" => "COMcomponentaccesscontrol:03"
					"[rsa][message][id1]" => "COMcomponentaccesscontrol:03"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Kernelprotection" {
		# MESSAGE Kernelprotection
		# line in RSA:  <event_source>^^Kernel protection: modification: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Kernel protection: modification: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Kernelprotection"
				add_field => {
					"[event][id]" => "Kernelprotection"
					"[rsa][message][id1]" => "Kernelprotection"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Kernelprotection:01
		# line in RSA:  <event_source>^^Kernel protection: modification: SET or Process action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Kernel protection: modification: SET or Process action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Kernelprotection:01"
				add_field => {
					"[event][id]" => "Kernelprotection:01"
					"[rsa][message][id1]" => "Kernelprotection:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Kernelprotection:02
		# line in RSA:  <event_source>^^Kernel protection: boot: SET or Process action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Kernel protection: boot: SET or Process action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Kernelprotection:02"
				add_field => {
					"[event][id]" => "Kernelprotection:02"
					"[rsa][message][id1]" => "Kernelprotection:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Connectionratelimit" {
		# MESSAGE Connectionratelimit
		# line in RSA:  <event_source>^^Network Connection Limit: Monitor^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Network Connection Limit: Monitor^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Connectionratelimit"
				add_field => {
					"[event][id]" => "Connectionratelimit"
					"[rsa][message][id1]" => "Connectionratelimit"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Connectionratelimit:01
		# line in RSA:  <event_source>^^Audit: Network Connection Limit: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Audit: Network Connection Limit: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Connectionratelimit:01"
				add_field => {
					"[event][id]" => "Connectionratelimit:01"
					"[rsa][message][id1]" => "Connectionratelimit:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId97
	# line in RSA:  <event_source>^^Global event correlation: Portscan detected^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
	else if [logstash][msgparser][id] == "msgParserId97" {
		dissect {
			mapping => { "message" => "%{event_source}^^Global event correlation: Portscan detected^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
			id => "msgParserId97"
			add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Scan"
				"ec_theme" => "TEV"
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "NTEventlog" {
		# MESSAGE NTEventlog
		# line in RSA:  <event_source>^^NT Event log: security message^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^NT Event log: security message^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-NTEventlog"
				add_field => {
					"[event][id]" => "NTEventlog"
					"[rsa][message][id1]" => "NTEventlog"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE NTEventlog:01
		# line in RSA:  <event_source>^^NT Event log: application message^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^NT Event log: application message^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-NTEventlog:01"
				add_field => {
					"[event][id]" => "NTEventlog:01"
					"[rsa][message][id1]" => "NTEventlog:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE NTEventlog:02
		# line in RSA:  <event_source>^^(null)^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^(null)^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-NTEventlog:02"
				add_field => {
					"[event][id]" => "NTEventlog:02"
					"[rsa][message][id1]" => "NTEventlog:02"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId100
	# line in RSA:  <event_source>^^Audit: Data access control: Deny action^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
	else if [logstash][msgparser][id] == "msgParserId100" {
		dissect {
			mapping => { "message" => "%{event_source}^^Audit: Data access control: Deny action^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
			id => "msgParserId100"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "Globaleventlog" {
		# MESSAGE Globaleventlog
		# line in RSA:  <event_source>^^NT Event log: multiple similar application messages^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^NT Event log: multiple similar application messages^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Globaleventlog"
				add_field => {
					"[event][id]" => "Globaleventlog"
					"[rsa][message][id1]" => "Globaleventlog"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Globaleventlog:01
		# line in RSA:  <event_source>^^NT Event log: multiple similar security messages^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^NT Event log: multiple similar security messages^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Globaleventlog:01"
				add_field => {
					"[event][id]" => "Globaleventlog:01"
					"[rsa][message][id1]" => "Globaleventlog:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Globalvirusscan" {
		# MESSAGE Globalvirusscan
		# line in RSA:  <event_source>^^Global event correlation: Suspected Virus file detected by AV^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^Global event correlation: Suspected Virus file detected by AV^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Globalvirusscan"
				add_field => {
					"[event][id]" => "Globalvirusscan"
					"[rsa][message][id1]" => "Globalvirusscan"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE Globalvirusscan:01
		# line in RSA:  <event_source>^^@DYNAMIC: file added^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_source}^^@DYNAMIC: file added^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
				id => "message-Globalvirusscan:01"
				add_field => {
					"[event][id]" => "Globalvirusscan:01"
					"[rsa][message][id1]" => "Globalvirusscan:01"
					"[event][categoryid]" => "1401010000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId104
	# line in RSA:  <event_source>^^@DYNAMIC: file added^^<hostid>^^<hostname>^^<fld31>^^<hostip>^^<level>^^<severity>^^<filename>^^<fld34>^^<saddr>^^<daddr>^^<rule>^^<rulename>^^<policy_id>^^<policyname>^^<fld1>^^<event_description>^^<sport>^^<dport>^^<disposition>^^<username>^^<fld2>
	else if [logstash][msgparser][id] == "msgParserId104" {
		dissect {
			mapping => { "message" => "%{event_source}^^@DYNAMIC: file added^^%{hostid}^^%{hostname}^^%{fld31}^^%{hostip}^^%{level}^^%{severity}^^%{filename}^^%{fld34}^^%{saddr}^^%{daddr}^^%{rule}^^%{rulename}^^%{policy_id}^^%{policyname}^^%{fld1}^^%{event_description}^^%{sport}^^%{dport}^^%{disposition}^^%{username}^^%{fld2}" }
			id => "msgParserId104"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_ciscosecagentmsg.json"
#			template_name => "ciscosecagent_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
