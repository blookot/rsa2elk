# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "paloaltonetworks"
			"[observer][name]" => "Palo Alto Networks Firewall"
			"[observer][type]" => "Firewall"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: <hmonth> <hdate> <htime> PA-<hfld1> <hdomain>,<hfld2>,<hfld3>,<messageid>,<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hmonth>[^\s]*)[\s]+(?<hdate>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+PA\-(?<message>(?<hfld1>[^\s]*)[\s]+(?<hdomain>[^,]*),(?<hfld2>[^,]*),(?<hfld3>[^,]*),(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: <hmonth> <hdate> <htime> <hdomain>,<hfld1>,<hfld2>,<messageid>,<!payload:hdomain>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hmonth>[^\s]*)[\s]+(?<hdate>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+(?<message>(?<hdomain>[^,]*),(?<hfld1>[^,]*),(?<hfld2>[^,]*),(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: <hmonth> <hdate> <htime> <hdomain>,<hfld1>,<hserial_number>,<hfld2>,<hfld3>,<messageid>,<!payload:hdomain>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hmonth>[^\s]*)[\s]+(?<hdate>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+(?<message>(?<hdomain>[^,]*),(?<hfld1>[^,]*),(?<hserial_number>[^,]*),(?<hfld2>[^,]*),(?<hfld3>[^,]*),(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-paloaltonetworksmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "CONFIG" {
		# MESSAGE CONFIG:Generic
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,<action>,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),(?<action>[^,]*),(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-CONFIG:Generic"
				add_field => {
				"devicehostname" => "%{domain}"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:Generic"
					"[rsa][message][id1]" => "CONFIG:Generic"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:add_01
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,add,<administrator>,<network_service>,<result>, vsys  <vsys> profiles <rule_group>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),add,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+profiles[\s]+(?<rule_group>.*)$" }
				id => "message-CONFIG:add_01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "add"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:add_01"
					"[rsa][message][id1]" => "CONFIG:add_01"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:add_02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,add,<administrator>,<network_service>,<result>, vsys  <vsys> <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),add,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+(?<info>.*)$" }
				id => "message-CONFIG:add_02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "add"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:add_02"
					"[rsa][message][id1]" => "CONFIG:add_02"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:add_03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,add,<administrator>,<network_service>,<result>, config shared <rule_group> syslog
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),add,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+(?<rule_group>[^\s]*)[\s]+syslog$" }
				id => "message-CONFIG:add_03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Failure"
				"action" => "add"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:add_03"
					"[rsa][message][id1]" => "CONFIG:add_03"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:add_04
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,add,<administrator>,<network_service>,<result>, <event_description>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),add,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>.*)$" }
				id => "message-CONFIG:add_04"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "add"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:add_04"
					"[rsa][message][id1]" => "CONFIG:add_04"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, vsys  <vsys> rulebase security rules  {<rulename>,<fld5>,<fld6>| <rulename> <rule_group> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+rulebase[\s]+security[\s]+rules[\s]+((?<rulename>[^,]*),(?<fld5>[^,]*),(?<fld6>.*)|[\s]*(?<rulename>[^\s]*)[\s]+(?<rule_group>[^\s]*)[\s]+)$" }
				id => "message-CONFIG:edit_01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:edit_01"
					"[rsa][message][id1]" => "CONFIG:edit_01"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, vsys  <vsys> profiles <rule_group>  <info> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+profiles[\s]+(?<rule_group>[^\s]*)[\s]+(?<info>[^\s]*)[\s]+$" }
				id => "message-CONFIG:edit_02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:edit_02"
					"[rsa][message][id1]" => "CONFIG:edit_02"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, config shared <rule_group> config
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+(?<rule_group>[^\s]*)[\s]+config$" }
				id => "message-CONFIG:edit_03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:edit_03"
					"[rsa][message][id1]" => "CONFIG:edit_03"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_04
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, config shared <rule_group> system
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+(?<rule_group>[^\s]*)[\s]+system$" }
				id => "message-CONFIG:edit_04"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:edit_04"
					"[rsa][message][id1]" => "CONFIG:edit_04"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_05
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, network interface <interface> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+network[\s]+interface[\s]+(?<interface>[^\s]*)[\s]+$" }
				id => "message-CONFIG:edit_05"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:edit_05"
					"[rsa][message][id1]" => "CONFIG:edit_05"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_06
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, deviceconfig system 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+deviceconfig[\s]+system[\s]+$" }
				id => "message-CONFIG:edit_06"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
				"event_description" => "Device Config"
					"[event][id]" => "CONFIG:edit_06"
					"[rsa][message][id1]" => "CONFIG:edit_06"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_07
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, config shared <rule_group>  <rulename>,<info> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+(?<rule_group>[^\s]*)[\s]+(?<rulename>[^,]*),(?<info>[^\s]*)[\s]+$" }
				id => "message-CONFIG:edit_07"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
				"event_description" => "Device Config"
					"[event][id]" => "CONFIG:edit_07"
					"[rsa][message][id1]" => "CONFIG:edit_07"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_08
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, vsys  <vsys> zone  <zone> <info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+zone[\s]+(?<zone>[^\s]*)[\s]+(?<info>.*)$" }
				id => "message-CONFIG:edit_08"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
				"event_description" => "Device Config"
					"[event][id]" => "CONFIG:edit_08"
					"[rsa][message][id1]" => "CONFIG:edit_08"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:edit_09
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,edit,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),edit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:edit_09"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "edit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:edit_09"
					"[rsa][message][id1]" => "CONFIG:edit_09"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, vsys  <vsys> rulebase security rules  <rulename> <rule_group> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+rulebase[\s]+security[\s]+rules[\s]+(?<rulename>[^\s]*)[\s]+(?<rule_group>[^\s]*)[\s]+$" }
				id => "message-CONFIG:delete_01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_01"
					"[rsa][message][id1]" => "CONFIG:delete_01"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, vsys  <vsys> profiles <rule_group>  <info> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+profiles[\s]+(?<rule_group>[^\s]*)[\s]+(?<info>[^\s]*)[\s]+$" }
				id => "message-CONFIG:delete_02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_02"
					"[rsa][message][id1]" => "CONFIG:delete_02"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, vsys  <vsys> <info> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+(?<info>[^\s]*)[\s]+$" }
				id => "message-CONFIG:delete_03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_03"
					"[rsa][message][id1]" => "CONFIG:delete_03"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_04
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, config shared <rule_group> syslog <info> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+(?<rule_group>[^\s]*)[\s]+syslog[\s]+(?<info>[^\s]*)[\s]+$" }
				id => "message-CONFIG:delete_04"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_04"
					"[rsa][message][id1]" => "CONFIG:delete_04"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_05
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, config shared local-user-database user <username>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+local\-user\-database[\s]+user[\s]+(?<username>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:delete_05"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_05"
					"[rsa][message][id1]" => "CONFIG:delete_05"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_06
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, config shared <rule_group>  <rulename>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+(?<rule_group>[^\s]*)[\s]+(?<rulename>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:delete_06"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_06"
					"[rsa][message][id1]" => "CONFIG:delete_06"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:delete_07
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,delete,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),delete,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:delete_07"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Failure"
				"action" => "delete"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:delete_07"
					"[rsa][message][id1]" => "CONFIG:delete_07"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:commit:02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,commit,<administrator>,<network_service>,<result>,<event_description>,<fld6>,<fld7>,<fld8>,<fld9>,<fld10>,<fld11>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),commit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),(?<event_description>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-CONFIG:commit:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "commit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:commit:02"
					"[rsa][message][id1]" => "CONFIG:commit:02"
					"[event][categoryid]" => "1701060000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:commit
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,commit,<administrator>,<network_service>,<result>,<event_description>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),commit,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),(?<event_description>.*)$" }
				id => "message-CONFIG:commit"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "commit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:commit"
					"[rsa][message][id1]" => "CONFIG:commit"
					"[event][categoryid]" => "1701060000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:commit:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,commit-all,<administrator>,<network_service>,<result>,<event_description>,<fld6>,<fld7>,<fld8>,<fld9>,<fld10>,<fld11>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),commit\-all,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),(?<event_description>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-CONFIG:commit:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "commit"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:commit:01"
					"[rsa][message][id1]" => "CONFIG:commit:01"
					"[event][categoryid]" => "1701060000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:create
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,create,<administrator>,<network_service>,<result>, vsys  <vsys> rulebase <rule_group> rules entry 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),create,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+rulebase[\s]+(?<rule_group>[^\s]*)[\s]+rules[\s]+entry[\s]+$" }
				id => "message-CONFIG:create"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "create"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:create"
					"[rsa][message][id1]" => "CONFIG:create"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:move
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,move,<administrator>,<network_service>,<result>, vsys  <vsys> <fld5> <rule_group> {rules <rulename>,<fld6>,<fld7>,<fld8>,<fld9>,<fld10>,<fld11>,,<hostname>|rules <rulename>} 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),move,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+(?<fld5>[^\s]*)[\s]+(?<rule_group>[^\s]*)[\s]+(rules[\s]+(?<rulename>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),,(?<hostname>[^\s]*)|rules[\s]+(?<rulename>[^\s]*))[\s]+$" }
				id => "message-CONFIG:move"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "move"
				"shost" => "%{saddr}"
				"sensor" => "%{hostname}"
					"[event][id]" => "CONFIG:move"
					"[rsa][message][id1]" => "CONFIG:move"
					"[event][categoryid]" => "1701080000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:set_01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,set,<administrator>,<network_service>,<result>, vsys  <vsys> zone  <zone> <info>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),set,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+zone[\s]+(?<zone>[^\s]*)[\s]+(?<info>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:set_01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "set"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:set_01"
					"[rsa][message][id1]" => "CONFIG:set_01"
					"[event][categoryid]" => "1701020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:set_02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,set,<administrator>,<network_service>,<result>, config shared local-user-database user  <username>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),set,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+local\-user\-database[\s]+user[\s]+(?<username>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:set_02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"ec_activity" => "Create"
				"action" => "set"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:set_02"
					"[rsa][message][id1]" => "CONFIG:set_02"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:set_03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,set,<administrator>,<network_service>,<result>, vsys  <vsys> rulebase security rules  <rulename>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),set,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+vsys[\s]+(?<vsys>[^\s]*)[\s]+rulebase[\s]+security[\s]+rules[\s]+(?<rulename>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:set_03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "set"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:set_03"
					"[rsa][message][id1]" => "CONFIG:set_03"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:set
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,set,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),set,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:set"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "set"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:set"
					"[rsa][message][id1]" => "CONFIG:set"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:rename_01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,rename,<administrator>,<network_service>,<result>, config shared local-user-database user  <username>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),rename,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+config[\s]+shared[\s]+local\-user\-database[\s]+user[\s]+(?<username>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:rename_01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_outcome" => "Success"
				"shost" => "%{saddr}"
				"action" => "rename"
					"[event][id]" => "CONFIG:rename_01"
					"[rsa][message][id1]" => "CONFIG:rename_01"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:rename
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,rename,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),rename,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:rename"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "rename"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:rename"
					"[rsa][message][id1]" => "CONFIG:rename"
					"[event][categoryid]" => "1701030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:clone
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,clone,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),clone,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:clone"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "clone"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:clone"
					"[rsa][message][id1]" => "CONFIG:clone"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE CONFIG:multi-clone
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,CONFIG,<category>,<version>,<fld2> <fld3>,<saddr>,<vsys>,multi-clone,<administrator>,<network_service>,<result>, <event_description>,<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),CONFIG,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<vsys>[^,]*),multi\-clone,(?<administrator>[^,]*),(?<network_service>[^,]*),(?<result>[^,]*),[\s]+(?<event_description>[^,]*),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-CONFIG:multi-clone"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "clone"
				"shost" => "%{saddr}"
					"[event][id]" => "CONFIG:multi-clone"
					"[rsa][message][id1]" => "CONFIG:multi-clone"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "SYSTEM" {
		# MESSAGE SYSTEM:general_login:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"User|User} <username> logged in via <network_service> from <saddr> using {https"|https},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"User|User)[\s]+(?<username>[^\s]*)[\s]+logged[\s]+in[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+(?<saddr>[^\s]*)[\s]+using[\s]+(https\"|https),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_login:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"shost" => "%{saddr}"
				"event_description" => "User logged in"
				"action" => "general-login"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_login:01"
					"[rsa][message][id1]" => "SYSTEM:general_login:01"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_login:02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,User <username> logged in via <network_service> from {<saddr> using http over an SSL connection|<saddr>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),User[\s]+(?<username>[^\s]*)[\s]+logged[\s]+in[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+((?<saddr>[^\s]*)[\s]+using[\s]+http[\s]+over[\s]+an[\s]+SSL[\s]+connection|(?<saddr>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_login:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"shost" => "%{saddr}"
				"event_description" => "User logged in"
				"action" => "general-login"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_login:02"
					"[rsa][message][id1]" => "SYSTEM:general_login:02"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_login:03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,User <username> logged in via <network_service> from <saddr>  
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),User[\s]+(?<username>[^\s]*)[\s]+logged[\s]+in[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+(?<saddr>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_login:03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"shost" => "%{saddr}"
				"event_description" => "User logged in"
				"action" => "general-login"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_login:03"
					"[rsa][message][id1]" => "SYSTEM:general_login:03"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_logout:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>{,"User|,User} <username> logged out via <network_service> from <saddr>{",|,}<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>  
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,,]*)(,\"User|,User)[\s]+(?<username>[^\s]*)[\s]+logged[\s]+out[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+(?<saddr>[^\",]*)(\",|,)(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_logout:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"ec_theme" => "Authentication"
				"shost" => "%{saddr}"
				"event_description" => "User logged out"
				"action" => "general-logout"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_logout:01"
					"[rsa][message][id1]" => "SYSTEM:general_logout:01"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_logout:02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,User <username> logged out via <network_service> from <saddr>  
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),User[\s]+(?<username>[^\s]*)[\s]+logged[\s]+out[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+(?<saddr>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_logout:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"ec_theme" => "Authentication"
				"shost" => "%{saddr}"
				"event_description" => "User logged out"
				"action" => "general-logout"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_logout:02"
					"[rsa][message][id1]" => "SYSTEM:general_logout:02"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_timeout
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,Session for user <username> via <network_service> from <saddr> timed out,<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),Session[\s]+for[\s]+user[\s]+(?<username>[^\s]*)[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+(?<saddr>[^\s]*)[\s]+timed[\s]+out,(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_timeout"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "User"
				"ec_theme" => "Authentication"
				"shost" => "%{saddr}"
				"event_description" => "Session timed out"
				"action" => "general-timeout"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_timeout"
					"[rsa][message][id1]" => "SYSTEM:general_timeout"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_loginfailed
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,Authentication failed for user <username> via <network_service> from <saddr>,<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),Authentication[\s]+failed[\s]+for[\s]+user[\s]+(?<username>[^\s]*)[\s]+via[\s]+(?<network_service>[^\s]*)[\s]+from[\s]+(?<saddr>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>[^\s]*)[\s]+$" }
				id => "message-SYSTEM:general_loginfailed"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"shost" => "%{saddr}"
				"event_description" => "Authentication failed"
				"action" => "general-login"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_loginfailed"
					"[rsa][message][id1]" => "SYSTEM:general_loginfailed"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:09
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<fld10>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"{failed authentication for user '<username>'.|User '<username>' failed authentication.} <space> (Additional Info : Commit in progress) {auth profile '<rulename>', vsys '<vsys>', server profile '<fld11>', server address '<daddr>', From: <saddr>.",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>|vsys '<vsys>', From: <saddr>.",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>|From: <saddr>.",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>|From: <saddr>.",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld17>,<vsys>,<sensor>|",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld17>,<vsys>,<sensor>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<fld10>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),\"(failed[\s]+authentication[\s]+for[\s]+user[\s]+'(?<username>[^']*)'\.|User[\s]+'(?<username>[^']*)'[\s]+failed[\s]+authentication\.)[\s]+(?<space>[^\s]*)[\s]+\(Additional[\s]+Info[\s]+:[\s]+Commit[\s]+in[\s]+progress\)[\s]+(auth[\s]+profile[\s]+'(?<rulename>[^']*)',[\s]+vsys[\s]+'(?<vsys>[^']*)',[\s]+server[\s]+profile[\s]+'(?<fld11>[^']*)',[\s]+server[\s]+address[\s]+'(?<daddr>[^']*)',[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld18>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)|vsys[\s]+'(?<vsys>[^']*)',[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld18>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)|From:[\s]+(?<saddr>[^\.]*)\.\",(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld18>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)|From:[\s]+(?<saddr>[^\.]*)\.\",(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)|\",(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),(?<vsys>[^,]*),(?<sensor>.*))$" }
				id => "message-SYSTEM:general:09"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_outcome" => "Failure"
				"action" => "general"
				"rule_group" => "auth profile"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:09"
					"[rsa][message][id1]" => "SYSTEM:general:09"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:07
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<fld10>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"failed authentication for user '<username>'.{Reason: <result> auth profile '<rulename>', vsys '<vsys>', server profile '<fld11>', server address '<daddr>', From: <saddr>.",| <space> auth profile '<rulename>', vsys '<vsys>', server profile '<fld11>', server address '<daddr>', From: <saddr>.",|Reason: <result> From: <saddr>.",}<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<fld10>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),\"failed[\s]+authentication[\s]+for[\s]+user[\s]+'(?<username>[^']*)'\.(Reason:[\s]+(?<result>[^\s]*)[\s]+auth[\s]+profile[\s]+'(?<rulename>[^']*)',[\s]+vsys[\s]+'(?<vsys>[^']*)',[\s]+server[\s]+profile[\s]+'(?<fld11>[^']*)',[\s]+server[\s]+address[\s]+'(?<daddr>[^']*)',[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",|[\s]*(?<space>[^\s]*)[\s]+auth[\s]+profile[\s]+'(?<rulename>[^']*)',[\s]+vsys[\s]+'(?<vsys>[^']*)',[\s]+server[\s]+profile[\s]+'(?<fld11>[^']*)',[\s]+server[\s]+address[\s]+'(?<daddr>[^']*)',[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",|Reason:[\s]+(?<result>[^\s]*)[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",)(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld18>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:07"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_outcome" => "Failure"
				"action" => "general"
				"rule_group" => "auth profile"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:07"
					"[rsa][message][id1]" => "SYSTEM:general:07"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:08
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<fld10>,<severity>,"failed authentication for user '<username>'. <space> vsys '<vsys>', From: <saddr>.", <fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<severity>[^,]*),\"failed[\s]+authentication[\s]+for[\s]+user[\s]+'(?<username>[^']*)'\.[\s]+(?<space>[^\s]*)[\s]+vsys[\s]+'(?<vsys>[^']*)',[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",[\s]+(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld18>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:08"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_outcome" => "Failure"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:08"
					"[rsa][message][id1]" => "SYSTEM:general:08"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:10
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"{User '<username>' failed authentication.  Reason: <result> From: <saddr>.", <fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld17>,<vsys>,<sensor>|User '<username>' failed authentication. <space>  Reason: <result>",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld17>,<vsys>,<sensor>|User <username> failed authentication", <fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld17>,<vsys>,<sensor>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),\"(User[\s]+'(?<username>[^']*)'[\s]+failed[\s]+authentication\.[\s]+Reason:[\s]+(?<result>[^\s]*)[\s]+From:[\s]+(?<saddr>[^\.]*)\.\",[\s]+(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)|User[\s]+'(?<username>[^']*)'[\s]+failed[\s]+authentication\.[\s]+(?<space>[^\s]*)[\s]+Reason:[\s]+(?<result>[^\"]*)\",(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)|User[\s]+(?<username>[^\s]*)[\s]+failed[\s]+authentication\",[\s]+(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<fld17>[^,]*),(?<vsys>[^,]*),(?<sensor>.*))$" }
				id => "message-SYSTEM:general:10"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_outcome" => "Failure"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:10"
					"[rsa][message][id1]" => "SYSTEM:general:10"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_Commit
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld11>,<severity>,"<event_description> Dequeue time=<fld12> JobId=<fld13> User: <username> ",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld11>[^,]*),(?<severity>[^,]*),\"(?<event_description>[^\s]*)[\s]+Dequeue[\s]+time=(?<fld12>[^\s]*)[\s]+JobId=(?<fld13>[^\s]*)[\s]+User:[\s]+(?<username>[^\s]*)[\s]+\",(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general_Commit"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_outcome" => "Success"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_Commit"
					"[rsa][message][id1]" => "SYSTEM:general_Commit"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:12
		# line in RSA: <domain> 1,<fld1>,<serial_number>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,{" Failed|Failed} password for <username> from <saddr> port <sport> {<network_service>"|<network_service>},<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<fld15>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<domain>[^\s]*)[\s]+1,(?<fld1>[^,]*),(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),(\"[\s]+Failed|Failed)[\s]+password[\s]+for[\s]+(?<username>[^\s]*)[\s]+from[\s]+(?<saddr>[^\s]*)[\s]+port[\s]+(?<sport>[^\s]*)[\s]+((?<network_service>[^\"]*)\"|(?<network_service>[^,]*)),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:12"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:12"
					"[rsa][message][id1]" => "SYSTEM:general:12"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general_Access
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld11>,<severity>,"User <username> accessed Monitor tab",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld11>[^,]*),(?<severity>[^,]*),\"User[\s]+(?<username>[^\s]*)[\s]+accessed[\s]+Monitor[\s]+tab\",(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general_Access"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_outcome" => "Success"
				"action" => "general"
				"event_description" => "User accessed Monitor tab"
				"category" => "general"
					"[event][id]" => "SYSTEM:general_Access"
					"[rsa][message][id1]" => "SYSTEM:general_Access"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"<info>",<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<fld15>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),\"(?<info>[^\"]*)\",(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Agent"
				"ec_activity" => "Request"
				"ec_outcome" => "Success"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:01"
					"[rsa][message][id1]" => "SYSTEM:general:01"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:02
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld11>,<severity>,User <username> failed authentication.  Reason:<result> From: <saddr>.,<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld11>[^,]*),(?<severity>[^,]*),User[\s]+(?<username>[^\s]*)[\s]+failed[\s]+authentication\.[\s]+Reason:(?<result>[^\s]*)[\s]+From:[\s]+(?<saddr>[^\.]*)\.,(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"shost" => "%{saddr}"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:02"
					"[rsa][message][id1]" => "SYSTEM:general:02"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>, FAILED LOGIN <dclass_counter1> FROM .<fld10>. FOR <result>,<fld11>,<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),[\s]+FAILED[\s]+LOGIN[\s]+(?<dclass_counter1>[^\s]*)[\s]+FROM[\s]+\.(?<fld10>[^\.]*)\.[\s]+FOR[\s]+(?<result>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:03"
					"[rsa][message][id1]" => "SYSTEM:general:03"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:04
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,User '<username>' authenticated.   From: <saddr>.,<fld15>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<severity>[^,]*),User[\s]+'(?<username>[^']*)'[\s]+authenticated\.[\s]+From:[\s]+(?<saddr>[^\.]*)\.,(?<fld15>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:04"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:04"
					"[rsa][message][id1]" => "SYSTEM:general:04"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:11
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld11>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld21>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld11>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld21>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:general:11"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Agent"
				"ec_activity" => "Request"
				"ec_outcome" => "Success"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:11"
					"[rsa][message][id1]" => "SYSTEM:general:11"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:05
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<fld2>,SYSTEM,general,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld11>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<fld2>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld11>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-SYSTEM:general:05"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Agent"
				"ec_activity" => "Request"
				"ec_outcome" => "Success"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:05"
					"[rsa][message][id1]" => "SYSTEM:general:05"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:general:06
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,general,<version>,<fld2> <fld3>,<vsys>,<fld4>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>"|<event_description>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,general,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>.*))$" }
				id => "message-SYSTEM:general:06"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "general"
				"category" => "general"
					"[event][id]" => "SYSTEM:general:06"
					"[rsa][message][id1]" => "SYSTEM:general:06"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:peer-version-match
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ha,<version>,<fld2> <fld3>,<vsys>,peer-version-match,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,<rule_group>: {"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ha,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),peer\-version\-match,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(?<rule_group>[^:]*):[\s]+(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:peer-version-match"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "ha"
				"info" => "peer version match"
				"category" => "ha"
					"[event][id]" => "SYSTEM:peer-version-match"
					"[rsa][message][id1]" => "SYSTEM:peer-version-match"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:state-change
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ha,<version>,<fld2> <fld3>,<vsys>,state-change,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,<rule_group>: {"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ha,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),state\-change,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(?<rule_group>[^:]*):[\s]+(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:state-change"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "ha"
				"info" => "state change"
				"category" => "ha"
					"[event][id]" => "SYSTEM:state-change"
					"[rsa][message][id1]" => "SYSTEM:state-change"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_success
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-success,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-success,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_success"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_outcome" => "Success"
				"action" => "routing"
				"info" => "start"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_success"
					"[rsa][message][id1]" => "SYSTEM:routing_success"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_backup
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-backup,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-backup,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_backup"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "routing"
				"info" => "backup"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_backup"
					"[rsa][message][id1]" => "SYSTEM:routing_backup"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_master
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-master,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-master,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_master"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "routing"
				"info" => "master"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_master"
					"[rsa][message][id1]" => "SYSTEM:routing_master"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_abort
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-abort,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-abort,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_abort"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Stop"
				"action" => "routing"
				"info" => "abort"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_abort"
					"[rsa][message][id1]" => "SYSTEM:routing_abort"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_start
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-start,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-start,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_start"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Start"
				"action" => "routing"
				"info" => "start"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_start"
					"[rsa][message][id1]" => "SYSTEM:routing_start"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_failed
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-failed,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-failed,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_failed"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_outcome" => "Failure"
				"action" => "routing"
				"info" => "failed"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_failed"
					"[rsa][message][id1]" => "SYSTEM:routing_failed"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_init
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-init,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-init,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_init"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "routing"
				"info" => "abort"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_init"
					"[rsa][message][id1]" => "SYSTEM:routing_init"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_full
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-full,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld8>,<fld9>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-full,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_full"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "routing"
				"info" => "abort"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_full"
					"[rsa][message][id1]" => "SYSTEM:routing_full"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_restart
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-restart,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld8>,<fld9>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-restart,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_restart"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "routing"
				"info" => "abort"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_restart"
					"[rsa][message][id1]" => "SYSTEM:routing_restart"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:routing_packet_drop
		# line in RSA: <domain>{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,routing,<version>,<fld2> <fld3>,<vsys>,<service>-bad,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"<event_description>. interface <interface>, from IP <saddr>.", <fld8>,<fld9>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<domain>[^1,]*)(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,routing,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-bad,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),\"(?<event_description>[^\.]*)\.[\s]+interface[\s]+(?<interface>[^,]*),[\s]+from[\s]+IP[\s]+(?<saddr>[^\.]*)\.\",[\s]+(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:routing_packet_drop"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "routing"
				"category" => "routing"
					"[event][id]" => "SYSTEM:routing_packet_drop"
					"[rsa][message][id1]" => "SYSTEM:routing_packet_drop"
					"[event][categoryid]" => "1805000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:vpn_success
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,vpn,<version>,<fld2> <fld3>,<vsys>,<service>-success,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,vpn,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-success,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:vpn_success"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_outcome" => "Success"
				"info" => "success"
				"action" => "vpn"
				"category" => "vpn"
					"[event][id]" => "SYSTEM:vpn_success"
					"[rsa][message][id1]" => "SYSTEM:vpn_success"
					"[event][categoryid]" => "1801020100"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:vpn_abort
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,vpn,<version>,<fld2> <fld3>,<vsys>,<service>-abort,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,vpn,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-abort,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:vpn_abort"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Stop"
				"info" => "abort"
				"action" => "vpn"
				"category" => "vpn"
					"[event][id]" => "SYSTEM:vpn_abort"
					"[rsa][message][id1]" => "SYSTEM:vpn_abort"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:vpn_done
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,vpn,<version>,<fld2> <fld3>,<vsys>,<service>-done,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,vpn,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-done,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:vpn_done"
				add_field => {
				"devicehostname" => "%{domain}"
				"info" => "done"
				"action" => "vpn"
				"category" => "vpn"
					"[event][id]" => "SYSTEM:vpn_done"
					"[rsa][message][id1]" => "SYSTEM:vpn_done"
					"[event][categoryid]" => "1801030100"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:vpn_start
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,vpn,<version>,<fld2> <fld3>,<vsys>,<service>-start,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,vpn,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-start,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:vpn_start"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Start"
				"info" => "start"
				"action" => "vpn"
				"category" => "vpn"
					"[event][id]" => "SYSTEM:vpn_start"
					"[rsa][message][id1]" => "SYSTEM:vpn_start"
					"[event][categoryid]" => "1801020100"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:vpn
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,vpn,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,vpn,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:vpn"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "vpn"
				"category" => "vpn"
					"[event][id]" => "SYSTEM:vpn"
					"[rsa][message][id1]" => "SYSTEM:vpn"
					"[event][categoryid]" => "1801030100"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:ras_success
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ras,<version>,<fld2> <fld3>,<vsys>,<service>-success,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ras,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-success,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:ras_success"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_outcome" => "Success"
				"info" => "success"
				"action" => "ras"
				"category" => "ras"
					"[event][id]" => "SYSTEM:ras_success"
					"[rsa][message][id1]" => "SYSTEM:ras_success"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:ras_abort
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ras,<version>,<fld2> <fld3>,<vsys>,<service>-abort,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ras,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-abort,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:ras_abort"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Stop"
				"info" => "abort"
				"action" => "ras"
				"category" => "ras"
					"[event][id]" => "SYSTEM:ras_abort"
					"[rsa][message][id1]" => "SYSTEM:ras_abort"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:ras_start
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ras,<version>,<fld2> <fld3>,<vsys>,<service>-start,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ras,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^\-]*)\-start,(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:ras_start"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Start"
				"info" => "abort"
				"action" => "ras"
				"category" => "ras"
					"[event][id]" => "SYSTEM:ras_start"
					"[rsa][message][id1]" => "SYSTEM:ras_start"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:ras
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ras,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ras,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:ras"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "Stop"
				"info" => "abort"
				"action" => "ras"
				"category" => "ras"
					"[event][id]" => "SYSTEM:ras"
					"[rsa][message][id1]" => "SYSTEM:ras"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:dnsproxy
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,dnsproxy,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,dnsproxy,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:dnsproxy"
				add_field => {
				"devicehostname" => "%{domain}"
				"info" => "cleared"
				"action" => "dnsproxy"
				"category" => "dnsproxy"
					"[event][id]" => "SYSTEM:dnsproxy"
					"[rsa][message][id1]" => "SYSTEM:dnsproxy"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:dhcp
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,dhcp,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,dhcp,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:dhcp"
				add_field => {
				"devicehostname" => "%{domain}"
				"info" => "finished"
				"action" => "dhcp"
				"category" => "dhcp"
					"[event][id]" => "SYSTEM:dhcp"
					"[rsa][message][id1]" => "SYSTEM:dhcp"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:globalprotect:04
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,globalprotect,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"<event_description>  Login from:<saddr>, Source region: <location_src>, User name: <username>, Client OS version: <os>, Reason: <result>, Auth type: <logon_type>.",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,globalprotect,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),\"(?<event_description>[^\s]*)[\s]+Login[\s]+from:(?<saddr>[^,]*),[\s]+Source[\s]+region:[\s]+(?<location_src>[^,]*),[\s]+User[\s]+name:[\s]+(?<username>[^,]*),[\s]+Client[\s]+OS[\s]+version:[\s]+(?<os>[^,]*),[\s]+Reason:[\s]+(?<result>[^,]*),[\s]+Auth[\s]+type:[\s]+(?<logon_type>[^\.]*)\.\",(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:globalprotect:04"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"action" => "globalprotect"
				"category" => "globalprotect"
					"[event][id]" => "SYSTEM:globalprotect:04"
					"[rsa][message][id1]" => "SYSTEM:globalprotect:04"
					"[event][categoryid]" => "1301000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:globalprotect:03
		# line in RSA: {PA-<fld22><domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,globalprotect,<version>,<fld2><fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"<event_description> User name:<username>, {Reason: <result> , Auth type: <logon_type>." | Reason: <result>."},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		# Parsing error: Couldn't parse because of 2 adjacent fields like <fld1><fld2>
		# MESSAGE SYSTEM:globalprotect:02
		# line in RSA: {PA-<fld22><domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,globalprotect,<version>,<fld2><fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"<event_description>{User name:<username>, Private IP:<hostip>, Client version: <fld23>, Device name: <device>, Client OS version: <os>, VPN type: <context> | User name:<username>, Private IP:<hostip>, Client<agent>, Client OS:<os> | User name:<username>, Private IP: <hostip>}.",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		# Parsing error: Couldn't parse because of 2 adjacent fields like <fld1><fld2>
		# MESSAGE SYSTEM:globalprotect:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,globalprotect,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"<event_description>  Login from:<saddr>, {User name: <username>, Auth type: <logon_type> | User name: <username>, Config name: <fld23> | User name: <username>}.",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,globalprotect,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),\"(?<event_description>[^\s]*)[\s]+Login[\s]+from:(?<saddr>[^,]*),[\s]+(User[\s]+name:[\s]+(?<username>[^,]*),[\s]+Auth[\s]+type:[\s]+(?<logon_type>[^\s]*)[\s]+|[\s]*User[\s]+name:[\s]+(?<username>[^,]*),[\s]+Config[\s]+name:[\s]+(?<fld23>[^\s]*)[\s]+|[\s]*User[\s]+name:[\s]+(?<username>[^\.]*))\.\",(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:globalprotect:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_activity" => "authentication"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "globalprotect"
				"category" => "globalprotect"
					"[event][id]" => "SYSTEM:globalprotect:01"
					"[rsa][message][id1]" => "SYSTEM:globalprotect:01"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:globalprotect
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,globalprotect,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,globalprotect,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:globalprotect"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"action" => "globalprotect"
				"category" => "globalprotect"
					"[event][id]" => "SYSTEM:globalprotect"
					"[rsa][message][id1]" => "SYSTEM:globalprotect"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:ntpd
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,ntpd,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ntpd,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:ntpd"
				add_field => {
				"devicehostname" => "%{domain}"
				"info" => "restart"
				"action" => "ntpd"
				"category" => "ntpd"
					"[event][id]" => "SYSTEM:ntpd"
					"[rsa][message][id1]" => "SYSTEM:ntpd"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:port
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,port,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,port,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:port"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "port"
				"category" => "port"
					"[event][id]" => "SYSTEM:port"
					"[rsa][message][id1]" => "SYSTEM:port"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:url-filtering:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,url-filtering,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,url\-filtering,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:url-filtering:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "url-filtering"
				"category" => "url-filtering"
					"[event][id]" => "SYSTEM:url-filtering:01"
					"[rsa][message][id1]" => "SYSTEM:url-filtering:01"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:url-filtering
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,url-filtering,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,url\-filtering,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-SYSTEM:url-filtering"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "url-filtering"
				"category" => "url-filtering"
					"[event][id]" => "SYSTEM:url-filtering"
					"[rsa][message][id1]" => "SYSTEM:url-filtering"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:userid_03
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,userid,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"ldap cfg Directory-Group-Mapping connected to server <fld15>:<sport>, initiated by: <saddr>",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,userid,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),\"ldap[\s]+cfg[\s]+Directory\-Group\-Mapping[\s]+connected[\s]+to[\s]+server[\s]+(?<fld15>[^:]*):(?<sport>[^,]*),[\s]+initiated[\s]+by:[\s]+(?<saddr>[^\"]*)\",(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:userid_03"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "userid"
				"category" => "userid"
					"[event][id]" => "SYSTEM:userid_03"
					"[rsa][message][id1]" => "SYSTEM:userid_03"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:userid
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,userid,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,"<event_description>",<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,userid,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),\"(?<event_description>[^\"]*)\",(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:userid"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "userid"
				"category" => "userid"
					"[event][id]" => "SYSTEM:userid"
					"[rsa][message][id1]" => "SYSTEM:userid"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:userid_01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,userid,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,userid,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:userid_01"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "userid"
				"category" => "userid"
					"[event][id]" => "SYSTEM:userid_01"
					"[rsa][message][id1]" => "SYSTEM:userid_01"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:satd
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,satd,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,satd,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:satd"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_outcome" => "Success"
				"action" => "satd"
				"category" => "satd"
					"[event][id]" => "SYSTEM:satd"
					"[rsa][message][id1]" => "SYSTEM:satd"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:sslmgr
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,sslmgr,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,sslmgr,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:sslmgr"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"action" => "sslmgr"
				"category" => "sslmgr"
					"[event][id]" => "SYSTEM:sslmgr"
					"[rsa][message][id1]" => "SYSTEM:sslmgr"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:syslog
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld2>,|,<fld2>,}<serial_number>,SYSTEM,syslog,<version>,<fld3> <fld4>,<vsys>,<service>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>['AF_INET.<daddr>:<dport>.']"|<event_description>['AF_INET.<daddr>:<dport>.']},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld2>[^,]*),|,(?<fld2>[^,]*),)(?<serial_number>[^,]*),SYSTEM,syslog,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\[]*)\['AF_INET\.(?<daddr>[^:]*):(?<dport>[^\.]*)\.'\]\"|(?<event_description>[^\[]*)\['AF_INET\.(?<daddr>[^:]*):(?<dport>[^\.]*)\.'\]),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:syslog"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"category" => "syslog"
					"[event][id]" => "SYSTEM:syslog"
					"[rsa][message][id1]" => "SYSTEM:syslog"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:pbf
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld2>,|,<fld2>,}<serial_number>,SYSTEM,pbf,<version>,<fld3> <fld4>,<vsys>,<service>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld2>[^,]*),|,(?<fld2>[^,]*),)(?<serial_number>[^,]*),SYSTEM,pbf,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:pbf"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"category" => "pbf"
					"[event][id]" => "SYSTEM:pbf"
					"[rsa][message][id1]" => "SYSTEM:pbf"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:ha
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld2>,|,<fld2>,}<serial_number>,SYSTEM,ha,<version>,<fld3> <fld4>,<vsys>,<service>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld2>[^,]*),|,(?<fld2>[^,]*),)(?<serial_number>[^,]*),SYSTEM,ha,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:ha"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"category" => "ha"
					"[event][id]" => "SYSTEM:ha"
					"[rsa][message][id1]" => "SYSTEM:ha"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:hw
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld2>,|,<fld2>,}<serial_number>,SYSTEM,hw,<version>,<fld3> <fld4>,<vsys>,<service>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld2>[^,]*),|,(?<fld2>[^,]*),)(?<serial_number>[^,]*),SYSTEM,hw,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:hw"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"category" => "hw"
					"[event][id]" => "SYSTEM:hw"
					"[rsa][message][id1]" => "SYSTEM:hw"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:raid
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld2>,|,<fld2>,}<serial_number>,SYSTEM,raid,<version>,<fld3> <fld4>,<vsys>,<service>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld2>[^,]*),|,(?<fld2>[^,]*),)(?<serial_number>[^,]*),SYSTEM,raid,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:raid"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"category" => "raid"
					"[event][id]" => "SYSTEM:raid"
					"[rsa][message][id1]" => "SYSTEM:raid"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:lacp
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld2>,|,<fld2>,}<serial_number>,SYSTEM,lacp,<version>,<fld3> <fld4>,<vsys>,<service>,<fld5>,<fld6>,<fld7>,<fld8>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld2>[^,]*),|,(?<fld2>[^,]*),)(?<serial_number>[^,]*),SYSTEM,lacp,(?<version>[^,]*),(?<fld3>[^\s]*)[\s]+(?<fld4>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:lacp"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_subject" => "Service"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"category" => "lacp"
					"[event][id]" => "SYSTEM:lacp"
					"[rsa][message][id1]" => "SYSTEM:lacp"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d H:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:AUTH-Failure:01
		# line in RSA: <domain> 1,<fld1>,<serial_number>,SYSTEM,auth,<version>,<fld3> <fld4>,<fld10>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"failed authentication for user '<username>'.<space>Reason: <result> auth profile '<rulename>', vsys '<vsys>', server profile '<fld11>', server address '<daddr>', From: <saddr>.",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{domain} 1,%{fld1},%{serial_number},SYSTEM,auth,%{version},%{fld3} %{fld4},%{fld10},%{fld5},%{fld6},%{fld7},%{fld8},%{fld9},%{severity},\"failed authentication for user '%{username}'.%{space}Reason: %{result} auth profile '%{rulename}', vsys '%{vsys}', server profile '%{fld11}', server address '%{daddr}', From: %{saddr}.\",%{fld12},%{fld13},%{fld14},%{fld15},%{fld16},%{fld18},%{vsys},%{sensor}" }
				id => "message-SYSTEM:AUTH-Failure:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_outcome" => "Failure"
				"action" => "Authentication"
				"category" => "auth"
					"[event][id]" => "SYSTEM:AUTH-Failure:01"
					"[rsa][message][id1]" => "SYSTEM:AUTH-Failure:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:AUTH-Failure
		# line in RSA: <domain> 1,<fld1>,<serial_number>,SYSTEM,auth,<version>,<fld3> <fld4>,<fld10>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"failed authentication for user '<username>'.<space>Reason: <result> From: <saddr>.",<fld12>,<fld13>,<fld14>,<fld15>,<fld16>,<fld18>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{domain} 1,%{fld1},%{serial_number},SYSTEM,auth,%{version},%{fld3} %{fld4},%{fld10},%{fld5},%{fld6},%{fld7},%{fld8},%{fld9},%{severity},\"failed authentication for user '%{username}'.%{space}Reason: %{result} From: %{saddr}.\",%{fld12},%{fld13},%{fld14},%{fld15},%{fld16},%{fld18},%{vsys},%{sensor}" }
				id => "message-SYSTEM:AUTH-Failure"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_outcome" => "Failure"
				"action" => "Authentication"
				"category" => "auth"
					"[event][id]" => "SYSTEM:AUTH-Failure"
					"[rsa][message][id1]" => "SYSTEM:AUTH-Failure"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:AUTH-Success:01
		# line in RSA: <domain> 1,<fld1>,<serial_number>,SYSTEM,auth,<version>,<fld3> <fld4>,<fld17>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"authenticated for user '<username>'.<space>auth profile '<rulename>', vsys '<vsys>', server profile '<fld18>', server address '<daddr>', From: <saddr>.",<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<fld15>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{domain} 1,%{fld1},%{serial_number},SYSTEM,auth,%{version},%{fld3} %{fld4},%{fld17},%{fld5},%{fld6},%{fld7},%{fld8},%{fld9},%{severity},\"authenticated for user '%{username}'.%{space}auth profile '%{rulename}', vsys '%{vsys}', server profile '%{fld18}', server address '%{daddr}', From: %{saddr}.\",%{fld10},%{fld11},%{fld12},%{fld13},%{fld14},%{fld15},%{vsys},%{sensor}" }
				id => "message-SYSTEM:AUTH-Success:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_outcome" => "Success"
				"action" => "Authentication"
				"category" => "auth"
					"[event][id]" => "SYSTEM:AUTH-Success:01"
					"[rsa][message][id1]" => "SYSTEM:AUTH-Success:01"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:AUTH-Success
		# line in RSA: <domain> 1,<fld1>,<serial_number>,SYSTEM,auth,<version>,<fld3> <fld4>,<vsys>,<fld5>,<fld6>,<fld7>,<fld8>,<fld9>,<severity>,"authenticated for user '<username>'.<space>From: <saddr>.",<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<fld15>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{domain} 1,%{fld1},%{serial_number},SYSTEM,auth,%{version},%{fld3} %{fld4},%{vsys},%{fld5},%{fld6},%{fld7},%{fld8},%{fld9},%{severity},\"authenticated for user '%{username}'.%{space}From: %{saddr}.\",%{fld10},%{fld11},%{fld12},%{fld13},%{fld14},%{fld15},%{vsys},%{sensor}" }
				id => "message-SYSTEM:AUTH-Success"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Authentication"
				"ec_subject" => "User"
				"ec_outcome" => "Success"
				"action" => "Authentication"
				"category" => "auth"
					"[event][id]" => "SYSTEM:AUTH-Success"
					"[rsa][message][id1]" => "SYSTEM:AUTH-Success"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:generic
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,<category>,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-SYSTEM:generic"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "url-filtering"
					"[event][id]" => "SYSTEM:generic"
					"[rsa][message][id1]" => "SYSTEM:generic"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE SYSTEM:generic:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,SYSTEM,<category>,<version>,<fld2> <fld3>,<vsys>,<service>,<fld4>,<fld5>,<fld6>,<fld7>,<severity>,{"<event_description>"|<event_description>},<fld9>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),SYSTEM,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<vsys>[^,]*),(?<service>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<fld6>[^,]*),(?<fld7>[^,]*),(?<severity>[^,]*),(\"(?<event_description>[^\"]*)\"|(?<event_description>[^,]*)),(?<fld9>[^,]*),(?<fld10>.*)$" }
				id => "message-SYSTEM:generic:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"action" => "url-filtering"
					"[event][id]" => "SYSTEM:generic:01"
					"[rsa][message][id1]" => "SYSTEM:generic:01"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId104
	# line in RSA: <domain> 1,<fld1>,<serial_number>,CORRELATION,,,<fld3> <fld4>,<saddr>,<username>,<vsys>,<category>,<severity>,<fld9>,<fld10>,<fld11>,<fld12>,<vsys>,<sensor>,<fld13>,<context>,<fld14>,<event_description>
	else if [logstash][msgparser][id] == "msgParserId104" {
		dissect {
			mapping => { "message" => "%{domain} 1,%{fld1},%{serial_number},CORRELATION,,,%{fld3} %{fld4},%{saddr},%{username},%{vsys},%{category},%{severity},%{fld9},%{fld10},%{fld11},%{fld12},%{vsys},%{sensor},%{fld13},%{context},%{fld14},%{event_description}" }
			id => "msgParserId104"
			add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"[logstash][fullDateTimeString]" => "%{fld3} %{fld4}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "THREAT" {
		# MESSAGE WILDFIRE
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,wildfire,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<filename>",{<signame>(<fld15>)(<sigid>)|<signame>(<sigid>)},<threat_val>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<fld17>,<fld18>,<checksum>,<fqdn>,<fld20>,,<filetype>,,,<from>,{"<subject>"|<subject>},<to>,<fld21>,<fld22>,<fld23>,<fld24>,<fld25>,<vsys>,<sensor>,{<fld50>,<fld59>,<fld52>,<web_method>,<fld54>,<fld55>,<fld56>,<starttime>,<fld58>,<threat_name>,<content_version>,<fld51>|<fld45>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,wildfire,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<filename>[^\"]*)\",((?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\)|(?<signame>[^\(]*)\((?<sigid>[^\)]*)\)),(?<threat_val>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<checksum>[^,]*),(?<fqdn>[^,]*),(?<fld20>[^,]*),,(?<filetype>[^,]*),,,(?<from>[^,]*),(\"(?<subject>[^\"]*)\"|(?<subject>[^,]*)),(?<to>[^,]*),(?<fld21>[^,]*),(?<fld22>[^,]*),(?<fld23>[^,]*),(?<fld24>[^,]*),(?<fld25>[^,]*),(?<vsys>[^,]*),(?<sensor>[^,]*),((?<fld50>[^,]*),(?<fld59>[^,]*),(?<fld52>[^,]*),(?<web_method>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<starttime>[^,]*),(?<fld58>[^,]*),(?<threat_name>[^,]*),(?<content_version>[^,]*),(?<fld51>.*)|(?<fld45>.*))$" }
				id => "message-WILDFIRE"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "wildfire"
					"[event][id]" => "WILDFIRE"
					"[rsa][message][id1]" => "WILDFIRE"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT3:03
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<dclass_counter1>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<url_raw>",(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>,<fld12>,<fld30>,<fld15>,<fld16>,{"<user_agent>"|<user_agent>},<filetype>,<ip.orig>,{"<web_referer>"|<web_referer>},<from>,{"<subject>"|<subject>},<to>,<fld24>,<fld25>,<fld26>,<fld27>,<fld28>,<vsys>,<sensor>,{<fld50>,<fld59>,<fld52>,<web_method>,<fld54>,<fld55>,<fld56>,<starttime>,<fld58>,<threat_name>,<content_version>,<fld51>|<fld45>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<dclass_counter1>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<url_raw>[^\"]*)\",\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>[^,]*),(?<fld12>[^,]*),(?<fld30>[^,]*),(?<fld15>[^,]*),(?<fld16>[^,]*),(\"(?<user_agent>[^\"]*)\"|(?<user_agent>[^,]*)),(?<filetype>[^,]*),(?<ip.orig>[^,]*),(\"(?<web_referer>[^\"]*)\"|(?<web_referer>[^,]*)),(?<from>[^,]*),(\"(?<subject>[^\"]*)\"|(?<subject>[^,]*)),(?<to>[^,]*),(?<fld24>[^,]*),(?<fld25>[^,]*),(?<fld26>[^,]*),(?<fld27>[^,]*),(?<fld28>[^,]*),(?<vsys>[^,]*),(?<sensor>[^,]*),((?<fld50>[^,]*),(?<fld59>[^,]*),(?<fld52>[^,]*),(?<web_method>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<starttime>[^,]*),(?<fld58>[^,]*),(?<threat_name>[^,]*),(?<content_version>[^,]*),(?<fld51>.*)|(?<fld45>.*))$" }
				id => "message-THREAT3:03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT3:03"
					"[rsa][message][id1]" => "THREAT3:03"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<url_raw>",<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<url_raw>[^\"]*)\",(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>.*)$" }
				id => "message-THREAT"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT"
					"[rsa][message][id1]" => "THREAT"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT3:02
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<url_raw>",(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>,<fld12>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<url_raw>[^\"]*)\",\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>[^,]*),(?<fld12>.*)$" }
				id => "message-THREAT3:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT3:02"
					"[rsa][message][id1]" => "THREAT3:02"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT3:01
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<url_raw>",(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<url_raw>[^\"]*)\",\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>.*)$" }
				id => "message-THREAT3:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT3:01"
					"[rsa][message][id1]" => "THREAT3:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT:01
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<url_raw>",<signame>(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<url_raw>[^\"]*)\",(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>.*)$" }
				id => "message-THREAT:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT:01"
					"[rsa][message][id1]" => "THREAT:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT:02
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,{"<url_raw>"|<url_raw>},<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(\"(?<url_raw>[^\"]*)\"|(?<url_raw>[^,]*)),(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>.*)$" }
				id => "message-THREAT:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT:02"
					"[rsa][message][id1]" => "THREAT:02"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT:03
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,url,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,{"<url_raw>"|<url_raw>},<signame>(<sigid>),<filter>,<severity>,<direction>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,url,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(\"(?<url_raw>[^\"]*)\"|(?<url_raw>[^,]*)),(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>.*)$" }
				id => "message-THREAT:03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"url" => "%{url_raw}"
				"category" => "url"
					"[event][id]" => "THREAT:03"
					"[rsa][message][id1]" => "THREAT:03"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:06
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,virus,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<dclass_counter1>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,{"<context>"|<context>},{<signame>(<fld15>)(<sigid>)|<signame>(<sigid>)},<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>,<fld18>,<fld19>,<fld20>,<fld21>,{"<user_agent>"|<user_agent>},<filetype>,<ip.orig>,{"<web_referer>"|<web_referer>},<from>,{"<subject>"|<subject>},<to>,<fld31>,<fld32>,<fld23>,<fld24>,<fld25>,<vsys>,<sensor>,{<fld50>,<fld59>,<fld52>,<web_method>,<fld54>,<fld55>,<fld56>,<starttime>,<fld58>,<threat_name>,<content_version>,<fld51>|<fld45>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,virus,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<dclass_counter1>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(\"(?<context>[^\"]*)\"|(?<context>[^,]*)),((?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\)|(?<signame>[^\(]*)\((?<sigid>[^\)]*)\)),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>[^,]*),(?<fld18>[^,]*),(?<fld19>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(\"(?<user_agent>[^\"]*)\"|(?<user_agent>[^,]*)),(?<filetype>[^,]*),(?<ip.orig>[^,]*),(\"(?<web_referer>[^\"]*)\"|(?<web_referer>[^,]*)),(?<from>[^,]*),(\"(?<subject>[^\"]*)\"|(?<subject>[^,]*)),(?<to>[^,]*),(?<fld31>[^,]*),(?<fld32>[^,]*),(?<fld23>[^,]*),(?<fld24>[^,]*),(?<fld25>[^,]*),(?<vsys>[^,]*),(?<sensor>[^,]*),((?<fld50>[^,]*),(?<fld59>[^,]*),(?<fld52>[^,]*),(?<web_method>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<starttime>[^,]*),(?<fld58>[^,]*),(?<threat_name>[^,]*),(?<content_version>[^,]*),(?<fld51>.*)|(?<fld45>.*))$" }
				id => "message-THREAT1:06"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "virus"
					"[event][id]" => "THREAT1:06"
					"[rsa][message][id1]" => "THREAT1:06"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:07
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,file,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<dclass_counter1>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,{"<filename>"|<filename>},{<filetype>(<fld15>)(<sigid>)|<filetype>(<sigid>)},<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>,<fld18>,<fld19>,<fld20>,<fld21>,{"<user_agent>"|<user_agent>},<filetype>,<ip.orig>,{"<web_referer>"|<web_referer>},<from>,{"<subject>"|<subject>},<to>,<fld31>,<fld32>,<fld23>,<fld24>,<fld25>,<vsys>,<sensor>,{<fld50>,<fld59>,<fld52>,<web_method>,<fld54>,<fld55>,<fld56>,<starttime>,<fld58>,<threat_name>,<content_version>,<fld51>|<fld45>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,file,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<dclass_counter1>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(\"(?<filename>[^\"]*)\"|(?<filename>[^,]*)),((?<filetype>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\)|(?<filetype>[^\(]*)\((?<sigid>[^\)]*)\)),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>[^,]*),(?<fld18>[^,]*),(?<fld19>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(\"(?<user_agent>[^\"]*)\"|(?<user_agent>[^,]*)),(?<filetype>[^,]*),(?<ip.orig>[^,]*),(\"(?<web_referer>[^\"]*)\"|(?<web_referer>[^,]*)),(?<from>[^,]*),(\"(?<subject>[^\"]*)\"|(?<subject>[^,]*)),(?<to>[^,]*),(?<fld31>[^,]*),(?<fld32>[^,]*),(?<fld23>[^,]*),(?<fld24>[^,]*),(?<fld25>[^,]*),(?<vsys>[^,]*),(?<sensor>[^,]*),((?<fld50>[^,]*),(?<fld59>[^,]*),(?<fld52>[^,]*),(?<web_method>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<starttime>[^,]*),(?<fld58>[^,]*),(?<threat_name>[^,]*),(?<content_version>[^,]*),(?<fld51>.*)|(?<fld45>.*))$" }
				id => "message-THREAT1:07"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "file"
					"[event][id]" => "THREAT1:07"
					"[rsa][message][id1]" => "THREAT1:07"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:04
		# line in RSA:  {PA-<fld22> <domain> |<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,virus,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,{"<filename>"|<filename>},<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^\s]*)[\s]+|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,virus,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(\"(?<filename>[^\"]*)\"|(?<filename>[^,]*)),(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>.*)$" }
				id => "message-THREAT1:04"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "virus"
					"[event][id]" => "THREAT1:04"
					"[rsa][message][id1]" => "THREAT1:04"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,file,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<filename>",<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<fld17>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,file,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<filename>[^\"]*)\",(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<fld17>.*)$" }
				id => "message-THREAT1"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "file"
					"[event][id]" => "THREAT1"
					"[rsa][message][id1]" => "THREAT1"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:05
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,virus,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<filename>",<signame>(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,{<fld14>,,<fld17>,,,,,,,,<fld18>,,<sensor>,<url>|<fld14>,<content_type>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,virus,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<filename>[^\"]*)\",(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),((?<fld14>[^,]*),,(?<fld17>[^,]*),,,,,,,,(?<fld18>[^,]*),,(?<sensor>[^,]*),(?<url>.*)|(?<fld14>[^,]*),(?<content_type>.*))$" }
				id => "message-THREAT1:05"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "virus"
					"[event][id]" => "THREAT1:05"
					"[rsa][message][id1]" => "THREAT1:05"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:01
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>}<serial_number>,THREAT,file,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<filename>",<signame>(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,{<fld14>,,<fld17>,,,,,,,,<fld18>,,<sensor>,<url>|<fld14>,<fld17>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>.*))(?<serial_number>[^,]*),THREAT,file,(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<filename>[^\"]*)\",(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),((?<fld14>[^,]*),,(?<fld17>[^,]*),,,,,,,,(?<fld18>[^,]*),,(?<sensor>[^,]*),(?<url>.*)|(?<fld14>[^,]*),(?<fld17>.*))$" }
				id => "message-THREAT1:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "file"
					"[event][id]" => "THREAT1:01"
					"[rsa][message][id1]" => "THREAT1:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:02
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,{ file | virus },<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,<filename>,<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,([\s]*file[\s]+|[\s]*virus[\s]+),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(?<filename>[^,]*),(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>.*)$" }
				id => "message-THREAT1:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "file/virus"
					"[event][id]" => "THREAT1:02"
					"[rsa][message][id1]" => "THREAT1:02"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT1:03
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,{ file | virus },<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,<filename>,<signame>(<sigid>),<filter>,<severity>,<direction>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,([\s]*file[\s]+|[\s]*virus[\s]+),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(?<filename>[^,]*),(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>.*)$" }
				id => "message-THREAT1:03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
				"category" => "file/virus"
					"[event][id]" => "THREAT1:03"
					"[rsa][message][id1]" => "THREAT1:03"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT2:06
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<dclass_counter1>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<context>",<signame>{(<fld99>:<web_domain>)|(<fld15>)}(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<fld17>,<fld18>,<checksum>,<fqdn>,<fld20>,<fld21>,<fld35>,<fld23>,<fld24>,<fld25>,<fld26>,<fld27>,<fld28>,<fld29>,<fld30>,<fld31>,<fld32>,<fld33>,<sensor>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<dclass_counter1>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<context>[^\"]*)\",(?<signame>[^\(\(]*)(\((?<fld99>[^:]*):(?<web_domain>[^\)]*)\)|\((?<fld15>[^\)]*)\))\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<checksum>[^,]*),(?<fqdn>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<fld35>[^,]*),(?<fld23>[^,]*),(?<fld24>[^,]*),(?<fld25>[^,]*),(?<fld26>[^,]*),(?<fld27>[^,]*),(?<fld28>[^,]*),(?<fld29>[^,]*),(?<fld30>[^,]*),(?<fld31>[^,]*),(?<fld32>[^,]*),(?<fld33>[^,]*),(?<sensor>[^,]*),$" }
				id => "message-THREAT2:06"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "THREAT2:06"
					"[rsa][message][id1]" => "THREAT2:06"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT2:05
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<context>",<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<fld17>,<fld18>,<checksum>,<fqdn>,<fld20>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<context>[^\"]*)\",(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<checksum>[^,]*),(?<fqdn>[^,]*),(?<fld20>.*)$" }
				id => "message-THREAT2:05"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "THREAT2:05"
					"[rsa][message][id1]" => "THREAT2:05"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT2
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<context>",<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<fld17>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<context>[^\"]*)\",(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<fld17>.*)$" }
				id => "message-THREAT2"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "THREAT2"
					"[rsa][message][id1]" => "THREAT2"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE ThreatGeneric
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<dclass_counter1>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<context>",<signame>(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<content_type>,<fld18>,<fld19>,<fld20>,<fld21>,{"<user_agent>"|<user_agent>},<filetype>,<ip.orig>,{"<web_referer>"|<web_referer>},<from>,{"<subject>"|<subject>},<to>,<fld31>,<fld32>,<fld23>,<fld24>,<fld25>,<vsys>,<sensor>,{<fld50>,<fld59>,<fld52>,<web_method>,<fld54>,<fld55>,<fld56>,<starttime>,<fld58>,<threat_name>,<content_version>,<fld51>|<fld45>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<dclass_counter1>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<context>[^\"]*)\",(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<content_type>[^,]*),(?<fld18>[^,]*),(?<fld19>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(\"(?<user_agent>[^\"]*)\"|(?<user_agent>[^,]*)),(?<filetype>[^,]*),(?<ip.orig>[^,]*),(\"(?<web_referer>[^\"]*)\"|(?<web_referer>[^,]*)),(?<from>[^,]*),(\"(?<subject>[^\"]*)\"|(?<subject>[^,]*)),(?<to>[^,]*),(?<fld31>[^,]*),(?<fld32>[^,]*),(?<fld23>[^,]*),(?<fld24>[^,]*),(?<fld25>[^,]*),(?<vsys>[^,]*),(?<sensor>[^,]*),((?<fld50>[^,]*),(?<fld59>[^,]*),(?<fld52>[^,]*),(?<web_method>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<starttime>[^,]*),(?<fld58>[^,]*),(?<threat_name>[^,]*),(?<content_version>[^,]*),(?<fld51>.*)|(?<fld45>.*))$" }
				id => "message-ThreatGeneric"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "ThreatGeneric"
					"[rsa][message][id1]" => "ThreatGeneric"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT2:01
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,"<context>",<signame>(<sigid>),<filter>,<severity>,<direction>,<fld10>,<fld11>,<location_src>,<location_dst>,<fld14>,<fld17>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),\"(?<context>[^\"]*)\",(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld14>[^,]*),(?<fld17>.*)$" }
				id => "message-THREAT2:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "THREAT2:01"
					"[rsa][message][id1]" => "THREAT2:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT2:02
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,<context>,<signame>(<fld15>)(<sigid>),<filter>,<severity>,<direction>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(?<context>[^,]*),(?<signame>[^\(]*)\((?<fld15>[^\)]*)\)\((?<sigid>[^\)]*)\),(?<filter>[^,]*),(?<severity>[^,]*),(?<direction>.*)$" }
				id => "message-THREAT2:02"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "THREAT2:02"
					"[rsa][message][id1]" => "THREAT2:02"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE THREAT2:03
		# line in RSA:  {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,THREAT,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,<context>,<signame>(<sigid>),<fld15>,<severity>,<direction>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),THREAT,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(?<context>[^,]*),(?<signame>[^\(]*)\((?<sigid>[^\)]*)\),(?<fld15>[^,]*),(?<severity>[^,]*),(?<direction>.*)$" }
				id => "message-THREAT2:03"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "TEV"
					"[event][id]" => "THREAT2:03"
					"[rsa][message][id1]" => "THREAT2:03"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "TRAFFIC" {
		# MESSAGE TRAFFIC1:01
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,TRAFFIC,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,<bytes>,<sbytes>,<rbytes>,<packets>,<starttime>,<duration>,<filter>,<fld10>,<fld11>,<fld12>,<location_src>,<location_dst>,<fld13>,<fld14>,<fld15>,<result>,<fld17>,<fld18>,<fld19>,<fld20>,<vsys>,<sensor>,<fld23>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),TRAFFIC,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(?<bytes>[^,]*),(?<sbytes>[^,]*),(?<rbytes>[^,]*),(?<packets>[^,]*),(?<starttime>[^,]*),(?<duration>[^,]*),(?<filter>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>[^,]*),(?<result>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<fld19>[^,]*),(?<fld20>[^,]*),(?<vsys>[^,]*),(?<sensor>[^,]*),(?<fld23>.*)$" }
				id => "message-TRAFFIC1:01"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_theme" => "Communication"
					"[event][id]" => "TRAFFIC1:01"
					"[rsa][message][id1]" => "TRAFFIC1:01"
					"[event][categoryid]" => ""
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE TRAFFIC1
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,TRAFFIC,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,allow,<bytes>,<sbytes>,<rbytes>,<packets>,<starttime>,<duration>,<filter>,<fld10>,<fld11>,<fld12>,<location_src>,<location_dst>,<fld13>,<fld14>,<fld15>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),TRAFFIC,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),allow,(?<bytes>[^,]*),(?<sbytes>[^,]*),(?<rbytes>[^,]*),(?<packets>[^,]*),(?<starttime>[^,]*),(?<duration>[^,]*),(?<filter>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<fld15>.*)$" }
				id => "message-TRAFFIC1"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_activity" => "Permit"
				"ec_theme" => "Communication"
				"action" => "allow"
					"[event][id]" => "TRAFFIC1"
					"[rsa][message][id1]" => "TRAFFIC1"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE TRAFFIC2
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,TRAFFIC,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,deny,<bytes>,<sbytes>,<rbytes>,<packets>,<starttime>,<duration>,<filter>,<fld10>,<fld11>,<fld12>,<location_src>,<location_dst>,<fld13>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),TRAFFIC,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),deny,(?<bytes>[^,]*),(?<sbytes>[^,]*),(?<rbytes>[^,]*),(?<packets>[^,]*),(?<starttime>[^,]*),(?<duration>[^,]*),(?<filter>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<location_src>[^,]*),(?<location_dst>[^,]*),(?<fld13>.*)$" }
				id => "message-TRAFFIC2"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "deny"
					"[event][id]" => "TRAFFIC2"
					"[rsa][message][id1]" => "TRAFFIC2"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE TRAFFIC3
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,TRAFFIC,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,drop,<bytes>,<sbytes>,<rbytes>,<packets>,<starttime>,<duration>,<filter>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),TRAFFIC,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),drop,(?<bytes>[^,]*),(?<sbytes>[^,]*),(?<rbytes>[^,]*),(?<packets>[^,]*),(?<starttime>[^,]*),(?<duration>[^,]*),(?<filter>[^,]*),(?<fld10>.*)$" }
				id => "message-TRAFFIC3"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_activity" => "Deny"
				"ec_theme" => "Communication"
				"action" => "drop"
					"[event][id]" => "TRAFFIC3"
					"[rsa][message][id1]" => "TRAFFIC3"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE TRAFFIC
		# line in RSA: {PA-<fld22> <domain>|<domain>}{1,<fld1>,|,<fld1>,}<serial_number>,TRAFFIC,<category>,<version>,<fld2> <fld3>,<saddr>,<daddr>,<stransaddr>,<dtransaddr>,<rule>,<c_username>,<username>,<application>,<vsys>,<src_zone>,<dst_zone>,<sinterface>,<dinterface>,<rulename>,<fld7>,<sessionid>,<fld8>,<sport>,<dport>,<stransport>,<dtransport>,<fld9>,<protocol>,<action>,<bytes>,<sbytes>,<rbytes>,<packets>,<starttime>,<duration>,<filter>,<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^1,]*)|(?<domain>[^1,]*))(1,(?<fld1>[^,]*),|,(?<fld1>[^,]*),)(?<serial_number>[^,]*),TRAFFIC,(?<category>[^,]*),(?<version>[^,]*),(?<fld2>[^\s]*)[\s]+(?<fld3>[^,]*),(?<saddr>[^,]*),(?<daddr>[^,]*),(?<stransaddr>[^,]*),(?<dtransaddr>[^,]*),(?<rule>[^,]*),(?<c_username>[^,]*),(?<username>[^,]*),(?<application>[^,]*),(?<vsys>[^,]*),(?<src_zone>[^,]*),(?<dst_zone>[^,]*),(?<sinterface>[^,]*),(?<dinterface>[^,]*),(?<rulename>[^,]*),(?<fld7>[^,]*),(?<sessionid>[^,]*),(?<fld8>[^,]*),(?<sport>[^,]*),(?<dport>[^,]*),(?<stransport>[^,]*),(?<dtransport>[^,]*),(?<fld9>[^,]*),(?<protocol>[^,]*),(?<action>[^,]*),(?<bytes>[^,]*),(?<sbytes>[^,]*),(?<rbytes>[^,]*),(?<packets>[^,]*),(?<starttime>[^,]*),(?<duration>[^,]*),(?<filter>[^,]*),(?<fld10>.*)$" }
				id => "message-TRAFFIC"
				add_field => {
				"devicehostname" => "%{domain}"
				"ec_activity" => "Stop"
				"ec_theme" => "Communication"
					"[event][id]" => "TRAFFIC"
					"[rsa][message][id1]" => "TRAFFIC"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "HIPMATCH" {
		# MESSAGE HIPMATCH_Generic
		# line in RSA: {PA-<fld22> <domain>|<domain>},<fld1>,<serial_number>,<fld2>,<fld3>,HIPMATCH,<category>,<dclass_counter1>,<fld4> <fld5>,<username>,<vsys>,<hostname>,<os>,<hostip>,<obj_name>,<fld6>,<obj_type>,<fld7>,<fld8>,<fld9>,<fld10>,<fld11>,<fld12>,<fld13>,<fld14>,<vsys>,<sensor>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^,]*)|(?<domain>[^,]*)),(?<fld1>[^,]*),(?<serial_number>[^,]*),(?<fld2>[^,]*),(?<fld3>[^,]*),HIPMATCH,(?<category>[^,]*),(?<dclass_counter1>[^,]*),(?<fld4>[^\s]*)[\s]+(?<fld5>[^,]*),(?<username>[^,]*),(?<vsys>[^,]*),(?<hostname>[^,]*),(?<os>[^,]*),(?<hostip>[^,]*),(?<obj_name>[^,]*),(?<fld6>[^,]*),(?<obj_type>[^,]*),(?<fld7>[^,]*),(?<fld8>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<fld13>[^,]*),(?<fld14>[^,]*),(?<vsys>[^,]*),(?<sensor>.*)$" }
				id => "message-HIPMATCH_Generic"
				add_field => {
				"devicehostname" => "%{domain}"
					"[event][id]" => "HIPMATCH_Generic"
					"[rsa][message][id1]" => "HIPMATCH_Generic"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld4} %{fld5}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
		# MESSAGE HIPMATCH
		# line in RSA: {PA-<fld22> <domain>|<domain>},<fld1>,<serial_number>,<fld2>,<fld3>,HIPMATCH,<category>,<dclass_counter1>,<fld4> <fld5>,<username>,<vsys>,<hostname>,<hostip>,<obj_name>,<fld6>,<obj_type>,<fld7>,<fld8>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(PA\-(?<fld22>[^\s]*)[\s]+(?<domain>[^,]*)|(?<domain>[^,]*)),(?<fld1>[^,]*),(?<serial_number>[^,]*),(?<fld2>[^,]*),(?<fld3>[^,]*),HIPMATCH,(?<category>[^,]*),(?<dclass_counter1>[^,]*),(?<fld4>[^\s]*)[\s]+(?<fld5>[^,]*),(?<username>[^,]*),(?<vsys>[^,]*),(?<hostname>[^,]*),(?<hostip>[^,]*),(?<obj_name>[^,]*),(?<fld6>[^,]*),(?<obj_type>[^,]*),(?<fld7>[^,]*),(?<fld8>.*)$" }
				id => "message-HIPMATCH"
				add_field => {
				"devicehostname" => "%{domain}"
					"[event][id]" => "HIPMATCH"
					"[rsa][message][id1]" => "HIPMATCH"
					"[event][categoryid]" => "1701010000"
					"[logstash][fullDateTimeString]" => "%{fld4} %{fld5}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId135
	# line in RSA: <domain> <fld1>,<fld4>,<serial_number>,<fld5>,<fld6>,USERID,<category>,<fld7>,<fld2> <fld3>,<fld8>,<fld9>,<fld10>,<fld11>,<fld12>,<device>,<fld13>,<vsys>,<saddr>,<username>,<c_username>,<id>,<fld14>,<fld15>,<sport>,<dport>,<event_source>,<fld16>,<fld17>,<fld18>,<fld19>,<fld20>,<fld22>
	else if [logstash][msgparser][id] == "msgParserId135" {
		dissect {
			mapping => { "message" => "%{domain} %{fld1},%{fld4},%{serial_number},%{fld5},%{fld6},USERID,%{category},%{fld7},%{fld2} %{fld3},%{fld8},%{fld9},%{fld10},%{fld11},%{fld12},%{device},%{fld13},%{vsys},%{saddr},%{username},%{c_username},%{id},%{fld14},%{fld15},%{sport},%{dport},%{event_source},%{fld16},%{fld17},%{fld18},%{fld19},%{fld20},%{fld22}" }
			id => "msgParserId135"
			add_field => {
				"devicehostname" => "%{domain}"
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy/M/d HH:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}

# Enrich events using VALUEMAP
filter {
	translate {
		field => "[action]"
		destination => "[event_cat]"
		dictionary => {
			"allow" => "1801020000"
			"deny" => "1803000000"
			"drop" => "1803000000"
		}
		fallback => "1901000000"
		override => true
	}
}
filter {
	translate {
		field => "[event_cat]"
		destination => "[event_cat_name]"
		dictionary => {
			"1801020000" => "Network.Connections.Successful"
			"1803000000" => "Network.Denied Connections"
		}
		fallback => "Other.Default"
		override => true
	}
}
filter {
	translate {
		field => "[action]"
		destination => "[ec_activity]"
		dictionary => {
			"allow" => "Permit"
			"deny" => "Deny"
			"drop" => "Deny"
		}
		fallback => ""
		override => true
	}
}

# Rename fields
filter {
	mutate {
		rename => {
			"ip.orig" => "ip_orig"
		}
	}
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-paloaltonetworksmsg.json"
#			template_name => "paloaltonetworks_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
