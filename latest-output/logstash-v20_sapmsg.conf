# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "sap"
			"[observer][name]" => "SAP ERP Central Component"
			"[observer][type]" => "Application Servers"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %SAP-<level>-<messageid> <hfld1>: <hfld2>|| <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%SAP-%{level}-%{messageid} %{hfld1}: %{hfld2}|| %{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %SAP-<level>-<messageid>: <hfld2>|| <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%SAP-%{level}-%{messageid}: %{hfld2}|| %{message}" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %SAP-<level>-INVALID_OR_NOT_FOUND: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%SAP-%{level}-INVALID_OR_NOT_FOUND: %{message}" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "INVALID_NOTFOUND"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_sapmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "Logon" {
		# MESSAGE Logon
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>||<fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||{Logon Failed | Logon failed} ({Reason =<resultcode>, Type =<result> | reason=<resultcode>, type=<result>, method=<fld15>}) <fld28>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<instance>[^\|]*)\|\|[\s]+(?<parent_process>[^\|]*)\|\|(?<parent_pid>[^\|]*)\|\|(?<fld1>[^\s]*)[\s]+(?<fld29>[^\|]*)\|\|(?<fld2>[^\s]*)[\s]+(?<fld30>[^\|]*)\|\|(?<fld33>[^\|]*)\|\|(?<username>[^\|]*)\|\|(?<hostname>[^\|]*)\|\|(?<trans_id>[^\|]*)\|\|(?<application>[^\|]*)\|\|(?<id>[^\|]*)\|\|(?<operation_id>[^\|]*)\|\|(?<fld35>[^\|]*)\|\|(?<severity>[^\|]*)\|\|(?<fld3>[^\|]*)\|\|(Logon[\s]+Failed[\s]+|[\s]*Logon[\s]+failed)[\s]+\((Reason[\s]+=(?<resultcode>[^,]*),[\s]+Type[\s]+=(?<result>[^\s]*)[\s]+|[\s]*reason=(?<resultcode>[^,]*),[\s]+type=(?<result>[^,]*),[\s]+method=(?<fld15>[^\)]*))\)[\s]+(?<fld28>[^\|]*)\|\|(?<fld7>[^\|]*)\|\|(?<fld8>[^\|]*)\|\|(?<fld9>[^\|]*)\|\|(?<fld10>[^\|]*)\|\|(?<fld11>[^\|]*)\|\|(?<fld12>.*)$" }
				id => "message-Logon"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"action" => "Logon Failed"
					"[event][id]" => "Logon"
					"[rsa][message][id1]" => "Logon"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Logon:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||{Logon Successful | Logon successful} <fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<instance>[^\|]*)\|\|[\s]+(?<parent_process>[^\|]*)\|\|(?<parent_pid>[^\|]*)\|\|[\s]+(?<fld1>[^\s]*)[\s]+(?<fld29>[^\|]*)\|\|(?<fld2>[^\s]*)[\s]+(?<fld30>[^\|]*)\|\|(?<fld33>[^\|]*)\|\|(?<username>[^\|]*)\|\|(?<hostname>[^\|]*)\|\|(?<trans_id>[^\|]*)\|\|(?<application>[^\|]*)\|\|(?<id>[^\|]*)\|\|(?<operation_id>[^\|]*)\|\|(?<fld35>[^\|]*)\|\|(?<severity>[^\|]*)\|\|(?<fld3>[^\|]*)\|\|(Logon[\s]+Successful[\s]+|[\s]*Logon[\s]+successful)[\s]+(?<fld6>[^\|]*)\|\|(?<fld7>[^\|]*)\|\|(?<fld8>[^\|]*)\|\|(?<fld9>[^\|]*)\|\|(?<fld10>[^\|]*)\|\|(?<fld11>[^\|]*)\|\|(?<fld12>.*)$" }
				id => "message-Logon:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"action" => "Logon Successful"
					"[event][id]" => "Logon:01"
					"[rsa][message][id1]" => "Logon:01"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Logon:02
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> Locked in Client <fld6> After Erroneous Password Checks <fld13>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} Locked in Client %{fld6} After Erroneous Password Checks %{fld13}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Logon:02"
				add_field => {
				"action" => "User Locked Erroneous Password Checks"
					"[event][id]" => "Logon:02"
					"[rsa][message][id1]" => "Logon:02"
					"[event][categoryid]" => "1402020400"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Logon:03
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User Logoff <fld28>||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User Logoff %{fld28}||%{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}" }
				id => "message-Logon:03"
				add_field => {
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"action" => "User Logoff"
					"[event][id]" => "Logon:03"
					"[rsa][message][id1]" => "Logon:03"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Logon:04
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> Locked in Client <fld6> Unlocked After Being Locked Due to <result> <fld28>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} Locked in Client %{fld6} Unlocked After Being Locked Due to %{result} %{fld28}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Logon:04"
				add_field => {
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"action" => "User Unlocked after being locked"
					"[event][id]" => "Logon:04"
					"[rsa][message][id1]" => "Logon:04"
					"[event][categoryid]" => "1402020400"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Logon:05
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> in Client <fld6> Unlocked After Being Locked Due to <result> <fld28>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} in Client %{fld6} Unlocked After Being Locked Due to %{result} %{fld28}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Logon:05"
				add_field => {
				"ec_subject" => "User"
				"ec_theme" => "Configuration"
				"action" => "User Unlocked after being locked"
					"[event][id]" => "Logon:05"
					"[rsa][message][id1]" => "Logon:05"
					"[event][categoryid]" => "1402020400"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Other" {
		# MESSAGE Other
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Password check failed for user <c_username> in client <fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Password check failed for user %{c_username} in client %{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Other"
				add_field => {
				"ec_theme" => "Password"
				"ec_outcome" => "Failure"
				"action" => "Password check failed"
					"[event][id]" => "Other"
					"[rsa][message][id1]" => "Other"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Other:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Field content change: <fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Field content change: %{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Other:01"
				add_field => {
				"ec_theme" => "Password"
				"ec_outcome" => "Failure"
				"action" => "Password check failed"
					"[event][id]" => "Other:01"
					"[rsa][message][id1]" => "Other:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Other:02
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||> in program <fld6>, line <fld13>, event <result> ||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||> in program %{fld6}, line %{fld13}, event %{result} ||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Other:02"
				add_field => {
				"ec_theme" => "Password"
				"ec_outcome" => "Failure"
				"action" => "Password check failed"
					"[event][id]" => "Other:02"
					"[rsa][message][id1]" => "Other:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Other:03
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Download <fld36> Bytes to File <filename> ||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Download %{fld36} Bytes to File %{filename} ||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Other:03"
				add_field => {
				"action" => "Download to File"
					"[event][id]" => "Other:03"
					"[rsa][message][id1]" => "Other:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Other:04
		# line in RSA:  <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Field content changed: <fld27>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Field content changed: %{fld27}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-Other:04"
				add_field => {
					"[event][id]" => "Other:04"
					"[rsa][message][id1]" => "Other:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Other:05
		# line in RSA:  <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Logical file name <fld28>  not configured. Physical file name <fld27>  not checked. <fld38>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Logical file name %{fld28}  not configured. Physical file name %{fld27}  not checked. %{fld38}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-Other:05"
				add_field => {
					"[event][id]" => "Other:05"
					"[rsa][message][id1]" => "Other:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "RFC" {
		# MESSAGE RFC
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Successful RFC Call <statement>||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Successful RFC Call %{statement}||%{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}" }
				id => "message-RFC"
				add_field => {
				"ec_theme" => "AccessControl"
				"ec_outcome" => "Success"
				"action" => "Successful RFC Call"
					"[event][id]" => "RFC"
					"[rsa][message][id1]" => "RFC"
					"[event][categoryid]" => "1602010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE RFC:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||RFC/CPIC {Logon Successful | logon successful} <fld28>||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<instance>[^\|]*)\|\|[\s]+(?<parent_process>[^\|]*)\|\|(?<parent_pid>[^\|]*)\|\|[\s]+(?<fld1>[^\s]*)[\s]+(?<fld29>[^\|]*)\|\|(?<fld2>[^\s]*)[\s]+(?<fld30>[^\|]*)\|\|(?<fld33>[^\|]*)\|\|(?<username>[^\|]*)\|\|(?<hostname>[^\|]*)\|\|(?<trans_id>[^\|]*)\|\|(?<application>[^\|]*)\|\|(?<id>[^\|]*)\|\|(?<operation_id>[^\|]*)\|\|(?<fld35>[^\|]*)\|\|(?<severity>[^\|]*)\|\|(?<fld3>[^\|]*)\|\|RFC/CPIC[\s]+(Logon[\s]+Successful[\s]+|[\s]*logon[\s]+successful)[\s]+(?<fld28>[^\|]*)\|\|(?<fld6>[^\|]*)\|\|(?<fld7>[^\|]*)\|\|(?<fld8>[^\|]*)\|\|(?<fld9>[^\|]*)\|\|(?<fld10>[^\|]*)\|\|(?<fld11>.*)$" }
				id => "message-RFC:01"
				add_field => {
				"ec_activity" => "Logon"
				"ec_theme" => "AccessControl"
				"ec_outcome" => "Success"
				"action" => "RFC/CPIC Logon Successful"
					"[event][id]" => "RFC:01"
					"[rsa][message][id1]" => "RFC:01"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE RFC:02
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||RFC/CPIC {Logon Failed | logon failed}, {Reason = <resultcode>, Type = <result> | reason=<resultcode>, type=<result>, method=<fld15>}||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<instance>[^\|]*)\|\|[\s]+(?<parent_process>[^\|]*)\|\|(?<parent_pid>[^\|]*)\|\|[\s]+(?<fld1>[^\s]*)[\s]+(?<fld29>[^\|]*)\|\|(?<fld2>[^\s]*)[\s]+(?<fld30>[^\|]*)\|\|(?<fld33>[^\|]*)\|\|(?<username>[^\|]*)\|\|(?<hostname>[^\|]*)\|\|(?<trans_id>[^\|]*)\|\|(?<application>[^\|]*)\|\|(?<id>[^\|]*)\|\|(?<operation_id>[^\|]*)\|\|(?<fld35>[^\|]*)\|\|(?<severity>[^\|]*)\|\|(?<fld3>[^\|]*)\|\|RFC/CPIC[\s]+(Logon[\s]+Failed[\s]+|[\s]*logon[\s]+failed),[\s]+(Reason[\s]+=[\s]+(?<resultcode>[^,]*),[\s]+Type[\s]+=[\s]+(?<result>[^\s]*)[\s]+|[\s]*reason=(?<resultcode>[^,]*),[\s]+type=(?<result>[^,]*),[\s]+method=(?<fld15>[^\|]*))\|\|(?<fld6>[^\|]*)\|\|(?<fld7>[^\|]*)\|\|(?<fld8>[^\|]*)\|\|(?<fld9>[^\|]*)\|\|(?<fld10>[^\|]*)\|\|(?<fld11>.*)$" }
				id => "message-RFC:02"
				add_field => {
				"ec_activity" => "Logon"
				"ec_theme" => "AccessControl"
				"ec_outcome" => "Failure"
				"action" => "RFC/CPIC Logon Failed"
					"[event][id]" => "RFC:02"
					"[rsa][message][id1]" => "RFC:02"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE RFC:03
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Generic table access by RFC to <info> with activity <resultcode>||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Generic table access by RFC to %{info} with activity %{resultcode}||%{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}" }
				id => "message-RFC:03"
				add_field => {
				"action" => "Generic table access by RFC"
					"[event][id]" => "RFC:03"
					"[rsa][message][id1]" => "RFC:03"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE RFC:06
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Successful RFC call <process> (function group = <fld12>) <fld13>||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Successful RFC call %{process} (function group = %{fld12}) %{fld13}||%{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}" }
				id => "message-RFC:06"
				add_field => {
				"action" => "Successful RFC call"
					"[event][id]" => "RFC:06"
					"[rsa][message][id1]" => "RFC:06"
					"[event][categoryid]" => "1401040000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE RFC:04
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Failed RFC Call <fld12> (Function Group = <info>)<fld13>||<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Failed RFC Call %{fld12} (Function Group = %{info})%{fld13}||%{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}" }
				id => "message-RFC:04"
				add_field => {
				"ec_theme" => "AccessControl"
				"ec_outcome" => "Failure"
				"action" => "Failed RFC Call "
					"[event][id]" => "RFC:04"
					"[rsa][message][id1]" => "RFC:04"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE RFC:05
		# line in RSA: <instance>||<parent_process>||<parent_pid>||<fld1><fld29>||<fld2><fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Successful WS Call<fld6>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}||%{parent_process}||%{parent_pid}||%{fld1}%{fld29}||%{fld2}%{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Successful WS Call%{fld6}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||" }
				id => "message-RFC:05"
				add_field => {
					"[event][id]" => "RFC:05"
					"[rsa][message][id1]" => "RFC:05"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Report" {
		# MESSAGE Report
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Report <fld6> {Started|started} <fld28>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<instance>[^\|]*)\|\|[\s]+(?<parent_process>[^\|]*)\|\|(?<parent_pid>[^\|]*)\|\|[\s]+(?<fld1>[^\s]*)[\s]+(?<fld29>[^\|]*)\|\|(?<fld2>[^\s]*)[\s]+(?<fld30>[^\|]*)\|\|(?<fld33>[^\|]*)\|\|(?<username>[^\|]*)\|\|(?<hostname>[^\|]*)\|\|(?<trans_id>[^\|]*)\|\|(?<application>[^\|]*)\|\|(?<id>[^\|]*)\|\|(?<operation_id>[^\|]*)\|\|(?<fld35>[^\|]*)\|\|(?<severity>[^\|]*)\|\|(?<fld3>[^\|]*)\|\|Report[\s]+(?<fld6>[^\s]*)[\s]+(Started|started)[\s]+(?<fld28>[^\|]*)\|\|(?<fld7>[^\|]*)\|\|(?<fld8>[^\|]*)\|\|(?<fld9>[^\|]*)\|\|(?<fld10>[^\|]*)\|\|(?<fld11>[^\|]*)\|\|(?<fld12>.*)$" }
				id => "message-Report"
				add_field => {
				"action" => "Report Started"
					"[event][id]" => "Report"
					"[rsa][message][id1]" => "Report"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Report:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Start Report <fld6> Failed (Reason = <result>)<fld28>||<fld7>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Start Report %{fld6} Failed (Reason = %{result})%{fld28}||%{fld7}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}" }
				id => "message-Report:01"
				add_field => {
				"action" => "Start Report Failed"
					"[event][id]" => "Report:01"
					"[rsa][message][id1]" => "Report:01"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "System" {
		# MESSAGE System
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Audit Configuration Changed <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Audit Configuration Changed %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-System"
				add_field => {
				"ec_subject" => "Configuration"
				"ec_activity" => "Modify"
				"action" => "Audit Configuration Changed"
					"[event][id]" => "System"
					"[rsa][message][id1]" => "System"
					"[event][categoryid]" => "1701000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE System:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Application Server Started <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Application Server Started %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-System:01"
				add_field => {
				"ec_subject" => "Configuration"
				"ec_activity" => "Start"
				"action" => "Application Server Started"
					"[event][id]" => "System:01"
					"[rsa][message][id1]" => "System:01"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE System:02
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Audit: Slot <fld8> Inactive <fld28>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>||<fld14>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Audit: Slot %{fld8} Inactive %{fld28}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}||%{fld14}" }
				id => "message-System:02"
				add_field => {
				"action" => "Slot Inactive"
					"[event][id]" => "System:02"
					"[rsa][message][id1]" => "System:02"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE System:03
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||<action>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||%{action}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-System:03"
				add_field => {
					"[event][id]" => "System:03"
					"[rsa][message][id1]" => "System:03"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Transaction" {
		# MESSAGE Transaction
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Transaction <fld8> Started <fld28>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>||<fld14>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Transaction %{fld8} Started %{fld28}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}||%{fld14}" }
				id => "message-Transaction"
				add_field => {
				"ec_subject" => "Service"
				"ec_activity" => "Start"
				"action" => "Transaction Started"
					"[event][id]" => "Transaction"
					"[rsa][message][id1]" => "Transaction"
					"[event][categoryid]" => "1602010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Transaction:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Start Transaction <fld8> Failed <fld28>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>||<fld14>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Start Transaction %{fld8} Failed %{fld28}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}||%{fld14}" }
				id => "message-Transaction:01"
				add_field => {
				"action" => "Start Transaction Failed"
					"[event][id]" => "Transaction:01"
					"[rsa][message][id1]" => "Transaction:01"
					"[event][categoryid]" => "1602020000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Transaction:02
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Start of transaction <fld8> failed (Reason=<result>)<fld28>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>||<fld14>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Start of transaction %{fld8} failed (Reason=%{result})%{fld28}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}||%{fld14}" }
				id => "message-Transaction:02"
				add_field => {
				"ec_activity" => "Start"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Failure"
				"action" => "Start of transaction failed"
					"[event][id]" => "Transaction:02"
					"[rsa][message][id1]" => "Transaction:02"
					"[event][categoryid]" => "1602020000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Transaction:03
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Transaction <fld8> Locked <fld17>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>||<fld14>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Transaction %{fld8} Locked %{fld17}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}||%{fld14}" }
				id => "message-Transaction:03"
				add_field => {
				"action" => "Transaction Locked"
					"[event][id]" => "Transaction:03"
					"[rsa][message][id1]" => "Transaction:03"
					"[event][categoryid]" => "1602020000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE Transaction:04
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Transaction <fld8> Unlocked <fld17>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>||<fld14>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Transaction %{fld8} Unlocked %{fld17}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}||%{fld14}" }
				id => "message-Transaction:04"
				add_field => {
				"action" => "Transaction Unlocked"
					"[event][id]" => "Transaction:04"
					"[rsa][message][id1]" => "Transaction:04"
					"[event][categoryid]" => "1602020000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "User" {
		# MESSAGE User
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> Unlocked <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} Unlocked %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User"
				add_field => {
				"action" => "User Unlocked"
					"[event][id]" => "User"
					"[rsa][message][id1]" => "User"
					"[event][categoryid]" => "1402020300"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:01
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> Locked <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} Locked %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:01"
				add_field => {
				"action" => "User Locked"
					"[event][id]" => "User:01"
					"[rsa][message][id1]" => "User:01"
					"[event][categoryid]" => "1402020400"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:02
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Perfil <fld27> Activated <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Perfil %{fld27} Activated %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:02"
				add_field => {
					"[event][id]" => "User:02"
					"[rsa][message][id1]" => "User:02"
					"[event][categoryid]" => "1402020400"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:03
		# line in RSA:  <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||{ Autorización <fld27> Activated | Autorización } <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<instance>[^\|]*)\|\|[\s]+(?<parent_process>[^\|]*)\|\|(?<parent_pid>[^\|]*)\|\|[\s]+(?<fld1>[^\s]*)[\s]+(?<fld29>[^\|]*)\|\|(?<fld2>[^\s]*)[\s]+(?<fld30>[^\|]*)\|\|(?<fld33>[^\|]*)\|\|(?<username>[^\|]*)\|\|(?<hostname>[^\|]*)\|\|(?<trans_id>[^\|]*)\|\|(?<application>[^\|]*)\|\|(?<id>[^\|]*)\|\|(?<operation_id>[^\|]*)\|\|(?<fld35>[^\|]*)\|\|(?<severity>[^\|]*)\|\|(?<fld3>[^\|]*)\|\|([\s]*Autorización[\s]+(?<fld27>[^\s]*)[\s]+Activated[\s]+|[\s]*Autorización[\s]+)[\s]+(?<fld28>[^\|]*)\|\|(?<fld8>[^\|]*)\|\|(?<fld9>[^\|]*)\|\|(?<fld10>[^\|]*)\|\|(?<fld11>[^\|]*)\|\|(?<fld12>[^\|]*)\|\|(?<fld13>.*)$" }
				id => "message-User:03"
				add_field => {
					"[event][id]" => "User:03"
					"[rsa][message][id1]" => "User:03"
					"[event][categoryid]" => "1402020400"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:04
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Password changed for user <c_username> in client <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Password changed for user %{c_username} in client %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:04"
				add_field => {
				"ec_subject" => "Password"
				"ec_activity" => "Modify"
				"action" => "Password changed"
					"[event][id]" => "User:04"
					"[rsa][message][id1]" => "User:04"
					"[event][categoryid]" => "1402040100"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:05
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> Created <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} Created %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:05"
				add_field => {
				"action" => "User Created"
					"[event][id]" => "User:05"
					"[rsa][message][id1]" => "User:05"
					"[event][categoryid]" => "1402020200"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:06
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User Master Record <c_username> Changed <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User Master Record %{c_username} Changed %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:06"
				add_field => {
				"action" => "User Master Record Changed"
					"[event][id]" => "User:06"
					"[rsa][message][id1]" => "User:06"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:07
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Authorizations for User <c_username> Changed <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Authorizations for User %{c_username} Changed %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:07"
				add_field => {
				"action" => "Authorizations for User Changed "
					"[event][id]" => "User:07"
					"[rsa][message][id1]" => "User:07"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:08
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||User <c_username> Deleted <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||User %{c_username} Deleted %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:08"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"action" => "User Deleted"
					"[event][id]" => "User:08"
					"[rsa][message][id1]" => "User:08"
					"[event][categoryid]" => "1402020100"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:09
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Authorization Activated <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Authorization Activated %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:09"
				add_field => {
				"action" => "Authorization Activated"
					"[event][id]" => "User:09"
					"[rsa][message][id1]" => "User:09"
					"[event][categoryid]" => "1402020100"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:10
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Authorization <fld14> Activated <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Authorization %{fld14} Activated %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:10"
				add_field => {
				"action" => "Authorization Activated"
					"[event][id]" => "User:10"
					"[rsa][message][id1]" => "User:10"
					"[event][categoryid]" => "1402020100"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:11
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Profile Activated <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Profile Activated %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:11"
				add_field => {
				"action" => "Profile Activated"
					"[event][id]" => "User:11"
					"[rsa][message][id1]" => "User:11"
					"[event][categoryid]" => "1402020100"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
		# MESSAGE User:12
		# line in RSA:   <instance>|| <parent_process>||<parent_pid>|| <fld1> <fld29>||<fld2> <fld30>||<fld33>||<username>||<hostname>||<trans_id>||<application>||<id>||<operation_id>||<fld35>||<severity>||<fld3>||Profile <fld14> Activated <fld28>||<fld8>||<fld9>||<fld10>||<fld11>||<fld12>||<fld13>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{instance}|| %{parent_process}||%{parent_pid}|| %{fld1} %{fld29}||%{fld2} %{fld30}||%{fld33}||%{username}||%{hostname}||%{trans_id}||%{application}||%{id}||%{operation_id}||%{fld35}||%{severity}||%{fld3}||Profile %{fld14} Activated %{fld28}||%{fld8}||%{fld9}||%{fld10}||%{fld11}||%{fld12}||%{fld13}" }
				id => "message-User:12"
				add_field => {
				"action" => "Profile Activated"
					"[event][id]" => "User:12"
					"[rsa][message][id1]" => "User:12"
					"[event][categoryid]" => "1402020100"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyyMMdd HHmmss" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "INVALID_NOTFOUND" {
		# MESSAGE INVALID_NOTFOUND:01
		# line in RSA: NAME="<filename>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "NAME=\"%{filename}\"" }
				id => "message-INVALID_NOTFOUND:01"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND:01"
					"[rsa][message][id1]" => "INVALID_NOTFOUND:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE INVALID_NOTFOUND:02
		# line in RSA: VALUE=<fld1>   SEVERITY=<severity>  UID=<id> TIME=<fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "VALUE=%{fld1}   SEVERITY=%{severity}  UID=%{id} TIME=%{fld2}" }
				id => "message-INVALID_NOTFOUND:02"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND:02"
					"[rsa][message][id1]" => "INVALID_NOTFOUND:02"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE INVALID_NOTFOUND:03
		# line in RSA: REPORTED_BY="<username>" STATUS=<event_state>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "REPORTED_BY=\"%{username}\" STATUS=%{event_state}" }
				id => "message-INVALID_NOTFOUND:03"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND:03"
					"[rsa][message][id1]" => "INVALID_NOTFOUND:03"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE INVALID_NOTFOUND:04
		# line in RSA: LAST_STAT_CHNG_AT=<fld2> LAST_STAT_CHNG_BY="<username>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "LAST_STAT_CHNG_AT=%{fld2} LAST_STAT_CHNG_BY=\"%{username}\"" }
				id => "message-INVALID_NOTFOUND:04"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND:04"
					"[rsa][message][id1]" => "INVALID_NOTFOUND:04"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE INVALID_NOTFOUND:05
		# line in RSA: MSG_TXT="<event_description>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "MSG_TXT=\"%{event_description}\"" }
				id => "message-INVALID_NOTFOUND:05"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND:05"
					"[rsa][message][id1]" => "INVALID_NOTFOUND:05"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE INVALID_NOTFOUND:06
		# line in RSA: MANDT="<fld1>" SAPUSERID="<username>" EXTLID="<id>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "MANDT=\"%{fld1}\" SAPUSERID=\"%{username}\" EXTLID=\"%{id}\"" }
				id => "message-INVALID_NOTFOUND:06"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND:06"
					"[rsa][message][id1]" => "INVALID_NOTFOUND:06"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE INVALID_NOTFOUND
		# line in RSA: <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{info}" }
				id => "message-INVALID_NOTFOUND"
				add_field => {
					"[event][id]" => "INVALID_NOTFOUND"
					"[rsa][message][id1]" => "INVALID_NOTFOUND"
					"[event][categoryid]" => "1612000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_sapmsg.json"
#			template_name => "sap_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
