# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "stealthwatch"
			"[observer][name]" => "Lancope StealthWatch"
			"[observer][type]" => "IDS"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: <month> <day> <time> <hlhost> StealthWatch[<hdata>]: StealthWatch: <htype>,<hseverity>,<hdatetime>,<hfacility>,<haddr>,<hmessage>,<data>,<hevent_type>,<messageid>,<!payload:hmessage>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<month>[^\s]*)[\s]+(?<day>[^\s]*)[\s]+(?<time>[^\s]*)[\s]+(?<hlhost>[^\s]*)[\s]+StealthWatch\[(?<hdata>[^\]]*)\]:[\s]+StealthWatch:[\s]+(?<htype>[^,]*),(?<hseverity>[^,]*),(?<hdatetime>[^,]*),(?<hfacility>[^,]*),(?<haddr>[^,]*),(?<message>(?<hmessage>[^,]*),(?<data>[^,]*),(?<hevent_type>[^,]*),(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: <hmonth> <hday> <htime> <hlhost> StealthWatch[<hdata>]: <hdatetime>,<messageid>,<!payload:messageid>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hmonth>[^\s]*)[\s]+(?<hday>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+(?<hlhost>[^\s]*)[\s]+StealthWatch\[(?<hdata>[^\]]*)\]:[\s]+(?<hdatetime>[^,]*),(?<message>(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: <hmonth> <hday> <htime> <hlhost> StealthWatch[<hdata>]: <hdatetime>,<hfld1>,<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hmonth>[^\s]*)[\s]+(?<hday>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+(?<hlhost>[^\s]*)[\s]+StealthWatch\[(?<hdata>[^\]]*)\]:[\s]+(?<hdatetime>[^,]*),(?<message>(?<hfld1>[^,]*),(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "Stealthwatch_events"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_stealthwatchmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "1" {
		# MESSAGE 1:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-1:01"
				add_field => {
					"[event][id]" => "1:01"
					"[rsa][message][id1]" => "1:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 1
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<fld2>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld2>[^,]*),(?<protocol>.*)$" }
				id => "message-1"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "1"
					"[rsa][message][id1]" => "1"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "2" {
		# MESSAGE 2:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-2:01"
				add_field => {
					"[event][id]" => "2:01"
					"[rsa][message][id1]" => "2:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 2
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<fld2>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld2>[^,]*),(?<protocol>.*)$" }
				id => "message-2"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "2"
					"[rsa][message][id1]" => "2"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "4" {
		# MESSAGE 4:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-4:01"
				add_field => {
					"[event][id]" => "4:01"
					"[rsa][message][id1]" => "4:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 4
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<fld2>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld2>[^,]*),(?<protocol>.*)$" }
				id => "message-4"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "4"
					"[rsa][message][id1]" => "4"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "5" {
		# MESSAGE 5:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-5:01"
				add_field => {
					"[event][id]" => "5:01"
					"[rsa][message][id1]" => "5:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 5
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-5"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "5"
					"[rsa][message][id1]" => "5"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "6" {
		# MESSAGE 6:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-6:01"
				add_field => {
					"[event][id]" => "6:01"
					"[rsa][message][id1]" => "6:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 6
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-6"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "6"
					"[rsa][message][id1]" => "6"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "7" {
		# MESSAGE 7:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-7:01"
				add_field => {
					"[event][id]" => "7:01"
					"[rsa][message][id1]" => "7:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 7
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-7"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "7"
					"[rsa][message][id1]" => "7"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "8" {
		# MESSAGE 8:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-8:01"
				add_field => {
					"[event][id]" => "8:01"
					"[rsa][message][id1]" => "8:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 8
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-8"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "8"
					"[rsa][message][id1]" => "8"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "9" {
		# MESSAGE 9:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-9:01"
				add_field => {
					"[event][id]" => "9:01"
					"[rsa][message][id1]" => "9:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 9
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-9"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "9"
					"[rsa][message][id1]" => "9"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "13" {
		# MESSAGE 13:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-13:01"
				add_field => {
					"[event][id]" => "13:01"
					"[rsa][message][id1]" => "13:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 13
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-13"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "13"
					"[rsa][message][id1]" => "13"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "15" {
		# MESSAGE 15:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-15:01"
				add_field => {
					"[event][id]" => "15:01"
					"[rsa][message][id1]" => "15:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 15
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-15"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "15"
					"[rsa][message][id1]" => "15"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "16" {
		# MESSAGE 16:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-16:01"
				add_field => {
					"[event][id]" => "16:01"
					"[rsa][message][id1]" => "16:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 16
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-16"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "16"
					"[rsa][message][id1]" => "16"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "17" {
		# MESSAGE 17:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-17:01"
				add_field => {
					"[event][id]" => "17:01"
					"[rsa][message][id1]" => "17:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 17
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-17"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "17"
					"[rsa][message][id1]" => "17"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "18" {
		# MESSAGE 18:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-18:01"
				add_field => {
					"[event][id]" => "18:01"
					"[rsa][message][id1]" => "18:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 18
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-18"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "18"
					"[rsa][message][id1]" => "18"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "19" {
		# MESSAGE 19:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-19:01"
				add_field => {
					"[event][id]" => "19:01"
					"[rsa][message][id1]" => "19:01"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 19
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-19"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "19"
					"[rsa][message][id1]" => "19"
					"[event][categoryid]" => "1002000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "20" {
		# MESSAGE 20:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-20:01"
				add_field => {
					"[event][id]" => "20:01"
					"[rsa][message][id1]" => "20:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 20
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-20"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "20"
					"[rsa][message][id1]" => "20"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "24" {
		# MESSAGE 24:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-24:01"
				add_field => {
					"[event][id]" => "24:01"
					"[rsa][message][id1]" => "24:01"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 24
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-24"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "24"
					"[rsa][message][id1]" => "24"
					"[event][categoryid]" => "1001000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "28" {
		# MESSAGE 28:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-28:01"
				add_field => {
					"[event][id]" => "28:01"
					"[rsa][message][id1]" => "28:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 28
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-28"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "28"
					"[rsa][message][id1]" => "28"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "30" {
		# MESSAGE 30:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-30:01"
				add_field => {
					"[event][id]" => "30:01"
					"[rsa][message][id1]" => "30:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 30
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-30"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "30"
					"[rsa][message][id1]" => "30"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "32" {
		# MESSAGE 32:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-32:01"
				add_field => {
					"[event][id]" => "32:01"
					"[rsa][message][id1]" => "32:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 32
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-32"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "32"
					"[rsa][message][id1]" => "32"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "33" {
		# MESSAGE 33:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-33:01"
				add_field => {
					"[event][id]" => "33:01"
					"[rsa][message][id1]" => "33:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 33
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<fld2>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld2>[^,]*),(?<protocol>.*)$" }
				id => "message-33"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "33"
					"[rsa][message][id1]" => "33"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "34" {
		# MESSAGE 34:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-34:01"
				add_field => {
					"[event][id]" => "34:01"
					"[rsa][message][id1]" => "34:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 34
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<fld2>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld2>[^,]*),(?<protocol>.*)$" }
				id => "message-34"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "34"
					"[rsa][message][id1]" => "34"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "35" {
		# MESSAGE 35:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-35:01"
				add_field => {
					"[event][id]" => "35:01"
					"[rsa][message][id1]" => "35:01"
					"[event][categoryid]" => "1003020000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 35
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<fld2>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld2>[^,]*),(?<protocol>.*)$" }
				id => "message-35"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "35"
					"[rsa][message][id1]" => "35"
					"[event][categoryid]" => "1003020000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "36" {
		# MESSAGE 36:03
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>,"<src_zone>",<daddr>,"<dst_zone>",<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,]*),\"(?<src_zone>[^\"]*)\",(?<daddr>[^,]*),\"(?<dst_zone>[^\"]*)\",(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-36:03"
				add_field => {
					"[event][id]" => "36:03"
					"[rsa][message][id1]" => "36:03"
					"[event][categoryid]" => "1003020000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 36
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>,<src_zone>,<daddr>,<dst_zone>,<fld10>,<fld11>,<fld12>,<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,]*),(?<src_zone>[^,]*),(?<daddr>[^,]*),(?<dst_zone>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-36"
				add_field => {
					"[event][id]" => "36"
					"[rsa][message][id1]" => "36"
					"[event][categoryid]" => "1003020000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 36:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>,<src_zone>,<daddr>,<dst_zone>,<fld10>,<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,]*),(?<src_zone>[^,]*),(?<daddr>[^,]*),(?<dst_zone>[^,]*),(?<fld10>[^,]*),(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-36:01"
				add_field => {
					"[event][id]" => "36:01"
					"[rsa][message][id1]" => "36:01"
					"[event][categoryid]" => "1003020000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 36:02
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>,<src_zone>,<daddr>,<dst_zone>,<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,]*),(?<src_zone>[^,]*),(?<daddr>[^,]*),(?<dst_zone>[^,]*),(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-36:02"
				add_field => {
					"[event][id]" => "36:02"
					"[rsa][message][id1]" => "36:02"
					"[event][categoryid]" => "1003020000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "37" {
		# MESSAGE 37:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-37:01"
				add_field => {
					"[event][id]" => "37:01"
					"[rsa][message][id1]" => "37:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 37
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-37"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "37"
					"[rsa][message][id1]" => "37"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "38" {
		# MESSAGE 38:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-38:01"
				add_field => {
					"[event][id]" => "38:01"
					"[rsa][message][id1]" => "38:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 38
		# line in RSA: <event_type>,<fld1>,<info>,<id>,<saddr>{,"<src_zone>",|,<src_zone>,}<fld7>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,]*),(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<fld7>.*)$" }
				id => "message-38"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "38"
					"[rsa][message][id1]" => "38"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "3010" {
		# MESSAGE 3010:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-3010:01"
				add_field => {
					"[event][id]" => "3010:01"
					"[rsa][message][id1]" => "3010:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 3010
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<fld9>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<fld9>.*)$" }
				id => "message-3010"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "3010"
					"[rsa][message][id1]" => "3010"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "3020" {
		# MESSAGE 3020:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-3020:01"
				add_field => {
					"[event][id]" => "3020:01"
					"[rsa][message][id1]" => "3020:01"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 3020
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<fld9>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<fld9>.*)$" }
				id => "message-3020"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "3020"
					"[rsa][message][id1]" => "3020"
					"[event][categoryid]" => "1001030300"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "4010" {
		# MESSAGE 4010:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-4010:01"
				add_field => {
					"[event][id]" => "4010:01"
					"[rsa][message][id1]" => "4010:01"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 4010
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<fld9>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<fld9>.*)$" }
				id => "message-4010"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "4010"
					"[rsa][message][id1]" => "4010"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "9010" {
		# MESSAGE 9010:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-9010:01"
				add_field => {
					"[event][id]" => "9010:01"
					"[rsa][message][id1]" => "9010:01"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 9010
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<protocol>.*)$" }
				id => "message-9010"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "9010"
					"[rsa][message][id1]" => "9010"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "9030" {
		# MESSAGE 9030:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-9030:01"
				add_field => {
					"[event][id]" => "9030:01"
					"[rsa][message][id1]" => "9030:01"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 9030
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<fld9>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<fld9>.*)$" }
				id => "message-9030"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "9030"
					"[rsa][message][id1]" => "9030"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "9998" {
		# MESSAGE 9998:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-9998:01"
				add_field => {
					"[event][id]" => "9998:01"
					"[rsa][message][id1]" => "9998:01"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 9998
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<fld9>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<fld9>.*)$" }
				id => "message-9998"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "9998"
					"[rsa][message][id1]" => "9998"
					"[event][categoryid]" => "1610000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "9999" {
		# MESSAGE 9999:01
		# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
				id => "message-9999:01"
				add_field => {
					"[event][id]" => "9999:01"
					"[rsa][message][id1]" => "9999:01"
					"[event][categoryid]" => "1611000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
			}
		}
		# MESSAGE 9999
		# line in RSA: <event_type>,<fld1>,<info>,<id>{,"<dst_zone>",|,<dst_zone>,}<fld8>,<fld9>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<event_type>[^,]*),(?<fld1>[^,]*),(?<info>[^,]*),(?<id>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<fld8>[^,]*),(?<fld9>.*)$" }
				id => "message-9999"
				add_field => {
				"category" => "%{hmsgtype}"
				"severity" => "%{hseverity}"
				"agent" => "%{hfacilityid}"
					"[event][id]" => "9999"
					"[rsa][message][id1]" => "9999"
					"[event][categoryid]" => "1611000000"
					"[logstash][fullDateTimeString]" => "%{hdatetime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'TZD'" ] }
			}
		}
	}
	# PARSER msgParserId0
	# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
	else if [logstash][msgparser][id] == "msgParserId0" {
		grok {
			match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
			id => "msgParserId0"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdatetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
		}
	}
	# PARSER msgParserId10
	# line in RSA: <id>,<event_type>{,"<info>",|,<info>,}<saddr>{,"<src_zone>",|,<src_zone>,}<daddr>{,"<dst_zone>",|,<dst_zone>,}<dport>,<protocol>,<hostip>,<fld4>,<fld3>,<category>,<severity>,<fld5>,<fld6> 
	else if [logstash][msgparser][id] == "msgParserId10" {
		grok {
			match => { "message" => "^(?<id>[^,]*),(?<event_type>[^,,]*)(,\"(?<info>[^\"]*)\",|,(?<info>[^,]*),)(?<saddr>[^,,]*)(,\"(?<src_zone>[^\"]*)\",|,(?<src_zone>[^,]*),)(?<daddr>[^,,]*)(,\"(?<dst_zone>[^\"]*)\",|,(?<dst_zone>[^,]*),)(?<dport>[^,]*),(?<protocol>[^,]*),(?<hostip>[^,]*),(?<fld4>[^,]*),(?<fld3>[^,]*),(?<category>[^,]*),(?<severity>[^,]*),(?<fld5>[^,]*),(?<fld6>[^\s]*)[\s]+$" }
			id => "msgParserId10"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{hdatetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d'T'H:m:s'Z'" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}

# Enrich events using VALUEMAP
filter {
	translate {
		field => "[id]"
		destination => "[ec_subject]"
		dictionary => {
			"14" => "Agent"
			"21" => "OS"
			"22" => "OS"
			"23" => "OS"
			"40" => "Agent"
			"42" => "Agent"
			"43" => "Agent"
			"290" => "Agent"
			"296" => "Agent"
			"301" => "Agent"
			"303" => "Agent"
			"319" => "Agent"
			"515" => "Agent"
			"6010" => "Agent"
			"60010" => "License"
			"60011" => "License"
			"60012" => "License"
			"60013" => "License"
		}
		fallback => ""
		override => true
	}
}
filter {
	translate {
		field => "[id]"
		destination => "[ec_activity]"
		dictionary => {
			"14" => "Create"
			"40" => "Detect"
			"42" => "Detect"
			"310" => "Deny"
			"5011" => "Detect"
			"5999" => "Detect"
			"6010" => "Create"
			"60001" => "Detect"
			"60015" => "Detect"
			"600016" => "Detect"
			"600017" => "Detect"
			"55" => "Scan"
			"63" => "Scan"
			"276" => "Scan"
			"277" => "Scan"
			"286" => "Scan"
		}
		fallback => ""
		override => true
	}
}
filter {
	translate {
		field => "[id]"
		destination => "[ec_theme]"
		dictionary => {
			"11" => "TEV"
			"14" => "Configuration"
			"29" => "Communication"
			"42" => "TEV"
			"49" => "Communication"
			"55" => "Communication"
			"63" => "Communication"
			"276" => "Communication"
			"277" => "Communication"
			"286" => "Communication"
			"289" => "Communication"
			"290" => "Communication"
			"291" => "Communication"
			"292" => "Communication"
			"294" => "Communication"
			"297" => "Communication"
			"298" => "Communication"
			"299" => "Communication"
			"300" => "Communication"
			"301" => "Communication"
			"302" => "Communication"
			"310" => "Communication"
			"513" => "Communication"
			"516" => "Communication"
			"517" => "Communication"
			"518" => "Communication"
			"519" => "Communication"
			"5011" => "Communication"
			"5999" => "Communication"
			"6010" => "Configuration"
			"7001" => "Communication"
			"7002" => "Communication"
			"7003" => "Communication"
			"7004" => "Communication"
			"7006" => "Communication"
			"7007" => "Communication"
			"7009" => "Communication"
			"7010" => "Communication"
			"7011" => "Communication"
			"60001" => "Communication"
			"60015" => "Communication"
			"600016" => "Communication"
			"600017" => "Communication"
		}
		fallback => ""
		override => true
	}
}
filter {
	translate {
		field => "[id]"
		destination => "[ec_outcome]"
		dictionary => {
			"289" => "Failure"
			"290" => "Failure"
			"291" => "Failure"
			"292" => "Failure"
			"294" => "Failure"
			"300" => "Failure"
			"301" => "Failure"
			"310" => "Failure"
			"318" => "Success"
			"514" => "Success"
			"5010" => "Error"
			"5011" => "Error"
			"5012" => "Failure"
			"5999" => "Failure"
			"9100" => "Failure"
			"60001" => "Failure"
			"60003" => "Failure"
			"60011" => "Error"
			"60012" => "Error"
			"60013" => "Error"
			"60015" => "Failure"
			"600016" => "Failure"
			"600017" => "Failure"
		}
		fallback => ""
		override => true
	}
}
filter {
	translate {
		field => "[info]"
		destination => "[info]"
		dictionary => {
			"0" => "Flow Alarm"
			"1" => "Threshold Alarm"
		}
		fallback => ""
		override => true
	}
}
filter {
	translate {
		field => "[protocol]"
		destination => "[protocol]"
		dictionary => {
			"17" => "UDP"
			"6" => "TCP"
			"1" => "ICMP or Other"
		}
		fallback => ""
		override => true
	}
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_stealthwatchmsg.json"
#			template_name => "stealthwatch_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
