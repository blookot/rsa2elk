# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "ciscoiportwsa"
			"[observer][name]" => "Cisco Ironport WSA"
			"[observer][type]" => "Web Logs"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %CISCOIPORTWSA-4: <hfld1> <hfld2> <hfld3> [<fld20> <fld21>] "<messageid> <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<message>(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<fld21>[^\]]*)\][\s]+\"(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %CISCOIPORTWSA-4: <hfld1> <hfld2> <hfld3> "<fld20> <fld21>" <messageid> <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<message>(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<fld21>[^\"]*)\"[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %CISCOIPORTWSA-4: #<hfld1>: <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+#(?<message>(?<hfld1>[^:]*):[\s]+(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "#"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0005
	# line in RSA: %CISCOIPORTWSA-4: <hfld1> <hfld2> <hfld3> <hfld4> <hfld5> <messageid>: <!payload:hfld2>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<hfld1>[^\s]*)[\s]+(?<message>(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^\s]*)[\s]+(?<hfld5>[^\s]*)[\s]+(?<messageid>[^:]*):[\s]+(?<payload>.*))$" }
			id => "header-0005"
			add_field => {
				"[rsa][header][id]" => "0005"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0008
	# line in RSA: %CISCOIPORTWSA-4: <hfld1>.<hfld2> <hduration> <hsaddr> <haction>/<hresultcode> <hfld3> <messageid> <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<message>(?<hfld1>[^\.]*)\.(?<hfld2>[^\s]*)[\s]+(?<hduration>[^\s]*)[\s]+(?<hsaddr>[^\s]*)[\s]+(?<haction>[^/]*)/(?<hresultcode>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0008"
			add_field => {
				"[rsa][header][id]" => "0008"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0004
	# line in RSA: %CISCOIPORTWSA-4: <hfld1> <hfld2> <hfld3> <hfld4> <hfld5> <hfld6> <hfld7> <messageid> <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<message>(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^\s]*)[\s]+(?<hfld5>[^\s]*)[\s]+(?<hfld6>[^\s]*)[\s]+(?<hfld7>[^\s]*)[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0004"
			add_field => {
				"[rsa][header][id]" => "0004"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 9999
	# line in RSA: %CISCOIPORTWSA-4: <saddr> <fld> <fld> [<p_time1> <timezone>] "<p_web_method> <p_url>" <resultcode> <fld13> <action>:<fld30> <duration_string> <policyname> <<<fld17>,<reputation_num>,<fld18>> <fld7> s-ip= <daddr> <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CISCOIPORTWSA-4: %{saddr} %{fld} %{fld} [%{p_time1} %{timezone}] \"%{p_web_method} %{p_url}\" %{resultcode} %{fld13} %{action}:%{fld30} %{duration_string} %{policyname} <%{fld17},%{reputation_num},%{fld18}> %{fld7} s-ip= %{daddr} %{message}" }
			id => "header-9999"
			add_field => {
				"[rsa][header][id]" => "9999"
				"[rsa][message][id2]" => "CISCOIPORTWSA_GENERIC"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 9995
	# line in RSA: %CISCOIPORTWSA-4: <p_time2>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <p_web_method> <p_url> "<sdomain_fld>\<username_fld>@<fld51>" <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CISCOIPORTWSA-4: %{p_time2}.%{fld2} %{duration_string} %{saddr} %{action}/%{resultcode} %{sbytes} %{p_web_method} %{p_url} \"%{sdomain_fld}\%{username_fld}@%{fld51}\" %{fld4}/%{fld5} %{content_type} %{policyname} <%{info}> %{fld7} s-ip= %{daddr} %{message}" }
			id => "header-9995"
			add_field => {
				"[rsa][header][id]" => "9995"
				"[rsa][message][id2]" => "CISCOIPORTWSA_GENERIC"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 9998
	# line in RSA: %CISCOIPORTWSA-4: <p_time2>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <p_web_method> <p_url> "{ <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> }" <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> <!payload>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<p_time2>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<p_web_method>[^\s]*)[\s]+(?<p_url>[^\s]*)[\s]+\"([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)|(?<username_fld>[^\s]*)[\s]+)\"[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+(?<message>.*)$" }
			id => "header-9998"
			add_field => {
				"[rsa][header][id]" => "9998"
				"[rsa][message][id2]" => "CISCOIPORTWSA_GENERIC"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0006
	# line in RSA: %CISCOIPORTWSA-4: <hfld1> <hfld2> <messageid> <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<message>(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0006"
			add_field => {
				"[rsa][header][id]" => "0006"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0007
	# line in RSA: %CISCOIPORTWSA-4: <hfld1> <hfld2> <hfld3> [<hfld4> <htimezone>] "<messageid> <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%CISCOIPORTWSA\-4:[\s]+(?<message>(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+\[(?<hfld4>[^\s]*)[\s]+(?<htimezone>[^\]]*)\][\s]+\"(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0007"
			add_field => {
				"[rsa][header][id]" => "0007"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0010
	# line in RSA: <hfld1> <hfld2> <hfld3> <hfld4>: <hfld5>: <hfld6> <hfld7> <hfld8> [<hfld9> <hfld10>] "<messageid> <!payload:hfld6>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^:]*):[\s]+(?<hfld5>[^:]*):[\s]+(?<message>(?<hfld6>[^\s]*)[\s]+(?<hfld7>[^\s]*)[\s]+(?<hfld8>[^\s]*)[\s]+\[(?<hfld9>[^\s]*)[\s]+(?<hfld10>[^\]]*)\][\s]+\"(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0010"
			add_field => {
				"[rsa][header][id]" => "0010"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 9997
	# line in RSA: <hfld1> <hfld2> <hfld3> <hfld4>: <hfld5>: <saddr> <hfld7> <hfld8> [<p_time1> <timezone>] "<p_web_method> <p_url>" <resultcode> <hfld13> <action>:<hfld30> <duration_string> <policyname> <<<hfld17>,<reputation_num>,<hfld18>> <hfld7> s-ip= <daddr> <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{hfld1} %{hfld2} %{hfld3} %{hfld4}: %{hfld5}: %{saddr} %{hfld7} %{hfld8} [%{p_time1} %{timezone}] \"%{p_web_method} %{p_url}\" %{resultcode} %{hfld13} %{action}:%{hfld30} %{duration_string} %{policyname} <%{hfld17},%{reputation_num},%{hfld18}> %{hfld7} s-ip= %{daddr} %{message}" }
			id => "header-9997"
			add_field => {
				"[rsa][header][id]" => "9997"
				"[rsa][message][id2]" => "CISCOIPORTWSA_GENERIC"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 9996
	# line in RSA: <hfld1> <hfld2> <hfld3> <hfld4>: <hfld5>: <p_time2>.<fld2> <duration> <saddr> <action>/<resultcode> <sbytes> <p_web_method> <p_url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <hfld10>/<hfld11> <content_type> <policyname> <<<info>> <hfld17> s-ip= <daddr> <!payload>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^:]*):[\s]+(?<hfld5>[^:]*):[\s]+(?<p_time2>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<p_web_method>[^\s]*)[\s]+(?<p_url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<hfld10>[^/]*)/(?<hfld11>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<hfld17>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+(?<message>.*)$" }
			id => "header-9996"
			add_field => {
				"[rsa][header][id]" => "9996"
				"[rsa][message][id2]" => "CISCOIPORTWSA_GENERIC"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0013
	# line in RSA: <hfld1> <hfld2> <hfld3> <messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{hfld1} %{hfld2} %{hfld3} %{messageid}: %{message}" }
			id => "header-0013"
			add_field => {
				"[rsa][header][id]" => "0013"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0011
	# line in RSA: <hfld1> <hfld2> <hfld3> <hfld4>: <hfld5>: <hfld6>.<hfld7> <hduration> <hsaddr> <haction>/<hresultcode> <hfld8> <messageid> <!payload:hfld6>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^:]*):[\s]+(?<hfld5>[^:]*):[\s]+(?<message>(?<hfld6>[^\.]*)\.(?<hfld7>[^\s]*)[\s]+(?<hduration>[^\s]*)[\s]+(?<hsaddr>[^\s]*)[\s]+(?<haction>[^/]*)/(?<hresultcode>[^\s]*)[\s]+(?<hfld8>[^\s]*)[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0011"
			add_field => {
				"[rsa][header][id]" => "0011"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0012
	# line in RSA: <hfld1> <hfld2> <hfld3> <hfld4>: #Version: <hfld5>_#Date: <hfld6>_#System: <hfld7>_#Software: <hfld8>_#Fields <!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<message>(?<hfld1>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<hfld3>[^\s]*)[\s]+(?<hfld4>[^:]*):[\s]+#Version:[\s]+(?<hfld5>[^_]*)_#Date:[\s]+(?<hfld6>[^_]*)_#System:[\s]+(?<hfld7>[^_]*)_#Software:[\s]+(?<hfld8>[^_]*)_#Fields[\s]+(?<payload>.*))$" }
			id => "header-0012"
			add_field => {
				"[rsa][header][id]" => "0012"
				"[rsa][message][id2]" => "Syslog_Initialization"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_ciscoiportwsamsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "CONNECT" {
		# MESSAGE CONNECT:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-CONNECT:03"
				add_field => {
					"[event][id]" => "CONNECT:03"
					"[rsa][message][id1]" => "CONNECT:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE CONNECT:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-CONNECT:04"
				add_field => {
					"[event][id]" => "CONNECT:04"
					"[rsa][message][id1]" => "CONNECT:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE CONNECT
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-CONNECT"
				add_field => {
					"[event][id]" => "CONNECT"
					"[rsa][message][id1]" => "CONNECT"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE CONNECT:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-CONNECT:01"
				add_field => {
					"[event][id]" => "CONNECT:01"
					"[rsa][message][id1]" => "CONNECT:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE CONNECT:08
		# line in RSA:  <fld15>.<fld16> <duration_string> <saddr> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> {"<filter>"|-} {"<user_agent>"|-} {"<fld21>"|-}  "<fld22> <timezone>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld15>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(\"(?<filter>[^\"]*)\"|\-)[\s]+(\"(?<user_agent>[^\"]*)\"|\-)[\s]+(\"(?<fld21>[^\"]*)\"|\-)[\s]+\"(?<fld22>[^\s]*)[\s]+(?<timezone>[^\"]*)\"$" }
				id => "message-CONNECT:08"
				add_field => {
					"[event][id]" => "CONNECT:08"
					"[rsa][message][id1]" => "CONNECT:08"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE CONNECT:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-CONNECT:02"
				add_field => {
					"[event][id]" => "CONNECT:02"
					"[rsa][message][id1]" => "CONNECT:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE CONNECT:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-CONNECT:05"
				add_field => {
					"[event][id]" => "CONNECT:05"
					"[rsa][message][id1]" => "CONNECT:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE CONNECT:06
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-CONNECT:06"
				add_field => {
					"[event][id]" => "CONNECT:06"
					"[rsa][message][id1]" => "CONNECT:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE CONNECT:07
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-CONNECT:07"
				add_field => {
					"[event][id]" => "CONNECT:07"
					"[rsa][message][id1]" => "CONNECT:07"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE CONNECT:09
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> {"<filter>"|-}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(\"(?<filter>[^\"]*)\"|\-)$" }
				id => "message-CONNECT:09"
				add_field => {
					"[event][id]" => "CONNECT:09"
					"[rsa][message][id1]" => "CONNECT:09"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE CONNECT:10
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] "<web_method> <url>" <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <fld19> <fld22> <content_type> <fld21>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<fld19>[^\s]*)[\s]+(?<fld22>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<fld21>.*)$" }
				id => "message-CONNECT:10"
				add_field => {
					"[event][id]" => "CONNECT:10"
					"[rsa][message][id1]" => "CONNECT:10"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GET" {
		# MESSAGE GET:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url_fld> <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> {sc-bytes | sc_bytes}= <sbytes> {cs-username | cs_username}= {"<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"|-|"<username_fld>"} s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url_fld>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+(sc\-bytes[\s]+|[\s]*sc_bytes)=[\s]+(?<sbytes>[^\s]*)[\s]+(cs\-username[\s]+|[\s]*cs_username)=[\s]+(\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|\-|\"(?<username_fld>[^\"]*)\")[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-GET:03"
				add_field => {
					"[event][id]" => "GET:03"
					"[rsa][message][id1]" => "GET:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> {"<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"|-|"<username_fld>"} <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|\-|\"(?<username_fld>[^\"]*)\")[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-GET:04"
				add_field => {
					"[event][id]" => "GET:04"
					"[rsa][message][id1]" => "GET:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE GET
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-GET"
				add_field => {
					"[event][id]" => "GET"
					"[rsa][message][id1]" => "GET"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-GET:01"
				add_field => {
					"[event][id]" => "GET:01"
					"[rsa][message][id1]" => "GET:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:09
		# line in RSA:  <fld15>.<fld16> <duration_string> <saddr> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> {"<filter>"|-} {"<user_agent>"|-} {"<fld21>"|-}  "<fld22> <timezone>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld15>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(\"(?<filter>[^\"]*)\"|\-)[\s]+(\"(?<user_agent>[^\"]*)\"|\-)[\s]+(\"(?<fld21>[^\"]*)\"|\-)[\s]+\"(?<fld22>[^\s]*)[\s]+(?<timezone>[^\"]*)\"$" }
				id => "message-GET:09"
				add_field => {
					"[event][id]" => "GET:09"
					"[rsa][message][id1]" => "GET:09"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-GET:02"
				add_field => {
					"[event][id]" => "GET:02"
					"[rsa][message][id1]" => "GET:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE GET:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "(Unauthenticated)<fld1>" | "<username>@<fld1>" } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\"(?<username>[^@]*)@(?<fld1>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-GET:05"
				add_field => {
					"[event][id]" => "GET:05"
					"[rsa][message][id1]" => "GET:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE GET:06
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] "<web_method> <url>" <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> {"<user_agent>"| - } {"<filter>"| - }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(\"(?<user_agent>[^\"]*)\"|[\s]*\-[\s]+)[\s]+(\"(?<filter>[^\"]*)\"|[\s]*\-[\s]+)$" }
				id => "message-GET:06"
				add_field => {
					"[event][id]" => "GET:06"
					"[rsa][message][id1]" => "GET:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:08
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] "<web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> s-ip=<daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= <username_fld> s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= <p_filter> cs-version= <fld11> cs-auth-group= <p_group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= <reputation_num> wbrs-threat-reason= <fld12> wbrs-threat-type= <result> cs-user-agent= <p_user_agent> cs-referer= <p_web_referer> 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+s\-ip=(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+(?<username_fld>[^\s]*)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+(?<p_filter>[^\s]*)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<p_group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+(?<reputation_num>[^\s]*)[\s]+wbrs\-threat\-reason=[\s]+(?<fld12>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<result>[^\s]*)[\s]+cs\-user\-agent=[\s]+(?<p_user_agent>[^\s]*)[\s]+cs\-referer=[\s]+(?<p_web_referer>[^\s]*)[\s]+$" }
				id => "message-GET:08"
				add_field => {
				"url" => "%{p_url}"
				"web_method" => "%{p_web_method}"
				"vid" => "%{web_method}"
					"[event][id]" => "%{web_method}"
					"[rsa][message][id1]" => "GET:08"
					"[event][categoryid]" => "1901000000"
					"[logstash][fullDateTimeString]" => "%{p_time1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:11
		# line in RSA: <saddr> "<username_fld>@<fld1>" <fld2> [<fld3>  <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld5> <duration_string> <policyname> {<fld6>, <fld7> ,<fld8>| <fld8>} s-ip= <daddr> s-port= <dport> {sc-bytes | sc_bytes}= <sbytes> cs-username= {"<username>"|<username>} s-hostname=<hostname> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld9> cs-auth-group= {"<group_object>"| <group_object>} c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= {"<category>"| <category>} cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<saddr>[^\s]*)[\s]+\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld5>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+((?<fld6>[^,]*),[\s]+(?<fld7>[^\s]*)[\s]+,(?<fld8>[^\s]*)|[\s]*(?<fld8>[^\s]*))[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+(sc\-bytes[\s]+|[\s]*sc_bytes)=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+(\"(?<username>[^\"]*)\"|(?<username>[^\s]*))[\s]+s\-hostname=(?<hostname>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld9>[^\s]*)[\s]+cs\-auth\-group=[\s]+(\"(?<group_object>[^\"]*)\"|[\s]*(?<group_object>[^\s]*))[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(\"(?<category>[^\"]*)\"|[\s]*(?<category>[^\s]*))[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-GET:11"
				add_field => {
					"[event][id]" => "GET:11"
					"[rsa][message][id1]" => "GET:11"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE GET:07
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}.%{fld2} %{duration_string} %{saddr} %{action}/%{resultcode} %{sbytes} %{web_method} %{url}" }
				id => "message-GET:07"
				add_field => {
					"[event][id]" => "GET:07"
					"[rsa][message][id1]" => "GET:07"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "HEAD" {
		# MESSAGE HEAD:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-HEAD:03"
				add_field => {
					"[event][id]" => "HEAD:03"
					"[rsa][message][id1]" => "HEAD:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-HEAD:04"
				add_field => {
					"[event][id]" => "HEAD:04"
					"[rsa][message][id1]" => "HEAD:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE HEAD
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-HEAD"
				add_field => {
					"[event][id]" => "HEAD"
					"[rsa][message][id1]" => "HEAD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-HEAD:01"
				add_field => {
					"[event][id]" => "HEAD:01"
					"[rsa][message][id1]" => "HEAD:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-HEAD:02"
				add_field => {
					"[event][id]" => "HEAD:02"
					"[rsa][message][id1]" => "HEAD:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE HEAD:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-HEAD:05"
				add_field => {
					"[event][id]" => "HEAD:05"
					"[rsa][message][id1]" => "HEAD:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE HEAD:06
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> - { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+\-[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-HEAD:06"
				add_field => {
					"[event][id]" => "HEAD:06"
					"[rsa][message][id1]" => "HEAD:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:07
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> "<user_agent>" { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+\"(?<user_agent>[^\"]*)\"[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-HEAD:07"
				add_field => {
					"[event][id]" => "HEAD:07"
					"[rsa][message][id1]" => "HEAD:07"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:08
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> { wbrs-threat-type= <category> cs-user-agent= "<user_agent>" cs-referer= "<web_referer>" | wbrs-threat-type= <category> cs-user-agent= - cs-referer= "<web_referer>" | wbrs-threat-type= <category> cs-user-agent= "<user_agent>" cs-referer= - | wbrs-threat-type= <category> cs-user-agent= - cs-referer= -| wbrs-threat-type= <category>} 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+([\s]*wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+\"(?<user_agent>[^\"]*)\"[\s]+cs\-referer=[\s]+\"(?<web_referer>[^\"]*)\"[\s]+|[\s]*wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+\-[\s]+cs\-referer=[\s]+\"(?<web_referer>[^\"]*)\"[\s]+|[\s]*wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+\"(?<user_agent>[^\"]*)\"[\s]+cs\-referer=[\s]+\-[\s]+|[\s]*wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+\-[\s]+cs\-referer=[\s]+\-|[\s]*wbrs\-threat\-type=[\s]+(?<category>[^\s]*))[\s]+$" }
				id => "message-HEAD:08"
				add_field => {
					"[event][id]" => "HEAD:08"
					"[rsa][message][id1]" => "HEAD:08"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:09
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+$" }
				id => "message-HEAD:09"
				add_field => {
					"[event][id]" => "HEAD:09"
					"[rsa][message][id1]" => "HEAD:09"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE HEAD:10
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-HEAD:10"
				add_field => {
					"[event][id]" => "HEAD:10"
					"[rsa][message][id1]" => "HEAD:10"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "LOCK" {
		# MESSAGE LOCK:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-LOCK:03"
				add_field => {
					"[event][id]" => "LOCK:03"
					"[rsa][message][id1]" => "LOCK:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE LOCK:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-LOCK:04"
				add_field => {
					"[event][id]" => "LOCK:04"
					"[rsa][message][id1]" => "LOCK:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE LOCK
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-LOCK"
				add_field => {
					"[event][id]" => "LOCK"
					"[rsa][message][id1]" => "LOCK"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE LOCK:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-LOCK:01"
				add_field => {
					"[event][id]" => "LOCK:01"
					"[rsa][message][id1]" => "LOCK:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE LOCK:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-LOCK:02"
				add_field => {
					"[event][id]" => "LOCK:02"
					"[rsa][message][id1]" => "LOCK:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE LOCK:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-LOCK:05"
				add_field => {
					"[event][id]" => "LOCK:05"
					"[rsa][message][id1]" => "LOCK:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "POST" {
		# MESSAGE POST:11
		# line in RSA: <saddr> "<username_fld>@<fld1>" <fld2> [<fld20>  <timezone>] "<web_method> <url> <resultcode> <fld10> <action>:<fld3> <duration_string> <policyname> <fld6> s-ip= <daddr> s-port= <dport> {sc-bytes | sc_bytes}= <sbytes> cs-username= {"<username>"|<username>} s-hostname=<hostname> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= {"<group_object>"| <group_object>} c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= {"<result>" | <result>} wbrs-threat-type= {"<category>"| <category>} cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<saddr>[^\s]*)[\s]+\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld10>[^\s]*)[\s]+(?<action>[^:]*):(?<fld3>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+(?<fld6>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+(sc\-bytes[\s]+|[\s]*sc_bytes)=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+(\"(?<username>[^\"]*)\"|(?<username>[^\s]*))[\s]+s\-hostname=(?<hostname>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(\"(?<group_object>[^\"]*)\"|[\s]*(?<group_object>[^\s]*))[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(\"(?<result>[^\"]*)\"[\s]+|[\s]*(?<result>[^\s]*))[\s]+wbrs\-threat\-type=[\s]+(\"(?<category>[^\"]*)\"|[\s]*(?<category>[^\s]*))[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)[\s]+$" }
				id => "message-POST:11"
				add_field => {
					"[event][id]" => "POST:11"
					"[rsa][message][id1]" => "POST:11"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-POST:03"
				add_field => {
					"[event][id]" => "POST:03"
					"[rsa][message][id1]" => "POST:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> <sdomain_fld>\<username_fld>@<fld51> <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>"| <web_cookie>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"|[\s]*(?<web_cookie>.*))$" }
				id => "message-POST:04"
				add_field => {
					"[event][id]" => "POST:04"
					"[rsa][message][id1]" => "POST:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POST:12
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> <sdomain_fld>\<username_fld> <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>"| <web_cookie>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"|[\s]*(?<web_cookie>.*))$" }
				id => "message-POST:12"
				add_field => {
					"[event][id]" => "POST:12"
					"[rsa][message][id1]" => "POST:12"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POST:13
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> <username_fld> <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>"| <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<username_fld>[^\s]*)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-POST:13"
				add_field => {
					"[event][id]" => "POST:13"
					"[rsa][message][id1]" => "POST:13"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POST
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-POST"
				add_field => {
					"[event][id]" => "POST"
					"[rsa][message][id1]" => "POST"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POST:01"
				add_field => {
					"[event][id]" => "POST:01"
					"[rsa][message][id1]" => "POST:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:09
		# line in RSA:  <fld15>.<fld16> <duration_string> <saddr> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> {"<filter>"|-} {"<user_agent>"|-} {"<fld21>"|-}  "<fld22> <timezone>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld15>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(\"(?<filter>[^\"]*)\"|\-)[\s]+(\"(?<user_agent>[^\"]*)\"|\-)[\s]+(\"(?<fld21>[^\"]*)\"|\-)[\s]+\"(?<fld22>[^\s]*)[\s]+(?<timezone>[^\"]*)\"$" }
				id => "message-POST:09"
				add_field => {
					"[event][id]" => "POST:09"
					"[rsa][message][id1]" => "POST:09"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POST:02"
				add_field => {
					"[event][id]" => "POST:02"
					"[rsa][message][id1]" => "POST:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POST:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POST:05"
				add_field => {
					"[event][id]" => "POST:05"
					"[rsa][message][id1]" => "POST:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POST:06
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POST:06"
				add_field => {
					"[event][id]" => "POST:06"
					"[rsa][message][id1]" => "POST:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:07
		# line in RSA:  <saddr> - <fld2> [<fld20> <timezone>] "<web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> { - | "<user_agent>" } <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+\-[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+(?<fld19>.*)$" }
				id => "message-POST:07"
				add_field => {
					"[event][id]" => "POST:07"
					"[rsa][message][id1]" => "POST:07"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POST:08
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-POST:08"
				add_field => {
					"[event][id]" => "POST:08"
					"[rsa][message][id1]" => "POST:08"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PROPFIND" {
		# MESSAGE PROPFIND:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PROPFIND:03"
				add_field => {
					"[event][id]" => "PROPFIND:03"
					"[rsa][message][id1]" => "PROPFIND:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE PROPFIND:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PROPFIND:04"
				add_field => {
					"[event][id]" => "PROPFIND:04"
					"[rsa][message][id1]" => "PROPFIND:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PROPFIND
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-PROPFIND"
				add_field => {
					"[event][id]" => "PROPFIND"
					"[rsa][message][id1]" => "PROPFIND"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE PROPFIND:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-PROPFIND:01"
				add_field => {
					"[event][id]" => "PROPFIND:01"
					"[rsa][message][id1]" => "PROPFIND:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE PROPFIND:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-PROPFIND:02"
				add_field => {
					"[event][id]" => "PROPFIND:02"
					"[rsa][message][id1]" => "PROPFIND:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PROPFIND:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-PROPFIND:05"
				add_field => {
					"[event][id]" => "PROPFIND:05"
					"[rsa][message][id1]" => "PROPFIND:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PROPFIND:06
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PROPFIND:06"
				add_field => {
					"[event][id]" => "PROPFIND:06"
					"[rsa][message][id1]" => "PROPFIND:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "TUNNEL" {
		# MESSAGE TUNNEL:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-TUNNEL:03"
				add_field => {
					"[event][id]" => "TUNNEL:03"
					"[rsa][message][id1]" => "TUNNEL:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE TUNNEL:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-TUNNEL:04"
				add_field => {
					"[event][id]" => "TUNNEL:04"
					"[rsa][message][id1]" => "TUNNEL:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE TUNNEL
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-TUNNEL"
				add_field => {
					"[event][id]" => "TUNNEL"
					"[rsa][message][id1]" => "TUNNEL"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE TUNNEL:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-TUNNEL:01"
				add_field => {
					"[event][id]" => "TUNNEL:01"
					"[rsa][message][id1]" => "TUNNEL:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE TUNNEL:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-TUNNEL:02"
				add_field => {
					"[event][id]" => "TUNNEL:02"
					"[rsa][message][id1]" => "TUNNEL:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE TUNNEL:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-TUNNEL:05"
				add_field => {
					"[event][id]" => "TUNNEL:05"
					"[rsa][message][id1]" => "TUNNEL:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "OPTIONS" {
		# MESSAGE OPTIONS:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-OPTIONS:03"
				add_field => {
					"[event][id]" => "OPTIONS:03"
					"[rsa][message][id1]" => "OPTIONS:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE OPTIONS:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-OPTIONS:04"
				add_field => {
					"[event][id]" => "OPTIONS:04"
					"[rsa][message][id1]" => "OPTIONS:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE OPTIONS:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-OPTIONS:01"
				add_field => {
					"[event][id]" => "OPTIONS:01"
					"[rsa][message][id1]" => "OPTIONS:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE OPTIONS:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-OPTIONS:02"
				add_field => {
					"[event][id]" => "OPTIONS:02"
					"[rsa][message][id1]" => "OPTIONS:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE OPTIONS:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-OPTIONS:05"
				add_field => {
					"[event][id]" => "OPTIONS:05"
					"[rsa][message][id1]" => "OPTIONS:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE OPTIONS:06
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-OPTIONS:06"
				add_field => {
					"[event][id]" => "OPTIONS:06"
					"[rsa][message][id1]" => "OPTIONS:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "TCP_CONNECT" {
		# MESSAGE TCP_CONNECT:05
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-TCP_CONNECT:05"
				add_field => {
					"[event][id]" => "TCP_CONNECT:05"
					"[rsa][message][id1]" => "TCP_CONNECT:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE TCP_CONNECT:06
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-TCP_CONNECT:06"
				add_field => {
					"[event][id]" => "TCP_CONNECT:06"
					"[rsa][message][id1]" => "TCP_CONNECT:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE TCP_CONNECT:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-TCP_CONNECT:01"
				add_field => {
					"[event][id]" => "TCP_CONNECT:01"
					"[rsa][message][id1]" => "TCP_CONNECT:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE TCP_CONNECT:03
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld2> "<fld20> <timezone>" <web_method> <fld32> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - |"<user_agent>" | <user_agent> } { "<filter>" | <filter> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<fld32>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+([\s]*\"(?<filter>[^\"]*)\"[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)$" }
				id => "message-TCP_CONNECT:03"
				add_field => {
					"[event][id]" => "TCP_CONNECT:03"
					"[rsa][message][id1]" => "TCP_CONNECT:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE TCP_CONNECT:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-TCP_CONNECT:02"
				add_field => {
					"[event][id]" => "TCP_CONNECT:02"
					"[rsa][message][id1]" => "TCP_CONNECT:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE TCP_CONNECT:04
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-TCP_CONNECT:04"
				add_field => {
					"[event][id]" => "TCP_CONNECT:04"
					"[rsa][message][id1]" => "TCP_CONNECT:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "DELETE" {
		# MESSAGE DELETE
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-DELETE"
				add_field => {
					"[event][id]" => "DELETE"
					"[rsa][message][id1]" => "DELETE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE DELETE:01
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-DELETE:01"
				add_field => {
					"[event][id]" => "DELETE:01"
					"[rsa][message][id1]" => "DELETE:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PROPPATCH" {
		# MESSAGE PROPPATCH
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PROPPATCH"
				add_field => {
					"[event][id]" => "PROPPATCH"
					"[rsa][message][id1]" => "PROPPATCH"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PROPPATCH:01
		# line in RSA:  <saddr> - - [<fld20> <timezone>] "<web_method> <url>" <resultcode> <fld13> <action>:<fld30> <duration_string> <policyname> <<<fld17>,<reputation_num>,<fld18>> - s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= { - | <fld12> } wbrs-threat-type= <result> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+\-[\s]+\-[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),(?<reputation_num>[^,]*),(?<fld18>[^>]*)>[\s]+\-[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+([\s]*\-[\s]+|[\s]*(?<fld12>[^\s]*)[\s]+)[\s]+wbrs\-threat\-type=[\s]+(?<result>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)[\s]+$" }
				id => "message-PROPPATCH:01"
				add_field => {
					"[event][id]" => "PROPPATCH:01"
					"[rsa][message][id1]" => "PROPPATCH:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId1
	# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
	else if [logstash][msgparser][id] == "msgParserId1" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
			id => "msgParserId1"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
		}
	}
	# PARSER msgParserId27
	# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> {"<sdomain_fld>\<username_fld>@<fld51>"|"<username_fld>@<fld1>"|"<sdomain_fld>\<username_fld>"|"<username_fld>" } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
	else if [logstash][msgparser][id] == "msgParserId27" {
		grok {
			match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
			id => "msgParserId27"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
		}
	}
	else if [logstash][msgparser][id] == "Info" {
		# MESSAGE Info:dlp
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Info: <duration_string> <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld17> <<<<<filename>,<content_type>,<bytes>>> <policyname> <fld2> <url> <fld3>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld6>[^\s]*)[\s]+(?<fld7>[^\s]*)[\s]+(?<fld8>[^\s]*)[\s]+(?<fld9>[^\s]*)[\s]+(?<fld10>[^\s]*)[\s]+Info:[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld17>[^\s]*)[\s]+<<(?<filename>[^,]*),(?<content_type>[^,]*),(?<bytes>[^>]*)>>[\s]+(?<policyname>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<fld3>.*)$" }
				id => "message-Info:dlp"
				add_field => {
					"[event][id]" => "Info:dlp"
					"[rsa][message][id1]" => "Info:dlp"
					"[event][categoryid]" => "1206000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE 000001
		# line in RSA:  <fld20> <fld21> <fld22> Info: PID <parent_pid>: User { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } login from <saddr> on <fld1>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\s]*)[\s]+(?<fld21>[^\s]*)[\s]+(?<fld22>[^\s]*)[\s]+Info:[\s]+PID[\s]+(?<parent_pid>[^:]*):[\s]+User[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+login[\s]+from[\s]+(?<saddr>[^\s]*)[\s]+on[\s]+(?<fld1>.*)$" }
				id => "message-000001"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"action" => "user login"
					"[event][id]" => "000001"
					"[rsa][message][id1]" => "000001"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21} %{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE 000002
		# line in RSA:  <fld20> <fld21> <fld22> Info: PID <parent_pid>: User { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } logged out of <fld2>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\s]*)[\s]+(?<fld21>[^\s]*)[\s]+(?<fld22>[^\s]*)[\s]+Info:[\s]+PID[\s]+(?<parent_pid>[^:]*):[\s]+User[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+logged[\s]+out[\s]+of[\s]+(?<fld2>.*)$" }
				id => "message-000002"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"ec_theme" => "Authentication"
				"action" => "user logout"
					"[event][id]" => "000002"
					"[rsa][message][id1]" => "000002"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21} %{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE 000003
		# line in RSA:  <fld20> <fld21> <fld22> Info: PID <parent_pid>: User { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } executed batch command: '<fld2>'
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\s]*)[\s]+(?<fld21>[^\s]*)[\s]+(?<fld22>[^\s]*)[\s]+Info:[\s]+PID[\s]+(?<parent_pid>[^:]*):[\s]+User[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+executed[\s]+batch[\s]+command:[\s]+'(?<fld2>[^']*)'$" }
				id => "message-000003"
				add_field => {
				"action" => "user executed batch command"
					"[event][id]" => "000003"
					"[rsa][message][id1]" => "000003"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21} %{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE 000004
		# line in RSA:  <fld20> <fld21> <fld22> Info: PID <parent_pid>: User { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } entered '<fld1>'; prompt was '<fld2>'
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\s]*)[\s]+(?<fld21>[^\s]*)[\s]+(?<fld22>[^\s]*)[\s]+Info:[\s]+PID[\s]+(?<parent_pid>[^:]*):[\s]+User[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+entered[\s]+'(?<fld1>[^']*)';[\s]+prompt[\s]+was[\s]+'(?<fld2>[^']*)'$" }
				id => "message-000004"
				add_field => {
				"action" => "user entered action"
					"[event][id]" => "000004"
					"[rsa][message][id1]" => "000004"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21} %{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE 000005
		# line in RSA:  <fld20> <fld21> <fld22> Info: <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld20} %{fld21} %{fld22} Info: %{event_description}" }
				id => "message-000005"
				add_field => {
					"[event][id]" => "000005"
					"[rsa][message][id1]" => "000005"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21} %{fld22}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Warning" {
		# MESSAGE Warning:PROX_AUTH
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Warning: <logon_type> : - : [<domain>]<fld11>: <fld17> machine <hostname> <result>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld6} %{fld7} %{fld8} %{fld9} %{fld10} Warning: %{logon_type} : - : [%{domain}]%{fld11}: %{fld17} machine %{hostname} %{result}" }
				id => "message-Warning:PROX_AUTH"
				add_field => {
					"[event][id]" => "Warning:PROX_AUTH"
					"[rsa][message][id1]" => "Warning:PROX_AUTH"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE Warning:dlp
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Warning: <duration_string> <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld17> <<<<<filename>,<content_type>,<bytes>>> <policyname> <fld2> <url> <fld3>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld6>[^\s]*)[\s]+(?<fld7>[^\s]*)[\s]+(?<fld8>[^\s]*)[\s]+(?<fld9>[^\s]*)[\s]+(?<fld10>[^\s]*)[\s]+Warning:[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld17>[^\s]*)[\s]+<<(?<filename>[^,]*),(?<content_type>[^,]*),(?<bytes>[^>]*)>>[\s]+(?<policyname>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<fld3>.*)$" }
				id => "message-Warning:dlp"
				add_field => {
					"[event][id]" => "Warning:dlp"
					"[rsa][message][id1]" => "Warning:dlp"
					"[event][categoryid]" => "1206000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE Warning
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Warning: <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld6} %{fld7} %{fld8} %{fld9} %{fld10} Warning: %{event_description}" }
				id => "message-Warning"
				add_field => {
					"[event][id]" => "Warning"
					"[rsa][message][id1]" => "Warning"
					"[event][categoryid]" => "1605020000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "SEARCH" {
		# MESSAGE SEARCH:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-SEARCH:03"
				add_field => {
					"[event][id]" => "SEARCH:03"
					"[rsa][message][id1]" => "SEARCH:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE SEARCH:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-SEARCH:04"
				add_field => {
					"[event][id]" => "SEARCH:04"
					"[rsa][message][id1]" => "SEARCH:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE SEARCH
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-SEARCH"
				add_field => {
					"[event][id]" => "SEARCH"
					"[rsa][message][id1]" => "SEARCH"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE SEARCH:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-SEARCH:01"
				add_field => {
					"[event][id]" => "SEARCH:01"
					"[rsa][message][id1]" => "SEARCH:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE SEARCH:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-SEARCH:02"
				add_field => {
					"[event][id]" => "SEARCH:02"
					"[rsa][message][id1]" => "SEARCH:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE SEARCH:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-SEARCH:05"
				add_field => {
					"[event][id]" => "SEARCH:05"
					"[rsa][message][id1]" => "SEARCH:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "SUBSCRIBE" {
		# MESSAGE SUBSCRIBE:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-SUBSCRIBE:03"
				add_field => {
					"[event][id]" => "SUBSCRIBE:03"
					"[rsa][message][id1]" => "SUBSCRIBE:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE SUBSCRIBE:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-SUBSCRIBE:04"
				add_field => {
					"[event][id]" => "SUBSCRIBE:04"
					"[rsa][message][id1]" => "SUBSCRIBE:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE SUBSCRIBE
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-SUBSCRIBE"
				add_field => {
					"[event][id]" => "SUBSCRIBE"
					"[rsa][message][id1]" => "SUBSCRIBE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE SUBSCRIBE:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-SUBSCRIBE:01"
				add_field => {
					"[event][id]" => "SUBSCRIBE:01"
					"[rsa][message][id1]" => "SUBSCRIBE:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE SUBSCRIBE:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-SUBSCRIBE:02"
				add_field => {
					"[event][id]" => "SUBSCRIBE:02"
					"[rsa][message][id1]" => "SUBSCRIBE:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE SUBSCRIBE:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-SUBSCRIBE:05"
				add_field => {
					"[event][id]" => "SUBSCRIBE:05"
					"[rsa][message][id1]" => "SUBSCRIBE:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "POLL" {
		# MESSAGE POLL:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-POLL:03"
				add_field => {
					"[event][id]" => "POLL:03"
					"[rsa][message][id1]" => "POLL:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POLL:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-POLL:04"
				add_field => {
					"[event][id]" => "POLL:04"
					"[rsa][message][id1]" => "POLL:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POLL
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-POLL"
				add_field => {
					"[event][id]" => "POLL"
					"[rsa][message][id1]" => "POLL"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POLL:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POLL:01"
				add_field => {
					"[event][id]" => "POLL:01"
					"[rsa][message][id1]" => "POLL:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE POLL:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POLL:02"
				add_field => {
					"[event][id]" => "POLL:02"
					"[rsa][message][id1]" => "POLL:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE POLL:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-POLL:05"
				add_field => {
					"[event][id]" => "POLL:05"
					"[rsa][message][id1]" => "POLL:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PUT" {
		# MESSAGE PUT:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PUT:03"
				add_field => {
					"[event][id]" => "PUT:03"
					"[rsa][message][id1]" => "PUT:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE PUT:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PUT:04"
				add_field => {
					"[event][id]" => "PUT:04"
					"[rsa][message][id1]" => "PUT:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PUT
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-PUT"
				add_field => {
					"[event][id]" => "PUT"
					"[rsa][message][id1]" => "PUT"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE PUT:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-PUT:01"
				add_field => {
					"[event][id]" => "PUT:01"
					"[rsa][message][id1]" => "PUT:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE PUT:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-PUT:02"
				add_field => {
					"[event][id]" => "PUT:02"
					"[rsa][message][id1]" => "PUT:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PUT:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>} <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>[^\s]*))[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-PUT:05"
				add_field => {
					"[event][id]" => "PUT:05"
					"[rsa][message][id1]" => "PUT:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE PUT:06
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | <filter> } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | <user_agent> } cs-referer= { - | <web_referer> } cs-cookie= { - | <web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*(?<filter>[^\s]*)[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*(?<user_agent>[^\s]*)[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*(?<web_referer>[^\s]*)[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-PUT:06"
				add_field => {
					"[event][id]" => "PUT:06"
					"[rsa][message][id1]" => "PUT:06"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "REPORT" {
		# MESSAGE REPORT:03
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-REPORT:03"
				add_field => {
					"[event][id]" => "REPORT:03"
					"[rsa][message][id1]" => "REPORT:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE REPORT:04
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-REPORT:04"
				add_field => {
					"[event][id]" => "REPORT:04"
					"[rsa][message][id1]" => "REPORT:04"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE REPORT
		# line in RSA:  <saddr> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld>@<fld1>|-|<username_fld> } <fld2> [<fld20> <timezone>] "<web_method> <url> <version>" <resultcode> <rbytes> <action>:<fld4> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld19>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^@]*)@(?<fld1>[^\s]*)|\-|(?<username_fld>[^\s]*)[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<version>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld4>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld19>.*)$" }
				id => "message-REPORT"
				add_field => {
					"[event][id]" => "REPORT"
					"[rsa][message][id1]" => "REPORT"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE REPORT:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> "<fld20> <timezone>" <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\"(?<fld20>[^\s]*)[\s]+(?<timezone>[^\"]*)\"[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-REPORT:01"
				add_field => {
					"[event][id]" => "REPORT:01"
					"[rsa][message][id1]" => "REPORT:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE REPORT:02
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-REPORT:02"
				add_field => {
					"[event][id]" => "REPORT:02"
					"[rsa][message][id1]" => "REPORT:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE REPORT:05
		# line in RSA:  <fld20>.<fld16> <duration_string> <saddr> <daddr> <dport> <action>/<resultcode> <rbytes> <web_method> <url> { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|"<username_fld>@<fld1>" | "(Unauthenticated)<fld1>" | - |<username_fld>}<fld30> <content_type> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> { "<user_agent>" | - } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld20>[^\.]*)\.(?<fld16>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>.*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>.*)|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"[\s]+|[\s]*\"\(Unauthenticated\)(?<fld1>[^\"]*)\"[\s]+|[\s]*\-[\s]+|(?<username_fld>.*))(?<fld30>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+([\s]*\"(?<user_agent>[^\"]*)\"[\s]+|[\s]*\-[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-REPORT:05"
				add_field => {
					"[event][id]" => "REPORT:05"
					"[rsa][message][id1]" => "REPORT:05"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "NLST" {
		# MESSAGE NLST
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-NLST"
				add_field => {
					"[event][id]" => "NLST"
					"[rsa][message][id1]" => "NLST"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE NLST:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-NLST:01"
				add_field => {
					"[event][id]" => "NLST:01"
					"[rsa][message][id1]" => "NLST:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "RETR" {
		# MESSAGE RETR
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-RETR"
				add_field => {
					"[event][id]" => "RETR"
					"[rsa][message][id1]" => "RETR"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE RETR:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-RETR:01"
				add_field => {
					"[event][id]" => "RETR:01"
					"[rsa][message][id1]" => "RETR:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE RETR:02
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld23>/<fld24> <content_type> <policyname> <<<info>> - s-ip=<daddr> s-port=<dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld23>[^/]*)/(?<fld24>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+\-[\s]+s\-ip=(?<daddr>[^\s]*)[\s]+s\-port=(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-RETR:02"
				add_field => {
					"[event][id]" => "RETR:02"
					"[rsa][message][id1]" => "RETR:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "LIST" {
		# MESSAGE LIST
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-LIST"
				add_field => {
					"[event][id]" => "LIST"
					"[rsa][message][id1]" => "LIST"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE LIST:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-LIST:01"
				add_field => {
					"[event][id]" => "LIST:01"
					"[rsa][message][id1]" => "LIST:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE LIST:02
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> {"<sdomain_fld>\<username_fld>@<fld51>"|"<username_fld>@<fld1>"|"<sdomain_fld>\<username_fld>"|"<username_fld>" } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-LIST:02"
				add_field => {
					"[event][id]" => "LIST:02"
					"[rsa][message][id1]" => "LIST:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "MKCOL" {
		# MESSAGE MKCOL
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-MKCOL"
				add_field => {
					"[event][id]" => "MKCOL"
					"[rsa][message][id1]" => "MKCOL"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE MKCOL:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-MKCOL:01"
				add_field => {
					"[event][id]" => "MKCOL:01"
					"[rsa][message][id1]" => "MKCOL:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE MKCOL:02
		# line in RSA: <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> "{ <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> }" <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= "<group_object>" c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= { - | <result>} wbrs-threat-type= { - | <category>} cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+\"([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)|(?<username_fld>[^\s]*)[\s]+)\"[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+\"(?<group_object>[^\"]*)\"[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+([\s]*\-[\s]+|[\s]*(?<result>[^\s]*))[\s]+wbrs\-threat\-type=[\s]+([\s]*\-[\s]+|[\s]*(?<category>[^\s]*))[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-MKCOL:02"
				add_field => {
					"[event][id]" => "MKCOL:02"
					"[rsa][message][id1]" => "MKCOL:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "USER" {
		# MESSAGE USER
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-USER"
				add_field => {
					"[event][id]" => "USER"
					"[rsa][message][id1]" => "USER"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE USER:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-USER:01"
				add_field => {
					"[event][id]" => "USER:01"
					"[rsa][message][id1]" => "USER:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "STOR" {
		# MESSAGE STOR
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "<web_method> <url>" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-STOR"
				add_field => {
					"[event][id]" => "STOR"
					"[rsa][message][id1]" => "STOR"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE STOR:01
		# line in RSA:  <saddr> { "<sdomain_fld>\<username_fld>@<fld51>"|"<sdomain_fld>\<username_fld>"| -|"<username_fld>"  } <fld2> [<fld20> <timezone>] <web_method> <url> <resultcode> <rbytes> <action>:<fld30> <duration_string> <policyname> <<<fld17>,{ ns | <reputation_num> },<fld18>> <fld16> <daddr> <dport> { - | "<user_agent>" } { - | "<filter>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+([\s]*\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|[\s]*\-|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+),(?<fld18>[^>]*)>[\s]+(?<fld16>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)$" }
				id => "message-STOR:01"
				add_field => {
					"[event][id]" => "STOR:01"
					"[rsa][message][id1]" => "STOR:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE STOR:02
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> {"<sdomain_fld>\<username_fld>@<fld51>"|"<username_fld>@<fld1>"|"<sdomain_fld>\<username_fld>"|"<username_fld>" } <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)\"|\"(?<username_fld>[^@]*)@(?<fld1>[^\"]*)\"|\"(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)\"|\"(?<username_fld>[^\"]*)\"[\s]+)[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-STOR:02"
				add_field => {
					"[event][id]" => "STOR:02"
					"[rsa][message][id1]" => "STOR:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "-" {
		# MESSAGE -
		# line in RSA:  <saddr> <fld1> <fld2> [<fld3> <timezone>] "" <resultcode> <fld4> <action>:<fld6> <duration_string> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+\[(?<fld3>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+(?<action>[^:]*):(?<fld6>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message--"
				add_field => {
					"[event][id]" => "-"
					"[rsa][message][id1]" => "-"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "d/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE -:01
		# line in RSA:  <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> - <fld4>/<fld5> <fld7> - s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { - | ns | <reputation_num> } wbrs-threat-reason= <result> wbrs-threat-type= <category> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+\-[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<fld7>[^\s]*)[\s]+\-[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*\-[\s]+|[\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+(?<result>[^\s]*)[\s]+wbrs\-threat\-type=[\s]+(?<category>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+)$" }
				id => "message--:01"
				add_field => {
					"[event][id]" => "-:01"
					"[rsa][message][id1]" => "-:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
		# MESSAGE -:02
		# line in RSA: <fld1> <fld2>] [<severity>] [client <saddr>] ModSecurity: <fld31> [id "<fld12>"][file <filename>][line "<fld7>"] - <fld8>. [hostname "<hostname>"] [uri "<fld32>"] [unique_id "<fld9>"]
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1} %{fld2}] [%{severity}] [client %{saddr}] ModSecurity: %{fld31} [id \"%{fld12}\"][file %{filename}][line \"%{fld7}\"] - %{fld8}. [hostname \"%{hostname}\"] [uri \"%{fld32}\"] [unique_id \"%{fld9}\"]" }
				id => "message--:02"
				add_field => {
					"[event][id]" => "-:02"
					"[rsa][message][id1]" => "-:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "MOVE" {
		# MESSAGE MOVE
		# line in RSA:  <saddr> - - [<fld20> <timezone>] "<web_method> <url>" <resultcode> <fld13> <action>:<fld30> <duration_string> <policyname> <<<fld17>,<reputation_num>,<fld18>> - s-ip= <daddr> s-port= <dport> sc-bytes= <sbytes> cs-username= { <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> } s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= <group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= { - | <fld12> } wbrs-threat-type= <result> cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> } 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+\-[\s]+\-[\s]+\[(?<fld20>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<url>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<action>[^:]*):(?<fld30>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<fld17>[^,]*),(?<reputation_num>[^,]*),(?<fld18>[^>]*)>[\s]+\-[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+sc\-bytes=[\s]+(?<sbytes>[^\s]*)[\s]+cs\-username=[\s]+([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\s]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\s]*)|(?<username_fld>[^\s]*)[\s]+)[\s]+s\-hostname=[\s]+(?<dhost>[^\s]*)[\s]+cs\-mime\-type=[\s]+(?<content_type>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+(?<group_object>[^\s]*)[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+([\s]*\-[\s]+|[\s]*(?<fld12>[^\s]*)[\s]+)[\s]+wbrs\-threat\-type=[\s]+(?<result>[^\s]*)[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)[\s]+$" }
				id => "message-MOVE"
				add_field => {
					"[event][id]" => "MOVE"
					"[rsa][message][id1]" => "MOVE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld20}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE MOVE:02
		# line in RSA: <fld1>.<fld2> <duration_string> <saddr> <action>/<resultcode> <sbytes> <web_method> <url> "{ <sdomain_fld>\<username_fld>@<fld51>|<sdomain_fld>\<username_fld>|<username_fld> }" <fld4>/<fld5> <content_type> <policyname> <<<info>> <fld7> s-ip= <daddr> s-port= <dport> webcat-code= { - | "<filter>" } cs-version= <fld11> cs-auth-group= "<group_object>" c-port= <sport> cs-bytes= <rbytes> wbrs-score= { ns | <reputation_num> } wbrs-threat-reason= { - | <result>} wbrs-threat-type= { - | <category>} cs-user-agent= { - | "<user_agent>" } cs-referer= { - | "<web_referer>" } cs-cookie= { - | "<web_cookie>" | "<web_cookie> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld1>[^\.]*)\.(?<fld2>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<saddr>[^\s]*)[\s]+(?<action>[^/]*)/(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+\"([\s]*(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^@]*)@(?<fld51>[^\"]*)|(?<sdomain_fld>[^\\]*)\\(?<username_fld>[^\"]*)|(?<username_fld>[^\s]*)[\s]+)\"[\s]+(?<fld4>[^/]*)/(?<fld5>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<policyname>[^\s]*)[\s]+<(?<info>[^>]*)>[\s]+(?<fld7>[^\s]*)[\s]+s\-ip=[\s]+(?<daddr>[^\s]*)[\s]+s\-port=[\s]+(?<dport>[^\s]*)[\s]+webcat\-code=[\s]+([\s]*\-[\s]+|[\s]*\"(?<filter>[^\"]*)\"[\s]+)[\s]+cs\-version=[\s]+(?<fld11>[^\s]*)[\s]+cs\-auth\-group=[\s]+\"(?<group_object>[^\"]*)\"[\s]+c\-port=[\s]+(?<sport>[^\s]*)[\s]+cs\-bytes=[\s]+(?<rbytes>[^\s]*)[\s]+wbrs\-score=[\s]+([\s]*ns[\s]+|[\s]*(?<reputation_num>[^\s]*)[\s]+)[\s]+wbrs\-threat\-reason=[\s]+([\s]*\-[\s]+|[\s]*(?<result>[^\s]*))[\s]+wbrs\-threat\-type=[\s]+([\s]*\-[\s]+|[\s]*(?<category>[^\s]*))[\s]+cs\-user\-agent=[\s]+([\s]*\-[\s]+|[\s]*\"(?<user_agent>[^\"]*)\"[\s]+)[\s]+cs\-referer=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_referer>[^\"]*)\"[\s]+)[\s]+cs\-cookie=[\s]+([\s]*\-[\s]+|[\s]*\"(?<web_cookie>[^\"]*)\"[\s]+|[\s]*\"(?<web_cookie>[^\s]*)[\s]+)$" }
				id => "message-MOVE:02"
				add_field => {
					"[event][id]" => "MOVE:02"
					"[rsa][message][id1]" => "MOVE:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "UNIX" ] }
			}
		}
	}
	# PARSER msgParserId45
	# line in RSA: <event_description>
	else if [logstash][msgparser][id] == "msgParserId45" {
		dissect {
			mapping => { "message" => "%{event_description}" }
			id => "msgParserId45"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId46
	# line in RSA: <msg>
	else if [logstash][msgparser][id] == "msgParserId46" {
		dissect {
			mapping => { "message" => "%{msg}" }
			id => "msgParserId46"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "system_logs" {
		# MESSAGE system_logs
		# line in RSA: <info> to remote host {<saddr>:<sport> | <saddr> <sport>| <saddr>} 
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<info>[^\s]*)[\s]+to[\s]+remote[\s]+host[\s]+((?<saddr>[^:]*):(?<sport>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+(?<sport>[^\s]*)|[\s]*(?<saddr>[^\s]*))[\s]+$" }
				id => "message-system_logs"
				add_field => {
					"[event][id]" => "system_logs"
					"[rsa][message][id1]" => "system_logs"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE system_logs:01
		# line in RSA: <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{event_description}" }
				id => "message-system_logs:01"
				add_field => {
					"[event][id]" => "system_logs:01"
					"[rsa][message][id1]" => "system_logs:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId48
	# line in RSA: <info> to remote host {<saddr>:<sport> | <saddr> <sport>| <saddr>}
	else if [logstash][msgparser][id] == "msgParserId48" {
		grok {
			match => { "message" => "^(?<info>[^\s]*)[\s]+to[\s]+remote[\s]+host[\s]+((?<saddr>[^:]*):(?<sport>[^\s]*)[\s]+|[\s]*(?<saddr>[^\s]*)[\s]+(?<sport>.*)|[\s]*(?<saddr>.*))$" }
			id => "msgParserId48"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "Critical" {
		# MESSAGE Critical:PROX_AUTH
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Critical: <logon_type> : - : [<domain>]<info>: <event_description>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld6} %{fld7} %{fld8} %{fld9} %{fld10} Critical: %{logon_type} : - : [%{domain}]%{info}: %{event_description}" }
				id => "message-Critical:PROX_AUTH"
				add_field => {
					"[event][id]" => "Critical:PROX_AUTH"
					"[rsa][message][id1]" => "Critical:PROX_AUTH"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE Critical:01
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Critical: <logon_type> : <result> : SCP failed to transfer to <daddr>:<dport>: <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld6} %{fld7} %{fld8} %{fld9} %{fld10} Critical: %{logon_type} : %{result} : SCP failed to transfer to %{daddr}:%{dport}: %{info}" }
				id => "message-Critical:01"
				add_field => {
					"[event][id]" => "Critical:01"
					"[rsa][message][id1]" => "Critical:01"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE Critical:02
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Critical: <logon_type> : <result> : DNS Hard Error looking up <url> <fld11>: <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld6} %{fld7} %{fld8} %{fld9} %{fld10} Critical: %{logon_type} : %{result} : DNS Hard Error looking up %{url} %{fld11}: %{info}" }
				id => "message-Critical:02"
				add_field => {
					"[event][id]" => "Critical:02"
					"[rsa][message][id1]" => "Critical:02"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
		# MESSAGE Critical:03
		# line in RSA:  <fld6> <fld7> <fld8> <fld9> <fld10> Critical: Internal SMTP giving up on message to <url> with subject <subject>: <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld6} %{fld7} %{fld8} %{fld9} %{fld10} Critical: Internal SMTP giving up on message to %{url} with subject %{subject}: %{info}" }
				id => "message-Critical:03"
				add_field => {
					"[event][id]" => "Critical:03"
					"[rsa][message][id1]" => "Critical:03"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld6} %{fld7} %{fld8} %{fld9}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d H:m:s yyyy" ] }
			}
		}
	}
	# PARSER msgParserId53
	# line in RSA: s-port= <dport> sc-bytes= <sbytes> cs-username= <username> s-hostname= <dhost> cs-mime-type= <content_type> webcat-code= <p_filter> cs-version= <fld11> cs-auth-group= <p_group_object> c-port= <sport> cs-bytes= <rbytes> wbrs-score= <reputation_num> wbrs-threat-reason= <fld12> wbrs-threat-type= <result> cs-user-agent= <p_user_agent> cs-referer= <p_web_referer> cs-cookie= <p_web_cookie> 
	else if [logstash][msgparser][id] == "msgParserId53" {
		dissect {
			mapping => { "message" => "s-port= %{dport} sc-bytes= %{sbytes} cs-username= %{username} s-hostname= %{dhost} cs-mime-type= %{content_type} webcat-code= %{p_filter} cs-version= %{fld11} cs-auth-group= %{p_group_object} c-port= %{sport} cs-bytes= %{rbytes} wbrs-score= %{reputation_num} wbrs-threat-reason= %{fld12} wbrs-threat-type= %{result} cs-user-agent= %{p_user_agent} cs-referer= %{p_web_referer} cs-cookie= %{p_web_cookie}" }
			id => "msgParserId53"
			add_field => {
				"url" => "%{p_url}"
				"web_method" => "%{p_web_method}"
				"vid" => "%{web_method}"
				"[logstash][fullDateTimeString]" => "%{p_time1}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}

# Enrich events using VALUEMAP
filter {
	translate {
		field => "[fld11]"
		destination => "[protocol]"
		dictionary => {
			"0" => "HOPOPT"
			"1" => "ICMP"
			"2" => "IGMP"
			"4" => "IP-in-IP"
			"6" => "TCP"
			"17" => "UDP"
			"21" => "PRM"
			"HOPOPT" => "HOPOPT"
			"icmp" => "ICMP"
			"tcp" => "TCP"
			"udp" => "UDP"
			"prm" => "PRM"
		}
		fallback => ""
		override => true
	}
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_ciscoiportwsamsg.json"
#			template_name => "ciscoiportwsa_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
