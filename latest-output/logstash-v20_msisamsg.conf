# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "msisa"
			"[observer][name]" => "Microsoft Internet Security and Acceleration Server"
			"[observer][type]" => "Firewall"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0011
	# line in RSA: %MSFTMG-4: <hsaddr>^^<husername>^^<hagent>^^<hfld1>^^<hfld20>^^<hfld21>^^<hservice>^^<hdhost>^^<hweb_referer>^^<hdaddr>^^<hdport>^^<hprocessing_time>^^<hrbytes>^^<hsbytes>^^<hprotocol>^^<messageid>^^<!payload:hsaddr>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%MSFTMG\-4:[\s]+(?<message>(?<hsaddr>[^\^]*)\^\^(?<husername>[^\^]*)\^\^(?<hagent>[^\^]*)\^\^(?<hfld1>[^\^]*)\^\^(?<hfld20>[^\^]*)\^\^(?<hfld21>[^\^]*)\^\^(?<hservice>[^\^]*)\^\^(?<hdhost>[^\^]*)\^\^(?<hweb_referer>[^\^]*)\^\^(?<hdaddr>[^\^]*)\^\^(?<hdport>[^\^]*)\^\^(?<hprocessing_time>[^\^]*)\^\^(?<hrbytes>[^\^]*)\^\^(?<hsbytes>[^\^]*)\^\^(?<hprotocol>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0011"
			add_field => {
				"[rsa][header][id]" => "0011"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0001
	# line in RSA: { %MSISAPF-4 | %MSISA-4 | %MSFTMG-4 }: #<messageid>: <hfld2> <!payload:hfld2>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^([\s]*%MSISAPF\-4[\s]+|[\s]*%MSISA\-4[\s]+|[\s]*%MSFTMG\-4[\s]+):[\s]+#(?<messageid>[^:]*):[\s]+(?<message>(?<hfld2>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %{ MSISAPF-4- | MSISAPF-4 | MSISAPF | MSISA-4- | MSISA-4 | MSISA | MSFTMG-4- | MSFTMG-4 | MSFTMG }: <hhostname>^^<hfld20>^^<hfld21>^^<hprotocol>^^<hstransaddr>^^<hdtransaddr>^^<hsaddr>^^<hfld4>^^<hfld5>^^<messageid>^^<!payload:hhostname>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%([\s]*MSISAPF\-4\-[\s]+|[\s]*MSISAPF\-4[\s]+|[\s]*MSISAPF[\s]+|[\s]*MSISA\-4\-[\s]+|[\s]*MSISA\-4[\s]+|[\s]*MSISA[\s]+|[\s]*MSFTMG\-4\-[\s]+|[\s]*MSFTMG\-4[\s]+|[\s]*MSFTMG[\s]+):[\s]+(?<message>(?<hhostname>[^\^]*)\^\^(?<hfld20>[^\^]*)\^\^(?<hfld21>[^\^]*)\^\^(?<hprotocol>[^\^]*)\^\^(?<hstransaddr>[^\^]*)\^\^(?<hdtransaddr>[^\^]*)\^\^(?<hsaddr>[^\^]*)\^\^(?<hfld4>[^\^]*)\^\^(?<hfld5>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %{ MSISAPF-4- | MSISAPF-4 | MSISAPF | MSISA-4- | MSISA-4 | MSISA | MSFTMG-4- | MSFTMG-4 | MSFTMG }: <hhostname>,<hfld20>,<hfld21>,<hprotocol>,<hstransaddr>,<hdtransaddr>,<hsaddr>,<hfld4>,<hfld5>,<messageid>,<!payload:hhostname>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%([\s]*MSISAPF\-4\-[\s]+|[\s]*MSISAPF\-4[\s]+|[\s]*MSISAPF[\s]+|[\s]*MSISA\-4\-[\s]+|[\s]*MSISA\-4[\s]+|[\s]*MSISA[\s]+|[\s]*MSFTMG\-4\-[\s]+|[\s]*MSFTMG\-4[\s]+|[\s]*MSFTMG[\s]+):[\s]+(?<message>(?<hhostname>[^,]*),(?<hfld20>[^,]*),(?<hfld21>[^,]*),(?<hprotocol>[^,]*),(?<hstransaddr>[^,]*),(?<hdtransaddr>[^,]*),(?<hsaddr>[^,]*),(?<hfld4>[^,]*),(?<hfld5>[^,]*),(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0004
	# line in RSA: %{ MSISAPF-4- | MSISAPF-4 | MSISAPF | MSISA-4- | MSISA-4 | MSISA | MSFTMG-4- | MSFTMG-4 | MSFTMG }: <hsaddr>^^<husername>^^<huser_agent>^^<hfld1>^^<hfld20>^^<hfld21>^^<hservice>^^<hhostname>^^<hweb_referer>^^<hweb_host>^^<hdaddr>^^<hdport>^^<hduration_string>^^<hsbytes>^^<hrbytes>^^<hnetwork_service>^^<hprotocol>^^<messageid>^^<!payload:hsaddr>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%([\s]*MSISAPF\-4\-[\s]+|[\s]*MSISAPF\-4[\s]+|[\s]*MSISAPF[\s]+|[\s]*MSISA\-4\-[\s]+|[\s]*MSISA\-4[\s]+|[\s]*MSISA[\s]+|[\s]*MSFTMG\-4\-[\s]+|[\s]*MSFTMG\-4[\s]+|[\s]*MSFTMG[\s]+):[\s]+(?<message>(?<hsaddr>[^\^]*)\^\^(?<husername>[^\^]*)\^\^(?<huser_agent>[^\^]*)\^\^(?<hfld1>[^\^]*)\^\^(?<hfld20>[^\^]*)\^\^(?<hfld21>[^\^]*)\^\^(?<hservice>[^\^]*)\^\^(?<hhostname>[^\^]*)\^\^(?<hweb_referer>[^\^]*)\^\^(?<hweb_host>[^\^]*)\^\^(?<hdaddr>[^\^]*)\^\^(?<hdport>[^\^]*)\^\^(?<hduration_string>[^\^]*)\^\^(?<hsbytes>[^\^]*)\^\^(?<hrbytes>[^\^]*)\^\^(?<hnetwork_service>[^\^]*)\^\^(?<hprotocol>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0004"
			add_field => {
				"[rsa][header][id]" => "0004"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0005
	# line in RSA: %{ MSISAPF-4- | MSISAPF-4 | MSISAPF | MSISA-4- | MSISA-4 | MSISA | MSFTMG-4- | MSFTMG-4 | MSFTMG }: <hsaddr>,<husername>,<huser_agent>,<hfld1>,<hfld20>,<hfld21>,<hservice>,<hhostname>,<hweb_referer>,<hweb_host>,<hdaddr>,<hdport>,<hduration_string>,<hsbytes>,<hrbytes>,<hnetwork_service>,<hprotocol>,<messageid>,<!payload:hsaddr>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%([\s]*MSISAPF\-4\-[\s]+|[\s]*MSISAPF\-4[\s]+|[\s]*MSISAPF[\s]+|[\s]*MSISA\-4\-[\s]+|[\s]*MSISA\-4[\s]+|[\s]*MSISA[\s]+|[\s]*MSFTMG\-4\-[\s]+|[\s]*MSFTMG\-4[\s]+|[\s]*MSFTMG[\s]+):[\s]+(?<message>(?<hsaddr>[^,]*),(?<husername>[^,]*),(?<huser_agent>[^,]*),(?<hfld1>[^,]*),(?<hfld20>[^,]*),(?<hfld21>[^,]*),(?<hservice>[^,]*),(?<hhostname>[^,]*),(?<hweb_referer>[^,]*),(?<hweb_host>[^,]*),(?<hdaddr>[^,]*),(?<hdport>[^,]*),(?<hduration_string>[^,]*),(?<hsbytes>[^,]*),(?<hrbytes>[^,]*),(?<hnetwork_service>[^,]*),(?<hprotocol>[^,]*),(?<messageid>[^,]*),(?<payload>.*))$" }
			id => "header-0005"
			add_field => {
				"[rsa][header][id]" => "0005"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0006
	# line in RSA: %MS_Forefront_TMG: <hserver>^^<hdatetime>^^<hprotocol>^^<hsaddr>^^<hsport>^^<hdaddr>^^<hdport>^^<haddr>^^<hfld50>^^<hfld51>^^<messageid>^^<!payload:hserver>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%MS_Forefront_TMG:[\s]+(?<message>(?<hserver>[^\^]*)\^\^(?<hdatetime>[^\^]*)\^\^(?<hprotocol>[^\^]*)\^\^(?<hsaddr>[^\^]*)\^\^(?<hsport>[^\^]*)\^\^(?<hdaddr>[^\^]*)\^\^(?<hdport>[^\^]*)\^\^(?<haddr>[^\^]*)\^\^(?<hfld50>[^\^]*)\^\^(?<hfld51>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0006"
			add_field => {
				"[rsa][header][id]" => "0006"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0007
	# line in RSA: %MS_Forefront_TMG_WP: <hfld50>^^<hfld57>^^<hfld52>^^<hfld1>^^<hdatetime>^^<hservice>^^<hhost>^^<hfld53>^^<hfld59>^^<hdaddr>^^<hdport>^^<hduration>^^<hsbytes>^^<hrbytes>^^<hfld58>^^<hprotocol>^^<hfld55>^^<url>^^<hfld56>^^<hfld2>^^<hstatus>^^<hinfo>^^<hrulename>^^<hfld3>^^<hfld4>^^<hfld5>^^<hfld6>^^<messageid>^^<!payload:hfld50>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%MS_Forefront_TMG_WP:[\s]+(?<message>(?<hfld50>[^\^]*)\^\^(?<hfld57>[^\^]*)\^\^(?<hfld52>[^\^]*)\^\^(?<hfld1>[^\^]*)\^\^(?<hdatetime>[^\^]*)\^\^(?<hservice>[^\^]*)\^\^(?<hhost>[^\^]*)\^\^(?<hfld53>[^\^]*)\^\^(?<hfld59>[^\^]*)\^\^(?<hdaddr>[^\^]*)\^\^(?<hdport>[^\^]*)\^\^(?<hduration>[^\^]*)\^\^(?<hsbytes>[^\^]*)\^\^(?<hrbytes>[^\^]*)\^\^(?<hfld58>[^\^]*)\^\^(?<hprotocol>[^\^]*)\^\^(?<hfld55>[^\^]*)\^\^(?<url>[^\^]*)\^\^(?<hfld56>[^\^]*)\^\^(?<hfld2>[^\^]*)\^\^(?<hstatus>[^\^]*)\^\^(?<hinfo>[^\^]*)\^\^(?<hrulename>[^\^]*)\^\^(?<hfld3>[^\^]*)\^\^(?<hfld4>[^\^]*)\^\^(?<hfld5>[^\^]*)\^\^(?<hfld6>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0007"
			add_field => {
				"[rsa][header][id]" => "0007"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0008
	# line in RSA: %NICWIN-<hlevel>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%NICWIN-%{hlevel}-%{messageid}: %{message}" }
			id => "header-0008"
			add_field => {
				"[rsa][header][id]" => "0008"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0009
	# line in RSA: %MSFTMG-4: <hsaddr>^^<husername>^^<huser_agent>^^<hfld1>^^<hfld20>^^<hhostname>^^<hfld2>^^<hweb_host>^^<hdaddr>^^<hdport>^^<hduration_string>^^<hsbytes>^^<hrbytes>^^<messageid>^^<!payload:hsaddr>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%MSFTMG\-4:[\s]+(?<message>(?<hsaddr>[^\^]*)\^\^(?<husername>[^\^]*)\^\^(?<huser_agent>[^\^]*)\^\^(?<hfld1>[^\^]*)\^\^(?<hfld20>[^\^]*)\^\^(?<hhostname>[^\^]*)\^\^(?<hfld2>[^\^]*)\^\^(?<hweb_host>[^\^]*)\^\^(?<hdaddr>[^\^]*)\^\^(?<hdport>[^\^]*)\^\^(?<hduration_string>[^\^]*)\^\^(?<hsbytes>[^\^]*)\^\^(?<hrbytes>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0009"
			add_field => {
				"[rsa][header][id]" => "0009"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0010
	# line in RSA: %MSFTMG-4: <hsaddr>^^<husername>^^<hagent>^^<hfld20>^^<hfld21>^^<hservice>^^<hdhost>^^<hweb_referer>^^<hdaddr>^^<hdport>^^<hprocessing_time>^^<hrbytes>^^<hsbytes>^^<hprotocol>^^<messageid>^^<!payload:messageid>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%MSFTMG\-4:[\s]+(?<hsaddr>[^\^]*)\^\^(?<husername>[^\^]*)\^\^(?<hagent>[^\^]*)\^\^(?<hfld20>[^\^]*)\^\^(?<hfld21>[^\^]*)\^\^(?<hservice>[^\^]*)\^\^(?<hdhost>[^\^]*)\^\^(?<hweb_referer>[^\^]*)\^\^(?<hdaddr>[^\^]*)\^\^(?<hdport>[^\^]*)\^\^(?<hprocessing_time>[^\^]*)\^\^(?<hrbytes>[^\^]*)\^\^(?<hsbytes>[^\^]*)\^\^(?<hprotocol>[^\^]*)\^\^(?<message>(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0010"
			add_field => {
				"[rsa][header][id]" => "0010"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0012
	# line in RSA: <haddr> <husername> <hagent> <hdate> <htime> <hshost> <hfld1> <hdhost> <hdaddr> <hdport> <hduration> <hsbytes> <hrbytes> <hprotocol> <messageid> <!payload:haddr>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^(?<message>(?<haddr>[^\s]*)[\s]+(?<husername>[^\s]*)[\s]+(?<hagent>[^\s]*)[\s]+(?<hdate>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+(?<hshost>[^\s]*)[\s]+(?<hfld1>[^\s]*)[\s]+(?<hdhost>[^\s]*)[\s]+(?<hdaddr>[^\s]*)[\s]+(?<hdport>[^\s]*)[\s]+(?<hduration>[^\s]*)[\s]+(?<hsbytes>[^\s]*)[\s]+(?<hrbytes>[^\s]*)[\s]+(?<hprotocol>[^\s]*)[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0012"
			add_field => {
				"[rsa][header][id]" => "0012"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_msisamsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	# PARSER msgParserId0
	# line in RSA: <fld30>
	if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "%{fld30}" }
			id => "msgParserId0"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "GET" {
		# MESSAGE GET:04
		# line in RSA:  <saddr>^^<username>^^<agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<dhost>^^<web_referer>^^<daddr>^^<dport>^^<processing_time>^^<rbytes>^^<sbytes>^^<protocol>^^<web_method>^^<url>^^<fld9>^^<fld10>^^<resultcode>^^<rulename>^^<info>^^<fld13>^^<fld14>^^<result>^^<action>^^<domain>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld22>^^<fld23>^^<fld24>^^<fld25>^^<fld26>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^<fld31>^^<fld32>^^<fld33>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{dhost}^^%{web_referer}^^%{daddr}^^%{dport}^^%{processing_time}^^%{rbytes}^^%{sbytes}^^%{protocol}^^%{web_method}^^%{url}^^%{fld9}^^%{fld10}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld13}^^%{fld14}^^%{result}^^%{action}^^%{domain}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld22}^^%{fld23}^^%{fld24}^^%{fld25}^^%{fld26}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^%{fld31}^^%{fld32}^^%{fld33}" }
				id => "message-GET:04"
				add_field => {
					"[event][id]" => "GET:04"
					"[rsa][message][id1]" => "GET:04"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hfld20} %{hfld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE GET
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message-GET"
				add_field => {
					"[event][id]" => "GET"
					"[rsa][message][id1]" => "GET"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GET:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<filter>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{filter}" }
				id => "message-GET:01"
				add_field => {
					"[event][id]" => "GET:01"
					"[rsa][message][id1]" => "GET:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GET:02
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<filter>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{filter}" }
				id => "message-GET:02"
				add_field => {
					"[event][id]" => "GET:02"
					"[rsa][message][id1]" => "GET:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GET:03
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}" }
				id => "message-GET:03"
				add_field => {
					"[event][id]" => "GET:03"
					"[rsa][message][id1]" => "GET:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GET:05
		# line in RSA:  <saddr> <username> <user_agent> <fld1> <fld20> <hostname> <web_referer> <web_host> <daddr> <dport> <duration_string> <sbytes> <rbytes> <protocol> <web_method> <url> <content_type> <fld2> <resultcode> <rulename> Req ID: <fld5>; Compression: client=<fld6>, server=<fld7>, compress rate=<fld8> decompress rate=<fld9> <sinterface> <dinterface> <fld10> { <action> <fld4> | <action> }
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<saddr>[^\s]*)[\s]+(?<username>[^\s]*)[\s]+(?<user_agent>[^\s]*)[\s]+(?<fld1>[^\s]*)[\s]+(?<fld20>[^\s]*)[\s]+(?<hostname>[^\s]*)[\s]+(?<web_referer>[^\s]*)[\s]+(?<web_host>[^\s]*)[\s]+(?<daddr>[^\s]*)[\s]+(?<dport>[^\s]*)[\s]+(?<duration_string>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+(?<rbytes>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+(?<web_method>[^\s]*)[\s]+(?<url>[^\s]*)[\s]+(?<content_type>[^\s]*)[\s]+(?<fld2>[^\s]*)[\s]+(?<resultcode>[^\s]*)[\s]+(?<rulename>[^\s]*)[\s]+Req[\s]+ID:[\s]+(?<fld5>[^;]*);[\s]+Compression:[\s]+client=(?<fld6>[^,]*),[\s]+server=(?<fld7>[^,]*),[\s]+compress[\s]+rate=(?<fld8>[^\s]*)[\s]+decompress[\s]+rate=(?<fld9>[^\s]*)[\s]+(?<sinterface>[^\s]*)[\s]+(?<dinterface>[^\s]*)[\s]+(?<fld10>[^\s]*)[\s]+([\s]*(?<action>[^\s]*)[\s]+(?<fld4>[^\s]*)[\s]+|[\s]*(?<action>[^\s]*)[\s]+)$" }
				id => "message-GET:05"
				add_field => {
					"[event][id]" => "GET:05"
					"[rsa][message][id1]" => "GET:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PROPFIND" {
		# MESSAGE PROPFIND
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{disposition}" }
				id => "message-PROPFIND"
				add_field => {
					"[event][id]" => "PROPFIND"
					"[rsa][message][id1]" => "PROPFIND"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE PROPFIND:01
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{disposition}" }
				id => "message-PROPFIND:01"
				add_field => {
					"[event][id]" => "PROPFIND:01"
					"[rsa][message][id1]" => "PROPFIND:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId8
	# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<disposition>
	else if [logstash][msgparser][id] == "msgParserId8" {
		dissect {
			mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{disposition}" }
			id => "msgParserId8"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "-" {
		# MESSAGE -:04
		# line in RSA:  <saddr>^^<username>^^<agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<dhost>^^<web_referer>^^<daddr>^^<dport>^^<processing_time>^^<rbytes>^^<sbytes>^^<protocol>^^<web_method>^^<url>^^<fld9>^^<fld10>^^<resultcode>^^<rulename>^^<info>^^<fld13>^^<fld14>^^<result>^^<action>^^<domain>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld22>^^<fld23>^^<fld24>^^<fld25>^^<fld26>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^<fld31>^^<fld32>^^<fld33>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{dhost}^^%{web_referer}^^%{daddr}^^%{dport}^^%{processing_time}^^%{rbytes}^^%{sbytes}^^%{protocol}^^%{web_method}^^%{url}^^%{fld9}^^%{fld10}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld13}^^%{fld14}^^%{result}^^%{action}^^%{domain}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld22}^^%{fld23}^^%{fld24}^^%{fld25}^^%{fld26}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^%{fld31}^^%{fld32}^^%{fld33}" }
				id => "message--:04"
				add_field => {
					"[event][id]" => "-:04"
					"[rsa][message][id1]" => "-:04"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hfld20} %{hfld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE -
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message--"
				add_field => {
					"[event][id]" => "-"
					"[rsa][message][id1]" => "-"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE -:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{disposition}" }
				id => "message--:01"
				add_field => {
					"[event][id]" => "-:01"
					"[rsa][message][id1]" => "-:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE -:02
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}" }
				id => "message--:02"
				add_field => {
					"[event][id]" => "-:02"
					"[rsa][message][id1]" => "-:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE -:03
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3}" }
				id => "message--:03"
				add_field => {
					"[event][id]" => "-:03"
					"[rsa][message][id1]" => "-:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "POST" {
		# MESSAGE POST:05
		# line in RSA: POST^^<url>^^<fld9>^^<fld10>^^<resultcode>^^<rulename>^^<info>^^<fld13>^^<fld14>^^<result>^^<action>^^<domain>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld22>^^<fld23>^^<fld24>^^<fld25>^^<fld26>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^<fld31>^^<fld32>^^<fld33>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "POST^^%{url}^^%{fld9}^^%{fld10}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld13}^^%{fld14}^^%{result}^^%{action}^^%{domain}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld22}^^%{fld23}^^%{fld24}^^%{fld25}^^%{fld26}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^%{fld31}^^%{fld32}^^%{fld33}" }
				id => "message-POST:05"
				add_field => {
				"saddr" => "%{hsaddr}"
				"username" => "%{husername}"
				"agent" => "%{hagent}"
				"service" => "%{hservice}"
				"dhost" => "%{hdhost}"
				"web_referer" => "%{hweb_referer}"
				"daddr" => "%{hdaddr}"
				"dport" => "%{dport}"
				"processing_time" => "%{hprocessing_time}"
				"rbytes" => "%{hrbytes}"
				"sbytes" => "%{hsbytes}"
				"protocol" => "%{hprotocol}"
				"web_method" => "%{messageid}"
					"[event][id]" => "POST:05"
					"[rsa][message][id1]" => "POST:05"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hfld20} %{hfld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE POST:04
		# line in RSA:  <saddr>^^<username>^^<agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<dhost>^^<web_referer>^^<daddr>^^<dport>^^<processing_time>^^<rbytes>^^<sbytes>^^<protocol>^^<web_method>^^<url>^^<fld9>^^<fld10>^^<resultcode>^^<rulename>^^<info>^^<fld13>^^<fld14>^^<result>^^<action>^^<domain>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld22>^^<fld23>^^<fld24>^^<fld25>^^<fld26>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^<fld31>^^<fld32>^^<fld33>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{dhost}^^%{web_referer}^^%{daddr}^^%{dport}^^%{processing_time}^^%{rbytes}^^%{sbytes}^^%{protocol}^^%{web_method}^^%{url}^^%{fld9}^^%{fld10}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld13}^^%{fld14}^^%{result}^^%{action}^^%{domain}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld22}^^%{fld23}^^%{fld24}^^%{fld25}^^%{fld26}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^%{fld31}^^%{fld32}^^%{fld33}" }
				id => "message-POST:04"
				add_field => {
					"[event][id]" => "POST:04"
					"[rsa][message][id1]" => "POST:04"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hfld20} %{hfld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE POST
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message-POST"
				add_field => {
					"[event][id]" => "POST"
					"[rsa][message][id1]" => "POST"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE POST:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{disposition}" }
				id => "message-POST:01"
				add_field => {
					"[event][id]" => "POST:01"
					"[rsa][message][id1]" => "POST:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE POST:02
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3}" }
				id => "message-POST:02"
				add_field => {
					"[event][id]" => "POST:02"
					"[rsa][message][id1]" => "POST:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE POST:03
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}" }
				id => "message-POST:03"
				add_field => {
					"[event][id]" => "POST:03"
					"[rsa][message][id1]" => "POST:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE POST:06
		# line in RSA:  <saddr> <username> <user_agent> <fld1> <fld20> <hostname> <web_referer> <web_host> <daddr> <dport> <duration_string> <sbytes> <rbytes> <protocol> <web_method> <url> <content_type> <fld2> <resultcode> <rulename> Req ID: <fld5>; Compression: client=<fld6>, server=<fld7>, compress rate=<fld8> decompress rate=<fld9> ; FBA cookie: exists=<fld10>, valid=<fld11>, updated=<fld12>, logged off=<fld13>, client type=<fld14>, user activity=<fld15> <sinterface> <dinterface> <fld16> <action> <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{username} %{user_agent} %{fld1} %{fld20} %{hostname} %{web_referer} %{web_host} %{daddr} %{dport} %{duration_string} %{sbytes} %{rbytes} %{protocol} %{web_method} %{url} %{content_type} %{fld2} %{resultcode} %{rulename} Req ID: %{fld5}; Compression: client=%{fld6}, server=%{fld7}, compress rate=%{fld8} decompress rate=%{fld9} ; FBA cookie: exists=%{fld10}, valid=%{fld11}, updated=%{fld12}, logged off=%{fld13}, client type=%{fld14}, user activity=%{fld15} %{sinterface} %{dinterface} %{fld16} %{action} %{info}" }
				id => "message-POST:06"
				add_field => {
					"[event][id]" => "POST:06"
					"[rsa][message][id1]" => "POST:06"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "POLL" {
		# MESSAGE POLL
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message-POLL"
				add_field => {
					"[event][id]" => "POLL"
					"[rsa][message][id1]" => "POLL"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE POLL:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{disposition}" }
				id => "message-POLL:01"
				add_field => {
					"[event][id]" => "POLL:01"
					"[rsa][message][id1]" => "POLL:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "HEAD" {
		# MESSAGE HEAD:03
		# line in RSA:  <saddr>^^<username>^^<agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<dhost>^^<web_referer>^^<daddr>^^<dport>^^<processing_time>^^<rbytes>^^<sbytes>^^<protocol>^^<web_method>^^<url>^^<fld9>^^<fld10>^^<resultcode>^^<rulename>^^<info>^^<fld13>^^<fld14>^^<result>^^<action>^^<domain>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld22>^^<fld23>^^<fld24>^^<fld25>^^<fld26>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^<fld31>^^<fld32>^^<fld33>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{dhost}^^%{web_referer}^^%{daddr}^^%{dport}^^%{processing_time}^^%{rbytes}^^%{sbytes}^^%{protocol}^^%{web_method}^^%{url}^^%{fld9}^^%{fld10}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld13}^^%{fld14}^^%{result}^^%{action}^^%{domain}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld22}^^%{fld23}^^%{fld24}^^%{fld25}^^%{fld26}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^%{fld31}^^%{fld32}^^%{fld33}" }
				id => "message-HEAD:03"
				add_field => {
					"[event][id]" => "HEAD:03"
					"[rsa][message][id1]" => "HEAD:03"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hfld20} %{hfld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE HEAD
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message-HEAD"
				add_field => {
					"[event][id]" => "HEAD"
					"[rsa][message][id1]" => "HEAD"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE HEAD:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{disposition}" }
				id => "message-HEAD:01"
				add_field => {
					"[event][id]" => "HEAD:01"
					"[rsa][message][id1]" => "HEAD:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE HEAD:02
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{disposition}" }
				id => "message-HEAD:02"
				add_field => {
					"[event][id]" => "HEAD:02"
					"[rsa][message][id1]" => "HEAD:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE HEAD:04
		# line in RSA:  <saddr> <username> <user_agent> <fld1> <fld20> <hostname> <web_referer> <web_host> <daddr> <dport> <duration_string> <sbytes> <rbytes> <protocol> <web_method> <url> <content_type> <fld2> <resultcode> <rulename> Req ID: <fld5>; Compression: client=<fld6>, server=<fld7>, compress rate=<fld8> decompress rate=<fld9> <sinterface> <dinterface> <fld10> <action> <info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{username} %{user_agent} %{fld1} %{fld20} %{hostname} %{web_referer} %{web_host} %{daddr} %{dport} %{duration_string} %{sbytes} %{rbytes} %{protocol} %{web_method} %{url} %{content_type} %{fld2} %{resultcode} %{rulename} Req ID: %{fld5}; Compression: client=%{fld6}, server=%{fld7}, compress rate=%{fld8} decompress rate=%{fld9} %{sinterface} %{dinterface} %{fld10} %{action} %{info}" }
				id => "message-HEAD:04"
				add_field => {
					"[event][id]" => "HEAD:04"
					"[rsa][message][id1]" => "HEAD:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{hdate} %{htime}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "CONNECT" {
		# MESSAGE CONNECT
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message-CONNECT"
				add_field => {
					"[event][id]" => "CONNECT"
					"[rsa][message][id1]" => "CONNECT"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE CONNECT:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{disposition}" }
				id => "message-CONNECT:01"
				add_field => {
					"[event][id]" => "CONNECT:01"
					"[rsa][message][id1]" => "CONNECT:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "OPTIONS" {
		# MESSAGE OPTIONS:03
		# line in RSA:  <saddr>^^<username>^^<agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<dhost>^^<web_referer>^^<daddr>^^<dport>^^<processing_time>^^<rbytes>^^<sbytes>^^<protocol>^^<web_method>^^<url>^^<fld9>^^<fld10>^^<resultcode>^^<rulename>^^<info>^^<fld13>^^<fld14>^^<result>^^<action>^^<domain>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld22>^^<fld23>^^<fld24>^^<fld25>^^<fld26>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^<fld31>^^<fld32>^^<fld33>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{dhost}^^%{web_referer}^^%{daddr}^^%{dport}^^%{processing_time}^^%{rbytes}^^%{sbytes}^^%{protocol}^^%{web_method}^^%{url}^^%{fld9}^^%{fld10}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld13}^^%{fld14}^^%{result}^^%{action}^^%{domain}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld22}^^%{fld23}^^%{fld24}^^%{fld25}^^%{fld26}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^%{fld31}^^%{fld32}^^%{fld33}" }
				id => "message-OPTIONS:03"
				add_field => {
					"[event][id]" => "OPTIONS:03"
					"[rsa][message][id1]" => "OPTIONS:03"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{hfld20} %{hfld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d H:m:s" ] }
			}
		}
		# MESSAGE OPTIONS
		# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}" }
				id => "message-OPTIONS"
				add_field => {
					"[event][id]" => "OPTIONS"
					"[rsa][message][id1]" => "OPTIONS"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE OPTIONS:01
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<fld3>,<fld4>,<fld5>,<fld6>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{fld3},%{fld4},%{fld5},%{fld6},%{disposition}" }
				id => "message-OPTIONS:01"
				add_field => {
					"[event][id]" => "OPTIONS:01"
					"[rsa][message][id1]" => "OPTIONS:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE OPTIONS:02
		# line in RSA:  <saddr>,<username>,<user_agent>,<fld1>,<fld20>,<fld21>,<service>,<hostname>,<web_referer>,<web_host>,<daddr>,<dport>,<duration_string>,<sbytes>,<rbytes>,<network_service>,<protocol>,<web_method>,<url>,<content_type>,<fld2>,<resultcode>,<info>,<rulename>,<disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr},%{username},%{user_agent},%{fld1},%{fld20},%{fld21},%{service},%{hostname},%{web_referer},%{web_host},%{daddr},%{dport},%{duration_string},%{sbytes},%{rbytes},%{network_service},%{protocol},%{web_method},%{url},%{content_type},%{fld2},%{resultcode},%{info},%{rulename},%{disposition}" }
				id => "message-OPTIONS:02"
				add_field => {
					"[event][id]" => "OPTIONS:02"
					"[rsa][message][id1]" => "OPTIONS:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "NotLogged" {
		# MESSAGE NotLogged
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-NotLogged"
				add_field => {
					"[event][id]" => "NotLogged"
					"[rsa][message][id1]" => "NotLogged"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE NotLogged:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-NotLogged:01"
				add_field => {
					"[event][id]" => "NotLogged:01"
					"[rsa][message][id1]" => "NotLogged:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Bind" {
		# MESSAGE Bind
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Bind"
				add_field => {
					"[event][id]" => "Bind"
					"[rsa][message][id1]" => "Bind"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Bind:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Bind:01"
				add_field => {
					"[event][id]" => "Bind:01"
					"[rsa][message][id1]" => "Bind:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Listen" {
		# MESSAGE Listen
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Listen"
				add_field => {
					"[event][id]" => "Listen"
					"[rsa][message][id1]" => "Listen"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Listen:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Listen:01"
				add_field => {
					"[event][id]" => "Listen:01"
					"[rsa][message][id1]" => "Listen:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GHBN" {
		# MESSAGE GHBN
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-GHBN"
				add_field => {
					"[event][id]" => "GHBN"
					"[rsa][message][id1]" => "GHBN"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GHBN:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-GHBN:01"
				add_field => {
					"[event][id]" => "GHBN:01"
					"[rsa][message][id1]" => "GHBN:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId17
	# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld20>^^<fld21>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld2>^^<resultcode>^^<info>^^<rulename>^^<fld3>^^<fld4>^^<fld5>^^<fld6>^^<disposition>^^<fld7>^^<fld8>
	else if [logstash][msgparser][id] == "msgParserId17" {
		dissect {
			mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld20}^^%{fld21}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld2}^^%{resultcode}^^%{info}^^%{rulename}^^%{fld3}^^%{fld4}^^%{fld5}^^%{fld6}^^%{disposition}^^%{fld7}^^%{fld8}" }
			id => "msgParserId17"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "GHBA" {
		# MESSAGE GHBA
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-GHBA"
				add_field => {
					"[event][id]" => "GHBA"
					"[rsa][message][id1]" => "GHBA"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GHBA:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-GHBA:01"
				add_field => {
					"[event][id]" => "GHBA:01"
					"[rsa][message][id1]" => "GHBA:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "RedirectBind" {
		# MESSAGE RedirectBind
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-RedirectBind"
				add_field => {
					"[event][id]" => "RedirectBind"
					"[rsa][message][id1]" => "RedirectBind"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE RedirectBind:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-RedirectBind:01"
				add_field => {
					"[event][id]" => "RedirectBind:01"
					"[rsa][message][id1]" => "RedirectBind:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Establish" {
		# MESSAGE Establish
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport>^^ | <stransaddr>^^}{<dtransaddr>:<dtransport>^^ | <dtransaddr>^^ } <saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\^]*)\^\^[\s]+|[\s]*(?<stransaddr>[^\^]*)\^\^)((?<dtransaddr>[^:]*):(?<dtransport>[^\^]*)\^\^[\s]+|[\s]*(?<dtransaddr>[^\^]*)\^\^[\s]+)[\s]+(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Establish"
				add_field => {
					"[event][id]" => "Establish"
					"[rsa][message][id1]" => "Establish"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Establish:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,<stransaddr>,<dtransaddr>:<dtransport>,<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname},%{fld20},%{fld21},%{protocol},%{stransaddr},%{dtransaddr}:%{dtransport},%{saddr},%{fld4},%{fld5},%{disposition},%{resultcode},%{rulename},%{network_service},%{fld6},%{sbytes},%{fld7},%{rbytes},%{fld8},%{duration_string},%{fld9},%{fld10},%{fld11},%{fld12},%{ddomain},%{username},%{os},%{sessionid},%{connectionid},%{interface},%{fld13},%{context}" }
				id => "message-Establish:01"
				add_field => {
					"[event][id]" => "Establish:01"
					"[rsa][message][id1]" => "Establish:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Establish:02
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,<stransaddr>:<stransport>,<dtransaddr>,<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname},%{fld20},%{fld21},%{protocol},%{stransaddr}:%{stransport},%{dtransaddr},%{saddr},%{fld4},%{fld5},%{disposition},%{resultcode},%{rulename},%{network_service},%{fld6},%{sbytes},%{fld7},%{rbytes},%{fld8},%{duration_string},%{fld9},%{fld10},%{fld11},%{fld12},%{ddomain},%{username},%{os},%{sessionid},%{connectionid},%{interface},%{fld13},%{context}" }
				id => "message-Establish:02"
				add_field => {
					"[event][id]" => "Establish:02"
					"[rsa][message][id1]" => "Establish:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Terminate" {
		# MESSAGE Terminate
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport>^^ | <stransaddr>^^ }{ <dtransaddr>:<dtransport>^^ | <dtransaddr>^^} <saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\^]*)\^\^[\s]+|[\s]*(?<stransaddr>[^\^]*)\^\^[\s]+)([\s]*(?<dtransaddr>[^:]*):(?<dtransport>[^\^]*)\^\^[\s]+|[\s]*(?<dtransaddr>[^\^]*)\^\^)[\s]+(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Terminate"
				add_field => {
					"[event][id]" => "Terminate"
					"[rsa][message][id1]" => "Terminate"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Terminate:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,<stransaddr>,<dtransaddr>:<dtransport>,<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname},%{fld20},%{fld21},%{protocol},%{stransaddr},%{dtransaddr}:%{dtransport},%{saddr},%{fld4},%{fld5},%{disposition},%{resultcode},%{rulename},%{network_service},%{fld6},%{sbytes},%{fld7},%{rbytes},%{fld8},%{duration_string},%{fld9},%{fld10},%{fld11},%{fld12},%{ddomain},%{username},%{os},%{sessionid},%{connectionid},%{interface},%{fld13},%{context}" }
				id => "message-Terminate:01"
				add_field => {
					"[event][id]" => "Terminate:01"
					"[rsa][message][id1]" => "Terminate:01"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Terminate:02
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,<stransaddr>:<stransport>,<dtransaddr>,<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname},%{fld20},%{fld21},%{protocol},%{stransaddr}:%{stransport},%{dtransaddr},%{saddr},%{fld4},%{fld5},%{disposition},%{resultcode},%{rulename},%{network_service},%{fld6},%{sbytes},%{fld7},%{rbytes},%{fld8},%{duration_string},%{fld9},%{fld10},%{fld11},%{fld12},%{ddomain},%{username},%{os},%{sessionid},%{connectionid},%{interface},%{fld13},%{context}" }
				id => "message-Terminate:02"
				add_field => {
					"[event][id]" => "Terminate:02"
					"[rsa][message][id1]" => "Terminate:02"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Terminate:03
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport>^^ | <stransaddr>^^ }{ <dtransaddr>:<dtransport>^^ | <dtransaddr>^^} <saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<fld13>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\^]*)\^\^[\s]+|[\s]*(?<stransaddr>[^\^]*)\^\^[\s]+)([\s]*(?<dtransaddr>[^:]*):(?<dtransport>[^\^]*)\^\^[\s]+|[\s]*(?<dtransaddr>[^\^]*)\^\^)[\s]+(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<fld13>.*)$" }
				id => "message-Terminate:03"
				add_field => {
					"[event][id]" => "Terminate:03"
					"[rsa][message][id1]" => "Terminate:03"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Denied" {
		# MESSAGE Denied
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport>^^ | <stransaddr>^^}{<dtransaddr>:<dtransport>^^ | <dtransaddr>^^ } <saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\^]*)\^\^[\s]+|[\s]*(?<stransaddr>[^\^]*)\^\^)((?<dtransaddr>[^:]*):(?<dtransport>[^\^]*)\^\^[\s]+|[\s]*(?<dtransaddr>[^\^]*)\^\^[\s]+)[\s]+(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Denied"
				add_field => {
					"[event][id]" => "Denied"
					"[rsa][message][id1]" => "Denied"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Denied:02
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^<stransaddr>^^<dtransaddr>^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld20}^^%{fld21}^^%{protocol}^^%{stransaddr}^^%{dtransaddr}^^%{saddr}^^%{fld4}^^%{fld5}^^%{disposition}^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld6}^^%{sbytes}^^%{fld7}^^%{rbytes}^^%{fld8}^^%{duration_string}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}" }
				id => "message-Denied:02"
				add_field => {
					"[event][id]" => "Denied:02"
					"[rsa][message][id1]" => "Denied:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Denied:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Denied:01"
				add_field => {
					"[event][id]" => "Denied:01"
					"[rsa][message][id1]" => "Denied:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Allowed" {
		# MESSAGE Allowed
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Allowed"
				add_field => {
					"[event][id]" => "Allowed"
					"[rsa][message][id1]" => "Allowed"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Allowed:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Allowed:01"
				add_field => {
					"[event][id]" => "Allowed:01"
					"[rsa][message][id1]" => "Allowed:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Failed" {
		# MESSAGE Failed
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Failed"
				add_field => {
					"[event][id]" => "Failed"
					"[rsa][message][id1]" => "Failed"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Failed:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Failed:01"
				add_field => {
					"[event][id]" => "Failed:01"
					"[rsa][message][id1]" => "Failed:01"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Intermediate" {
		# MESSAGE Intermediate
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Intermediate"
				add_field => {
					"[event][id]" => "Intermediate"
					"[rsa][message][id1]" => "Intermediate"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Intermediate:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Intermediate:01"
				add_field => {
					"[event][id]" => "Intermediate:01"
					"[rsa][message][id1]" => "Intermediate:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Intermediate:02
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<fld13>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<fld13>.*)$" }
				id => "message-Intermediate:02"
				add_field => {
					"[event][id]" => "Intermediate:02"
					"[rsa][message][id1]" => "Intermediate:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "SuccessfulConnection" {
		# MESSAGE SuccessfulConnection
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-SuccessfulConnection"
				add_field => {
					"[event][id]" => "SuccessfulConnection"
					"[rsa][message][id1]" => "SuccessfulConnection"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE SuccessfulConnection:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-SuccessfulConnection:01"
				add_field => {
					"[event][id]" => "SuccessfulConnection:01"
					"[rsa][message][id1]" => "SuccessfulConnection:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "UnsuccessfulConnection" {
		# MESSAGE UnsuccessfulConnection
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-UnsuccessfulConnection"
				add_field => {
					"[event][id]" => "UnsuccessfulConnection"
					"[rsa][message][id1]" => "UnsuccessfulConnection"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE UnsuccessfulConnection:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-UnsuccessfulConnection:01"
				add_field => {
					"[event][id]" => "UnsuccessfulConnection:01"
					"[rsa][message][id1]" => "UnsuccessfulConnection:01"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Disconnect" {
		# MESSAGE Disconnect
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-Disconnect"
				add_field => {
					"[event][id]" => "Disconnect"
					"[rsa][message][id1]" => "Disconnect"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Disconnect:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-Disconnect:01"
				add_field => {
					"[event][id]" => "Disconnect:01"
					"[rsa][message][id1]" => "Disconnect:01"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "UserClearedQuarantine" {
		# MESSAGE UserClearedQuarantine
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-UserClearedQuarantine"
				add_field => {
					"[event][id]" => "UserClearedQuarantine"
					"[rsa][message][id1]" => "UserClearedQuarantine"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE UserClearedQuarantine:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-UserClearedQuarantine:01"
				add_field => {
					"[event][id]" => "UserClearedQuarantine:01"
					"[rsa][message][id1]" => "UserClearedQuarantine:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "QuarantineTimeout" {
		# MESSAGE QuarantineTimeout
		# line in RSA:  <hostname>^^<fld20>^^<fld21>^^<protocol>^^{<stransaddr>:<stransport> | <stransaddr>}^^{<dtransaddr>:<dtransport> | <dtransaddr>}^^<saddr>^^<fld4>^^<fld5>^^<disposition>^^<resultcode>^^<rulename>^^<network_service>^^<fld6>^^<sbytes>^^<fld7>^^<rbytes>^^<fld8>^^<duration_string>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld13>^^<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^\^]*)\^\^(?<fld20>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<protocol>[^\^]*)\^\^((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^\^]*))\^\^((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^\^]*))\^\^(?<saddr>[^\^]*)\^\^(?<fld4>[^\^]*)\^\^(?<fld5>[^\^]*)\^\^(?<disposition>[^\^]*)\^\^(?<resultcode>[^\^]*)\^\^(?<rulename>[^\^]*)\^\^(?<network_service>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<sbytes>[^\^]*)\^\^(?<fld7>[^\^]*)\^\^(?<rbytes>[^\^]*)\^\^(?<fld8>[^\^]*)\^\^(?<duration_string>[^\^]*)\^\^(?<fld9>[^\^]*)\^\^(?<fld10>[^\^]*)\^\^(?<fld11>[^\^]*)\^\^(?<fld12>[^\^]*)\^\^(?<ddomain>[^\^]*)\^\^(?<username>[^\^]*)\^\^(?<os>[^\^]*)\^\^(?<sessionid>[^\^]*)\^\^(?<connectionid>[^\^]*)\^\^(?<interface>[^\^]*)\^\^(?<fld13>[^\^]*)\^\^(?<context>.*)$" }
				id => "message-QuarantineTimeout"
				add_field => {
					"[event][id]" => "QuarantineTimeout"
					"[rsa][message][id1]" => "QuarantineTimeout"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE QuarantineTimeout:01
		# line in RSA:  <hostname>,<fld20>,<fld21>,<protocol>,{<stransaddr>:<stransport> | <stransaddr>},{<dtransaddr>:<dtransport> | <dtransaddr>},<saddr>,<fld4>,<fld5>,<disposition>,<resultcode>,<rulename>,<network_service>,<fld6>,<sbytes>,<fld7>,<rbytes>,<fld8>,<duration_string>,<fld9>,<fld10>,<fld11>,<fld12>,<ddomain>,<username>,<os>,<sessionid>,<connectionid>,<interface>,<fld13>,<context>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<hostname>[^,]*),(?<fld20>[^,]*),(?<fld21>[^,]*),(?<protocol>[^,]*),((?<stransaddr>[^:]*):(?<stransport>[^\s]*)[\s]+|[\s]*(?<stransaddr>[^,]*)),((?<dtransaddr>[^:]*):(?<dtransport>[^\s]*)[\s]+|[\s]*(?<dtransaddr>[^,]*)),(?<saddr>[^,]*),(?<fld4>[^,]*),(?<fld5>[^,]*),(?<disposition>[^,]*),(?<resultcode>[^,]*),(?<rulename>[^,]*),(?<network_service>[^,]*),(?<fld6>[^,]*),(?<sbytes>[^,]*),(?<fld7>[^,]*),(?<rbytes>[^,]*),(?<fld8>[^,]*),(?<duration_string>[^,]*),(?<fld9>[^,]*),(?<fld10>[^,]*),(?<fld11>[^,]*),(?<fld12>[^,]*),(?<ddomain>[^,]*),(?<username>[^,]*),(?<os>[^,]*),(?<sessionid>[^,]*),(?<connectionid>[^,]*),(?<interface>[^,]*),(?<fld13>[^,]*),(?<context>.*)$" }
				id => "message-QuarantineTimeout:01"
				add_field => {
					"[event][id]" => "QuarantineTimeout:01"
					"[rsa][message][id1]" => "QuarantineTimeout:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld20} %{fld21}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "0" {
		# MESSAGE wp_not_logged
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^0^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^0^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_not_logged"
				add_field => {
					"[event][id]" => "wp_not_logged"
					"[rsa][message][id1]" => "wp_not_logged"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_not_logged
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^0^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^0^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_not_logged"
				add_field => {
					"[event][id]" => "fw_not_logged"
					"[rsa][message][id1]" => "fw_not_logged"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "1" {
		# MESSAGE wp_bind
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^1^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^1^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_bind"
				add_field => {
					"[event][id]" => "wp_bind"
					"[rsa][message][id1]" => "wp_bind"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_bind
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^1^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^1^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_bind"
				add_field => {
					"[event][id]" => "fw_bind"
					"[rsa][message][id1]" => "fw_bind"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "2" {
		# MESSAGE wp_listen
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^2^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^2^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_listen"
				add_field => {
					"[event][id]" => "wp_listen"
					"[rsa][message][id1]" => "wp_listen"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_listen
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^2^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^2^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_listen"
				add_field => {
					"[event][id]" => "fw_listen"
					"[rsa][message][id1]" => "fw_listen"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "3" {
		# MESSAGE wp_GHBN
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^3^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^3^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_GHBN"
				add_field => {
					"[event][id]" => "wp_GHBN"
					"[rsa][message][id1]" => "wp_GHBN"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_GHBN
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^3^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^3^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_GHBN"
				add_field => {
					"[event][id]" => "fw_GHBN"
					"[rsa][message][id1]" => "fw_GHBN"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "4" {
		# MESSAGE wp_ghba
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^4^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^4^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_ghba"
				add_field => {
					"[event][id]" => "wp_ghba"
					"[rsa][message][id1]" => "wp_ghba"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_ghba
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^4^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^4^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_ghba"
				add_field => {
					"[event][id]" => "fw_ghba"
					"[rsa][message][id1]" => "fw_ghba"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "5" {
		# MESSAGE wp_redirect_bind
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^5^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^5^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_redirect_bind"
				add_field => {
					"[event][id]" => "wp_redirect_bind"
					"[rsa][message][id1]" => "wp_redirect_bind"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_redirect_bind
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^5^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^5^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_redirect_bind"
				add_field => {
					"[event][id]" => "fw_redirect_bind"
					"[rsa][message][id1]" => "fw_redirect_bind"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "6" {
		# MESSAGE wp_establish
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^6^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^6^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_establish"
				add_field => {
					"[event][id]" => "wp_establish"
					"[rsa][message][id1]" => "wp_establish"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_establish
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^6^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^6^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_establish"
				add_field => {
					"[event][id]" => "fw_establish"
					"[rsa][message][id1]" => "fw_establish"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "7" {
		# MESSAGE wp_terminate
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^7^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^7^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_terminate"
				add_field => {
					"[event][id]" => "wp_terminate"
					"[rsa][message][id1]" => "wp_terminate"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_terminate
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^7^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^7^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_terminate"
				add_field => {
					"[event][id]" => "fw_terminate"
					"[rsa][message][id1]" => "fw_terminate"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "8" {
		# MESSAGE wp_denied
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^8^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^8^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_denied"
				add_field => {
					"[event][id]" => "wp_denied"
					"[rsa][message][id1]" => "wp_denied"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_denied
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^8^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^8^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_denied"
				add_field => {
					"[event][id]" => "fw_denied"
					"[rsa][message][id1]" => "fw_denied"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "9" {
		# MESSAGE wp_allowed
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^9^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^9^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_allowed"
				add_field => {
					"[event][id]" => "wp_allowed"
					"[rsa][message][id1]" => "wp_allowed"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_allowed
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^9^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^9^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_allowed"
				add_field => {
					"[event][id]" => "fw_allowed"
					"[rsa][message][id1]" => "fw_allowed"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "10" {
		# MESSAGE wp_failed
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^10^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^10^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_failed"
				add_field => {
					"[event][id]" => "wp_failed"
					"[rsa][message][id1]" => "wp_failed"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_failed
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^10^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^10^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_failed"
				add_field => {
					"[event][id]" => "fw_failed"
					"[rsa][message][id1]" => "fw_failed"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "11" {
		# MESSAGE wp_intermediate
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^11^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^11^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_intermediate"
				add_field => {
					"[event][id]" => "wp_intermediate"
					"[rsa][message][id1]" => "wp_intermediate"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_intermediate
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^11^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^11^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_intermediate"
				add_field => {
					"[event][id]" => "fw_intermediate"
					"[rsa][message][id1]" => "fw_intermediate"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "12" {
		# MESSAGE wp_successful_connection
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^12^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^12^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_successful_connection"
				add_field => {
					"[event][id]" => "wp_successful_connection"
					"[rsa][message][id1]" => "wp_successful_connection"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_successful_connection
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^12^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^12^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_successful_connection"
				add_field => {
					"[event][id]" => "fw_successful_connection"
					"[rsa][message][id1]" => "fw_successful_connection"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "13" {
		# MESSAGE wp_unsuccessful_connection
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^13^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^13^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_unsuccessful_connection"
				add_field => {
					"[event][id]" => "wp_unsuccessful_connection"
					"[rsa][message][id1]" => "wp_unsuccessful_connection"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_unsuccessful_connection
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^13^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^13^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_unsuccessful_connection"
				add_field => {
					"[event][id]" => "fw_unsuccessful_connection"
					"[rsa][message][id1]" => "fw_unsuccessful_connection"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "14" {
		# MESSAGE wp_disconnect
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^14^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^14^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_disconnect"
				add_field => {
					"[event][id]" => "wp_disconnect"
					"[rsa][message][id1]" => "wp_disconnect"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_disconnect
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^14^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^14^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_disconnect"
				add_field => {
					"[event][id]" => "fw_disconnect"
					"[rsa][message][id1]" => "fw_disconnect"
					"[event][categoryid]" => "1801030000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "15" {
		# MESSAGE wp_user_cleared_quarantine
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^15^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^15^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_user_cleared_quarantine"
				add_field => {
					"[event][id]" => "wp_user_cleared_quarantine"
					"[rsa][message][id1]" => "wp_user_cleared_quarantine"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_user_cleared_quarantine
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^15^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^15^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_user_cleared_quarantine"
				add_field => {
					"[event][id]" => "fw_user_cleared_quarantine"
					"[rsa][message][id1]" => "fw_user_cleared_quarantine"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "16" {
		# MESSAGE wp_quarantine_timeout
		# line in RSA: <saddr>^^<username>^^<user_agent>^^<fld24>^^<fld1>.<fld56>^^<service>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration>^^<sbytes>^^<rbytes>^^<network_service>^^<protocol>^^<web_method>^^<url>^^<content_type>^^<fld26>^^<status>^^<info>^^<rulename>^^<fld27>^^<fld28>^^<fld29>^^<fld30>^^16^^<fld31>^^<fld59>^^<fld32>^^<fld33>^^<fld34>^^<fld35>^^<fld36>^^<filter>^^<fld37>^^<fld38>^^<fld39>^^<fld40>^^<fld50>^^<fld51>^^<fld52>^^<fld53>^^<fld54>^^<fld41>^^<fld42>^^<fld43>^^<fld44>^^<fld45>^^<fld46>^^<fld47>^^<fld48>^^<fld49>^^<fld55>^^<fld5>^^<fld57>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld24}^^%{fld1}.%{fld56}^^%{service}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration}^^%{sbytes}^^%{rbytes}^^%{network_service}^^%{protocol}^^%{web_method}^^%{url}^^%{content_type}^^%{fld26}^^%{status}^^%{info}^^%{rulename}^^%{fld27}^^%{fld28}^^%{fld29}^^%{fld30}^^16^^%{fld31}^^%{fld59}^^%{fld32}^^%{fld33}^^%{fld34}^^%{fld35}^^%{fld36}^^%{filter}^^%{fld37}^^%{fld38}^^%{fld39}^^%{fld40}^^%{fld50}^^%{fld51}^^%{fld52}^^%{fld53}^^%{fld54}^^%{fld41}^^%{fld42}^^%{fld43}^^%{fld44}^^%{fld45}^^%{fld46}^^%{fld47}^^%{fld48}^^%{fld49}^^%{fld55}^^%{fld5}^^%{fld57}" }
				id => "message-wp_quarantine_timeout"
				add_field => {
					"[event][id]" => "wp_quarantine_timeout"
					"[rsa][message][id1]" => "wp_quarantine_timeout"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE fw_quarantine_timeout
		# line in RSA: <hostname>^^<fld1>^^<protocol>^^<stransaddr>^^<stransport>^^<dtransaddr>^^<dtransport>^^<saddr>^^<fld2>^^<fld3>^^16^^<resultcode>^^<rulename>^^<network_service>^^<fld4>^^<sbytes>^^<fld5>^^<rbytes>^^<fld6>^^<duration_string>^^<fld7>^^<ddomain>^^<username>^^<os>^^<sessionid>^^<connectionid>^^<interface>^^<fld8>^^<context>^^<fld9>^^<fld10>^^<fld11>^^<fld12>^^<fld60>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>^^<fld22>^^<fld23>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^^%{fld1}^^%{protocol}^^%{stransaddr}^^%{stransport}^^%{dtransaddr}^^%{dtransport}^^%{saddr}^^%{fld2}^^%{fld3}^^16^^%{resultcode}^^%{rulename}^^%{network_service}^^%{fld4}^^%{sbytes}^^%{fld5}^^%{rbytes}^^%{fld6}^^%{duration_string}^^%{fld7}^^%{ddomain}^^%{username}^^%{os}^^%{sessionid}^^%{connectionid}^^%{interface}^^%{fld8}^^%{context}^^%{fld9}^^%{fld10}^^%{fld11}^^%{fld12}^^%{fld60}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}^^%{fld22}^^%{fld23}" }
				id => "message-fw_quarantine_timeout"
				add_field => {
					"[event][id]" => "fw_quarantine_timeout"
					"[rsa][message][id1]" => "fw_quarantine_timeout"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId59
	# line in RSA: <event_log>,<fld11>,<fld10> <datetime>,<id>,<event_source>,<event_user>,<event_type>,<event_computer>,<category>,<fld12>,<event_description>
	else if [logstash][msgparser][id] == "msgParserId59" {
		dissect {
			mapping => { "message" => "%{event_log},%{fld11},%{fld10} %{datetime},%{id},%{event_source},%{event_user},%{event_type},%{event_computer},%{category},%{fld12},%{event_description}" }
			id => "msgParserId59"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{datetime}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "MMM dd H:m:s yyyy" ] }
		}
	}
	# PARSER msgParserId60
	# line in RSA:  <saddr>^^<username>^^<user_agent>^^<fld1>^^<fld2>^^<hostname>^^<web_referer>^^<web_host>^^<daddr>^^<dport>^^<duration_string>^^<sbytes>^^<rbytes>^^<protocol>^^<web_method>^^<url>^^<application>^^<obj_type>^^<resultcode>^^<rulename>^^<info>^^<fld21>^^<fld3>^^<fld4>^^<action>^^<fld5>^^<fld6>^^<fld7>^^<fld8>^^<fld9>^^<fld10>^^<result>^^<fld11>^^<fld12>^^<fld13>^^<fld14>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>
	else if [logstash][msgparser][id] == "msgParserId60" {
		dissect {
			mapping => { "message" => "%{saddr}^^%{username}^^%{user_agent}^^%{fld1}^^%{fld2}^^%{hostname}^^%{web_referer}^^%{web_host}^^%{daddr}^^%{dport}^^%{duration_string}^^%{sbytes}^^%{rbytes}^^%{protocol}^^%{web_method}^^%{url}^^%{application}^^%{obj_type}^^%{resultcode}^^%{rulename}^^%{info}^^%{fld21}^^%{fld3}^^%{fld4}^^%{action}^^%{fld5}^^%{fld6}^^%{fld7}^^%{fld8}^^%{fld9}^^%{fld10}^^%{result}^^%{fld11}^^%{fld12}^^%{fld13}^^%{fld14}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}" }
			id => "msgParserId60"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_msisamsg.json"
#			template_name => "msisa_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
