# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "clariion"
			"[observer][name]" => "EMC Clariion/VNX"
			"[observer][type]" => "Storage"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %CLARIION-<messageid> <hservice>|<!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CLARIION-%{messageid} %{hservice}|%{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_clariionmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	# PARSER msgParserId0
	# line in RSA: <fld27>|<fld1>|<event_description>
	if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId0"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "3e8" {
		# MESSAGE 3e8
		# line in RSA: <fld27>|<fld1>|Performance counters for the <service> (<fld2>) service were loaded successfully. The Record Data contains the new index values assigned to this service.  <fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|Performance counters for the %{service} (%{fld2}) service were loaded successfully. The Record Data contains the new index values assigned to this service.  %{fld22}" }
				id => "message-3e8"
				add_field => {
				"event_description" => "Performance counters for the WmiApRpl service were loaded successfully"
					"[event][id]" => "3e8"
					"[rsa][message][id1]" => "3e8"
					"[event][categoryid]" => "1602010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 3e8:01
		# line in RSA: <fld27>|<fld1>|<event_description>:<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}:%{info}" }
				id => "message-3e8:01"
				add_field => {
					"[event][id]" => "3e8:01"
					"[rsa][message][id1]" => "3e8:01"
					"[event][categoryid]" => "1602010000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "3e9" {
		# MESSAGE 3e9
		# line in RSA: <fld27>|<fld1>|The <service> Service has started successfully.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|The %{service} Service has started successfully." }
				id => "message-3e9"
				add_field => {
				"ec_subject" => "Service"
				"ec_activity" => "Start"
				"ec_theme" => "ALM"
				"ec_outcome" => "Success"
				"event_description" => "Service started"
					"[event][id]" => "3e9"
					"[rsa][message][id1]" => "3e9"
					"[event][categoryid]" => "1610000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 3e9:01
		# line in RSA: <fld27>|<fld1>|Performance counters for the <service> (<fld2>) service were removed successfully. The Record Data contains the new values of the system Last Counter and Last Help registry entries.  <fld3> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|Performance counters for the %{service} (%{fld2}) service were removed successfully. The Record Data contains the new values of the system Last Counter and Last Help registry entries.  %{fld3}" }
				id => "message-3e9:01"
				add_field => {
				"event_description" => "service were removed"
					"[event][id]" => "3e9:01"
					"[rsa][message][id1]" => "3e9:01"
					"[event][categoryid]" => "1602010000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "40000001" {
		# MESSAGE 40000001
		# line in RSA: <fld27>|<fld1>|Attempting to reconnect to peer  <fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|Attempting to reconnect to peer  %{fld2}" }
				id => "message-40000001"
				add_field => {
				"event_description" => "Reconnect to peer"
					"[event][id]" => "40000001"
					"[rsa][message][id1]" => "40000001"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 40000001:01
		# line in RSA: <fld27>|<fld1>|Message Dispatcher has { started | reconnected }  <fld2>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|Message[\s]+Dispatcher[\s]+has[\s]+([\s]*started[\s]+|[\s]*reconnected[\s]+)[\s]+(?<fld2>.*)$" }
				id => "message-40000001:01"
				add_field => {
				"event_description" => "Message Dispatcher started"
					"[event][id]" => "40000001:01"
					"[rsa][message][id1]" => "40000001:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 40000001:02
		# line in RSA: <fld27>|<fld1>|Entering Main Alert Handler  <fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|Entering Main Alert Handler  %{fld2}" }
				id => "message-40000001:02"
				add_field => {
				"event_description" => "Entering Main Alert Handler"
					"[event][id]" => "40000001:02"
					"[rsa][message][id1]" => "40000001:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 40000001:03
		# line in RSA: <fld27>|<fld1>|<service> has mapped device map.  <fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{service} has mapped device map.  %{fld2}" }
				id => "message-40000001:03"
				add_field => {
				"event_description" => "Mapped device map"
					"[event][id]" => "40000001:03"
					"[rsa][message][id1]" => "40000001:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId9
	# line in RSA: <fld27>|<fld1>|SP time changed by user from <fld2>  <fld3> to <fld4>  <fld5>  <fld6> 
	else if [logstash][msgparser][id] == "msgParserId9" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|SP time changed by user from %{fld2}  %{fld3} to %{fld4}  %{fld5}  %{fld6}" }
			id => "msgParserId9"
			add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"event_description" => "SP time changed by user"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId10
	# line in RSA: <fld27>|<fld1>|#THREADO: Peer died in Run:  <fld2>  <fld3>
	else if [logstash][msgparser][id] == "msgParserId10" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|#THREADO: Peer died in Run:  %{fld2}  %{fld3}" }
			id => "msgParserId10"
			add_field => {
				"event_description" => "Peer died in Run"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId11
	# line in RSA: <fld27>|<fld1>|Starting service:  <fld2>  <fld3>    
	else if [logstash][msgparser][id] == "msgParserId11" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Starting service:  %{fld2}  %{fld3}" }
			id => "msgParserId11"
			add_field => {
				"ec_subject" => "Service"
				"ec_activity" => "Start"
				"ec_theme" => "ALM"
				"ec_outcome" => "Success"
				"event_description" => "Starting service"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "41000001" {
		# MESSAGE 41000001
		# line in RSA: <fld27>|<fld1>|All processes started, process count = <fld2>.  <fld3> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|All processes started, process count = %{fld2}.  %{fld3}" }
				id => "message-41000001"
				add_field => {
				"event_description" => "All processes started"
					"[event][id]" => "41000001"
					"[rsa][message][id1]" => "41000001"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 41000001:01
		# line in RSA: <fld27>|<fld1>|<service> process started, executable = <fld2>.  <fld3> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{service} process started, executable = %{fld2}.  %{fld3}" }
				id => "message-41000001:01"
				add_field => {
				"ec_subject" => "Process"
				"ec_activity" => "Start"
				"ec_theme" => "ALM"
				"ec_outcome" => "Success"
				"event_description" => "K10Monitor process started"
					"[event][id]" => "41000001:01"
					"[rsa][message][id1]" => "41000001:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId14
	# line in RSA: <fld27>|<fld1>|<event_description> 
	else if [logstash][msgparser][id] == "msgParserId14" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId14"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId15
	# line in RSA: |<fld0>|Process ndumon exited normally, probably in response to user command  <fld1>
	else if [logstash][msgparser][id] == "msgParserId15" {
		dissect {
			mapping => { "message" => "|%{fld0}|Process ndumon exited normally, probably in response to user command  %{fld1}" }
			id => "msgParserId15"
			add_field => {
				"ec_subject" => "Process"
				"ec_activity" => "Stop"
				"ec_theme" => "ALM"
				"ec_outcome" => "Success"
				"event_description" => "Process exited normally<fld27"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId16
	# line in RSA: |<fld0>|Process NaviCimom exited with return code <resultcode> <fld1>
	else if [logstash][msgparser][id] == "msgParserId16" {
		dissect {
			mapping => { "message" => "|%{fld0}|Process NaviCimom exited with return code %{resultcode} %{fld1}" }
			id => "msgParserId16"
			add_field => {
				"ec_subject" => "Process"
				"ec_activity" => "Stop"
				"ec_theme" => "ALM"
				"ec_outcome" => "Success"
				"event_description" => "Process NaviCimom exited<fld27"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId17
	# line in RSA: <fld27>|<fld1>|<fld2> started  <fld3> 
	else if [logstash][msgparser][id] == "msgParserId17" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{fld2} started  %{fld3}" }
			id => "msgParserId17"
			add_field => {
				"event_description" => "DumpManager started"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId18
	# line in RSA: <fld27>|<fld1>|Nodes added to the domain: ipAddress=<saddr>,name=<fld21>,port=<sport>,securePort=<fld22>;ipAddress=<fld2>,name=<fld3>,port=<fld4>,securePort=<fld5>;
	else if [logstash][msgparser][id] == "msgParserId18" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Nodes added to the domain: ipAddress=%{saddr},name=%{fld21},port=%{sport},securePort=%{fld22};ipAddress=%{fld2},name=%{fld3},port=%{fld4},securePort=%{fld5};" }
			id => "msgParserId18"
			add_field => {
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"event_description" => "Nodes added"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId19
	# line in RSA: <fld27>|<fld1>|<event_description>
	else if [logstash][msgparser][id] == "msgParserId19" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId19"
			add_field => {
				"ec_activity" => "Detect"
				"ec_theme" => "Configuration"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "4600" {
		# MESSAGE 4600
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) on '<device>' (Result: <disposition>). <fld7>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|'%{service}' called by '%{username}' (%{saddr}) on '%{device}' (Result: %{disposition}). %{fld7}" }
				id => "message-4600"
				add_field => {
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
				"event_description" => "%{fld7}"
					"[event][id]" => "4600"
					"[rsa][message][id1]" => "4600"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:04
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) with result: <disposition> (Navisphere CLI command: '<fld6>' in Engineering mode. Error: <result> )
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|'%{service}' called by '%{username}' (%{saddr}) with result: %{disposition} (Navisphere CLI command: '%{fld6}' in Engineering mode. Error: %{result} )" }
				id => "message-4600:04"
				add_field => {
					"[event][id]" => "4600:04"
					"[rsa][message][id1]" => "4600:04"
					"[event][categoryid]" => "1704010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:05
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) with result: <disposition> (Navisphere CLI command: '<fld6>' in Engineering mode)
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|'%{service}' called by '%{username}' (%{saddr}) with result: %{disposition} (Navisphere CLI command: '%{fld6}' in Engineering mode)" }
				id => "message-4600:05"
				add_field => {
					"[event][id]" => "4600:05"
					"[rsa][message][id1]" => "4600:05"
					"[event][categoryid]" => "1704010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:06
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) on '<fld4>' with result: <disposition> (<result>)
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|'%{service}' called by '%{username}' (%{saddr}) on '%{fld4}' with result: %{disposition} (%{result})" }
				id => "message-4600:06"
				add_field => {
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"ec_outcome" => "Success"
					"[event][id]" => "4600:06"
					"[rsa][message][id1]" => "4600:06"
					"[event][categoryid]" => "1701020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:11
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) with result: <disposition> (Navisphere { Secure CLI | CLI } command: '<action>'. Error: <result>)
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|'(?<service>[^']*)'[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+\((?<saddr>[^\)]*)\)[\s]+with[\s]+result:[\s]+(?<disposition>[^\s]*)[\s]+\(Navisphere[\s]+([\s]*Secure[\s]+CLI[\s]+|[\s]*CLI[\s]+)[\s]+command:[\s]+'(?<action>[^']*)'\.[\s]+Error:[\s]+(?<result>[^\)]*)\)$" }
				id => "message-4600:11"
				add_field => {
					"[event][id]" => "4600:11"
					"[rsa][message][id1]" => "4600:11"
					"[event][categoryid]" => "1704010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:07
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) with result: <disposition> (Navisphere { Secure CLI | CLI } command: { '<action>' | <action> })
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|'(?<service>[^']*)'[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+\((?<saddr>[^\)]*)\)[\s]+with[\s]+result:[\s]+(?<disposition>[^\s]*)[\s]+\(Navisphere[\s]+([\s]*Secure[\s]+CLI[\s]+|[\s]*CLI[\s]+)[\s]+command:[\s]+([\s]*'(?<action>[^']*)'[\s]+|[\s]*(?<action>[^\s]*)[\s]+)\)$" }
				id => "message-4600:07"
				add_field => {
					"[event][id]" => "4600:07"
					"[rsa][message][id1]" => "4600:07"
					"[event][categoryid]" => "1704010000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:08
		# line in RSA: <fld27>|<fld1>|'<service>' called by '<username>' (<saddr>) on '<fld4>' with result: <disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|'%{service}' called by '%{username}' (%{saddr}) on '%{fld4}' with result: %{disposition}" }
				id => "message-4600:08"
				add_field => {
					"[event][id]" => "4600:08"
					"[rsa][message][id1]" => "4600:08"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:09
		# line in RSA: <fld27>|<fld1>|Access is denied to {NaviConnection_UserAccount called by '<username>' | setstats. called by '<username>' |arrayname.SET called by '<username>' } from '<saddr>'.
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|Access[\s]+is[\s]+denied[\s]+to[\s]+(NaviConnection_UserAccount[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+|[\s]*setstats\.[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+|arrayname\.SET[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+)[\s]+from[\s]+'(?<saddr>[^']*)'\.$" }
				id => "message-4600:09"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Access is denied"
					"[event][id]" => "4600:09"
					"[rsa][message][id1]" => "4600:09"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4600:10
		# line in RSA: <fld27>|<fld1>|<fld12> called by '<username>' (<saddr>)  with result: <status>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{fld12} called by '%{username}' (%{saddr})  with result: %{status}" }
				id => "message-4600:10"
				add_field => {
					"[event][id]" => "4600:10"
					"[rsa][message][id1]" => "4600:10"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId29
	# line in RSA: <fld27>|<fld1>|'<action>' called by '<username>' (<saddr>) on '<service>' (Result: <disposition>). New user added - '<c_username>' 
	else if [logstash][msgparser][id] == "msgParserId29" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|'%{action}' called by '%{username}' (%{saddr}) on '%{service}' (Result: %{disposition}). New user added - '%{c_username}'" }
			id => "msgParserId29"
			add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Create"
				"ec_theme" => "UserGroup"
				"ec_outcome" => "Success"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId30
	# line in RSA: <fld27>|<fld1>|'<action>' called by '<username>' (<saddr>) on '<service>' (Result: <disposition>). b - The user's role or password has been modified
	else if [logstash][msgparser][id] == "msgParserId30" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|'%{action}' called by '%{username}' (%{saddr}) on '%{service}' (Result: %{disposition}). b - The user's role or password has been modified" }
			id => "msgParserId30"
			add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Modify"
				"ec_theme" => "UserGroup"
				"ec_outcome" => "Success"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId31
	# line in RSA: <fld27>|<fld1>|'<action>' called by <username> (<saddr>) on '<service>' (Result: <disposition>). User has been deleted - '<c_username>' 
	else if [logstash][msgparser][id] == "msgParserId31" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|'%{action}' called by %{username} (%{saddr}) on '%{service}' (Result: %{disposition}). User has been deleted - '%{c_username}'" }
			id => "msgParserId31"
			add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Delete"
				"ec_theme" => "UserGroup"
				"ec_outcome" => "Success"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId32
	# line in RSA:  <fld27>|<fld20>|<fld1> application was started by the user, following was the application detail  Process Id : <process_id> Path :<directory> User : <username> Domain : <domain>.
	else if [logstash][msgparser][id] == "msgParserId32" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld20}|%{fld1} application was started by the user, following was the application detail  Process Id : %{process_id} Path :%{directory} User : %{username} Domain : %{domain}." }
			id => "msgParserId32"
			add_field => {
				"event_description" => "application started"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId33
	# line in RSA: <fld27>|<fld20>|<fld1> application was closed by the user, following was the application detail  Process Id : <process_id> Path :<directory> 
	else if [logstash][msgparser][id] == "msgParserId33" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld20}|%{fld1} application was closed by the user, following was the application detail  Process Id : %{process_id} Path :%{directory}" }
			id => "msgParserId33"
			add_field => {
				"event_description" => "application closed"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "4622" {
		# MESSAGE 4622
		# line in RSA:  <fld27>|<fld1>|Client module {connected|disconnected}.
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^[\s]*(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|Client[\s]+module[\s]+(connected|disconnected)\.$" }
				id => "message-4622"
				add_field => {
					"[event][id]" => "4622"
					"[rsa][message][id1]" => "4622"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4622:01
		# line in RSA:  <fld27>|<fld1>|<event_description>.
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}." }
				id => "message-4622:01"
				add_field => {
					"[event][id]" => "4622:01"
					"[rsa][message][id1]" => "4622:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "4640" {
		# MESSAGE 4640
		# line in RSA: <fld27>|<fld1>|Access is denied to {NaviSec_Authentication.LogIn called by '<username>' | Navi_Error called by '<username>' | NaviDir_LocalSystemInfo | NaviCimom_WebServer.Put} from '<saddr>'. Application Accessed: <application>. Result: <disposition>.
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|Access[\s]+is[\s]+denied[\s]+to[\s]+(NaviSec_Authentication\.LogIn[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+|[\s]*Navi_Error[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+|[\s]*NaviDir_LocalSystemInfo[\s]+|[\s]*NaviCimom_WebServer\.Put)[\s]+from[\s]+'(?<saddr>[^']*)'\.[\s]+Application[\s]+Accessed:[\s]+(?<application>[^\.]*)\.[\s]+Result:[\s]+(?<disposition>[^\.]*)\.$" }
				id => "message-4640"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Access is denied"
					"[event][id]" => "4640"
					"[rsa][message][id1]" => "4640"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4640:01
		# line in RSA: <fld27>|<fld1>|Access is denied to <hostname> called by an <username>. Application Accessed: <application> Result: <disposition>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|Access is denied to %{hostname} called by an %{username}. Application Accessed: %{application} Result: %{disposition}" }
				id => "message-4640:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Access is denied"
					"[event][id]" => "4640:01"
					"[rsa][message][id1]" => "4640:01"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 4640:02
		# line in RSA: <fld27>|<fld1>|Access is denied to {NaviConnection_UserAccount called by '<username>' | setstats. called by '<username>' | NaviSec_SecurityAdmin.GetUserList called by '<username>'} from '<saddr>'.
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|Access[\s]+is[\s]+denied[\s]+to[\s]+(NaviConnection_UserAccount[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+|[\s]*setstats\.[\s]+called[\s]+by[\s]+'(?<username>[^']*)'[\s]+|[\s]*NaviSec_SecurityAdmin\.GetUserList[\s]+called[\s]+by[\s]+'(?<username>[^']*)')[\s]+from[\s]+'(?<saddr>[^']*)'\.$" }
				id => "message-4640:02"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"event_description" => "Access is denied"
					"[event][id]" => "4640:02"
					"[rsa][message][id1]" => "4640:02"
					"[event][categoryid]" => "1301000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId39
	# line in RSA: |<fld0>|'<saddr>' was managed successfully.
	else if [logstash][msgparser][id] == "msgParserId39" {
		dissect {
			mapping => { "message" => "|%{fld0}|'%{saddr}' was managed successfully." }
			id => "msgParserId39"
			add_field => {
				"event_description" => "managed successfully<fld27"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId40
	# line in RSA: <fld27>|<fld1>|<event_description>.
	else if [logstash][msgparser][id] == "msgParserId40" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}." }
			id => "msgParserId40"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId41
	# line in RSA: <fld27>|<fld1>|<service> Enabled - Checking Config
	else if [logstash][msgparser][id] == "msgParserId41" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{service} Enabled - Checking Config" }
			id => "msgParserId41"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId42
	# line in RSA: <fld27>|<fld1>|<fld2> Fibre Port Enabled
	else if [logstash][msgparser][id] == "msgParserId42" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{fld2} Fibre Port Enabled" }
			id => "msgParserId42"
			add_field => {
				"event_description" => "Fibre Port Enabled"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId43
	# line in RSA: <fld27>|<fld1>|SnapView incremental session SANCopy_Unknown:<fld2> has been started on LUN <lun>.  <fld4> 
	else if [logstash][msgparser][id] == "msgParserId43" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|SnapView incremental session SANCopy_Unknown:%{fld2} has been started on LUN %{lun}.  %{fld4}" }
			id => "msgParserId43"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId44
	# line in RSA: <fld27>|<fld1>|Internal Information only. <fld2> File <filename> Deleted.  <fld4> 
	else if [logstash][msgparser][id] == "msgParserId44" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Internal Information only. %{fld2} File %{filename} Deleted.  %{fld4}" }
			id => "msgParserId44"
			add_field => {
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"event_description" => "PSM File Deleted"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId45
	# line in RSA: <fld27>|<fld1>|TCD0 claimed physical port <sport> for <fld22>.  <fld2> 
	else if [logstash][msgparser][id] == "msgParserId45" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|TCD0 claimed physical port %{sport} for %{fld22}.  %{fld2}" }
			id => "msgParserId45"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "71170003" {
		# MESSAGE 71170003
		# line in RSA: <fld27>|<fld1>|TDD linked with ScsiTarg.  <fld2> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|TDD linked with ScsiTarg.  %{fld2}" }
				id => "message-71170003"
				add_field => {
					"[event][id]" => "71170003"
					"[rsa][message][id1]" => "71170003"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 71170003:01
		# line in RSA: <fld27>|<fld1>|<event_description> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
				id => "message-71170003:01"
				add_field => {
					"[event][id]" => "71170003:01"
					"[rsa][message][id1]" => "71170003:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "71170004" {
		# MESSAGE 71170004
		# line in RSA: <fld27>|<fld1>|TDD activated with ScsiTarg.  <fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|TDD activated with ScsiTarg.  %{fld2}" }
				id => "message-71170004"
				add_field => {
					"[event][id]" => "71170004"
					"[rsa][message][id1]" => "71170004"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 71170004:01
		# line in RSA: <fld27>|<fld1>|<event_description> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
				id => "message-71170004:01"
				add_field => {
					"[event][id]" => "71170004:01"
					"[rsa][message][id1]" => "71170004:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId48
	# line in RSA: <fld27>|<fld1>|<fld22> Removed for physical port <sport>  <fld2> 
	else if [logstash][msgparser][id] == "msgParserId48" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{fld22} Removed for physical port %{sport}  %{fld2}" }
			id => "msgParserId48"
			add_field => {
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"event_description" => "SFP Removed for physical port"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "71214000" {
		# MESSAGE 71214000
		# line in RSA: <fld27>|<fld1>|ktconsService log:  Waiting for signal from the Governor to take ktrace dump.   <fld2>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|ktconsService log:  Waiting for signal from the Governor to take ktrace dump.   %{fld2}" }
				id => "message-71214000"
				add_field => {
				"event_description" => "Waiting for signal from the Governor to take ktrace dump"
					"[event][id]" => "71214000"
					"[rsa][message][id1]" => "71214000"
					"[event][categoryid]" => "1603000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 71214000:01
		# line in RSA: <fld27>|<fld1>|<event_description> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
				id => "message-71214000:01"
				add_field => {
					"[event][id]" => "71214000:01"
					"[rsa][message][id1]" => "71214000:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId50
	# line in RSA: <fld27>|<fld1>|Internal information only. Uncorrectable checksum error primary <fld2> at <fld3> <fld4> (non-boot partition) <fld5>  
	else if [logstash][msgparser][id] == "msgParserId50" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Internal information only. Uncorrectable checksum error primary %{fld2} at %{fld3} %{fld4} (non-boot partition) %{fld5}" }
			id => "msgParserId50"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId51
	# line in RSA: <fld27>|<fld1>|Bus <fld2> disk <fld3> status:  <fld4> 
	else if [logstash][msgparser][id] == "msgParserId51" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Bus %{fld2} disk %{fld3} status:  %{fld4}" }
			id => "msgParserId51"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId52
	# line in RSA: <fld27>|<fld1>|TOD: Old time: <fld2>, <fld3>, <fld4>  <fld5> 
	else if [logstash][msgparser][id] == "msgParserId52" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|TOD: Old time: %{fld2}, %{fld3}, %{fld4}  %{fld5}" }
			id => "msgParserId52"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId53
	# line in RSA: <fld27>|<fld1>|Internal information only: The RollBack Driver has started; compile info: <fld2> <fld3> <fld4> <fld5> Free (Retail) Build.  <fld6> 
	else if [logstash][msgparser][id] == "msgParserId53" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Internal information only: The RollBack Driver has started; compile info: %{fld2} %{fld3} %{fld4} %{fld5} Free (Retail) Build.  %{fld6}" }
			id => "msgParserId53"
			add_field => {
				"event_description" => "The RollBack Driver has started"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId54
	# line in RSA: <fld27>|<fld1>|Internal information only. Maximum number of concurrent copies was reset. (Concurrent copies: <fld2>).  <fld3> 
	else if [logstash][msgparser][id] == "msgParserId54" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Internal information only. Maximum number of concurrent copies was reset. (Concurrent copies: %{fld2}).  %{fld3}" }
			id => "msgParserId54"
			add_field => {
				"event_description" => "Maximum number of concurrent copies was reset"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId55
	# line in RSA: <fld27>|<fld1>|Internal information only. The maximum buffer size used for copy commands has been set. (Size: <fld2>).  <fld3> 
	else if [logstash][msgparser][id] == "msgParserId55" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Internal information only. The maximum buffer size used for copy commands has been set. (Size: %{fld2}).  %{fld3}" }
			id => "msgParserId55"
			add_field => {
				"event_description" => "The maximum buffer size has been set"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId56
	# line in RSA: <fld27>|<fld1>|Failing Command: <fld2> 
	else if [logstash][msgparser][id] == "msgParserId56" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Failing Command: %{fld2}" }
			id => "msgParserId56"
			add_field => {
				"event_description" => "Failing Command"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId57
	# line in RSA: <fld27>|<fld1>|Command: <fld2>; Exception: <fld3>
	else if [logstash][msgparser][id] == "msgParserId57" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Command: %{fld2}; Exception: %{fld3}" }
			id => "msgParserId57"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId58
	# line in RSA: <fld27>|<fld1>|Completion of the admin operation - Get { ThinLun | Driver } Properties, Status - <fld2> CommitStatus - <fld3>.  <fld4> 
	else if [logstash][msgparser][id] == "msgParserId58" {
		grok {
			match => { "message" => "^(?<fld27>[^\|]*)\|(?<fld1>[^\|]*)\|Completion[\s]+of[\s]+the[\s]+admin[\s]+operation[\s]+\-[\s]+Get[\s]+([\s]*ThinLun[\s]+|[\s]*Driver[\s]+)[\s]+Properties,[\s]+Status[\s]+\-[\s]+(?<fld2>[^\s]*)[\s]+CommitStatus[\s]+\-[\s]+(?<fld3>[^\.]*)\.[\s]+(?<fld4>[^\s]*)[\s]+$" }
			id => "msgParserId58"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId59
	# line in RSA: <fld27>|<fld1>|<fld2> Transport Device <fld3>: <fld4> gate(s) found.  <fld5> 
	else if [logstash][msgparser][id] == "msgParserId59" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{fld2} Transport Device %{fld3}: %{fld4} gate(s) found.  %{fld5}" }
			id => "msgParserId59"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId60
	# line in RSA: <fld27>|<fld1>|<service> Transport Device 0: Gate 0 connects to SP ID <fld22>:<fld23> (Signature <fld3>)  <fld4> 
	else if [logstash][msgparser][id] == "msgParserId60" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{service} Transport Device 0: Gate 0 connects to SP ID %{fld22}:%{fld23} (Signature %{fld3})  %{fld4}" }
			id => "msgParserId60"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId61
	# line in RSA: <fld27>|<fld1>|<event_description> 
	else if [logstash][msgparser][id] == "msgParserId61" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId61"
			add_field => {
				"ec_activity" => "Delete"
				"ec_theme" => "Configuration"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId62
	# line in RSA: <fld27>|<fld1>|ID Manager: Lun Id changed Old Lun ID: <change_old>, New Lun ID: <change_new>.  <fld4> 
	else if [logstash][msgparser][id] == "msgParserId62" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|ID Manager: Lun Id changed Old Lun ID: %{change_old}, New Lun ID: %{change_new}.  %{fld4}" }
			id => "msgParserId62"
			add_field => {
				"ec_activity" => "Modify"
				"ec_theme" => "Configuration"
				"change_attribute" => "Lun Id"
				"event_description" => "Lun Id changed"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId63
	# line in RSA: <fld27>|<fld1>|The peer SP failed to reboot.  Call Service Provider.    File: <filename> Line: <fld3> Details: Reboot peer failed Operation Counter: <fld4> Status: <resultcode> 
	else if [logstash][msgparser][id] == "msgParserId63" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|The peer SP failed to reboot.  Call Service Provider.    File: %{filename} Line: %{fld3} Details: Reboot peer failed Operation Counter: %{fld4} Status: %{resultcode}" }
			id => "msgParserId63"
			add_field => {
				"event_description" => "The peer SP failed to reboot"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId64
	# line in RSA: <fld27>|<fld1>|An error on the communication path to the Peer Storage Processor will disable Write Caching. Contact your Service Provider. Offset = <fld2>, Value = <fld3>.  <fld4>
	else if [logstash][msgparser][id] == "msgParserId64" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|An error on the communication path to the Peer Storage Processor will disable Write Caching. Contact your Service Provider. Offset = %{fld2}, Value = %{fld3}.  %{fld4}" }
			id => "msgParserId64"
			add_field => {
				"event_description" => "An error on the communication path"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId65
	# line in RSA: <fld27>|<fld1>|<event_description>
	else if [logstash][msgparser][id] == "msgParserId65" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId65"
			add_field => {
				"ec_theme" => "ALM"
				"ec_outcome" => "Failure"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId66
	# line in RSA: <fld27>|<fld1>|Storage Processor (<fld2>) is faulted. See Navisphere Manager Alerts for details.
	else if [logstash][msgparser][id] == "msgParserId66" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Storage Processor (%{fld2}) is faulted. See Navisphere Manager Alerts for details." }
			id => "msgParserId66"
			add_field => {
				"event_description" => "Storage Processor is faulted."
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId67
	# line in RSA: <fld27>|<fld1>|Navisphere can no longer manage (<fld2>). This does not impact server <fld3> to the storage system. See Navisphere Manager Alerts for details.
	else if [logstash][msgparser][id] == "msgParserId67" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Navisphere can no longer manage (%{fld2}). This does not impact server %{fld3} to the storage system. See Navisphere Manager Alerts for details." }
			id => "msgParserId67"
			add_field => {
				"event_description" => "Navisphere can no longer manage"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "782" {
		# MESSAGE 782
		# line in RSA: <fld27>|<fld1>|<fld2> <fld3> Bus <fld4> Enclosure <fld5> (<fld6>) FRUMON Revision: <fld7> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{fld2} %{fld3} Bus %{fld4} Enclosure %{fld5} (%{fld6}) FRUMON Revision: %{fld7}" }
				id => "message-782"
				add_field => {
					"[event][id]" => "782"
					"[rsa][message][id1]" => "782"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 782:01
		# line in RSA: <fld27>|<fld1>|<event_description> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
				id => "message-782:01"
				add_field => {
					"[event][id]" => "782:01"
					"[rsa][message][id1]" => "782:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	# PARSER msgParserId69
	# line in RSA: <fld27>|<fld1>|<event_description>
	else if [logstash][msgparser][id] == "msgParserId69" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId69"
			add_field => {
				"ec_activity" => "Create"
				"ec_theme" => "Configuration"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId70
	# line in RSA: <fld27>|<fld1>|<event_description>
	else if [logstash][msgparser][id] == "msgParserId70" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId70"
			add_field => {
				"ec_activity" => "Start"
				"ec_theme" => "ALM"
				"ec_outcome" => "Success"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId71
	# line in RSA: <fld27>|<fld1>|<event_description>
	else if [logstash][msgparser][id] == "msgParserId71" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}" }
			id => "msgParserId71"
			add_field => {
				"ec_theme" => "ALM"
				"ec_outcome" => "Error"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId2
	# line in RSA: <fld27>|<fld1>|<event_description>:<info>
	else if [logstash][msgparser][id] == "msgParserId2" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|%{event_description}:%{info}" }
			id => "msgParserId2"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId72
	# line in RSA: <fld27>|<fld1>|'<daddr>' <event_description>
	else if [logstash][msgparser][id] == "msgParserId72" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|'%{daddr}' %{event_description}" }
			id => "msgParserId72"
			add_field => {
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId73
	# line in RSA: <fld27>|<fld1>|Fibre Channel loop down on physical port <fld28>.<fld22>
	else if [logstash][msgparser][id] == "msgParserId73" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Fibre Channel loop down on physical port %{fld28}.%{fld22}" }
			id => "msgParserId73"
			add_field => {
				"event_description" => "Fibre Channel loop down on physical port"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId74
	# line in RSA: <fld27>|<fld1>|Fibre Channel loop up on physical port <fld28> <fld22>
	else if [logstash][msgparser][id] == "msgParserId74" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|Fibre Channel loop up on physical port %{fld28} %{fld22}" }
			id => "msgParserId74"
			add_field => {
				"event_description" => "Fibre Channel loop up on physical port"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId75
	# line in RSA: <fld27>|<fld1>|LUN <lun> is ready to service IO.<info>
	else if [logstash][msgparser][id] == "msgParserId75" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|LUN %{lun} is ready to service IO.%{info}" }
			id => "msgParserId75"
			add_field => {
				"event_description" => "LUN is ready to service IO."
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId76
	# line in RSA: <fld27>|<fld1>|SPA Status:(<fld2>) Application running.  <fld3> 
	else if [logstash][msgparser][id] == "msgParserId76" {
		dissect {
			mapping => { "message" => "%{fld27}|%{fld1}|SPA Status:(%{fld2}) Application running.  %{fld3}" }
			id => "msgParserId76"
			add_field => {
				"event_description" => "Application running."
				"[logstash][messagefound]" => true
			}
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_clariionmsg.json"
#			template_name => "clariion_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
