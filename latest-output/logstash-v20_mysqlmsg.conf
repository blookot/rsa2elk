# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "mysql"
			"[observer][name]" => "MySQL"
			"[observer][type]" => "Database"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: { %MySQL NULL^<hhostname> | %MySQL <hhostname> } ^<hseverity>^<messageid>^<!payload:hhostname>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^([\s]*%MySQL[\s]+NULL\^(?<hhostname>[^\s]*)[\s]+|[\s]*%MySQL[\s]+(?<hhostname>[^\s]*)[\s]+)[\s]+\^(?<hseverity>[^\^]*)\^(?<messageid>[^\^]*)\^(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: { %MySQL NULL^<hhostname> | %MySQL <hhostname> } ^<hseverity>^<msgIdPart1> <msgIdPart2>^<!payload:hhostname>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^([\s]*%MySQL[\s]+NULL\^(?<hhostname>[^\s]*)[\s]+|[\s]*%MySQL[\s]+(?<hhostname>[^\s]*)[\s]+)[\s]+\^(?<hseverity>[^\^]*)\^(?<msgIdPart1>[^\s]*)[\s]+(?<msgIdPart2>[^\^]*)\^(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{msgIdPart1}_%{msgIdPart2}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %MySQL NULL^<hhostname>^<hseverity>^<msgIdPart1> <msgIdPart2> <msgIdPart3> <msgIdPart4>^<!payload:hhostname>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%MySQL[\s]+NULL\^(?<message>(?<hhostname>[^\^]*)\^(?<hseverity>[^\^]*)\^(?<msgIdPart1>[^\s]*)[\s]+(?<msgIdPart2>[^\s]*)[\s]+(?<msgIdPart3>[^\s]*)[\s]+(?<msgIdPart4>[^\^]*)\^(?<payload>.*))$" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{msgIdPart1}_%{msgIdPart2}_%{msgIdPart3}_%{msgIdPart4}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_mysqlmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "Administration" {
		# MESSAGE Administration:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^32-Bit Binary Running on 64-Bit AMD Or Intel System^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^32-Bit Binary Running on 64-Bit AMD Or Intel System^%{action}^%{info}" }
				id => "message-Administration:01"
				add_field => {
				"event_description" => "32-Bit Binary Running on 64-Bit AMD Or Intel System"
					"[event][id]" => "Administration:01"
					"[rsa][message][id1]" => "Administration:01"
					"[event][categoryid]" => "1702030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Attempted Connections To The Server Have Failed^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Attempted Connections To The Server Have Failed^%{action}^%{info}" }
				id => "message-Administration:02"
				add_field => {
				"event_description" => "Attempted Connections To The Server Have Failed"
					"[event][id]" => "Administration:02"
					"[rsa][message][id1]" => "Administration:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Binary Logging Is Limited^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Binary Logging Is Limited^%{action}^%{info}" }
				id => "message-Administration:03"
				add_field => {
				"event_description" => "Binary Logging Is Limited"
					"[event][id]" => "Administration:03"
					"[rsa][message][id1]" => "Administration:03"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Binary Logging Not Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Binary Logging Not Enabled^%{action}^%{info}" }
				id => "message-Administration:04"
				add_field => {
				"event_description" => "Binary Logging Not Enabled"
					"[event][id]" => "Administration:04"
					"[rsa][message][id1]" => "Administration:04"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Binary Logging Not Synchronized To Disk At Each Write^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Binary Logging Not Synchronized To Disk At Each Write^%{action}^%{info}" }
				id => "message-Administration:05"
				add_field => {
				"event_description" => "Binary Logging Not Synchronized To Disk At Each Write"
					"[event][id]" => "Administration:05"
					"[rsa][message][id1]" => "Administration:05"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Database May Not Be Portable Due To Identifier Case Sensitivity^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Database May Not Be Portable Due To Identifier Case Sensitivity^%{action}^%{info}" }
				id => "message-Administration:06"
				add_field => {
				"event_description" => "Database May Not Be Portable Due To Identifier Case Sensitivity"
					"[event][id]" => "Administration:06"
					"[rsa][message][id1]" => "Administration:06"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Default Value Being Used For max_prepared_stmt_count^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Default Value Being Used For max_prepared_stmt_count^%{action}^%{info}" }
				id => "message-Administration:07"
				add_field => {
				"event_description" => "Default Value Being Used For max_prepared_stmt_count"
					"[event][id]" => "Administration:07"
					"[rsa][message][id1]" => "Administration:07"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:08
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Event Scheduler Disabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Event Scheduler Disabled^%{action}^%{info}" }
				id => "message-Administration:08"
				add_field => {
				"event_description" => "Event Scheduler Disabled"
					"[event][id]" => "Administration:08"
					"[rsa][message][id1]" => "Administration:08"
					"[event][categoryid]" => "1701070000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:09
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Excessive Percentage Of Attempted Connections To The Server Have Failed^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Excessive Percentage Of Attempted Connections To The Server Have Failed^%{action}^%{info}" }
				id => "message-Administration:09"
				add_field => {
				"event_description" => "Excessive Percentage Of Attempted Connections To The Server Have Failed"
					"[event][id]" => "Administration:09"
					"[rsa][message][id1]" => "Administration:09"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:10
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^General Query Log Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^General Query Log Enabled^%{action}^%{info}" }
				id => "message-Administration:10"
				add_field => {
				"event_description" => "General Query Log Enabled"
					"[event][id]" => "Administration:10"
					"[rsa][message][id1]" => "Administration:10"
					"[event][categoryid]" => "1701060000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:11
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^In-Memory Temporary Table Size Limited By Maximum Heap Table Size^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^In-Memory Temporary Table Size Limited By Maximum Heap Table Size^%{action}^%{info}" }
				id => "message-Administration:11"
				add_field => {
				"event_description" => "In-Memory Temporary Table Size Limited By Maximum Heap Table Size"
					"[event][id]" => "Administration:11"
					"[rsa][message][id1]" => "Administration:11"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:12
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Incorrect InnoDB Flush Method On Windows^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Incorrect InnoDB Flush Method On Windows^%{action}^%{info}" }
				id => "message-Administration:12"
				add_field => {
				"event_description" => "Incorrect InnoDB Flush Method On Windows"
					"[event][id]" => "Administration:12"
					"[rsa][message][id1]" => "Administration:12"
					"[event][categoryid]" => "1603040000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:13
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^InnoDB Tablespace Cannot Automatically Expand^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^InnoDB Tablespace Cannot Automatically Expand^%{action}^%{info}" }
				id => "message-Administration:13"
				add_field => {
				"event_description" => "InnoDB Tablespace Cannot Automatically Expand"
					"[event][id]" => "Administration:13"
					"[rsa][message][id1]" => "Administration:13"
					"[event][categoryid]" => "1603040000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:14
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^InnoDB Transaction Logs Not Sized Correctly^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^InnoDB Transaction Logs Not Sized Correctly^%{action}^%{info}" }
				id => "message-Administration:14"
				add_field => {
				"event_description" => "InnoDB Transaction Logs Not Sized Correctly"
					"[event][id]" => "Administration:14"
					"[rsa][message][id1]" => "Administration:14"
					"[event][categoryid]" => "1603040000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:15
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Key Buffer Size Greater Than 4 GB^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Key Buffer Size Greater Than 4 GB^%{action}^%{info}" }
				id => "message-Administration:15"
				add_field => {
				"event_description" => "Key Buffer Size Greater Than 4 GB"
					"[event][id]" => "Administration:15"
					"[rsa][message][id1]" => "Administration:15"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:16
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Maximum Connection Limit Nearing Or Reached^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Maximum Connection Limit Nearing Or Reached^%{action}^%{info}" }
				id => "message-Administration:16"
				add_field => {
				"event_description" => "Maximum Connection Limit Nearing Or Reached"
					"[event][id]" => "Administration:16"
					"[rsa][message][id1]" => "Administration:16"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:17
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Multiple Threads Used When Repairing MyISAM Tables^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Multiple Threads Used When Repairing MyISAM Tables^%{action}^%{info}" }
				id => "message-Administration:17"
				add_field => {
				"event_description" => "Multiple Threads Used When Repairing MyISAM Tables"
					"[event][id]" => "Administration:17"
					"[rsa][message][id1]" => "Administration:17"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:18
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^MySQL Server Has Been Restarted^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^MySQL Server Has Been Restarted^%{action}^%{info}" }
				id => "message-Administration:18"
				add_field => {
				"event_description" => "MySQL Server Has Been Restarted"
					"[event][id]" => "Administration:18"
					"[rsa][message][id1]" => "Administration:18"
					"[event][categoryid]" => "1606000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:19
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Next-Key Locking Disabled For InnoDB But Binary Logging Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Next-Key Locking Disabled For InnoDB But Binary Logging Enabled^%{action}^%{info}" }
				id => "message-Administration:19"
				add_field => {
				"event_description" => "Next-Key Locking Disabled For InnoDB But Binary Logging Enabled"
					"[event][id]" => "Administration:19"
					"[rsa][message][id1]" => "Administration:19"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:20
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^No Value Set For myisam-recover^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^No Value Set For myisam-recover^%{action}^%{info}" }
				id => "message-Administration:20"
				add_field => {
				"event_description" => "No Value Set For myisam-recover"
					"[event][id]" => "Administration:20"
					"[rsa][message][id1]" => "Administration:20"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:21
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Query Cache Not Available^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Query Cache Not Available^%{action}^%{info}" }
				id => "message-Administration:21"
				add_field => {
				"event_description" => "Query Cache Not Available"
					"[event][id]" => "Administration:21"
					"[rsa][message][id1]" => "Administration:21"
					"[event][categoryid]" => "1603040000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:22
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Table Cache Set Too Low For Startup^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Table Cache Set Too Low For Startup^%{action}^%{info}" }
				id => "message-Administration:22"
				add_field => {
				"event_description" => "Table Cache Set Too Low For Startup"
					"[event][id]" => "Administration:22"
					"[rsa][message][id1]" => "Administration:22"
					"[event][categoryid]" => "1603040000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:23
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^XA Distributed Transaction Support Enabled For InnoDB^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^XA Distributed Transaction Support Enabled For InnoDB^%{action}^%{info}" }
				id => "message-Administration:23"
				add_field => {
				"event_description" => "XA Distributed Transaction Support Enabled For InnoDB"
					"[event][id]" => "Administration:23"
					"[rsa][message][id1]" => "Administration:23"
					"[event][categoryid]" => "1701060000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:24
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^No Value Set For MyISAM Recover Options^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^No Value Set For MyISAM Recover Options^%{action}^%{info}" }
				id => "message-Administration:24"
				add_field => {
				"event_description" => "No Value Set For MyISAM Recover Options"
					"[event][id]" => "Administration:24"
					"[rsa][message][id1]" => "Administration:24"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:25
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^Time Zone Data Not Loaded^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^Time Zone Data Not Loaded^%{action}^%{info}" }
				id => "message-Administration:25"
				add_field => {
				"event_description" => "Time Zone Data Not Loaded"
					"[event][id]" => "Administration:25"
					"[rsa][message][id1]" => "Administration:25"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Administration:26
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Administration:26"
				add_field => {
					"[event][id]" => "Administration:26"
					"[rsa][message][id1]" => "Administration:26"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Heat_Chart" {
		# MESSAGE Heat_Chart:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Agent Host Time Out of Sync Relative to Dashboard^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Agent Host Time Out of Sync Relative to Dashboard^%{action}^%{info}" }
				id => "message-Heat_Chart:01"
				add_field => {
				"event_description" => "Agent Host Time Out of Sync Relative to Dashboard"
					"[event][id]" => "Heat_Chart:01"
					"[rsa][message][id1]" => "Heat_Chart:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Connection Usage Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Connection Usage Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:02"
				add_field => {
				"event_description" => "Connection Usage Excessive"
					"[event][id]" => "Heat_Chart:02"
					"[rsa][message][id1]" => "Heat_Chart:02"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^CPU I/O Usage Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^CPU I/O Usage Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:03"
				add_field => {
				"event_description" => "CPU I/O Usage Excessive"
					"[event][id]" => "Heat_Chart:03"
					"[rsa][message][id1]" => "Heat_Chart:03"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^CPU Usage Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^CPU Usage Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:04"
				add_field => {
				"event_description" => "CPU Usage Excessive"
					"[event][id]" => "Heat_Chart:04"
					"[rsa][message][id1]" => "Heat_Chart:04"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Lock Contention Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Lock Contention Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:05"
				add_field => {
				"event_description" => "Lock Contention Excessive"
					"[event][id]" => "Heat_Chart:05"
					"[rsa][message][id1]" => "Heat_Chart:05"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^MyISAM Key Cache Has Sub-Optimal Hit Rate^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^MyISAM Key Cache Has Sub-Optimal Hit Rate^%{action}^%{info}" }
				id => "message-Heat_Chart:06"
				add_field => {
				"event_description" => "MyISAM Key Cache Has Sub-Optimal Hit Rate"
					"[event][id]" => "Heat_Chart:06"
					"[rsa][message][id1]" => "Heat_Chart:06"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^MySQL Agent Memory Usage Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^MySQL Agent Memory Usage Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:07"
				add_field => {
				"event_description" => "MySQL Agent Memory Usage Excessive"
					"[event][id]" => "Heat_Chart:07"
					"[rsa][message][id1]" => "Heat_Chart:07"
					"[event][categoryid]" => "1603110000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:08
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^MySQL Agent Not Communicating With Database Server^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^MySQL Agent Not Communicating With Database Server^%{action}^%{info}" }
				id => "message-Heat_Chart:08"
				add_field => {
				"event_description" => "MySQL Agent Not Communicating With Database Server"
					"[event][id]" => "Heat_Chart:08"
					"[rsa][message][id1]" => "Heat_Chart:08"
					"[event][categoryid]" => "1603110000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:09
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^MySQL Agent Not Reachable^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^MySQL Agent Not Reachable^%{action}^%{info}" }
				id => "message-Heat_Chart:09"
				add_field => {
				"event_description" => "MySQL Agent Not Reachable"
					"[event][id]" => "Heat_Chart:09"
					"[rsa][message][id1]" => "Heat_Chart:09"
					"[event][categoryid]" => "1603110000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:10
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^MySQL Server Not Reachable^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^MySQL Server Not Reachable^%{action}^%{info}" }
				id => "message-Heat_Chart:10"
				add_field => {
				"event_description" => "MySQL Server Not Reachable"
					"[event][id]" => "Heat_Chart:10"
					"[rsa][message][id1]" => "Heat_Chart:10"
					"[event][categoryid]" => "1603110000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:11
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Query Cache Has Sub-Optimal Hit Rate^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Query Cache Has Sub-Optimal Hit Rate^%{action}^%{info}" }
				id => "message-Heat_Chart:11"
				add_field => {
				"event_description" => "Query Cache Has Sub-Optimal Hit Rate"
					"[event][id]" => "Heat_Chart:11"
					"[rsa][message][id1]" => "Heat_Chart:11"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:12
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^RAM Usage Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^RAM Usage Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:12"
				add_field => {
				"event_description" => "RAM Usage Excessive"
					"[event][id]" => "Heat_Chart:12"
					"[rsa][message][id1]" => "Heat_Chart:12"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:13
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Table Scans Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Table Scans Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:13"
				add_field => {
				"event_description" => "Table Scans Excessive"
					"[event][id]" => "Heat_Chart:13"
					"[rsa][message][id1]" => "Heat_Chart:13"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Heat_Chart:14
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Temporary Tables To Disk Ratio Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Temporary Tables To Disk Ratio Excessive^%{action}^%{info}" }
				id => "message-Heat_Chart:14"
				add_field => {
				"event_description" => "Temporary Tables To Disk Ratio Excessive"
					"[event][id]" => "Heat_Chart:14"
					"[rsa][message][id1]" => "Heat_Chart:14"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Memory_Usage" {
		# MESSAGE Memory_Usage:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Key Buffer Size May Not Be Optimal For Key Cache^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Key Buffer Size May Not Be Optimal For Key Cache^%{action}^%{info}" }
				id => "message-Memory_Usage:01"
				add_field => {
				"event_description" => "Key Buffer Size May Not Be Optimal For Key Cache"
					"[event][id]" => "Memory_Usage:01"
					"[rsa][message][id1]" => "Memory_Usage:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Memory_Usage:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Table Cache Not Optimal^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Table Cache Not Optimal^%{action}^%{info}" }
				id => "message-Memory_Usage:02"
				add_field => {
				"event_description" => "Table Cache Not Optimal"
					"[event][id]" => "Memory_Usage:02"
					"[rsa][message][id1]" => "Memory_Usage:02"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Memory_Usage:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Thread Cache Size May Not Be Optimal^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Thread Cache Size May Not Be Optimal^%{action}^%{info}" }
				id => "message-Memory_Usage:03"
				add_field => {
				"event_description" => "Thread Cache Size May Not Be Optimal"
					"[event][id]" => "Memory_Usage:03"
					"[rsa][message][id1]" => "Memory_Usage:03"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Memory_Usage:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Memory_Usage:04"
				add_field => {
					"[event][id]" => "Memory_Usage:04"
					"[rsa][message][id1]" => "Memory_Usage:04"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Performance" {
		# MESSAGE Performance:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Binary Log Usage Exceeding Disk Cache Memory Limits^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Binary Log Usage Exceeding Disk Cache Memory Limits^%{action}^%{info}" }
				id => "message-Performance:01"
				add_field => {
				"event_description" => "Binary Log Usage Exceeding Disk Cache Memory Limits"
					"[event][id]" => "Performance:01"
					"[rsa][message][id1]" => "Performance:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Data Flushed To Disk After Each SQL Statement^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Data Flushed To Disk After Each SQL Statement^%{action}^%{info}" }
				id => "message-Performance:02"
				add_field => {
				"event_description" => "Data Flushed To Disk After Each SQL Statement"
					"[event][id]" => "Performance:02"
					"[rsa][message][id1]" => "Performance:02"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Excessive Disk Temporary Table Usage Detected^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Excessive Disk Temporary Table Usage Detected^%{action}^%{info}" }
				id => "message-Performance:03"
				add_field => {
				"event_description" => "Excessive Disk Temporary Table Usage Detected"
					"[event][id]" => "Performance:03"
					"[rsa][message][id1]" => "Performance:03"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^InnoDB Buffer Pool Writes May Be Performance Bottleneck^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^InnoDB Buffer Pool Writes May Be Performance Bottleneck^%{action}^%{info}" }
				id => "message-Performance:04"
				add_field => {
				"event_description" => "InnoDB Buffer Pool Writes May Be Performance Bottleneck"
					"[event][id]" => "Performance:04"
					"[rsa][message][id1]" => "Performance:04"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^InnoDB Log Buffer Flushed To Disk After Each Transaction^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^InnoDB Log Buffer Flushed To Disk After Each Transaction^%{action}^%{info}" }
				id => "message-Performance:05"
				add_field => {
				"event_description" => "InnoDB Log Buffer Flushed To Disk After Each Transaction"
					"[event][id]" => "Performance:05"
					"[rsa][message][id1]" => "Performance:05"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^InnoDB Log Waits May Be Performance Bottleneck^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^InnoDB Log Waits May Be Performance Bottleneck^%{action}^%{info}" }
				id => "message-Performance:06"
				add_field => {
				"event_description" => "InnoDB Log Waits May Be Performance Bottleneck"
					"[event][id]" => "Performance:06"
					"[rsa][message][id1]" => "Performance:06"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slow Query Log Not Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slow Query Log Not Enabled^%{action}^%{info}" }
				id => "message-Performance:07"
				add_field => {
				"event_description" => "Slow Query Log Not Enabled"
					"[event][id]" => "Performance:07"
					"[rsa][message][id1]" => "Performance:07"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:08
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Too Many Concurrent Queries Running^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Too Many Concurrent Queries Running^%{action}^%{info}" }
				id => "message-Performance:08"
				add_field => {
				"event_description" => "Too Many Concurrent Queries Running"
					"[event][id]" => "Performance:08"
					"[rsa][message][id1]" => "Performance:08"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Performance:09
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Performance:09"
				add_field => {
					"[event][id]" => "Performance:09"
					"[rsa][message][id1]" => "Performance:09"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Replication" {
		# MESSAGE Replication:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slave Has Been Stopped^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slave Has Been Stopped^%{action}^%{info}" }
				id => "message-Replication:01"
				add_field => {
				"event_description" => "Slave Has Been Stopped"
					"[event][id]" => "Replication:01"
					"[rsa][message][id1]" => "Replication:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slave Has Stopped Replicating^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slave Has Stopped Replicating^%{action}^%{info}" }
				id => "message-Replication:02"
				add_field => {
				"event_description" => "Slave Has Stopped Replicating"
					"[event][id]" => "Replication:02"
					"[rsa][message][id1]" => "Replication:02"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slave I/O Thread Not Running^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slave I/O Thread Not Running^%{action}^%{info}" }
				id => "message-Replication:03"
				add_field => {
				"event_description" => "Slave I/O Thread Not Running"
					"[event][id]" => "Replication:03"
					"[rsa][message][id1]" => "Replication:03"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slave Not Configured As Read Only^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slave Not Configured As Read Only^%{action}^%{info}" }
				id => "message-Replication:04"
				add_field => {
				"event_description" => "Slave Not Configured As Read Only"
					"[event][id]" => "Replication:04"
					"[rsa][message][id1]" => "Replication:04"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slave SQL Thread Not Running^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slave SQL Thread Not Running^%{action}^%{info}" }
				id => "message-Replication:05"
				add_field => {
				"event_description" => "Slave SQL Thread Not Running"
					"[event][id]" => "Replication:05"
					"[rsa][message][id1]" => "Replication:05"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Slave Too Far Behind Master^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Slave Too Far Behind Master^%{action}^%{info}" }
				id => "message-Replication:06"
				add_field => {
				"event_description" => "Slave Too Far Behind Master"
					"[event][id]" => "Replication:06"
					"[rsa][message][id1]" => "Replication:06"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^Binary Log Row Based Images Excessive^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^Binary Log Row Based Images Excessive^%{action}^%{info}" }
				id => "message-Replication:07"
				add_field => {
				"event_description" => "Binary Log Row Based Images Excessive"
					"[event][id]" => "Replication:07"
					"[rsa][message][id1]" => "Replication:07"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:08
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^Master Not Verifying Checksums When Reading From Binary Log^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^Master Not Verifying Checksums When Reading From Binary Log^%{action}^%{info}" }
				id => "message-Replication:08"
				add_field => {
				"event_description" => "Master Not Verifying Checksums When Reading From Binary Log"
					"[event][id]" => "Replication:08"
					"[rsa][message][id1]" => "Replication:08"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Replication:09
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Replication:09"
				add_field => {
					"[event][id]" => "Replication:09"
					"[rsa][message][id1]" => "Replication:09"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Schema" {
		# MESSAGE Schema:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Object Changed: Database Has Been Created^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Object Changed: Database Has Been Created^%{action}^%{info}" }
				id => "message-Schema:01"
				add_field => {
				"event_description" => "Object Changed: Database Has Been Created"
					"[event][id]" => "Schema:01"
					"[rsa][message][id1]" => "Schema:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Schema:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Object Changed: Database Has Been Dropped^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Object Changed: Database Has Been Dropped^%{action}^%{info}" }
				id => "message-Schema:02"
				add_field => {
				"event_description" => "Object Changed: Database Has Been Dropped"
					"[event][id]" => "Schema:02"
					"[rsa][message][id1]" => "Schema:02"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Schema:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Object Changed: Index Has Been Dropped^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Object Changed: Index Has Been Dropped^%{action}^%{info}" }
				id => "message-Schema:03"
				add_field => {
				"event_description" => "Object Changed: Index Has Been Dropped"
					"[event][id]" => "Schema:03"
					"[rsa][message][id1]" => "Schema:03"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Schema:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Object Changed: Table Has Been Dropped^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Object Changed: Table Has Been Dropped^%{action}^%{info}" }
				id => "message-Schema:04"
				add_field => {
				"event_description" => "Object Changed: Table Has Been Dropped"
					"[event][id]" => "Schema:04"
					"[rsa][message][id1]" => "Schema:04"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Schema:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Object Changes Detected^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Object Changes Detected^%{action}^%{info}" }
				id => "message-Schema:05"
				add_field => {
				"event_description" => "Object Changes Detected"
					"[event][id]" => "Schema:05"
					"[rsa][message][id1]" => "Schema:05"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Schema:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Server-Enforced Data Integrity Checking Disabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Server-Enforced Data Integrity Checking Disabled^%{action}^%{info}" }
				id => "message-Schema:06"
				add_field => {
				"event_description" => "Server-Enforced Data Integrity Checking Disabled"
					"[event][id]" => "Schema:06"
					"[rsa][message][id1]" => "Schema:06"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Schema:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Schema:07"
				add_field => {
					"[event][id]" => "Schema:07"
					"[rsa][message][id1]" => "Schema:07"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Security" {
		# MESSAGE Security:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Account Has An Overly Broad Host Specifier^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Account Has An Overly Broad Host Specifier^%{action}^%{info}" }
				id => "message-Security:01"
				add_field => {
				"event_description" => "Account Has An Overly Broad Host Specifier"
					"[event][id]" => "Security:01"
					"[rsa][message][id1]" => "Security:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Account Has Global Privileges^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Account Has Global Privileges^%{action}^%{info}" }
				id => "message-Security:02"
				add_field => {
				"event_description" => "Account Has Global Privileges"
					"[event][id]" => "Security:02"
					"[rsa][message][id1]" => "Security:02"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Account Has Old Insecure Password Hash^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Account Has Old Insecure Password Hash^%{action}^%{info}" }
				id => "message-Security:03"
				add_field => {
				"event_description" => "Account Has Old Insecure Password Hash"
					"[event][id]" => "Security:03"
					"[rsa][message][id1]" => "Security:03"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Account Has Strong MySQL Privileges^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Account Has Strong MySQL Privileges^%{action}^%{info}" }
				id => "message-Security:04"
				add_field => {
				"event_description" => "Account Has Strong MySQL Privileges"
					"[event][id]" => "Security:04"
					"[rsa][message][id1]" => "Security:04"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Insecure Password Authentication Option Is Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Insecure Password Authentication Option Is Enabled^%{action}^%{info}" }
				id => "message-Security:05"
				add_field => {
				"event_description" => "Insecure Password Authentication Option Is Enabled"
					"[event][id]" => "Security:05"
					"[rsa][message][id1]" => "Security:05"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Insecure Password Generation Option Is Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Insecure Password Generation Option Is Enabled^%{action}^%{info}" }
				id => "message-Security:06"
				add_field => {
				"event_description" => "Insecure Password Generation Option Is Enabled"
					"[event][id]" => "Security:06"
					"[rsa][message][id1]" => "Security:06"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^LOCAL Option Of LOAD DATA Statement Is Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^LOCAL Option Of LOAD DATA Statement Is Enabled^%{action}^%{info}" }
				id => "message-Security:07"
				add_field => {
				"event_description" => "LOCAL Option Of LOAD DATA Statement Is Enabled"
					"[event][id]" => "Security:07"
					"[rsa][message][id1]" => "Security:07"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:08
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Non-Authorized User Has DB, Table, Or Index Privileges On All Databases^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Non-Authorized User Has DB, Table, Or Index Privileges On All Databases^%{action}^%{info}" }
				id => "message-Security:08"
				add_field => {
				"event_description" => "Non-Authorized User Has DB, Table, Or Index Privileges On All Databases"
					"[event][id]" => "Security:08"
					"[rsa][message][id1]" => "Security:08"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:09
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Non-Authorized User Has GRANT Privileges On All Databases^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Non-Authorized User Has GRANT Privileges On All Databases^%{action}^%{info}" }
				id => "message-Security:09"
				add_field => {
				"event_description" => "Non-Authorized User Has GRANT Privileges On All Databases"
					"[event][id]" => "Security:09"
					"[rsa][message][id1]" => "Security:09"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:10
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Non-Authorized User Has Server Admin Privileges^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Non-Authorized User Has Server Admin Privileges^%{action}^%{info}" }
				id => "message-Security:10"
				add_field => {
				"event_description" => "Non-Authorized User Has Server Admin Privileges"
					"[event][id]" => "Security:10"
					"[rsa][message][id1]" => "Security:10"
					"[event][categoryid]" => "1501000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:11
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Root Account Can Login Remotely^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Root Account Can Login Remotely^%{action}^%{info}" }
				id => "message-Security:11"
				add_field => {
				"event_description" => "Root Account Can Login Remotely"
					"[event][id]" => "Security:11"
					"[rsa][message][id1]" => "Security:11"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:12
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Root Account Without Password^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Root Account Without Password^%{action}^%{info}" }
				id => "message-Security:12"
				add_field => {
				"event_description" => "Root Account Without Password"
					"[event][id]" => "Security:12"
					"[rsa][message][id1]" => "Security:12"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:13
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Security Alterations Detected: User Privileges Granted^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Security Alterations Detected: User Privileges Granted^%{action}^%{info}" }
				id => "message-Security:13"
				add_field => {
				"event_description" => "Security Alterations Detected: User Privileges Granted"
					"[event][id]" => "Security:13"
					"[rsa][message][id1]" => "Security:13"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:14
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Security Alterations Detected: User Privileges Revoked^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Security Alterations Detected: User Privileges Revoked^%{action}^%{info}" }
				id => "message-Security:14"
				add_field => {
				"event_description" => "Security Alterations Detected: User Privileges Revoked"
					"[event][id]" => "Security:14"
					"[rsa][message][id1]" => "Security:14"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:15
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Security Alterations Have Been Detected^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Security Alterations Have Been Detected^%{action}^%{info}" }
				id => "message-Security:15"
				add_field => {
				"event_description" => "Security Alterations Have Been Detected"
					"[event][id]" => "Security:15"
					"[rsa][message][id1]" => "Security:15"
					"[event][categoryid]" => "1402020300"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:16
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Server Contains Default  { \"test\" | "test" } Database^<action>^<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<hostname>[^\^]*)\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^Server[\s]+Contains[\s]+Default[\s]+([\s]*\\\"test\\\"[\s]+|[\s]*\"test\"[\s]+)[\s]+Database\^(?<action>[^\^]*)\^(?<info>.*)$" }
				id => "message-Security:16"
				add_field => {
				"event_description" => "Server Contains Default test Database"
					"[event][id]" => "Security:16"
					"[rsa][message][id1]" => "Security:16"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:17
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Server Has Accounts Without A Password^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Server Has Accounts Without A Password^%{action}^%{info}" }
				id => "message-Security:17"
				add_field => {
				"event_description" => "Server Has Accounts Without A Password"
					"[event][id]" => "Security:17"
					"[rsa][message][id1]" => "Security:17"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:18
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Server Has Anonymous Accounts^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Server Has Anonymous Accounts^%{action}^%{info}" }
				id => "message-Security:18"
				add_field => {
				"event_description" => "Server Has Anonymous Accounts"
					"[event][id]" => "Security:18"
					"[rsa][message][id1]" => "Security:18"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:19
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Server Includes A Root User Account^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Server Includes A Root User Account^%{action}^%{info}" }
				id => "message-Security:19"
				add_field => {
				"event_description" => "Server Includes A Root User Account"
					"[event][id]" => "Security:19"
					"[rsa][message][id1]" => "Security:19"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:20
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Symlinks Are Enabled^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Symlinks Are Enabled^%{action}^%{info}" }
				id => "message-Security:20"
				add_field => {
				"event_description" => "Symlinks Are Enabled"
					"[event][id]" => "Security:20"
					"[rsa][message][id1]" => "Security:20"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:21
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^User Has Rights To Database That Does Not Exist^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^User Has Rights To Database That Does Not Exist^%{action}^%{info}" }
				id => "message-Security:21"
				add_field => {
				"event_description" => "User Has Rights To Database That Does Not Exist"
					"[event][id]" => "Security:21"
					"[rsa][message][id1]" => "Security:21"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:22
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Users Can View All Databases On MySQL Server^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Users Can View All Databases On MySQL Server^%{action}^%{info}" }
				id => "message-Security:22"
				add_field => {
				"event_description" => "Users Can View All Databases On MySQL Server"
					"[event][id]" => "Security:22"
					"[rsa][message][id1]" => "Security:22"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:23
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^Server Has No Locally Authenticated Root User^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^Server Has No Locally Authenticated Root User^%{action}^%{info}" }
				id => "message-Security:23"
				add_field => {
				"event_description" => "Server Has No Locally Authenticated Root User"
					"[event][id]" => "Security:23"
					"[rsa][message][id1]" => "Security:23"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:24
		# line in RSA: <fld5>, <fld6>, <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld5}, %{fld6}, %{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Security:24"
				add_field => {
					"[event][id]" => "Security:24"
					"[rsa][message][id1]" => "Security:24"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:25
		# line in RSA: {<fld4>, <fld5>|<hostname>}^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^{Subject: <fld6>, Firewall Time: <fld7> Category: <category> Event: <fld8> Status: <fld9>^<info>|Subject: <fld6> Time: <fld7> Category: <category> Event: <fld8> Status: <fld9>^<info>|<fld6>^<info>|<info>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^((?<fld4>[^,]*),[\s]+(?<fld5>[^\^]*)|(?<hostname>[^\^]*))\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(Subject:[\s]+(?<fld6>[^,]*),[\s]+Firewall[\s]+Time:[\s]+(?<fld7>[^\s]*)[\s]+Category:[\s]+(?<category>[^\s]*)[\s]+Event:[\s]+(?<fld8>[^\s]*)[\s]+Status:[\s]+(?<fld9>[^\^]*)\^(?<info>.*)|Subject:[\s]+(?<fld6>[^\s]*)[\s]+Time:[\s]+(?<fld7>[^\s]*)[\s]+Category:[\s]+(?<category>[^\s]*)[\s]+Event:[\s]+(?<fld8>[^\s]*)[\s]+Status:[\s]+(?<fld9>[^\^]*)\^(?<info>.*)|(?<fld6>[^\^]*)\^(?<info>.*)|(?<info>.*))$" }
				id => "message-Security:25"
				add_field => {
					"[event][id]" => "Security:25"
					"[rsa][message][id1]" => "Security:25"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Security:26
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^{Subject: <fld6>, Firewall Time: <fld7> Category: <category> Event: <fld8> Status: <fld9>^<info>|Subject: <fld6> Time: <fld7> Category: <category> Event: <fld8> Status: <fld9>^<info>|<fld4>^<info>|<info>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<hostname>[^\^]*)\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(Subject:[\s]+(?<fld6>[^,]*),[\s]+Firewall[\s]+Time:[\s]+(?<fld7>[^\s]*)[\s]+Category:[\s]+(?<category>[^\s]*)[\s]+Event:[\s]+(?<fld8>[^\s]*)[\s]+Status:[\s]+(?<fld9>[^\^]*)\^(?<info>.*)|Subject:[\s]+(?<fld6>[^\s]*)[\s]+Time:[\s]+(?<fld7>[^\s]*)[\s]+Category:[\s]+(?<category>[^\s]*)[\s]+Event:[\s]+(?<fld8>[^\s]*)[\s]+Status:[\s]+(?<fld9>[^\^]*)\^(?<info>.*)|(?<fld4>[^\^]*)\^(?<info>.*)|(?<info>.*))$" }
				id => "message-Security:26"
				add_field => {
					"[event][id]" => "Security:26"
					"[rsa][message][id1]" => "Security:26"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Upgrade" {
		# MESSAGE Upgrade:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^CREATE TABLE LIKE Does Not Require Any Privileges On Source Table^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^CREATE TABLE LIKE Does Not Require Any Privileges On Source Table^%{action}^%{info}" }
				id => "message-Upgrade:01"
				add_field => {
				"event_description" => "CREATE TABLE LIKE Does Not Require Any Privileges On Source Table"
					"[event][id]" => "Upgrade:01"
					"[rsa][message][id1]" => "Upgrade:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Date-Handling Bugs Can Crash The Server^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Date-Handling Bugs Can Crash The Server^%{action}^%{info}" }
				id => "message-Upgrade:02"
				add_field => {
				"event_description" => "Date-Handling Bugs Can Crash The Server "
					"[event][id]" => "Upgrade:02"
					"[rsa][message][id1]" => "Upgrade:02"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Disabling Next-Key Locking In InnoDB Can Crash The Server^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Disabling Next-Key Locking In InnoDB Can Crash The Server^%{action}^%{info}" }
				id => "message-Upgrade:03"
				add_field => {
				"event_description" => "Disabling Next-Key Locking In InnoDB Can Crash The Server "
					"[event][id]" => "Upgrade:03"
					"[rsa][message][id1]" => "Upgrade:03"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Improper key_cache_block_size Setting Can Corrupt MyISAM Tables^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Improper key_cache_block_size Setting Can Corrupt MyISAM Tables^%{action}^%{info}" }
				id => "message-Upgrade:04"
				add_field => {
				"event_description" => "Improper key_cache_block_size Setting Can Corrupt MyISAM Tables "
					"[event][id]" => "Upgrade:04"
					"[rsa][message][id1]" => "Upgrade:04"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:05
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Malformed Password Packet In Connection Protocol Can Crash Server^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Malformed Password Packet In Connection Protocol Can Crash Server^%{action}^%{info}" }
				id => "message-Upgrade:05"
				add_field => {
				"event_description" => "Malformed Password Packet In Connection Protocol Can Crash Server "
					"[event][id]" => "Upgrade:05"
					"[rsa][message][id1]" => "Upgrade:05"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:06
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Missing Security Improvements In GRANT Options^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Missing Security Improvements In GRANT Options^%{action}^%{info}" }
				id => "message-Upgrade:06"
				add_field => {
				"event_description" => "Missing Security Improvements In GRANT Options "
					"[event][id]" => "Upgrade:06"
					"[rsa][message][id1]" => "Upgrade:06"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:07
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Multi-Byte Encoding Processing Can Lead To SQL Injection^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Multi-Byte Encoding Processing Can Lead To SQL Injection^%{action}^%{info}" }
				id => "message-Upgrade:07"
				add_field => {
				"event_description" => "Multi-Byte Encoding Processing Can Lead To SQL Injection "
					"[event][id]" => "Upgrade:07"
					"[rsa][message][id1]" => "Upgrade:07"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:08
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^No Limit On Total Number Of Prepared Statements^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^No Limit On Total Number Of Prepared Statements^%{action}^%{info}" }
				id => "message-Upgrade:08"
				add_field => {
				"event_description" => "No Limit On Total Number Of Prepared Statements "
					"[event][id]" => "Upgrade:08"
					"[rsa][message][id1]" => "Upgrade:08"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:09
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Row-based Replication Broken For UTF8 CHAR Columns Longer Than 85 Characters^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Row-based Replication Broken For UTF8 CHAR Columns Longer Than 85 Characters^%{action}^%{info}" }
				id => "message-Upgrade:09"
				add_field => {
				"event_description" => "Row-based Replication Broken For UTF8 CHAR Columns Longer Than 85 Characters "
					"[event][id]" => "Upgrade:09"
					"[rsa][message][id1]" => "Upgrade:09"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:10
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Security Risk with BINLOG statement^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Security Risk with BINLOG statement^%{action}^%{info}" }
				id => "message-Upgrade:10"
				add_field => {
				"event_description" => "Security Risk with BINLOG statement "
					"[event][id]" => "Upgrade:10"
					"[rsa][message][id1]" => "Upgrade:10"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:11
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Stored Routine Runs In Definer's Rather Than Caller's Security Context^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Stored Routine Runs In Definer's Rather Than Caller's Security Context^%{action}^%{info}" }
				id => "message-Upgrade:11"
				add_field => {
				"event_description" => "Stored Routine Runs In Definer's Rather Than Caller's Security Context "
					"[event][id]" => "Upgrade:11"
					"[rsa][message][id1]" => "Upgrade:11"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:12
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Use Of View Overrides Column Update Privileges On Underlying Table^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Use Of View Overrides Column Update Privileges On Underlying Table^%{action}^%{info}" }
				id => "message-Upgrade:12"
				add_field => {
				"event_description" => "Use Of View Overrides Column Update Privileges On Underlying Table "
					"[event][id]" => "Upgrade:12"
					"[rsa][message][id1]" => "Upgrade:12"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:13
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^User Can Gain Privileges By Running Stored Routine Declared Using SQL SECURITY INVOKER^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^User Can Gain Privileges By Running Stored Routine Declared Using SQL SECURITY INVOKER^%{action}^%{info}" }
				id => "message-Upgrade:13"
				add_field => {
				"event_description" => "User Can Gain Privileges By Running Stored Routine Declared Using SQL SECURITY INVOKER "
					"[event][id]" => "Upgrade:13"
					"[rsa][message][id1]" => "Upgrade:13"
					"[event][categoryid]" => "1702010000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Upgrade:14
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^User With Only ALTER Privilege On Partitioned Table Can Obtain SELECT Privilege Information^<action>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^User With Only ALTER Privilege On Partitioned Table Can Obtain SELECT Privilege Information^%{action}^%{info}" }
				id => "message-Upgrade:14"
				add_field => {
				"event_description" => "User With Only ALTER Privilege On Partitioned Table Can Obtain SELECT Privilege Information "
					"[event][id]" => "Upgrade:14"
					"[rsa][message][id1]" => "Upgrade:14"
					"[event][categoryid]" => "1402030000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId25
	# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
	else if [logstash][msgparser][id] == "msgParserId25" {
		dissect {
			mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
			id => "msgParserId25"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "Availability" {
		# MESSAGE Availability:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^MySQL server is AVAILABLE
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^MySQL server is AVAILABLE" }
				id => "message-Availability:01"
				add_field => {
				"info" => "MySQL server is AVAILABLE"
					"[event][id]" => "Availability:01"
					"[rsa][message][id1]" => "Availability:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Availability:02
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^MySQL server is UNREACHABLE
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^MySQL server is UNREACHABLE" }
				id => "message-Availability:02"
				add_field => {
				"info" => "MySQL server is UNREACHABLE"
					"[event][id]" => "Availability:02"
					"[rsa][message][id1]" => "Availability:02"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Availability:03
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^MySQL Server Has Been Restarted
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^MySQL Server Has Been Restarted" }
				id => "message-Availability:03"
				add_field => {
				"info" => "MySQL Server Has Been Restarted"
					"[event][id]" => "Availability:03"
					"[rsa][message][id1]" => "Availability:03"
					"[event][categoryid]" => "1606000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Availability:04
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^%{fld4}^%{info}" }
				id => "message-Availability:04"
				add_field => {
					"[event][id]" => "Availability:04"
					"[rsa][message][id1]" => "Availability:04"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "Monitoring_and_Support_Services" {
		# MESSAGE Monitoring_and_Support_Services:01
		# line in RSA: <hostname>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^Subject: <fld4> Time: <fld5> Category: <category> Event: <fld6> Status: <fld7>^<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{hostname}^%{severity}^%{vendor_event_cat}^%{fld1}T%{fld2}.%{fld3}^Subject: %{fld4} Time: %{fld5} Category: %{category} Event: %{fld6} Status: %{fld7}^%{info}" }
				id => "message-Monitoring_and_Support_Services:01"
				add_field => {
					"[event][id]" => "Monitoring_and_Support_Services:01"
					"[rsa][message][id1]" => "Monitoring_and_Support_Services:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Monitoring_and_Support_Services:02
		# line in RSA: {<hostname>, <fld5>|<hostname>}^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^((?<hostname>[^,]*),[\s]+(?<fld5>[^\^]*)|(?<hostname>[^\^]*))\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(?<fld4>[^\^]*)\^(?<info>.*)$" }
				id => "message-Monitoring_and_Support_Services:02"
				add_field => {
					"[event][id]" => "Monitoring_and_Support_Services:02"
					"[rsa][message][id1]" => "Monitoring_and_Support_Services:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId111
	# line in RSA: {<fld5>, <fld6>|<hostname>}^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld4>^<info>
	else if [logstash][msgparser][id] == "msgParserId111" {
		grok {
			match => { "message" => "^((?<fld5>[^,]*),[\s]+(?<fld6>[^\^]*)|(?<hostname>[^\^]*))\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(?<fld4>[^\^]*)\^(?<info>.*)$" }
			id => "msgParserId111"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "Query_Analysis" {
		# MESSAGE Query_Analysis:01
		# line in RSA: {{<fld4> : <fld5>}, <fld6>^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld7>^<info>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^\{(?<fld4>[^\s]*)[\s]+:[\s]+(?<fld5>[^\}]*)\},[\s]+(?<fld6>[^\^]*)\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(?<fld7>[^\^]*)\^(?<info>.*)$" }
				id => "message-Query_Analysis:01"
				add_field => {
					"[event][id]" => "Query_Analysis:01"
					"[rsa][message][id1]" => "Query_Analysis:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE Query_Analysis:02
		# line in RSA: {<fld4>, <hostname>|<hostname>}^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld9>{Subject: <fld5> Time: <fld6> Category: <category> Event: <fld7> Status: <fld8>^<info>|^<info>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^((?<fld4>[^,]*),[\s]+(?<hostname>[^\^]*)|(?<hostname>[^\^]*))\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(?<fld9>[^S\^]*)(Subject:[\s]+(?<fld5>[^\s]*)[\s]+Time:[\s]+(?<fld6>[^\s]*)[\s]+Category:[\s]+(?<category>[^\s]*)[\s]+Event:[\s]+(?<fld7>[^\s]*)[\s]+Status:[\s]+(?<fld8>[^\^]*)\^(?<info>.*)|\^(?<info>.*))$" }
				id => "message-Query_Analysis:02"
				add_field => {
					"[event][id]" => "Query_Analysis:02"
					"[rsa][message][id1]" => "Query_Analysis:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId114
	# line in RSA: {<fld4>, <hostname>|<hostname>}^<severity>^<vendor_event_cat>^<fld1>T<fld2>.<fld3>^<fld5>^<info>
	else if [logstash][msgparser][id] == "msgParserId114" {
		grok {
			match => { "message" => "^((?<fld4>[^,]*),[\s]+(?<hostname>[^\^]*)|(?<hostname>[^\^]*))\^(?<severity>[^\^]*)\^(?<vendor_event_cat>[^\^]*)\^(?<fld1>[^T]*)T(?<fld2>[^\.]*)\.(?<fld3>[^\^]*)\^(?<fld5>[^\^]*)\^(?<info>.*)$" }
			id => "msgParserId114"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld1} %{fld2}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_mysqlmsg.json"
#			template_name => "mysql_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
