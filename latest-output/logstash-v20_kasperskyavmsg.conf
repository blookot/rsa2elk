# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "kasperskyav"
			"[observer][name]" => "Kaspersky Anti-Virus"
			"[observer][type]" => "Anti Virus"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %kasperskyav: <hfld1>^^<hrecorded_time>^^<messageid>^^<!payload:hfld1>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%kasperskyav:[\s]+(?<message>(?<hfld1>[^\^]*)\^\^(?<hrecorded_time>[^\^]*)\^\^(?<messageid>[^\^]*)\^\^(?<payload>.*))$" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %kasperskyav-<hlevel>: <hdate> <htime> <hfld1> <messageid> <!payload:hdate>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%kasperskyav\-(?<hlevel>[^:]*):[\s]+(?<message>(?<hdate>[^\s]*)[\s]+(?<htime>[^\s]*)[\s]+(?<hfld1>[^\s]*)[\s]+(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_kasperskyavmsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "KLSRV_EVENT_HOSTS_NEW_DETECTED" {
		# MESSAGE KLSRV_EVENT_HOSTS_NEW_DETECTED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLSRV_EVENT_HOSTS_NEW_DETECTED:01"
				add_field => {
					"[event][id]" => "KLSRV_EVENT_HOSTS_NEW_DETECTED:01"
					"[rsa][message][id1]" => "KLSRV_EVENT_HOSTS_NEW_DETECTED:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLSRV_EVENT_HOSTS_NEW_DETECTED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
				id => "message-KLSRV_EVENT_HOSTS_NEW_DETECTED"
				add_field => {
					"[event][id]" => "KLSRV_EVENT_HOSTS_NEW_DETECTED"
					"[rsa][message][id1]" => "KLSRV_EVENT_HOSTS_NEW_DETECTED"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId1
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
	else if [logstash][msgparser][id] == "msgParserId1" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
			id => "msgParserId1"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "KLSRV_HOST_STATUS_WARNING" {
		# MESSAGE KLSRV_HOST_STATUS_WARNING:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLSRV_HOST_STATUS_WARNING:01"
				add_field => {
					"[event][id]" => "KLSRV_HOST_STATUS_WARNING:01"
					"[rsa][message][id1]" => "KLSRV_HOST_STATUS_WARNING:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLSRV_HOST_STATUS_WARNING
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
				id => "message-KLSRV_HOST_STATUS_WARNING"
				add_field => {
					"[event][id]" => "KLSRV_HOST_STATUS_WARNING"
					"[rsa][message][id1]" => "KLSRV_HOST_STATUS_WARNING"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId0
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
	else if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
			id => "msgParserId0"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "KLSRV_HOST_STATUS_CRITICAL" {
		# MESSAGE KLSRV_HOST_STATUS_CRITICAL:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLSRV_HOST_STATUS_CRITICAL:01"
				add_field => {
					"[event][id]" => "KLSRV_HOST_STATUS_CRITICAL:01"
					"[rsa][message][id1]" => "KLSRV_HOST_STATUS_CRITICAL:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLSRV_HOST_STATUS_CRITICAL
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
				id => "message-KLSRV_HOST_STATUS_CRITICAL"
				add_field => {
					"[event][id]" => "KLSRV_HOST_STATUS_CRITICAL"
					"[rsa][message][id1]" => "KLSRV_HOST_STATUS_CRITICAL"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "KLAUD_EV_OBJECTMODIFY" {
		# MESSAGE KLAUD_EV_OBJECTMODIFY:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLAUD_EV_OBJECTMODIFY:01"
				add_field => {
					"[event][id]" => "KLAUD_EV_OBJECTMODIFY:01"
					"[rsa][message][id1]" => "KLAUD_EV_OBJECTMODIFY:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLAUD_EV_OBJECTMODIFY
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}" }
				id => "message-KLAUD_EV_OBJECTMODIFY"
				add_field => {
					"[event][id]" => "KLAUD_EV_OBJECTMODIFY"
					"[rsa][message][id1]" => "KLAUD_EV_OBJECTMODIFY"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "KLAUD_EV_TASK_STATE_CHANGED" {
		# MESSAGE KLAUD_EV_TASK_STATE_CHANGED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLAUD_EV_TASK_STATE_CHANGED:01"
				add_field => {
					"[event][id]" => "KLAUD_EV_TASK_STATE_CHANGED:01"
					"[rsa][message][id1]" => "KLAUD_EV_TASK_STATE_CHANGED:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLAUD_EV_TASK_STATE_CHANGED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}" }
				id => "message-KLAUD_EV_TASK_STATE_CHANGED"
				add_field => {
					"[event][id]" => "KLAUD_EV_TASK_STATE_CHANGED"
					"[rsa][message][id1]" => "KLAUD_EV_TASK_STATE_CHANGED"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "KLAUD_EV_ADMGROUP_CHANGED" {
		# MESSAGE KLAUD_EV_ADMGROUP_CHANGED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLAUD_EV_ADMGROUP_CHANGED:01"
				add_field => {
					"[event][id]" => "KLAUD_EV_ADMGROUP_CHANGED:01"
					"[rsa][message][id1]" => "KLAUD_EV_ADMGROUP_CHANGED:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLAUD_EV_ADMGROUP_CHANGED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}" }
				id => "message-KLAUD_EV_ADMGROUP_CHANGED"
				add_field => {
					"[event][id]" => "KLAUD_EV_ADMGROUP_CHANGED"
					"[rsa][message][id1]" => "KLAUD_EV_ADMGROUP_CHANGED"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "KLAUD_EV_SERVERCONNECT" {
		# MESSAGE KLAUD_EV_SERVERCONNECT:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLAUD_EV_SERVERCONNECT:01"
				add_field => {
					"[event][id]" => "KLAUD_EV_SERVERCONNECT:01"
					"[rsa][message][id1]" => "KLAUD_EV_SERVERCONNECT:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLAUD_EV_SERVERCONNECT
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<username>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{username}^^%{fld18}" }
				id => "message-KLAUD_EV_SERVERCONNECT"
				add_field => {
					"[event][id]" => "KLAUD_EV_SERVERCONNECT"
					"[rsa][message][id1]" => "KLAUD_EV_SERVERCONNECT"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GNRL_EV_SUSPICIOUS_OBJECT_FOUND" {
		# MESSAGE GNRL_EV_SUSPICIOUS_OBJECT_FOUND:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<fld18>^^<virusname>^^<username>^^<fld19>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{fld18}^^%{virusname}^^%{username}^^%{fld19}" }
				id => "message-GNRL_EV_SUSPICIOUS_OBJECT_FOUND:01"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_SUSPICIOUS_OBJECT_FOUND:01"
					"[rsa][message][id1]" => "GNRL_EV_SUSPICIOUS_OBJECT_FOUND:01"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_SUSPICIOUS_OBJECT_FOUND
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{fld18}" }
				id => "message-GNRL_EV_SUSPICIOUS_OBJECT_FOUND"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_SUSPICIOUS_OBJECT_FOUND"
					"[rsa][message][id1]" => "GNRL_EV_SUSPICIOUS_OBJECT_FOUND"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GNRL_EV_OBJECT_CURED" {
		# MESSAGE GNRL_EV_OBJECT_CURED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<virusname>^^<username>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{virusname}^^%{username}^^%{fld18}" }
				id => "message-GNRL_EV_OBJECT_CURED:01"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_OBJECT_CURED:01"
					"[rsa][message][id1]" => "GNRL_EV_OBJECT_CURED:01"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_OBJECT_CURED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<virusname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{virusname}" }
				id => "message-GNRL_EV_OBJECT_CURED"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_OBJECT_CURED"
					"[rsa][message][id1]" => "GNRL_EV_OBJECT_CURED"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GNRL_EV_OBJECT_NOTCURED" {
		# MESSAGE GNRL_EV_OBJECT_NOTCURED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-GNRL_EV_OBJECT_NOTCURED:01"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_OBJECT_NOTCURED:01"
					"[rsa][message][id1]" => "GNRL_EV_OBJECT_NOTCURED:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_OBJECT_NOTCURED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<virusname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{virusname}" }
				id => "message-GNRL_EV_OBJECT_NOTCURED"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_OBJECT_NOTCURED"
					"[rsa][message][id1]" => "GNRL_EV_OBJECT_NOTCURED"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GNRL_EV_OBJECT_DELETED" {
		# MESSAGE GNRL_EV_OBJECT_DELETED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^^^<virusname>^^<username>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^^^%{virusname}^^%{username}^^%{fld18}" }
				id => "message-GNRL_EV_OBJECT_DELETED:01"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_OBJECT_DELETED:01"
					"[rsa][message][id1]" => "GNRL_EV_OBJECT_DELETED:01"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_OBJECT_DELETED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<virusname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{virusname}" }
				id => "message-GNRL_EV_OBJECT_DELETED"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_OBJECT_DELETED"
					"[rsa][message][id1]" => "GNRL_EV_OBJECT_DELETED"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GNRL_EV_VIRUS_FOUND" {
		# MESSAGE GNRL_EV_VIRUS_FOUND:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^Virus '<fld7>' detected in message from '<from>' to '<to>'.^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<virusname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^Virus '%{fld7}' detected in message from '%{from}' to '%{to}'.^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{virusname}" }
				id => "message-GNRL_EV_VIRUS_FOUND:01"
				add_field => {
				"obj_type" => "Dangerous Object"
				"event_description" => "Virus detected in email message"
					"[event][id]" => "GNRL_EV_VIRUS_FOUND:01"
					"[rsa][message][id1]" => "GNRL_EV_VIRUS_FOUND:01"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_VIRUS_FOUND:03
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<fld18>^^<virusname>^^<username>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{fld18}^^%{virusname}^^%{username}^^%{fld22}" }
				id => "message-GNRL_EV_VIRUS_FOUND:03"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_VIRUS_FOUND:03"
					"[rsa][message][id1]" => "GNRL_EV_VIRUS_FOUND:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_VIRUS_FOUND:02
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<virusname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{virusname}" }
				id => "message-GNRL_EV_VIRUS_FOUND:02"
				add_field => {
				"obj_type" => "Dangerous Object"
					"[event][id]" => "GNRL_EV_VIRUS_FOUND:02"
					"[rsa][message][id1]" => "GNRL_EV_VIRUS_FOUND:02"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GNRL_EV_ATTACK_DETECTED" {
		# MESSAGE GNRL_EV_ATTACK_DETECTED:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<threat_name>^^<protocol>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{threat_name}^^%{protocol}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-GNRL_EV_ATTACK_DETECTED:01"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Detect"
				"ec_theme" => "TEV"
					"[event][id]" => "GNRL_EV_ATTACK_DETECTED:01"
					"[rsa][message][id1]" => "GNRL_EV_ATTACK_DETECTED:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE GNRL_EV_ATTACK_DETECTED
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
				id => "message-GNRL_EV_ATTACK_DETECTED"
				add_field => {
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Detect"
				"ec_theme" => "TEV"
					"[event][id]" => "GNRL_EV_ATTACK_DETECTED"
					"[rsa][message][id1]" => "GNRL_EV_ATTACK_DETECTED"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "KLEVP_GroupTaskSyncState" {
		# MESSAGE KLEVP_GroupTaskSyncState:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLEVP_GroupTaskSyncState:01"
				add_field => {
					"[event][id]" => "KLEVP_GroupTaskSyncState:01"
					"[rsa][message][id1]" => "KLEVP_GroupTaskSyncState:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLEVP_GroupTaskSyncState
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
				id => "message-KLEVP_GroupTaskSyncState"
				add_field => {
					"[event][id]" => "KLEVP_GroupTaskSyncState"
					"[rsa][message][id1]" => "KLEVP_GroupTaskSyncState"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "KLPRCI_TaskState" {
		# MESSAGE KLPRCI_TaskState:01
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
				id => "message-KLPRCI_TaskState:01"
				add_field => {
					"[event][id]" => "KLPRCI_TaskState:01"
					"[rsa][message][id1]" => "KLPRCI_TaskState:01"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
		# MESSAGE KLPRCI_TaskState
		# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}" }
				id => "message-KLPRCI_TaskState"
				add_field => {
					"[event][id]" => "KLPRCI_TaskState"
					"[rsa][message][id1]" => "KLPRCI_TaskState"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId14
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>
	else if [logstash][msgparser][id] == "msgParserId14" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}" }
			id => "msgParserId14"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "HTTP" {
		# MESSAGE HTTP:Object_Infected
		# line in RSA: <fld11> <fld12> <fld13> <protocol> { object | Object } '<obj_name>' is infected with '<virusname>'(Database date: <fld14>, { Client's | client's } address: <hostip>)
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld11>[^\s]*)[\s]+(?<fld12>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+([\s]*object[\s]+|[\s]*Object[\s]+)[\s]+'(?<obj_name>[^']*)'[\s]+is[\s]+infected[\s]+with[\s]+'(?<virusname>[^']*)'\(Database[\s]+date:[\s]+(?<fld14>[^,]*),[\s]+([\s]*Client's[\s]+|[\s]*client's[\s]+)[\s]+address:[\s]+(?<hostip>[^\)]*)\)$" }
				id => "message-HTTP:Object_Infected"
				add_field => {
				"obj_type" => "%{protocol}"
					"[event][id]" => "HTTP:Object_Infected"
					"[rsa][message][id1]" => "HTTP:Object_Infected"
					"[event][categoryid]" => "1003010000"
					"[logstash][fullDateTimeString]" => "%{fld11} %{fld12} %{fld13}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "M/d/yyyy H:m:s a" ] }
			}
		}
		# MESSAGE HTTP:Object_Scanning_Error
		# line in RSA: <fld11> <fld12> <fld13> <protocol> { object | Object } '<obj_name>' scanning resulted in an error (Database date: <fld14>, { Client's | client's } address: <hostip>)
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld11>[^\s]*)[\s]+(?<fld12>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+([\s]*object[\s]+|[\s]*Object[\s]+)[\s]+'(?<obj_name>[^']*)'[\s]+scanning[\s]+resulted[\s]+in[\s]+an[\s]+error[\s]+\(Database[\s]+date:[\s]+(?<fld14>[^,]*),[\s]+([\s]*Client's[\s]+|[\s]*client's[\s]+)[\s]+address:[\s]+(?<hostip>[^\)]*)\)$" }
				id => "message-HTTP:Object_Scanning_Error"
				add_field => {
				"obj_type" => "%{protocol}"
					"[event][id]" => "HTTP:Object_Scanning_Error"
					"[rsa][message][id1]" => "HTTP:Object_Scanning_Error"
					"[event][categoryid]" => "1603000000"
					"[logstash][fullDateTimeString]" => "%{fld11} %{fld12} %{fld13}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "M/d/yyyy H:m:s a" ] }
			}
		}
		# MESSAGE HTTP:Object_Scanned_And_Clean
		# line in RSA: <fld11> <fld12> <fld13> <protocol> { object | Object } '<obj_name>' has been scanned and flagged as clean(Database date: <fld14>, { Client's | client's } address: <hostip>)
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld11>[^\s]*)[\s]+(?<fld12>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+([\s]*object[\s]+|[\s]*Object[\s]+)[\s]+'(?<obj_name>[^']*)'[\s]+has[\s]+been[\s]+scanned[\s]+and[\s]+flagged[\s]+as[\s]+clean\(Database[\s]+date:[\s]+(?<fld14>[^,]*),[\s]+([\s]*Client's[\s]+|[\s]*client's[\s]+)[\s]+address:[\s]+(?<hostip>[^\)]*)\)$" }
				id => "message-HTTP:Object_Scanned_And_Clean"
				add_field => {
				"obj_type" => "%{protocol}"
					"[event][id]" => "HTTP:Object_Scanned_And_Clean"
					"[rsa][message][id1]" => "HTTP:Object_Scanned_And_Clean"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld11} %{fld12} %{fld13}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "M/d/yyyy H:m:s a" ] }
			}
		}
		# MESSAGE HTTP:Object_Not_Scanned_01
		# line in RSA: <fld11> <fld12> <fld13> <protocol> { object | Object } '<obj_name>' has not been scanned as defined by the policy as <policyname> <fld17> ({ Client's | client's } address: <hostip>)
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld11>[^\s]*)[\s]+(?<fld12>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+([\s]*object[\s]+|[\s]*Object[\s]+)[\s]+'(?<obj_name>[^']*)'[\s]+has[\s]+not[\s]+been[\s]+scanned[\s]+as[\s]+defined[\s]+by[\s]+the[\s]+policy[\s]+as[\s]+(?<policyname>[^\s]*)[\s]+(?<fld17>[^\s]*)[\s]+\(([\s]*Client's[\s]+|[\s]*client's[\s]+)[\s]+address:[\s]+(?<hostip>[^\)]*)\)$" }
				id => "message-HTTP:Object_Not_Scanned_01"
				add_field => {
				"obj_type" => "%{protocol}"
					"[event][id]" => "HTTP:Object_Not_Scanned_01"
					"[rsa][message][id1]" => "HTTP:Object_Not_Scanned_01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld11} %{fld12} %{fld13}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "M/d/yyyy H:m:s a" ] }
			}
		}
		# MESSAGE HTTP:Object_Not_Scanned_02
		# line in RSA: <fld11> <fld12> <fld13> <protocol> { object | Object } '<obj_name>' has not been scanned as defined by the policy ({ Client's | client's } address: <hostip>)
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld11>[^\s]*)[\s]+(?<fld12>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+([\s]*object[\s]+|[\s]*Object[\s]+)[\s]+'(?<obj_name>[^']*)'[\s]+has[\s]+not[\s]+been[\s]+scanned[\s]+as[\s]+defined[\s]+by[\s]+the[\s]+policy[\s]+\(([\s]*Client's[\s]+|[\s]*client's[\s]+)[\s]+address:[\s]+(?<hostip>[^\)]*)\)$" }
				id => "message-HTTP:Object_Not_Scanned_02"
				add_field => {
				"obj_type" => "%{protocol}"
					"[event][id]" => "HTTP:Object_Not_Scanned_02"
					"[rsa][message][id1]" => "HTTP:Object_Not_Scanned_02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld11} %{fld12} %{fld13}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "M/d/yyyy H:m:s a" ] }
			}
		}
		# MESSAGE HTTP:01
		# line in RSA: <fld11> <fld12> <fld13> <protocol> { object | Object } '<obj_name>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<fld11>[^\s]*)[\s]+(?<fld12>[^\s]*)[\s]+(?<fld13>[^\s]*)[\s]+(?<protocol>[^\s]*)[\s]+([\s]*object[\s]+|[\s]*Object[\s]+)[\s]+'(?<obj_name>.*)$" }
				id => "message-HTTP:01"
				add_field => {
				"obj_type" => "%{protocol}"
					"[event][id]" => "HTTP:01"
					"[rsa][message][id1]" => "HTTP:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld11} %{fld12} %{fld13}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "M/d/yyyy H:m:s a" ] }
			}
		}
	}
	# PARSER msgParserId21
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<fld7>^^<fld8>^^<fld15>^^
	else if [logstash][msgparser][id] == "msgParserId21" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{fld7}^^%{fld8}^^%{fld15}^^" }
			id => "msgParserId21"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId22
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^
	else if [logstash][msgparser][id] == "msgParserId22" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^" }
			id => "msgParserId22"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId23
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<fld5>^^<fld7>^^<fld8>^^
	else if [logstash][msgparser][id] == "msgParserId23" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{fld5}^^%{fld7}^^%{fld8}^^" }
			id => "msgParserId23"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId24
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^Object not scanned. Reason: <event_description> Object name: <filename>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>
	else if [logstash][msgparser][id] == "msgParserId24" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^Object not scanned. Reason: %{event_description} Object name: %{filename}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}" }
			id => "msgParserId24"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId25
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<fld5>^^<fld7>^^<product>^^<version>^^<fld8>
	else if [logstash][msgparser][id] == "msgParserId25" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{fld5}^^%{fld7}^^%{product}^^%{version}^^%{fld8}" }
			id => "msgParserId25"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId26
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info> User: <username> Component: <fld5>Result\Description: <event_description>^^<context>^^<product>^^<version>^^<fld15>^^
	else if [logstash][msgparser][id] == "msgParserId26" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info} User: %{username} Component: %{fld5}Result\Description: %{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^" }
			id => "msgParserId26"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId27
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_description>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^Event type:<event_type> Result: <fld23> Object: <obj_name> Object\Path: <url> User:<username> Update ID: <fld51>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
	else if [logstash][msgparser][id] == "msgParserId27" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_description}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^Event type:%{event_type} Result: %{fld23} Object: %{obj_name} Object\Path: %{url} User:%{username} Update ID: %{fld51}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld21}^^%{fld22}" }
			id => "msgParserId27"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId28
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>^^<obj_name>^^<fld17>^^<fld19>^^<virusname>^^<username>^^<fld18>
	else if [logstash][msgparser][id] == "msgParserId28" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}^^%{obj_name}^^%{fld17}^^%{fld19}^^%{virusname}^^%{username}^^%{fld18}" }
			id => "msgParserId28"
			add_field => {
				"obj_type" => "Dangerous Object"
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId29
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^<event_description>^^<context>^^<product>^^<version>^^<fld15>
	else if [logstash][msgparser][id] == "msgParserId29" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^%{event_description}^^%{context}^^%{product}^^%{version}^^%{fld15}" }
			id => "msgParserId29"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId30
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_description>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^Event type:<event_type> Result: <result> {Object: <obj_name> Object\Path: <url> User:<username>(<privilege>)|User:<username>(<privilege>)} Release date: <fld23>^^<context>^^<product>^^<version>^^<fld15>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld21>^^<fld22>
	else if [logstash][msgparser][id] == "msgParserId30" {
		grok {
			match => { "message" => "^(?<fld1>[^\^]*)\^\^(?<fld2>[^\s]*)[\s]+(?<fld3>[^\.]*)\.(?<fld4>[^\^]*)\^\^(?<event_description>[^\^]*)\^\^(?<fld6>[^\^]*)\^\^(?<hostip>[^\^]*)\^\^(?<hostname>[^\^]*)\^\^(?<group_object>[^\^]*)\^\^(?<info>[^\^]*)\^\^Event[\s]+type:(?<event_type>[^\s]*)[\s]+Result:[\s]+(?<result>[^\s]*)[\s]+(Object:[\s]+(?<obj_name>[^\s]*)[\s]+Object\\Path:[\s]+(?<url>[^\s]*)[\s]+User:(?<username>[^\(]*)\((?<privilege>[^\)]*)\)|User:(?<username>[^\(]*)\((?<privilege>[^\)]*)\))[\s]+Release[\s]+date:[\s]+(?<fld23>[^\^]*)\^\^(?<context>[^\^]*)\^\^(?<product>[^\^]*)\^\^(?<version>[^\^]*)\^\^(?<fld15>[^\^]*)\^\^(?<fld16>[^\^]*)\^\^(?<fld17>[^\^]*)\^\^(?<fld18>[^\^]*)\^\^(?<fld19>[^\^]*)\^\^(?<fld21>[^\^]*)\^\^(?<fld22>.*)$" }
			id => "msgParserId30"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}
	# PARSER msgParserId31
	# line in RSA: <fld1>^^<fld2> <fld3>.<fld4>^^<event_type>^^<fld6>^^<hostip>^^<hostname>^^<group_object>^^<info>^^Object not quarantined. Reason: <event_description>^^<context>^^<product>^^<version>^^<filename>^^<fld16>^^<fld17>^^<fld18>^^<fld19>^^<fld20>^^<fld21>
	else if [logstash][msgparser][id] == "msgParserId31" {
		dissect {
			mapping => { "message" => "%{fld1}^^%{fld2} %{fld3}.%{fld4}^^%{event_type}^^%{fld6}^^%{hostip}^^%{hostname}^^%{group_object}^^%{info}^^Object not quarantined. Reason: %{event_description}^^%{context}^^%{product}^^%{version}^^%{filename}^^%{fld16}^^%{fld17}^^%{fld18}^^%{fld19}^^%{fld20}^^%{fld21}" }
			id => "msgParserId31"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld2} %{fld3}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "yyyy-M-d HH:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}

# Enrich events using VALUEMAP
filter {
	translate {
		field => "[fld6]"
		destination => "[severity]"
		dictionary => {
			"1" => "Info"
			"2" => "Warning"
			"3" => "Error"
			"4" => "Critical"
		}
		fallback => ""
		override => true
	}
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_kasperskyavmsg.json"
#			template_name => "kasperskyav_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
