# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "checkpointfw1"
			"[observer][name]" => "Check Point FW-1"
			"[observer][type]" => "Firewall"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %CHKPNT-<hlevel>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%CHKPNT-%{hlevel}-%{messageid}: %{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: <month> <day> <year> <time> %CHKPNT-<hlevel>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{month} %{day} %{year} %{time} %CHKPNT-%{hlevel}-%{messageid}: %{message}" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: <month> <day> <year> <time> %CHKPNT: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{month} %{day} %{year} %{time} %CHKPNT: %{message}" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "CHECKPOINT_EVENT"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_checkpointfw1msg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	# PARSER msgParserId0
	# line in RSA: System Message: <msg>
	if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "System Message: %{msg}" }
			id => "msgParserId0"
			add_field => {
				"level" => "%{hlevel}"
				"ntype" => "15"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId1
	# line in RSA: <msg>
	else if [logstash][msgparser][id] == "msgParserId1" {
		dissect {
			mapping => { "message" => "%{msg}" }
			id => "msgParserId1"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId2
	# line in RSA: Kernel Message: <msg>
	else if [logstash][msgparser][id] == "msgParserId2" {
		dissect {
			mapping => { "message" => "Kernel Message: %{msg}" }
			id => "msgParserId2"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId3
	# line in RSA: Alert: <msg>
	else if [logstash][msgparser][id] == "msgParserId3" {
		dissect {
			mapping => { "message" => "Alert: %{msg}" }
			id => "msgParserId3"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "020010" {
		# MESSAGE 020010:01
		# line in RSA: Authentication failed for user <username> from <saddr>/<sport> to <daddr>/<dport> interface:<interface> rule:<rule>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Authentication failed for user %{username} from %{saddr}/%{sport} to %{daddr}/%{dport} interface:%{interface} rule:%{rule}" }
				id => "message-020010:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"list_name" => "%{rule}"
				"ntype" => "22"
				"result" => "failed"
					"[event][id]" => "020010:01"
					"[rsa][message][id1]" => "020010:01"
					"[event][categoryid]" => "1301020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 020010
		# line in RSA: Authentication succeeded for user <username> from <saddr>/<sport> to <daddr>/<dport> interface:<interface> rule:<rule>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Authentication succeeded for user %{username} from %{saddr}/%{sport} to %{daddr}/%{dport} interface:%{interface} rule:%{rule}" }
				id => "message-020010"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"list_name" => "%{rule}"
				"ntype" => "21"
				"result" => "succeeded"
					"[event][id]" => "020010"
					"[rsa][message][id1]" => "020010"
					"[event][categoryid]" => "1401060000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "020011" {
		# MESSAGE 020011:01
		# line in RSA: Authentication failed for user <username> from <saddr>/<sport> to <daddr>/<dport> interface:<interface> rule:<rule>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Authentication failed for user %{username} from %{saddr}/%{sport} to %{daddr}/%{dport} interface:%{interface} rule:%{rule}" }
				id => "message-020011:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"list_name" => "%{rule}"
				"ntype" => "22"
				"result" => "failed"
					"[event][id]" => "020011:01"
					"[rsa][message][id1]" => "020011:01"
					"[event][categoryid]" => "1301020000"
					"[logstash][messagefound]" => true
				}
			}
		}
		# MESSAGE 020011
		# line in RSA: Authentication succeeded for user <username> from <saddr>/<sport> to <daddr>/<dport> interface:<interface> rule:<rule>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Authentication succeeded for user %{username} from %{saddr}/%{sport} to %{daddr}/%{dport} interface:%{interface} rule:%{rule}" }
				id => "message-020011"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"list_name" => "%{rule}"
				"ntype" => "21"
				"result" => "succeeded"
					"[event][id]" => "020011"
					"[rsa][message][id1]" => "020011"
					"[event][categoryid]" => "1401060000"
					"[logstash][messagefound]" => true
				}
			}
		}
	}
	else if [logstash][msgparser][id] == "020060" {
		# MESSAGE 020060:23
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld81>,<policy_id>,<fld79>,<fld80>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld81>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020060:23"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"action" => "drop"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:23"
					"[rsa][message][id1]" => "020060:23"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:03
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld81>,<policy_id>,<fld79>,<fld80>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld81>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020060:03"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"action" => "drop"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:03"
					"[rsa][message][id1]" => "020060:03"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:02
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020060:02"
				add_field => {
				"level" => "%{hlevel}"
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"action" => "drop"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:02"
					"[rsa][message][id1]" => "020060:02"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:24
		# line in RSA: reject,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld81>,<policy_id>,<fld79>,<fld80>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^reject,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld81>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020060:24"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"action" => "reject"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:24"
					"[rsa][message][id1]" => "020060:24"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:04
		# line in RSA: reject,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld81>,<policy_id>,<fld79>,<fld80>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^reject,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld81>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020060:04"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"action" => "reject"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:04"
					"[rsa][message][id1]" => "020060:04"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:01
		# line in RSA: reject,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^reject,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020060:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"action" => "reject"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:01"
					"[rsa][message][id1]" => "020060:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:25
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020060:25"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:25"
					"[rsa][message][id1]" => "020060:25"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060:05
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020060:05"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060:05"
					"[rsa][message][id1]" => "020060:05"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020060
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020060"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020060"
					"[rsa][message][id1]" => "020060"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "020070" {
		# MESSAGE 020070:24
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<event_description>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>,<fld81>,<fld82>,<fld83>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<event_description>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<fld83>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020070:24"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020070:24"
					"[rsa][message][id1]" => "020070:24"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020070:04
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<event_description>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>,<fld81>,<fld82>,<fld83>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<event_description>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<fld83>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020070:04"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020070:04"
					"[rsa][message][id1]" => "020070:04"
					"[event][categoryid]" => "1608010000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020070:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>, Log file has been switched to: <fld81>,<fld82>,<fld83>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),[\s]+Log[\s]+file[\s]+has[\s]+been[\s]+switched[\s]+to:[\s]+(?<fld81>[^,]*),(?<fld82>[^,]*),(?<fld83>[^,]*),(?<rule_uid>.*)$" }
				id => "message-020070:03"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
				"event_description" => "Log file has been switched"
					"[event][id]" => "020070:03"
					"[rsa][message][id1]" => "020070:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020070:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>, Log file <fld81> has been deleted by the "<fld84>" mechanism,<fld82>,<fld83>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),[\s]+Log[\s]+file[\s]+(?<fld81>[^\s]*)[\s]+has[\s]+been[\s]+deleted[\s]+by[\s]+the[\s]+\"(?<fld84>[^\"]*)\"[\s]+mechanism,(?<fld82>[^,]*),(?<fld83>[^,]*),(?<rule_uid>.*)$" }
				id => "message-020070:02"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
				"event_description" => "Log file has been deleted"
					"[event][id]" => "020070:02"
					"[rsa][message][id1]" => "020070:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020070:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<event_description>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld77>,<fld78>,<fld79>,<fld80>, <fld81>,<fld82>,<fld83>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<event_description>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld77>[^,]*),(?<fld78>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),[\s]+(?<fld81>[^,]*),(?<fld82>[^,]*),(?<fld83>[^,]*),(?<rule_uid>.*)$" }
				id => "message-020070:01"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020070:01"
					"[rsa][message][id1]" => "020070:01"
					"[event][categoryid]" => "1608010000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020070
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020070"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020070"
					"[rsa][message][id1]" => "020070"
					"[event][categoryid]" => "1608010000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "020080" {
		# MESSAGE 020080:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020080:21"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020080:21"
					"[rsa][message][id1]" => "020080:21"
					"[event][categoryid]" => "1603090000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020080:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020080:01"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020080:01"
					"[rsa][message][id1]" => "020080:01"
					"[event][categoryid]" => "1603090000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020080
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020080"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020080"
					"[rsa][message][id1]" => "020080"
					"[event][categoryid]" => "1603090000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "020090" {
		# MESSAGE 020090:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020090:22"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020090:22"
					"[rsa][message][id1]" => "020090:22"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020090:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020090:02"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020090:02"
					"[rsa][message][id1]" => "020090:02"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020090:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld81>,<policy_id>,<fld79>,<fld80>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld81>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020090:21"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020090:21"
					"[rsa][message][id1]" => "020090:21"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020090:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld81>,<policy_id>,<fld79>,<fld80>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld81>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020090:01"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020090:01"
					"[rsa][message][id1]" => "020090:01"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020090
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020090"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020090"
					"[rsa][message][id1]" => "020090"
					"[event][categoryid]" => "1609000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "020100" {
		# MESSAGE 020100:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020100:21"
				add_field => {
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020100:21"
					"[rsa][message][id1]" => "020100:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020100:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020100:01"
				add_field => {
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020100:01"
					"[rsa][message][id1]" => "020100:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020100:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>.*)$" }
				id => "message-020100:31"
				add_field => {
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020100:31"
					"[rsa][message][id1]" => "020100:31"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020100
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020100"
				add_field => {
				"level" => "%{hlevel}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020100"
					"[rsa][message][id1]" => "020100"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "020110" {
		# MESSAGE 020110:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-020110:21"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020110:21"
					"[rsa][message][id1]" => "020110:21"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020110:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-020110:01"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020110:01"
					"[rsa][message][id1]" => "020110:01"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020110:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>.*)$" }
				id => "message-020110:31"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020110:31"
					"[rsa][message][id1]" => "020110:31"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 020110
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-020110"
				add_field => {
				"level" => "%{hlevel}"
				"priority" => "%{event_type}"
				"shost" => "%{event_computer}"
					"[event][id]" => "020110"
					"[rsa][message][id1]" => "020110"
					"[event][categoryid]" => "1304000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "021050" {
		# MESSAGE 021050:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-021050:21"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"fhost" => "%{event_computer}"
					"[event][id]" => "021050:21"
					"[rsa][message][id1]" => "021050:21"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 021050:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-021050:01"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"fhost" => "%{event_computer}"
					"[event][id]" => "021050:01"
					"[rsa][message][id1]" => "021050:01"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 021050
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,{<fld62>,<fld63>,<peer_id> and host: <hostip>|<fld62>,<peer_id> and host: <hostip>},<ike_cookie1>,<ike_cookie2>,<icmptype>,{, <icmpcode>,<fld64>,|,<icmpcode>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),((?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^\s]*)[\s]+and[\s]+host:[\s]+(?<hostip>[^,]*)|(?<fld62>[^,]*),(?<peer_id>[^\s]*)[\s]+and[\s]+host:[\s]+(?<hostip>[^,]*)),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(,[\s]+(?<icmpcode>[^,]*),(?<fld64>[^,]*),|,(?<icmpcode>.*))$" }
				id => "message-021050"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"fhost" => "%{event_computer}"
					"[event][id]" => "021050"
					"[rsa][message][id1]" => "021050"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId33
	# line in RSA: SMTP Agent: <agent>
	else if [logstash][msgparser][id] == "msgParserId33" {
		dissect {
			mapping => { "message" => "SMTP Agent: %{agent}" }
			id => "msgParserId33"
			add_field => {
				"level" => "%{hlevel}"
				"protocol" => "SMTP"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId34
	# line in RSA: SMTP Error: <result>
	else if [logstash][msgparser][id] == "msgParserId34" {
		dissect {
			mapping => { "message" => "SMTP Error: %{result}" }
			id => "msgParserId34"
			add_field => {
				"level" => "%{hlevel}"
				"protocol" => "SMTP"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId35
	# line in RSA: SMTP From: <from>
	else if [logstash][msgparser][id] == "msgParserId35" {
		dissect {
			mapping => { "message" => "SMTP From: %{from}" }
			id => "msgParserId35"
			add_field => {
				"level" => "%{hlevel}"
				"protocol" => "SMTP"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId36
	# line in RSA: SMTP Orig From: <trans_from>
	else if [logstash][msgparser][id] == "msgParserId36" {
		dissect {
			mapping => { "message" => "SMTP Orig From: %{trans_from}" }
			id => "msgParserId36"
			add_field => {
				"level" => "%{hlevel}"
				"protocol" => "SMTP"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId37
	# line in RSA: SMTP To: <to>
	else if [logstash][msgparser][id] == "msgParserId37" {
		dissect {
			mapping => { "message" => "SMTP To: %{to}" }
			id => "msgParserId37"
			add_field => {
				"level" => "%{hlevel}"
				"protocol" => "SMTP"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId38
	# line in RSA: SMTP Orig To: <trans_to>
	else if [logstash][msgparser][id] == "msgParserId38" {
		dissect {
			mapping => { "message" => "SMTP Orig To: %{trans_to}" }
			id => "msgParserId38"
			add_field => {
				"level" => "%{hlevel}"
				"protocol" => "SMTP"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "030050" {
		# MESSAGE 030050:24
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-030050:24"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "030050:24"
					"[rsa][message][id1]" => "030050:24"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-030050:22"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "030050:22"
					"[rsa][message][id1]" => "030050:22"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-030050:02"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030050:02"
					"[rsa][message][id1]" => "030050:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:32
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>.*)$" }
				id => "message-030050:32"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030050:32"
					"[rsa][message][id1]" => "030050:32"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-030050"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030050"
					"[rsa][message][id1]" => "030050"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:25
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-030050:25"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "030050:25"
					"[rsa][message][id1]" => "030050:25"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-030050:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "030050:23"
					"[rsa][message][id1]" => "030050:23"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-030050:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030050:03"
					"[rsa][message][id1]" => "030050:03"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030050:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-030050:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030050:01"
					"[rsa][message][id1]" => "030050:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "030060" {
		# MESSAGE 030060:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-030060:22"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "030060:22"
					"[rsa][message][id1]" => "030060:22"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030060:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-030060:02"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030060:02"
					"[rsa][message][id1]" => "030060:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030060
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-030060"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030060"
					"[rsa][message][id1]" => "030060"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030060:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-030060:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "030060:23"
					"[rsa][message][id1]" => "030060:23"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030060:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-030060:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030060:03"
					"[rsa][message][id1]" => "030060:03"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030060:33
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>.*)$" }
				id => "message-030060:33"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030060:33"
					"[rsa][message][id1]" => "030060:33"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 030060:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-030060:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "030060:01"
					"[rsa][message][id1]" => "030060:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031050" {
		# MESSAGE 031050:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031050:22"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "031050:22"
					"[rsa][message][id1]" => "031050:22"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031050:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<fld82>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<fld82>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031050:02"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031050:02"
					"[rsa][message][id1]" => "031050:02"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031050:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031050:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031050:01"
					"[rsa][message][id1]" => "031050:01"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031050
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031050"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031050"
					"[rsa][message][id1]" => "031050"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031060" {
		# MESSAGE 031060:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031060:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "031060:23"
					"[rsa][message][id1]" => "031060:23"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031060:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031060:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031060:03"
					"[rsa][message][id1]" => "031060:03"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031060:33
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-031060:33"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031060:33"
					"[rsa][message][id1]" => "031060:33"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031060:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>.*)$" }
				id => "message-031060:02"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031060:02"
					"[rsa][message][id1]" => "031060:02"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031060:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>.*)$" }
				id => "message-031060:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031060:01"
					"[rsa][message][id1]" => "031060:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031060
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031060"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031060"
					"[rsa][message][id1]" => "031060"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031065" {
		# MESSAGE 031065:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031065:21"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "031065:21"
					"[rsa][message][id1]" => "031065:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031065:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031065:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031065:01"
					"[rsa][message][id1]" => "031065:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031065:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-031065:31"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031065:31"
					"[rsa][message][id1]" => "031065:31"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031065
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031065"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031065"
					"[rsa][message][id1]" => "031065"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031070" {
		# MESSAGE 031070:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031070:22"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "031070:22"
					"[rsa][message][id1]" => "031070:22"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031070:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031070:02"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031070:02"
					"[rsa][message][id1]" => "031070:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031070:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031070:21"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "031070:21"
					"[rsa][message][id1]" => "031070:21"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031070:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031070:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031070:01"
					"[rsa][message][id1]" => "031070:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031070
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031070"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031070"
					"[rsa][message][id1]" => "031070"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031080" {
		# MESSAGE 031080:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031080:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "031080:23"
					"[rsa][message][id1]" => "031080:23"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031080:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031080:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031080:03"
					"[rsa][message][id1]" => "031080:03"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031080:33
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-031080:33"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031080:33"
					"[rsa][message][id1]" => "031080:33"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031080:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>.*)$" }
				id => "message-031080:02"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031080:02"
					"[rsa][message][id1]" => "031080:02"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031080:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>.*)$" }
				id => "message-031080:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031080:01"
					"[rsa][message][id1]" => "031080:01"
					"[event][categoryid]" => "1801020100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031080
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031080"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031080"
					"[rsa][message][id1]" => "031080"
					"[event][categoryid]" => "1801020100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031085" {
		# MESSAGE 031085:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031085:21"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "031085:21"
					"[rsa][message][id1]" => "031085:21"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031085:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031085:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031085:01"
					"[rsa][message][id1]" => "031085:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031085:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-031085:31"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031085:31"
					"[rsa][message][id1]" => "031085:31"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031085
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031085"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031085"
					"[rsa][message][id1]" => "031085"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "031090" {
		# MESSAGE 031090:24
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031090:24"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
					"[event][id]" => "031090:24"
					"[rsa][message][id1]" => "031090:24"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:04
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031090:04"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031090:04"
					"[rsa][message][id1]" => "031090:04"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:34
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-031090:34"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031090:34"
					"[rsa][message][id1]" => "031090:34"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:22
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031090:22"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
					"[event][id]" => "031090:22"
					"[rsa][message][id1]" => "031090:22"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:02
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031090:02"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031090:02"
					"[rsa][message][id1]" => "031090:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031090:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "031090:23"
					"[rsa][message][id1]" => "031090:23"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031090:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031090:03"
					"[rsa][message][id1]" => "031090:03"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-031090:21"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "031090:21"
					"[rsa][message][id1]" => "031090:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-031090:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031090:01"
					"[rsa][message][id1]" => "031090:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 031090
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-031090"
				add_field => {
				"level" => "%{hlevel}"
				"method" => "%{encryption_type}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "031090"
					"[rsa][message][id1]" => "031090"
					"[event][categoryid]" => "1801010100"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId72
	# line in RSA: Decrypt Failure: <fld>
	else if [logstash][msgparser][id] == "msgParserId72" {
		dissect {
			mapping => { "message" => "Decrypt Failure: %{fld}" }
			id => "msgParserId72"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId73
	# line in RSA: Encrypt Failure: <fld>
	else if [logstash][msgparser][id] == "msgParserId73" {
		dissect {
			mapping => { "message" => "Encrypt Failure: %{fld}" }
			id => "msgParserId73"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId74
	# line in RSA: ISAKMP Log: <fld>
	else if [logstash][msgparser][id] == "msgParserId74" {
		dissect {
			mapping => { "message" => "ISAKMP Log: %{fld}" }
			id => "msgParserId74"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId75
	# line in RSA: <fld>
	else if [logstash][msgparser][id] == "msgParserId75" {
		dissect {
			mapping => { "message" => "%{fld}" }
			id => "msgParserId75"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId76
	# line in RSA: Encrypt Method: <fld>
	else if [logstash][msgparser][id] == "msgParserId76" {
		dissect {
			mapping => { "message" => "Encrypt Method: %{fld}" }
			id => "msgParserId76"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId77
	# line in RSA: Negotiation Id: <fld>
	else if [logstash][msgparser][id] == "msgParserId77" {
		dissect {
			mapping => { "message" => "Negotiation Id: %{fld}" }
			id => "msgParserId77"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId78
	# line in RSA: Certificate Auth: <fld>
	else if [logstash][msgparser][id] == "msgParserId78" {
		dissect {
			mapping => { "message" => "Certificate Auth: %{fld}" }
			id => "msgParserId78"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId79
	# line in RSA: Security Parameter Index: <fld>
	else if [logstash][msgparser][id] == "msgParserId79" {
		dissect {
			mapping => { "message" => "Security Parameter Index: %{fld}" }
			id => "msgParserId79"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId80
	# line in RSA: Source Encryption Key: <fld>
	else if [logstash][msgparser][id] == "msgParserId80" {
		dissect {
			mapping => { "message" => "Source Encryption Key: %{fld}" }
			id => "msgParserId80"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId81
	# line in RSA: Dst Encryption Key: <fld>
	else if [logstash][msgparser][id] == "msgParserId81" {
		dissect {
			mapping => { "message" => "Dst Encryption Key: %{fld}" }
			id => "msgParserId81"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "040300" {
		# MESSAGE 040300:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-040300:22"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
					"[event][id]" => "040300:22"
					"[rsa][message][id1]" => "040300:22"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040300:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-040300:21"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
					"[event][id]" => "040300:21"
					"[rsa][message][id1]" => "040300:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040300:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-040300:01"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040300:01"
					"[rsa][message][id1]" => "040300:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040300:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-040300:31"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040300:31"
					"[rsa][message][id1]" => "040300:31"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040300
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-040300"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040300"
					"[rsa][message][id1]" => "040300"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "040400" {
		# MESSAGE 040400:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-040400:21"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "040400:21"
					"[rsa][message][id1]" => "040400:21"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040400:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-040400:01"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040400:01"
					"[rsa][message][id1]" => "040400:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040400:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-040400:31"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040400:31"
					"[rsa][message][id1]" => "040400:31"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040400
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-040400"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040400"
					"[rsa][message][id1]" => "040400"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "040500" {
		# MESSAGE 040500:24
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-040500:24"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
					"[event][id]" => "040500:24"
					"[rsa][message][id1]" => "040500:24"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:22
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-040500:22"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
					"[event][id]" => "040500:22"
					"[rsa][message][id1]" => "040500:22"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:02
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-040500:02"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040500:02"
					"[rsa][message][id1]" => "040500:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:32
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-040500:32"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040500:32"
					"[rsa][message][id1]" => "040500:32"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:01
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-040500:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"orig_from" => "%{from}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040500:01"
					"[rsa][message][id1]" => "040500:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-040500:23"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "040500:23"
					"[rsa][message][id1]" => "040500:23"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-040500:03"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040500:03"
					"[rsa][message][id1]" => "040500:03"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500:33
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-040500:33"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040500:33"
					"[rsa][message][id1]" => "040500:33"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 040500
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-040500"
				add_field => {
				"level" => "%{hlevel}"
				"orig_from" => "%{from}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "040500"
					"[rsa][message][id1]" => "040500"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId96
	# line in RSA: Deny inbound <protocol> from <saddr>/<sport> to <daddr>/<dport> rule <rule>
	else if [logstash][msgparser][id] == "msgParserId96" {
		dissect {
			mapping => { "message" => "Deny inbound %{protocol} from %{saddr}/%{sport} to %{daddr}/%{dport} rule %{rule}" }
			id => "msgParserId96"
			add_field => {
				"level" => "%{hlevel}"
				"inout" => "0"
				"action" => "Deny"
				"direction" => "inbound"
				"[logstash][messagefound]" => true
			}
		}
	}
	# PARSER msgParserId97
	# line in RSA: Deny outbound <protocol> from <saddr>/<sport> to <daddr>/<dport> rule <rule>
	else if [logstash][msgparser][id] == "msgParserId97" {
		dissect {
			mapping => { "message" => "Deny outbound %{protocol} from %{saddr}/%{sport} to %{daddr}/%{dport} rule %{rule}" }
			id => "msgParserId97"
			add_field => {
				"level" => "%{hlevel}"
				"inout" => "1"
				"action" => "Deny"
				"direction" => "outbound"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "050100" {
		# MESSAGE 050100:28
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",rule=<rule>,rule_uid={{<fld1>},rule_name={"<rulename>"|<rulename>},{service_id=<fld20>,src=<saddr>|src=<saddr>},s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,xlatesrc=<stransaddr>,xlatedst=<dtransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>|proto=<protocol>},__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",origin_sic_name=<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",rule=(?<rule>[^,]*),rule_uid=\{(?<fld1>[^\}]*)\},rule_name=(\"(?<rulename>[^\"]*)\"|(?<rulename>[^,]*)),(service_id=(?<fld20>[^,]*),src=(?<saddr>[^,]*)|src=(?<saddr>[^,]*)),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),xlatesrc=(?<stransaddr>[^,]*),xlatedst=(?<dtransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>[^,]*)|proto=(?<protocol>[^,]*)),__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",origin_sic_name=(?<fld10>.*)$" }
				id => "message-050100:28"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050100:28"
					"[rsa][message][id1]" => "050100:28"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050100:29
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",rule=<rule>,rule_uid={{<fld1>},{service_id=<fld20>,src=<saddr>|src=<saddr>},s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,xlatesrc=<stransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>|proto=<protocol>},__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",origin_sic_name=<fld10>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",rule=(?<rule>[^,]*),rule_uid=\{(?<fld1>[^\}]*)\},(service_id=(?<fld20>[^,]*),src=(?<saddr>[^,]*)|src=(?<saddr>[^,]*)),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),xlatesrc=(?<stransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>[^,]*)|proto=(?<protocol>[^,]*)),__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",origin_sic_name=(?<fld10>.*)$" }
				id => "message-050100:29"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050100:29"
					"[rsa][message][id1]" => "050100:29"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050100:26
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050100:26"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050100:26"
					"[rsa][message][id1]" => "050100:26"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:24
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050100:24"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050100:24"
					"[rsa][message][id1]" => "050100:24"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:04
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-050100:04"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:04"
					"[rsa][message][id1]" => "050100:04"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:34
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-050100:34"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:34"
					"[rsa][message][id1]" => "050100:34"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>.*)$" }
				id => "message-050100:02"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:02"
					"[rsa][message][id1]" => "050100:02"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-050100"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100"
					"[rsa][message][id1]" => "050100"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:27
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050100:27"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050100:27"
					"[rsa][message][id1]" => "050100:27"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:25
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050100:25"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050100:25"
					"[rsa][message][id1]" => "050100:25"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:05
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-050100:05"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:05"
					"[rsa][message][id1]" => "050100:05"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:35
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-050100:35"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:35"
					"[rsa][message][id1]" => "050100:35"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>.*)$" }
				id => "message-050100:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:03"
					"[rsa][message][id1]" => "050100:03"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-050100:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050100:01"
					"[rsa][message][id1]" => "050100:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050100:36
		# line in RSA: time=<fld85>,action=<action>,Origin=<hostname>,i/f_name=<interface>,src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,origin_sic_name=<fld7>,srckeyid=<src_spi>,dstkeyid=<dst_spi>,peer gateway=<peer>,msgid=<fld3>,user=<username>,community=<fld9>,CookieI=<ike_cookie1>,CookieR=<ike_cookie2>,fw_subproduct=<product>,vpn_feature_name=<fld5>,scheme:=<scheme>,O=<fld10>,methods:=<encryption_type>,IKE:=<ike>,ike_ids=<peer_id>,IKE IDs:=<peer_id>,session_id:=<sessionid>,orig_name=<vsys>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},action=%{action},Origin=%{hostname},i/f_name=%{interface},src=%{saddr},s_port=%{sport},dst=%{daddr},service=%{network_service},d_port=%{dport},origin_sic_name=%{fld7},srckeyid=%{src_spi},dstkeyid=%{dst_spi},peer gateway=%{peer},msgid=%{fld3},user=%{username},community=%{fld9},CookieI=%{ike_cookie1},CookieR=%{ike_cookie2},fw_subproduct=%{product},vpn_feature_name=%{fld5},scheme:=%{scheme},O=%{fld10},methods:=%{encryption_type},IKE:=%{ike},ike_ids=%{peer_id},IKE IDs:=%{peer_id},session_id:=%{sessionid},orig_name=%{vsys}" }
				id => "message-050100:36"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "050100:36"
					"[rsa][message][id1]" => "050100:36"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "050200" {
		# MESSAGE 050200:25
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050200:25"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050200:25"
					"[rsa][message][id1]" => "050200:25"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:24
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050200:24"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050200:24"
					"[rsa][message][id1]" => "050200:24"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:04
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-050200:04"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050200:04"
					"[rsa][message][id1]" => "050200:04"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:34
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-050200:34"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "050200:34"
					"[rsa][message][id1]" => "050200:34"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,{icmp | ICMP},<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(icmp[\s]+|[\s]*ICMP),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-050200"
				add_field => {
				"level" => "%{hlevel}"
				"protocol" => "ICMP"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050200"
					"[rsa][message][id1]" => "050200"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:26
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<event_description>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<event_description>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050200:26"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "050200:26"
					"[rsa][message][id1]" => "050200:26"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-050200:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "050200:23"
					"[rsa][message][id1]" => "050200:23"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-050200:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050200:03"
					"[rsa][message][id1]" => "050200:03"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>.*)$" }
				id => "message-050200:02"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050200:02"
					"[rsa][message][id1]" => "050200:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>.*)$" }
				id => "message-050200:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "050200:01"
					"[rsa][message][id1]" => "050200:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050200:05
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",src=<saddr>,dst=<daddr>,{proto=<protocol>,message_info="<info>"|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",src=(?<saddr>[^,]*),dst=(?<daddr>[^,]*),(proto=(?<protocol>[^,]*),message_info=\"(?<info>[^\"]*)\"|proto=(?<protocol>.*))$" }
				id => "message-050200:05"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:05"
					"[rsa][message][id1]" => "050200:05"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050200:06
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,message_info="<info>"|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),message_info=\"(?<info>[^\"]*)\"|proto=(?<protocol>.*))$" }
				id => "message-050200:06"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:06"
					"[rsa][message][id1]" => "050200:06"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050200:07
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",rule=<rule>,rule_uid={{<rule_uid>},rule_name={"<rulename>",SmartDefense profile=<fld19>,service_id=<fld20>|"<rulename>",SmartDefense profile=<fld19>|"<rulename>",service_id=<fld20>|"<rulename>"},src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,xlatesrc=<stransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",rule=(?<rule>[^,]*),rule_uid=\{(?<rule_uid>[^\}]*)\},rule_name=(\"(?<rulename>[^\"]*)\",SmartDefense[\s]+profile=(?<fld19>[^,]*),service_id=(?<fld20>[^,]*)|\"(?<rulename>[^\"]*)\",SmartDefense[\s]+profile=(?<fld19>[^,]*)|\"(?<rulename>[^\"]*)\",service_id=(?<fld20>[^,]*)|\"(?<rulename>[^\"]*)\"),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),xlatesrc=(?<stransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>.*)|proto=(?<protocol>.*))$" }
				id => "message-050200:07"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:07"
					"[rsa][message][id1]" => "050200:07"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050200:08
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",rule=<rule>,rule_uid={{<rule_uid>},rule_name={<rulename>,SmartDefense profile=<fld19>,service_id=<fld20>|<rulename>,SmartDefense profile=<fld19>|<rulename>,service_id=<fld20>|<rulename>},src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,xlatesrc=<stransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",rule=(?<rule>[^,]*),rule_uid=\{(?<rule_uid>[^\}]*)\},rule_name=((?<rulename>[^,]*),SmartDefense[\s]+profile=(?<fld19>[^,]*),service_id=(?<fld20>[^,]*)|(?<rulename>[^,]*),SmartDefense[\s]+profile=(?<fld19>[^,]*)|(?<rulename>[^,]*),service_id=(?<fld20>[^,]*)|(?<rulename>[^,]*)),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),xlatesrc=(?<stransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>.*)|proto=(?<protocol>.*))$" }
				id => "message-050200:08"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:08"
					"[rsa][message][id1]" => "050200:08"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050200:09
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",service_id=<fld20>,ICMP={"<network_service>"|<network_service>},src=<saddr>,dst=<daddr>,proto=<protocol>,ICMP Type=<icmptype>,ICMP Code=<icmpcode>,rule=<rule>,message_info="<info>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",service_id=(?<fld20>[^,]*),ICMP=(\"(?<network_service>[^\"]*)\"|(?<network_service>[^,]*)),src=(?<saddr>[^,]*),dst=(?<daddr>[^,]*),proto=(?<protocol>[^,]*),ICMP[\s]+Type=(?<icmptype>[^,]*),ICMP[\s]+Code=(?<icmpcode>[^,]*),rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\"$" }
				id => "message-050200:09"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:09"
					"[rsa][message][id1]" => "050200:09"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050200:10
		# line in RSA: Origin=<origin>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",{inzone=<fld1>,outzone=<fld1>,service_id=<fld20>|service_id=<fld20>},src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,rule=<rule>,message_info="<info>"|proto=<protocol>,message_info="<info>"}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",(inzone=(?<fld1>[^,]*),outzone=(?<fld1>[^,]*),service_id=(?<fld20>[^,]*)|service_id=(?<fld20>[^,]*)),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\"|proto=(?<protocol>[^,]*),message_info=\"(?<info>[^\"]*)\")$" }
				id => "message-050200:10"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:10"
					"[rsa][message][id1]" => "050200:10"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 050200:11
		# line in RSA: Origin=<origin>,i/f_name=<interface>,src=<saddr>,dst=<daddr>,srckeyid=<fld1>,dstkeyid=<fld2>,peer gateway=<peer>,scheme:=<scheme>,IKE:="<ike>",CookieI=<ike_cookie1>,CookieR=<ike_cookie2>,msgid=<fld3>,methods:="<encryption_type>",IKE IDs:=""<peer_id>"",user="<username>",community=<fld4>,fw_subproduct=<product>,vpn_feature_name=<fld5>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},i/f_name=%{interface},src=%{saddr},dst=%{daddr},srckeyid=%{fld1},dstkeyid=%{fld2},peer gateway=%{peer},scheme:=%{scheme},IKE:=\"%{ike}\",CookieI=%{ike_cookie1},CookieR=%{ike_cookie2},msgid=%{fld3},methods:=\"%{encryption_type}\",IKE IDs:=\"\"%{peer_id}\"\",user=\"%{username}\",community=%{fld4},fw_subproduct=%{product},vpn_feature_name=%{fld5}" }
				id => "message-050200:11"
				add_field => {
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
					"[event][id]" => "050200:11"
					"[rsa][message][id1]" => "050200:11"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "050300" {
		# MESSAGE 050300:22
		# line in RSA: <action>,<event_computer>,outbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer},outbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81},%{group},%{rule_uid},%{rulename},%{protocol_detail},%{vsys},%{severity},%{fld87}" }
				id => "message-050300:22"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "1"
				"ntype" => "7"
				"direction" => "outbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:22"
					"[rsa][message][id1]" => "050300:22"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300:02
		# line in RSA: <action>,<event_computer>,outbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer},outbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81},%{group},%{rule_uid},%{rulename},%{protocol_detail}" }
				id => "message-050300:02"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "1"
				"ntype" => "7"
				"direction" => "outbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:02"
					"[rsa][message][id1]" => "050300:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300:32
		# line in RSA: <action>,<event_computer>,outbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer},outbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81},%{group},%{rule_uid}" }
				id => "message-050300:32"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "1"
				"ntype" => "7"
				"direction" => "outbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:32"
					"[rsa][message][id1]" => "050300:32"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300
		# line in RSA: <action>,<event_computer>,outbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer},outbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69}" }
				id => "message-050300"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "1"
				"ntype" => "7"
				"direction" => "outbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300"
					"[rsa][message][id1]" => "050300"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300:23
		# line in RSA: <action>,<event_computer>, <space> inbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer}, %{space} inbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81},%{group},%{rule_uid},%{rulename},%{protocol_detail},%{vsys},%{severity},%{fld87}" }
				id => "message-050300:23"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "0"
				"ntype" => "9"
				"direction" => "inbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:23"
					"[rsa][message][id1]" => "050300:23"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300:03
		# line in RSA: <action>,<event_computer>, <space> inbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer}, %{space} inbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81},%{group},%{rule_uid},%{rulename},%{protocol_detail}" }
				id => "message-050300:03"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "0"
				"ntype" => "9"
				"direction" => "inbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:03"
					"[rsa][message][id1]" => "050300:03"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300:33
		# line in RSA: <action>,<event_computer>, <space> inbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer}, %{space} inbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81},%{group},%{rule_uid}" }
				id => "message-050300:33"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "0"
				"ntype" => "9"
				"direction" => "inbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:33"
					"[rsa][message][id1]" => "050300:33"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 050300:01
		# line in RSA: <action>,<event_computer>, <space> inbound,<interface>,<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{action},%{event_computer}, %{space} inbound,%{interface},%{saddr},%{sport},%{daddr},%{dport},%{network_service},%{protocol},%{rule},%{bytes},%{duration},%{trans_from},%{trans_to},%{from},%{fld17},%{fld18},%{agent},%{result},%{event_type},%{username},%{info},%{encryption_type},%{peer},%{scheme},%{ike},%{rbytes},%{sbytes},%{url},%{to},%{fld32},%{filename},%{doc_number},%{fld85},%{fld36},%{product},%{stransaddr},%{stransport},%{dtransaddr},%{dtransport},%{c_username},%{src_spi},%{dst_spi},%{fld45},%{fld46},%{fld47},%{fld86},%{fld49},%{packets},%{fld51},%{fld52},%{fld53},%{fld54},%{fld55},%{fld56},%{fld57},%{fld58},%{fld59},%{fld60},%{fld61},%{fld62},%{fld63},%{peer_id},%{ike_cookie1},%{ike_cookie2},%{icmptype},%{icmpcode},%{fld69},%{context},%{detail},%{fld72},%{fld73},%{fld74},%{fld75},%{fld76},%{fld83},%{policy_id},%{fld79},%{fld80},%{fld81}" }
				id => "message-050300:01"
				add_field => {
				"level" => "%{hlevel}"
				"inout" => "0"
				"ntype" => "9"
				"direction" => "inbound"
				"lhost" => "%{event_computer}"
					"[event][id]" => "050300:01"
					"[rsa][message][id1]" => "050300:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId131
	# line in RSA: <protocol> Connection src <saddr>/<sport> gaddr <addr> dst <daddr>/<dport> duration <duration> bytes <bytes>
	else if [logstash][msgparser][id] == "msgParserId131" {
		dissect {
			mapping => { "message" => "%{protocol} Connection src %{saddr}/%{sport} gaddr %{addr} dst %{daddr}/%{dport} duration %{duration} bytes %{bytes}" }
			id => "msgParserId131"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "060020" {
		# MESSAGE 060020:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-060020:21"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
					"[event][id]" => "060020:21"
					"[rsa][message][id1]" => "060020:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 060020:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-060020:01"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "060020:01"
					"[rsa][message][id1]" => "060020:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 060020:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-060020:31"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "060020:31"
					"[rsa][message][id1]" => "060020:31"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 060020
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-060020"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "060020"
					"[rsa][message][id1]" => "060020"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "060030" {
		# MESSAGE 060030:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-060030:21"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
					"[event][id]" => "060030:21"
					"[rsa][message][id1]" => "060030:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 060030:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-060030:01"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "060030:01"
					"[rsa][message][id1]" => "060030:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 060030:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-060030:31"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "060030:31"
					"[rsa][message][id1]" => "060030:31"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 060030
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-060030"
				add_field => {
				"level" => "%{hlevel}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "060030"
					"[rsa][message][id1]" => "060030"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId136
	# line in RSA: laddr <daddr>/<dport> action <action> faddr <saddr>/<sport>:<url>
	else if [logstash][msgparser][id] == "msgParserId136" {
		dissect {
			mapping => { "message" => "laddr %{daddr}/%{dport} action %{action} faddr %{saddr}/%{sport}:%{url}" }
			id => "msgParserId136"
			add_field => {
				"level" => "%{hlevel}"
				"ntype" => "2"
				"[logstash][messagefound]" => true
			}
		}
	}
	else if [logstash][msgparser][id] == "070500" {
		# MESSAGE 070500:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070500:21"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "070500:21"
					"[rsa][message][id1]" => "070500:21"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070500:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-070500:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070500:01"
					"[rsa][message][id1]" => "070500:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070500:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-070500:31"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070500:31"
					"[rsa][message][id1]" => "070500:31"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070500
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-070500"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070500"
					"[rsa][message][id1]" => "070500"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "070550" {
		# MESSAGE 070550:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070550:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "070550:23"
					"[rsa][message][id1]" => "070550:23"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070550:22
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070550:22"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
					"[event][id]" => "070550:22"
					"[rsa][message][id1]" => "070550:22"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070550:02
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-070550:02"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070550:02"
					"[rsa][message][id1]" => "070550:02"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070550:32
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-070550:32"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070550:32"
					"[rsa][message][id1]" => "070550:32"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070550:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>,<fld79>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>[^,]*),(?<fld79>.*)$" }
				id => "message-070550:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070550:01"
					"[rsa][message][id1]" => "070550:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070550
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-070550"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070550"
					"[rsa][message][id1]" => "070550"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "070560" {
		# MESSAGE 070560:21
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070560:21"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "070560:21"
					"[rsa][message][id1]" => "070560:21"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070560:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-070560:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070560:01"
					"[rsa][message][id1]" => "070560:01"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070560:31
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-070560:31"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070560:31"
					"[rsa][message][id1]" => "070560:31"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070560
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-070560"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070560"
					"[rsa][message][id1]" => "070560"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "070570" {
		# MESSAGE 070570:25
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<fld88>,<fld89>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<fld88>[^,]*),(?<fld89>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070570:25"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
					"[event][id]" => "070570:25"
					"[rsa][message][id1]" => "070570:25"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:24
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070570:24"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
					"[event][id]" => "070570:24"
					"[rsa][message][id1]" => "070570:24"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:04
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-070570:04"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570:04"
					"[rsa][message][id1]" => "070570:04"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:34
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-070570:34"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570:34"
					"[rsa][message][id1]" => "070570:34"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:02
		# line in RSA: drop,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^drop,(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>.*)$" }
				id => "message-070570:02"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "drop"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570:02"
					"[rsa][message][id1]" => "070570:02"
					"[event][categoryid]" => "1803000000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:23
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>,<vsys>,<severity>,<fld87>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>[^,]*),(?<vsys>[^,]*),(?<severity>[^,]*),(?<fld87>.*)$" }
				id => "message-070570:23"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
					"[event][id]" => "070570:23"
					"[rsa][message][id1]" => "070570:23"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:03
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>,<rulename>,<protocol_detail>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>[^,]*),(?<rulename>[^,]*),(?<protocol_detail>.*)$" }
				id => "message-070570:03"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570:03"
					"[rsa][message][id1]" => "070570:03"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:33
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<fld83>,<policy_id>,<fld79>,<fld80>,<fld81>,<group>,<rule_uid>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<fld83>[^,]*),(?<policy_id>[^,]*),(?<fld79>[^,]*),(?<fld80>[^,]*),(?<fld81>[^,]*),(?<group>[^,]*),(?<rule_uid>.*)$" }
				id => "message-070570:33"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570:33"
					"[rsa][message][id1]" => "070570:33"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570:01
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>,<fld76>,<protocol_detail>,<policy_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>[^,]*),(?<fld76>[^,]*),(?<protocol_detail>[^,]*),(?<policy_id>.*)$" }
				id => "message-070570:01"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570:01"
					"[rsa][message][id1]" => "070570:01"
					"[event][categoryid]" => "1801020000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
		# MESSAGE 070570
		# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>.*)$" }
				id => "message-070570"
				add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"vsys" => "%{event_computer}"
					"[event][id]" => "070570"
					"[rsa][message][id1]" => "070570"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld85}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080000" {
		# MESSAGE 080000:02
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Changes="<changes>",Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Changes=\"(?<changes>[^\"]*)\",Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080000:02"
				add_field => {
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"change_new" => "%{changes}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
					"[event][id]" => "080000:02"
					"[rsa][message][id1]" => "080000:02"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080000:03
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Changes="<changes>",Subject="<subject>",Operation Number=<recordnum>,client_ip=<saddr>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Changes=\"%{changes}\",Subject=\"%{subject}\",Operation Number=%{recordnum},client_ip=%{saddr}," }
				id => "message-080000:03"
				add_field => {
				"action" => "%{operation}"
				"change_new" => "%{changes}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
					"[event][id]" => "080000:03"
					"[rsa][message][id1]" => "080000:03"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080000:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080000:01"
				add_field => {
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
					"[event][id]" => "080000:01"
					"[rsa][message][id1]" => "080000:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080000:04
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation="<action>",Uid={{<uid>},Administrator=<administrator>,Client=<shost>,Changes={"<changes>"|<changes>},session_id={"<sessionid>"|<sessionid>},Subject="<subject>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Type=(?<obj_type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<action>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Changes=(\"(?<changes>[^\"]*)\"|(?<changes>[^,]*)),session_id=(\"(?<sessionid>[^\"]*)\"|(?<sessionid>[^,]*)),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080000:04"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080000:04"
					"[rsa][message][id1]" => "080000:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080000:05
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080000:05"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080000:05"
					"[rsa][message][id1]" => "080000:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080000
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080000"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080000"
					"[rsa][message][id1]" => "080000"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080010" {
		# MESSAGE 080010:03
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Changes="<changes>",session_id=<sessionid>,Subject="<subject>",Operation Number=<recordnum>,client_ip=<saddr>,origin_sic_name=<fld1>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Changes=\"(?<changes>[^\"]*)\",session_id=(?<sessionid>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>.*)$" }
				id => "message-080010:03"
				add_field => {
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"change_new" => "%{changes}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
					"[event][id]" => "080010:03"
					"[rsa][message][id1]" => "080010:03"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080010:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Changes="<changes>",Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Changes=\"(?<changes>[^\"]*)\",Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080010:01"
				add_field => {
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"change_new" => "%{changes}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
					"[event][id]" => "080010:01"
					"[rsa][message][id1]" => "080010:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080010:02
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Changes="<changes>",Subject="<subject>",Operation Number=<recordnum>,client_ip=<saddr>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Changes=\"%{changes}\",Subject=\"%{subject}\",Operation Number=%{recordnum},client_ip=%{saddr}," }
				id => "message-080010:02"
				add_field => {
				"action" => "%{operation}"
				"change_new" => "%{changes}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
					"[event][id]" => "080010:02"
					"[rsa][message][id1]" => "080010:02"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080010:04
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation=""<operation>"",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Changes=""<changes>"<fld1>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"\"(?<operation>[^\"]*)\"\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Changes=\"\"(?<changes>[^\"]*)\"(?<fld1>.*)$" }
				id => "message-080010:04"
				add_field => {
				"change_new" => "%{changes}"
				"level" => "%{hlevel}"
				"hostname" => "%{origin}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"shost" => "%{client}"
					"[event][id]" => "080010:04"
					"[rsa][message][id1]" => "080010:04"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080010:05
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation="<action>",Uid={{<uid>},Administrator=<administrator>,Client=<shost>,Changes={"<changes>"|<changes>},session_id={"<sessionid>"|<sessionid>},Subject="<subject>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Type=(?<obj_type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<action>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Changes=(\"(?<changes>[^\"]*)\"|(?<changes>[^,]*)),session_id=(\"(?<sessionid>[^\"]*)\"|(?<sessionid>[^,]*)),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080010:05"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080010:05"
					"[rsa][message][id1]" => "080010:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080010:06
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080010:06"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080010:06"
					"[rsa][message][id1]" => "080010:06"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080010
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080010"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080010"
					"[rsa][message][id1]" => "080010"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080020" {
		# MESSAGE 080020:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Changes="<changes>",Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Changes=\"(?<changes>[^\"]*)\",Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080020:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"change_new" => "%{changes}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080020:01"
					"[rsa][message][id1]" => "080020:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080020:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation="<action>",Uid={{<uid>},Administrator=<administrator>,Client=<shost>,Changes={"<changes>"|<changes>},Subject="<subject>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Type=(?<obj_type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<action>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Changes=(\"(?<changes>[^\"]*)\"|(?<changes>[^,]*)),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080020:02"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080020:02"
					"[rsa][message][id1]" => "080020:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080020:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080020:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080020:03"
					"[rsa][message][id1]" => "080020:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080020
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080020"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080020"
					"[rsa][message][id1]" => "080020"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080030" {
		# MESSAGE 080030:02
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Changes="<changes>",Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Changes=\"(?<changes>[^\"]*)\",Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080030:02"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"change_new" => "%{changes}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080030:02"
					"[rsa][message][id1]" => "080030:02"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080030:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080030:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080030:01"
					"[rsa][message][id1]" => "080030:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080030:03
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation="<action>",Uid={{<uid>},Administrator=<administrator>,Client=<shost>,Subject="<subject>",Operation Number=<operation_id>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Type=(?<obj_type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<action>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080030:03"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080030:03"
					"[rsa][message][id1]" => "080030:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080030:04
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080030:04"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080030:04"
					"[rsa][message][id1]" => "080030:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080030
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080030"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080030"
					"[rsa][message][id1]" => "080030"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080040" {
		# MESSAGE 080040:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Uid={{<uid>},Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Name=(?<name>[^,]*),Type=(?<type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<operation>[^\"]*)\",Uid=\{(?<uid>[^\}]*)\},Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Subject=\"(?<subject>[^\"]*)\",Audit[\s]+Status=(?<status>[^,]*),Info=\"(?<info>[^\"]*)\",Operation[\s]+Number=(?<recordnum>[^,]*),$" }
				id => "message-080040:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080040:01"
					"[rsa][message][id1]" => "080040:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080040:02
		# line in RSA: time=<fld27>,logId=<id>,log_type=<fld42>,is_first_for_luuid=<fld44>,log_sequence_num=<serial_number>,log_version=<version>,origin_sic_name=<fld40>,Application=<application>,Name=<fld54>,Type=<fld53>,Category=<category>,Operation=<fld51>,Uid=<uid>,Administrator=<administrator>,Client=<fld52>,Subject=<subject>,Audit Status=<result>,Info=<info>,Operation Number=<fld50>,client_ip=<saddr>,Origin=<hostname>,s_port=<sport>,d_port=<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld27},logId=%{id},log_type=%{fld42},is_first_for_luuid=%{fld44},log_sequence_num=%{serial_number},log_version=%{version},origin_sic_name=%{fld40},Application=%{application},Name=%{fld54},Type=%{fld53},Category=%{category},Operation=%{fld51},Uid=%{uid},Administrator=%{administrator},Client=%{fld52},Subject=%{subject},Audit Status=%{result},Info=%{info},Operation Number=%{fld50},client_ip=%{saddr},Origin=%{hostname},s_port=%{sport},d_port=%{dport}" }
				id => "message-080040:02"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{fld54}"
				"obj_type" => "%{fld53}"
				"shost" => "%{fld52}"
				"action" => "%{fld51}"
				"operation_id" => "%{fld50}"
					"[event][id]" => "080040:02"
					"[rsa][message][id1]" => "080040:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080040
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080040"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080040"
					"[rsa][message][id1]" => "080040"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId152
	# line in RSA: <msg>
	else if [logstash][msgparser][id] == "msgParserId152" {
		dissect {
			mapping => { "message" => "%{msg}" }
			id => "msgParserId152"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "080070" {
		# MESSAGE 080070:02
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Info="<info>",Operation Number=<recordnum>,client_ip=<saddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Info=\"%{info}\",Operation Number=%{recordnum},client_ip=%{saddr}" }
				id => "message-080070:02"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080070:02"
					"[rsa][message][id1]" => "080070:02"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080070:01
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Info="<info>",{Operation Number=<recordnum>,|Operation Number=<recordnum>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Operation=\"(?<operation>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Subject=\"(?<subject>[^\"]*)\",Info=\"(?<info>[^\"]*)\",(Operation[\s]+Number=(?<recordnum>[^,]*),|Operation[\s]+Number=(?<recordnum>.*))$" }
				id => "message-080070:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080070:01"
					"[rsa][message][id1]" => "080070:01"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080070:03
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Operation="<action>",Administrator=<administrator>,Client=<shost>,Subject="<subject>",Info="<info>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Operation=\"(?<action>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Info=\"(?<info>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080070:03"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080070:03"
					"[rsa][message][id1]" => "080070:03"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080070:04
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Info=<info>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Info=%{info},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080070:04"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080070:04"
					"[rsa][message][id1]" => "080070:04"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080070
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080070"
				add_field => {
				"ec_theme" => "Authentication"
				"ec_outcome" => "Success"
				"level" => "%{hlevel}"
					"[event][id]" => "080070"
					"[rsa][message][id1]" => "080070"
					"[event][categoryid]" => "1401060000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080080" {
		# MESSAGE 080080:01
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080080:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080080:01"
					"[rsa][message][id1]" => "080080:01"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080080:02
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Client=<client>,Subject="<subject>",Audit Status=<status>,Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080080:02"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080080:02"
					"[rsa][message][id1]" => "080080:02"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080080:03
		# line in RSA: time=<fld27>,origin_sic_name=<fld40>,Application=<application>,Operation=<fld51>,Administrator=<administrator>,Client=<fld52>,Subject=<subject>,Audit Status=<result>,Info=<info>,Operation Number=<operation_id>,client_ip=<saddr>,o=<fld10>,Origin=<hostname>,s_port=<sport>,d_port=<dport>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld27},origin_sic_name=%{fld40},Application=%{application},Operation=%{fld51},Administrator=%{administrator},Client=%{fld52},Subject=%{subject},Audit Status=%{result},Info=%{info},Operation Number=%{operation_id},client_ip=%{saddr},o=%{fld10},Origin=%{hostname},s_port=%{sport},d_port=%{dport}" }
				id => "message-080080:03"
				add_field => {
				"level" => "%{hlevel}"
				"shost" => "%{fld52}"
				"action" => "%{fld51}"
					"[event][id]" => "080080:03"
					"[rsa][message][id1]" => "080080:03"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080080
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080080"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logon"
				"ec_outcome" => "Failure"
				"level" => "%{hlevel}"
					"[event][id]" => "080080"
					"[rsa][message][id1]" => "080080"
					"[event][categoryid]" => "1401030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080090" {
		# MESSAGE 080090:02
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Operation Number=<recordnum>,client_ip=<saddr>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Operation Number=%{recordnum},client_ip=%{saddr}" }
				id => "message-080090:02"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080090:02"
					"[rsa][message][id1]" => "080090:02"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080090:01
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",{Operation Number=<recordnum>,|Operation Number=<recordnum>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<origin>[^,]*),Application=(?<application>[^,]*),Operation=\"(?<operation>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<client>[^,]*),Subject=\"(?<subject>[^\"]*)\",(Operation[\s]+Number=(?<recordnum>[^,]*),|Operation[\s]+Number=(?<recordnum>.*))$" }
				id => "message-080090:01"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080090:01"
					"[rsa][message][id1]" => "080090:01"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080090:03
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Operation="<action>",Administrator=<administrator>,Client=<shost>,Subject="<subject>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Operation=\"(?<action>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080090:03"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080090:03"
					"[rsa][message][id1]" => "080090:03"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080090:04
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080090:04"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080090:04"
					"[rsa][message][id1]" => "080090:04"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080090
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080090"
				add_field => {
				"ec_subject" => "User"
				"ec_activity" => "Logoff"
				"level" => "%{hlevel}"
					"[event][id]" => "080090"
					"[rsa][message][id1]" => "080090"
					"[event][categoryid]" => "1401070000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080100" {
		# MESSAGE 080100:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=%{name},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080100:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"obj_name" => "%{name}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080100:01"
					"[rsa][message][id1]" => "080100:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080100:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Operation="<action>",Administrator={"<administrator>"|<administrator>},Client=<shost>,Subject="<subject>",Audit Status=<result>,Info="<info>",Operation Number=<operation_id>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Operation=\"(?<action>[^\"]*)\",Administrator=(\"(?<administrator>[^\"]*)\"|(?<administrator>[^,]*)),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Audit[\s]+Status=(?<result>[^,]*),Info=\"(?<info>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080100:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080100:02"
					"[rsa][message][id1]" => "080100:02"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080100:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,Audit Status=<result>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},Audit Status=%{result},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080100:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080100:03"
					"[rsa][message][id1]" => "080100:03"
					"[event][categoryid]" => "1612000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080100
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080100"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080100"
					"[rsa][message][id1]" => "080100"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080120" {
		# MESSAGE 080120:01
		# line in RSA: Origin=<origin>,alert=<alert>,Application="<application>",Name=<name>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},alert=%{alert},Application=\"%{application}\",Name=%{name},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080120:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080120:01"
					"[rsa][message][id1]" => "080120:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080120
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080120"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080120"
					"[rsa][message][id1]" => "080120"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080230" {
		# MESSAGE 080230:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=%{name},Type=%{type},Category=%{category},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Operation Number=%{recordnum}," }
				id => "message-080230:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080230:01"
					"[rsa][message][id1]" => "080230:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080230
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080230"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080230"
					"[rsa][message][id1]" => "080230"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080240" {
		# MESSAGE 080240:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=%{name},Type=%{type},Category=%{category},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Operation Number=%{recordnum}," }
				id => "message-080240:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080240:01"
					"[rsa][message][id1]" => "080240:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080240:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation="<action>",Administrator=<administrator>,Client=<shost>,session_id=<sessionid>,Subject="<subject>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Type=(?<obj_type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<action>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),session_id=(?<sessionid>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080240:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080240:02"
					"[rsa][message][id1]" => "080240:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080240:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080240:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080240:03"
					"[rsa][message][id1]" => "080240:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080240
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080240"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080240"
					"[rsa][message][id1]" => "080240"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080250" {
		# MESSAGE 080250:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Type=<type>,Category=<category>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=%{name},Type=%{type},Category=%{category},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Operation Number=%{recordnum}," }
				id => "message-080250:01"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{name}"
				"obj_type" => "%{type}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080250:01"
					"[rsa][message][id1]" => "080250:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080250:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation="<action>",Administrator=<administrator>,Client=<shost>,session_id=<sessionid>,Subject="<subject>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(?<obj_name>[^,]*),Type=(?<obj_type>[^,]*),Category=(?<category>[^,]*),Operation=\"(?<action>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),session_id=(?<sessionid>[^,]*),Subject=\"(?<subject>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080250:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080250:02"
					"[rsa][message][id1]" => "080250:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080250:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080250:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080250:03"
					"[rsa][message][id1]" => "080250:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080250
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080250"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080250"
					"[rsa][message][id1]" => "080250"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080390" {
		# MESSAGE 080390:01
		# line in RSA: Origin=<origin>,Application=<application>,Name="<name>",Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=\"%{name}\",Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080390:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080390:01"
					"[rsa][message][id1]" => "080390:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080390:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name={"<obj_name>"|<obj_name>},Operation="<action>",Administrator={"<administrator>"|<administrator>},Client=<shost>,Subject="<subject>",Info="<info>",Operation Number=<operation_id>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(\"(?<obj_name>[^\"]*)\"|(?<obj_name>[^,]*)),Operation=\"(?<action>[^\"]*)\",Administrator=(\"(?<administrator>[^\"]*)\"|(?<administrator>[^,]*)),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Info=\"(?<info>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080390:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080390:02"
					"[rsa][message][id1]" => "080390:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080390:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,Info=<info>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},Info=%{info},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080390:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080390:03"
					"[rsa][message][id1]" => "080390:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080390
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080390"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080390"
					"[rsa][message][id1]" => "080390"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080400" {
		# MESSAGE 080400:01
		# line in RSA: Origin=<origin>,Application=<application>,Name="<name>",Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=\"%{name}\",Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080400:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080400:01"
					"[rsa][message][id1]" => "080400:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080400:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Name={"<obj_name>"|<obj_name>},Operation="<action>",Administrator={"<administrator>"|<administrator>},Client=<shost>,Subject="<subject>",Info="<info>",Operation Number=<operation_id>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Name=(\"(?<obj_name>[^\"]*)\"|(?<obj_name>[^,]*)),Operation=\"(?<action>[^\"]*)\",Administrator=(\"(?<administrator>[^\"]*)\"|(?<administrator>[^,]*)),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Info=\"(?<info>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080400:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080400:02"
					"[rsa][message][id1]" => "080400:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080400:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Operation=<action>,Info=<info>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Operation=%{action},Info=%{info},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080400:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080400:03"
					"[rsa][message][id1]" => "080400:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080400
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080400"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080400"
					"[rsa][message][id1]" => "080400"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080410" {
		# MESSAGE 080410:02
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Info="<info>",Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=%{name},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Info=\"%{info}\",Operation Number=%{recordnum}," }
				id => "message-080410:02"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"obj_name" => "%{name}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080410:02"
					"[rsa][message][id1]" => "080410:02"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080410:01
		# line in RSA: Origin=<origin>,Application=<application>,Name=<name>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Name=%{name},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Operation Number=%{recordnum}," }
				id => "message-080410:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"obj_name" => "%{name}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080410:01"
					"[rsa][message][id1]" => "080410:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080410
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080410"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080410"
					"[rsa][message][id1]" => "080410"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080420" {
		# MESSAGE 080420:01
		# line in RSA: Origin=<origin>,alert=<alert>,Application=<application>,Name=<name>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Audit Status=<status>,Info=<info>,Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},alert=%{alert},Application=%{application},Name=%{name},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Audit Status=%{status},Info=%{info},Operation Number=%{recordnum}," }
				id => "message-080420:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"obj_name" => "%{name}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080420:01"
					"[rsa][message][id1]" => "080420:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080420
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080420"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080420"
					"[rsa][message][id1]" => "080420"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080430" {
		# MESSAGE 080430:01
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator=<administrator>,Client=<client>,Subject="<subject>",Info=<info>,Operation Number=<recordnum>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=%{administrator},Client=%{client},Subject=\"%{subject}\",Info=%{info},Operation Number=%{recordnum}," }
				id => "message-080430:01"
				add_field => {
				"level" => "%{hlevel}"
				"action" => "%{operation}"
				"shost" => "%{client}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
					"[event][id]" => "080430:01"
					"[rsa][message][id1]" => "080430:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080430:02
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Operation="<action>",Administrator=<administrator>,Client=<shost>,Subject="<subject>",Info={"<info>"|<info>},Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Operation=\"(?<action>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),Subject=\"(?<subject>[^\"]*)\",Info=(\"(?<info>[^\"]*)\"|(?<info>[^,]*)),Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080430:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080430:02"
					"[rsa][message][id1]" => "080430:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080430:03
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Info=<info>,Type=<obj_type>,Category=<category>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Info=%{info},Type=%{obj_type},Category=%{category},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080430:03"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080430:03"
					"[rsa][message][id1]" => "080430:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080430
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080430"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080430"
					"[rsa][message][id1]" => "080430"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "080440" {
		# MESSAGE 080440:01
		# line in RSA: time=<fld85>,{Application="<application>"|Application=<application>},Operation="<action>",Administrator=<administrator>,Client=<shost>,session_id={"<sessionid>"|<sessionid>},Subject="<subject>",Info="<info>",Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^time=(?<fld85>[^,]*),(Application=\"(?<application>[^\"]*)\"|Application=(?<application>[^,]*)),Operation=\"(?<action>[^\"]*)\",Administrator=(?<administrator>[^,]*),Client=(?<shost>[^,]*),session_id=(\"(?<sessionid>[^\"]*)\"|(?<sessionid>[^,]*)),Subject=\"(?<subject>[^\"]*)\",Info=\"(?<info>[^\"]*)\",Operation[\s]+Number=(?<operation_id>[^,]*),client_ip=(?<saddr>[^,]*),origin_sic_name=(?<fld1>[^,]*),s_port=(?<sport>[^,]*),d_port=(?<dport>[^,]*),Origin=(?<hostname>.*)$" }
				id => "message-080440:01"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080440:01"
					"[rsa][message][id1]" => "080440:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080440:02
		# line in RSA: time=<fld85>,Application=<application>,Name=<obj_name>,Type=<obj_type>,Category=<category>,Info=<info>,Operation=<action>,Uid=<uid>,Administrator=<administrator>,Client=<shost>,Changes=<changes>,session_id=<sessionid>,Subject=<subject>,Operation Number=<operation_id>,client_ip=<saddr>,origin_sic_name=<fld1>,s_port=<sport>,d_port=<dport>,Origin=<hostname>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},Application=%{application},Name=%{obj_name},Type=%{obj_type},Category=%{category},Info=%{info},Operation=%{action},Uid=%{uid},Administrator=%{administrator},Client=%{shost},Changes=%{changes},session_id=%{sessionid},Subject=%{subject},Operation Number=%{operation_id},client_ip=%{saddr},origin_sic_name=%{fld1},s_port=%{sport},d_port=%{dport},Origin=%{hostname}" }
				id => "message-080440:02"
				add_field => {
				"level" => "%{hlevel}"
				"change_new" => "%{changes}"
					"[event][id]" => "080440:02"
					"[rsa][message][id1]" => "080440:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 080440
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-080440"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "080440"
					"[rsa][message][id1]" => "080440"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "089998" {
		# MESSAGE 089998:01
		# line in RSA: Origin=<origin>,Application=<application>,Operation="<operation>",Administrator="<administrator>",Client=<client>,Subject="<subject>",Info="<info>",Operation Number=<recordnum>,client_ip=<saddr>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{origin},Application=%{application},Operation=\"%{operation}\",Administrator=\"%{administrator}\",Client=%{client},Subject=\"%{subject}\",Info=\"%{info}\",Operation Number=%{recordnum},client_ip=%{saddr}," }
				id => "message-089998:01"
				add_field => {
				"action" => "%{operation}"
				"hostname" => "%{origin}"
				"operation_id" => "%{recordnum}"
				"level" => "%{hlevel}"
				"shost" => "%{client}"
					"[event][id]" => "089998:01"
					"[rsa][message][id1]" => "089998:01"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089998:02
		# line in RSA: time=<fld27>,logId=<id>,log_type=<fld42>,is_first_for_luuid=<fld44>,log_sequence_num=<serial_number>,log_version=<version>,origin_sic_name=<fld40>,Application=<application>,Name=<rulename>,Type=<fld53>,Category=<category>,Operation=<fld51>,Uid=<uid>,Administrator=<administrator>,Client=<fld52>,Subject=<subject>,Audit Status=<result>,Info=<info>,Operation Number=<fld50>,client_ip=<saddr>,Origin=<hostname>,s_port=<sport>,d_port=<dport>,Session name=<fld70>,Session description=<fld71>,Session UID=<sessionid>,Changes=<info>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld27},logId=%{id},log_type=%{fld42},is_first_for_luuid=%{fld44},log_sequence_num=%{serial_number},log_version=%{version},origin_sic_name=%{fld40},Application=%{application},Name=%{rulename},Type=%{fld53},Category=%{category},Operation=%{fld51},Uid=%{uid},Administrator=%{administrator},Client=%{fld52},Subject=%{subject},Audit Status=%{result},Info=%{info},Operation Number=%{fld50},client_ip=%{saddr},Origin=%{hostname},s_port=%{sport},d_port=%{dport},Session name=%{fld70},Session description=%{fld71},Session UID=%{sessionid},Changes=%{info}" }
				id => "message-089998:02"
				add_field => {
				"level" => "%{hlevel}"
				"obj_name" => "%{rulename}"
				"obj_type" => "%{fld53}"
				"shost" => "%{fld52}"
				"action" => "%{fld51}"
				"operation_id" => "%{fld50}"
					"[event][id]" => "089998:02"
					"[rsa][message][id1]" => "089998:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089998
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-089998"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089998"
					"[rsa][message][id1]" => "089998"
					"[event][categoryid]" => "1605030000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId194
	# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<detail>,<fld72>,<fld73>,<fld74>,<fld75>
	else if [logstash][msgparser][id] == "msgParserId194" {
		grok {
			match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<detail>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>.*)$" }
			id => "msgParserId194"
			add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
				"[logstash][fullDateTimeString]" => "%{fld85}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
		}
	}
	# PARSER msgParserId195
	# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<event_description>,<fld72>,<fld73>,<fld74>,<fld75>
	else if [logstash][msgparser][id] == "msgParserId195" {
		grok {
			match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<event_description>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>.*)$" }
			id => "msgParserId195"
			add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
				"ec_subject" => "NetworkComm"
				"ec_activity" => "Scan"
				"ec_theme" => "TEV"
				"[logstash][fullDateTimeString]" => "%{fld85}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
		}
	}
	# PARSER msgParserId196
	# line in RSA: <action>,<event_computer>,<direction>,{bad interface number <interface>,|<interface>,}<saddr>,<sport>,<daddr>,<dport>,<network_service>,<protocol>,<rule>,<bytes>,<duration>,<trans_from>,<trans_to>,<from>,<fld17>,<fld18>,<agent>,<result>,<event_type>,<username>,<info>,<encryption_type>,<peer>,<scheme>,<ike>,<rbytes>,<sbytes>,<url>,<to>,<fld32>,<filename>,<doc_number>,<fld85>,<fld36>,<product>,<stransaddr>,<stransport>,<dtransaddr>,<dtransport>,<c_username>,<src_spi>,<dst_spi>,<fld45>,<fld46>,<fld47>,<fld86>,<fld49>,<packets>,<fld51>,<fld52>,<fld53>,<fld54>,<fld55>,<fld56>,<fld57>,<fld58>,<fld59>,<fld60>,<fld61>,<fld62>,<fld63>,<peer_id>,<ike_cookie1>,<ike_cookie2>,<icmptype>,<icmpcode>,<fld69>,<context>,<event_description>,<fld72>,<fld73>,<fld74>,<fld75>
	else if [logstash][msgparser][id] == "msgParserId196" {
		grok {
			match => { "message" => "^(?<action>[^,]*),(?<event_computer>[^,]*),(?<direction>[^,]*),(bad[\s]+interface[\s]+number[\s]+(?<interface>[^,]*),|(?<interface>[^,]*),)(?<saddr>[^,]*),(?<sport>[^,]*),(?<daddr>[^,]*),(?<dport>[^,]*),(?<network_service>[^,]*),(?<protocol>[^,]*),(?<rule>[^,]*),(?<bytes>[^,]*),(?<duration>[^,]*),(?<trans_from>[^,]*),(?<trans_to>[^,]*),(?<from>[^,]*),(?<fld17>[^,]*),(?<fld18>[^,]*),(?<agent>[^,]*),(?<result>[^,]*),(?<event_type>[^,]*),(?<username>[^,]*),(?<info>[^,]*),(?<encryption_type>[^,]*),(?<peer>[^,]*),(?<scheme>[^,]*),(?<ike>[^,]*),(?<rbytes>[^,]*),(?<sbytes>[^,]*),(?<url>[^,]*),(?<to>[^,]*),(?<fld32>[^,]*),(?<filename>[^,]*),(?<doc_number>[^,]*),(?<fld85>[^,]*),(?<fld36>[^,]*),(?<product>[^,]*),(?<stransaddr>[^,]*),(?<stransport>[^,]*),(?<dtransaddr>[^,]*),(?<dtransport>[^,]*),(?<c_username>[^,]*),(?<src_spi>[^,]*),(?<dst_spi>[^,]*),(?<fld45>[^,]*),(?<fld46>[^,]*),(?<fld47>[^,]*),(?<fld86>[^,]*),(?<fld49>[^,]*),(?<packets>[^,]*),(?<fld51>[^,]*),(?<fld52>[^,]*),(?<fld53>[^,]*),(?<fld54>[^,]*),(?<fld55>[^,]*),(?<fld56>[^,]*),(?<fld57>[^,]*),(?<fld58>[^,]*),(?<fld59>[^,]*),(?<fld60>[^,]*),(?<fld61>[^,]*),(?<fld62>[^,]*),(?<fld63>[^,]*),(?<peer_id>[^,]*),(?<ike_cookie1>[^,]*),(?<ike_cookie2>[^,]*),(?<icmptype>[^,]*),(?<icmpcode>[^,]*),(?<fld69>[^,]*),(?<context>[^,]*),(?<event_description>[^,]*),(?<fld72>[^,]*),(?<fld73>[^,]*),(?<fld74>[^,]*),(?<fld75>.*)$" }
			id => "msgParserId196"
			add_field => {
				"level" => "%{hlevel}"
				"reason" => "%{result}"
				"service" => "%{network_service}"
				"vsys" => "%{event_computer}"
				"[logstash][fullDateTimeString]" => "%{fld85}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
		}
	}
	# PARSER msgParserId197
	# line in RSA: time=<fld85>,action=<action>,orig=<hostname>,i/f_dir=<direction>,i/f_name=<interface>,has_accounting=<recordnum>,logId=<id>,log_sequence_num=<serial_number>,is_first_for_luuid=<fld1>,product=<product>,src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,proto=<protocol>,appi_name=<application>,app_desc=<fld2>,app_id=<fld3>,app_category=<category>,matched_category=<filter>,app_properties=<fld5>,app_risk=<fld6>,app_rule_id=<rule_uid>,app_rule_name=<rulename>,app_sig_id=<sigid>,proxy_src_ip=<stransaddr>,__policy_id_tag=<fld6>,origin_sic_name=<fld7>,bytes=<bytes>,sent_bytes=<sbytes>,received_bytes=<rbytes>,browse_time=<fld10>,Suppressed logs=<fld11>,LastUpdateTime=<fld30>,log_type=<event_log>,log_version=<version>,proto=<protocol>,session_id=<sessionid>,Protection name=<threat_name>,malware_family=<context>,malware_action=<action>,Confidence Level=<fld22>,severity=<severity>,Protection Type=<fld23>,malware_rule_id=<fld24>,protection_id=<fld24>,log_id=<id>,scope=<stransaddr>,sync_info:=<info>,packet_capture_unique_id=<id1>,packet_capture_time=<fld86>,packet_capture_name=<fld27>,user=<username>,src_user_name=<fld87>,resource=<web_referer>
	else if [logstash][msgparser][id] == "msgParserId197" {
		dissect {
			mapping => { "message" => "time=%{fld85},action=%{action},orig=%{hostname},i/f_dir=%{direction},i/f_name=%{interface},has_accounting=%{recordnum},logId=%{id},log_sequence_num=%{serial_number},is_first_for_luuid=%{fld1},product=%{product},src=%{saddr},s_port=%{sport},dst=%{daddr},service=%{network_service},d_port=%{dport},proto=%{protocol},appi_name=%{application},app_desc=%{fld2},app_id=%{fld3},app_category=%{category},matched_category=%{filter},app_properties=%{fld5},app_risk=%{fld6},app_rule_id=%{rule_uid},app_rule_name=%{rulename},app_sig_id=%{sigid},proxy_src_ip=%{stransaddr},__policy_id_tag=%{fld6},origin_sic_name=%{fld7},bytes=%{bytes},sent_bytes=%{sbytes},received_bytes=%{rbytes},browse_time=%{fld10},Suppressed logs=%{fld11},LastUpdateTime=%{fld30},log_type=%{event_log},log_version=%{version},proto=%{protocol},session_id=%{sessionid},Protection name=%{threat_name},malware_family=%{context},malware_action=%{action},Confidence Level=%{fld22},severity=%{severity},Protection Type=%{fld23},malware_rule_id=%{fld24},protection_id=%{fld24},log_id=%{id},scope=%{stransaddr},sync_info:=%{info},packet_capture_unique_id=%{id1},packet_capture_time=%{fld86},packet_capture_name=%{fld27},user=%{username},src_user_name=%{fld87},resource=%{web_referer}" }
			id => "msgParserId197"
			add_field => {
				"level" => "%{hlevel}"
				"[logstash][fullDateTimeString]" => "%{fld85}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "089999" {
		# MESSAGE 089999:12
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",rule=<rule>,rule_uid={{<rule_uid>},rule_name={"<rulename>"|<rulename>},src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,proto=<protocol>,__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",origin_sic_name="<fld7>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",rule=(?<rule>[^,]*),rule_uid=\{(?<rule_uid>[^\}]*)\},rule_name=(\"(?<rulename>[^\"]*)\"|(?<rulename>[^,]*)),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),proto=(?<protocol>[^,]*),__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",origin_sic_name=\"(?<fld7>[^\"]*)\"$" }
				id => "message-089999:12"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:12"
					"[rsa][message][id1]" => "089999:12"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:11
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",{service_id=<fld20>,ICMP="<network_service>",src=<saddr>|service_id=<fld20>,ICMP=<network_service>,src=<saddr>|src=<saddr>},dst=<daddr>,{proto=<protocol>,ICMP Type=<icmptype>,ICMP Code=<icmpcode>,rule=<rule>|proto=<protocol>},message_info="<info>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",origin_sic_name="<fld7>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",(service_id=(?<fld20>[^,]*),ICMP=\"(?<network_service>[^\"]*)\",src=(?<saddr>[^,]*)|service_id=(?<fld20>[^,]*),ICMP=(?<network_service>[^,]*),src=(?<saddr>[^,]*)|src=(?<saddr>[^,]*)),dst=(?<daddr>[^,]*),(proto=(?<protocol>[^,]*),ICMP[\s]+Type=(?<icmptype>[^,]*),ICMP[\s]+Code=(?<icmpcode>[^,]*),rule=(?<rule>[^,]*)|proto=(?<protocol>[^,]*)),message_info=\"(?<info>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",origin_sic_name=\"(?<fld7>[^\"]*)\"$" }
				id => "message-089999:11"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:11"
					"[rsa][message][id1]" => "089999:11"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:10
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,src=<saddr>,dst=<daddr>,srckeyid=<fld1>,dstkeyid=<fld2>,peer gateway=<peer>,scheme:=<scheme>,IKE:="<ike>",CookieI=<ike_cookie1>,CookieR=<ike_cookie2>,msgid=<fld3>,methods:="<encryption_type>",IKE IDs:=""<peer_id>"",user="<username>",community=<fld4>,fw_subproduct=<product>,vpn_feature_name=<fld5>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "Origin=%{hostname},i/f_name=%{interface},src=%{saddr},dst=%{daddr},srckeyid=%{fld1},dstkeyid=%{fld2},peer gateway=%{peer},scheme:=%{scheme},IKE:=\"%{ike}\",CookieI=%{ike_cookie1},CookieR=%{ike_cookie2},msgid=%{fld3},methods:=\"%{encryption_type}\",IKE IDs:=\"\"%{peer_id}\"\",user=\"%{username}\",community=%{fld4},fw_subproduct=%{product},vpn_feature_name=%{fld5}" }
				id => "message-089999:10"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:10"
					"[rsa][message][id1]" => "089999:10"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:09
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",SmartDefense profile=<fld19>,src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,proto=<protocol>,message_info="<info>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",SmartDefense[\s]+profile=(?<fld19>[^,]*),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),proto=(?<protocol>[^,]*),message_info=\"(?<info>[^\"]*)\"$" }
				id => "message-089999:09"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:09"
					"[rsa][message][id1]" => "089999:09"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:08
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",session_id:=<sessionid>,dns_query=<fld20>,dns_type=<dns_querytype>,SmartDefense profile=<fld19>,service_id=<fld21>,src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,proto=<protocol>,rule=<rule>,message_info="<info>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",session_id:=(?<sessionid>[^,]*),dns_query=(?<fld20>[^,]*),dns_type=(?<dns_querytype>[^,]*),SmartDefense[\s]+profile=(?<fld19>[^,]*),service_id=(?<fld21>[^,]*),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),proto=(?<protocol>[^,]*),rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\"$" }
				id => "message-089999:08"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:08"
					"[rsa][message][id1]" => "089999:08"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:06
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",src=<saddr>,dst=<daddr>,{proto=<protocol>,message_info="<info>"|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",src=(?<saddr>[^,]*),dst=(?<daddr>[^,]*),(proto=(?<protocol>[^,]*),message_info=\"(?<info>[^\"]*)\"|proto=(?<protocol>.*))$" }
				id => "message-089999:06"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:06"
					"[rsa][message][id1]" => "089999:06"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:05
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",{inzone=<fld21>,outzone=<fld22>,service_id=<fld20>|service_id=<fld20>},src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,proto=<protocol>,{xlatesrc=<stransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>,rule=<rule>,message_info="<info>"|rule=<rule>,message_info="<info>"}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",(inzone=(?<fld21>[^,]*),outzone=(?<fld22>[^,]*),service_id=(?<fld20>[^,]*)|service_id=(?<fld20>[^,]*)),src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),proto=(?<protocol>[^,]*),(xlatesrc=(?<stransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>[^,]*),rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\"|rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\")$" }
				id => "message-089999:05"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:05"
					"[rsa][message][id1]" => "089999:05"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:04
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,message_info="<info>"|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),message_info=\"(?<info>[^\"]*)\"|proto=(?<protocol>.*))$" }
				id => "message-089999:04"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:04"
					"[rsa][message][id1]" => "089999:04"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:03
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",service_id=<fld20>,ICMP="<network_service>",src=<saddr>,dst=<daddr>,proto=<protocol>,ICMP Type=<icmptype>,ICMP Code=<icmpcode>,{xlatedst=<dtransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>,rule=<rule>,message_info="<info>"|rule=<rule>,message_info="<info>"}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",service_id=(?<fld20>[^,]*),ICMP=\"(?<network_service>[^\"]*)\",src=(?<saddr>[^,]*),dst=(?<daddr>[^,]*),proto=(?<protocol>[^,]*),ICMP[\s]+Type=(?<icmptype>[^,]*),ICMP[\s]+Code=(?<icmpcode>[^,]*),(xlatedst=(?<dtransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>[^,]*),rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\"|rule=(?<rule>[^,]*),message_info=\"(?<info>[^\"]*)\")$" }
				id => "message-089999:03"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:03"
					"[rsa][message][id1]" => "089999:03"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:02
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",rule=<rule>,rule_uid={{<rule_uid>},rule_name={"<rulename>",SmartDefense profile=<fld19>,service_id=<fld20>|<rulename>,SmartDefense profile=<fld19>,service_id=<fld20>|"<rulename>",SmartDefense profile=<fld19>|"<rulename>",service_id=<fld20>|<rulename>,service_id=<fld20>|"<rulename>"},{src=<saddr>,s_port=<sport>|s_port=<sport>},dst=<daddr>,service=<network_service>,d_port=<dport>,{proto=<protocol>,xlatesrc=<stransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>|proto=<protocol>}
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",rule=(?<rule>[^,]*),rule_uid=\{(?<rule_uid>[^\}]*)\},rule_name=(\"(?<rulename>[^\"]*)\",SmartDefense[\s]+profile=(?<fld19>[^,]*),service_id=(?<fld20>[^,]*)|(?<rulename>[^,]*),SmartDefense[\s]+profile=(?<fld19>[^,]*),service_id=(?<fld20>[^,]*)|\"(?<rulename>[^\"]*)\",SmartDefense[\s]+profile=(?<fld19>[^,]*)|\"(?<rulename>[^\"]*)\",service_id=(?<fld20>[^,]*)|(?<rulename>[^,]*),service_id=(?<fld20>[^,]*)|\"(?<rulename>[^\"]*)\"),(src=(?<saddr>[^,]*),s_port=(?<sport>[^,]*)|s_port=(?<sport>[^,]*)),dst=(?<daddr>[^,]*),service=(?<network_service>[^,]*),d_port=(?<dport>[^,]*),(proto=(?<protocol>[^,]*),xlatesrc=(?<stransaddr>[^,]*),xlatesport=(?<stransport>[^,]*),xlatedport=(?<dtransport>[^,]*),NAT_rulenum=(?<fld15>[^,]*),NAT_addtnl_rulenum=(?<fld14>.*)|proto=(?<protocol>.*))$" }
				id => "message-089999:02"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:02"
					"[rsa][message][id1]" => "089999:02"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:07
		# line in RSA: Origin=<hostname>,i/f_name=<interface>,Application="<application>",__policy_id_tag=""product=<product>[db_tag={{<fld1>};mgmt=<fld2>;date=<fld3>;policy_name=<policyname>]"",rule=<rule>,rule_uid={{<rule_uid>},rule_name="<rulename>",SmartDefense profile=<fld19>,dst=<daddr>,proto=<protocol>
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^Origin=(?<hostname>[^,]*),i/f_name=(?<interface>[^,]*),Application=\"(?<application>[^\"]*)\",__policy_id_tag=\"\"product=(?<product>[^\[]*)\[db_tag=\{(?<fld1>[^\}]*)\};mgmt=(?<fld2>[^;]*);date=(?<fld3>[^;]*);policy_name=(?<policyname>[^\]]*)\]\"\",rule=(?<rule>[^,]*),rule_uid=\{(?<rule_uid>[^\}]*)\},rule_name=\"(?<rulename>[^\"]*)\",SmartDefense[\s]+profile=(?<fld19>[^,]*),dst=(?<daddr>[^,]*),proto=(?<protocol>.*)$" }
				id => "message-089999:07"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:07"
					"[rsa][message][id1]" => "089999:07"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999:01
		# line in RSA: time=<fld85>,action=<action>,Origin=<hostname>,i/f_dir=<direction>,i/f_name=<interface>,has_accounting=<fld50>,logId=<id>,log_sequence_num=<serial_number>,is_first_for_luuid=<fld1>,product=<product>,src=<saddr>,s_port=<sport>,dst=<daddr>,service=<network_service>,d_port=<dport>,appi_name=<application>,app_desc=<fld2>,app_id=<fld3>,app_category=<category>,matched_category=<fld4>,app_properties=<fld5>,app_risk=<fld6>,app_rule_id=<rule_uid>,app_rule_name=<rulename>,app_sig_id=<sigid>,proxy_src_ip=<stransaddr>,__policy_id_tag=<fld6>,origin_sic_name=<fld7>,bytes=<bytes>,sent_bytes=<sbytes>,received_bytes=<rbytes>,browse_time=<fld10>,Suppressed logs=<fld11>,LastUpdateTime=<fld30>,log_type=<event_log>,log_version=<version>,proto=<protocol>,session_id=<sessionid>,Protection name=<threat_name>,malware_family=<context>,malware_action=<action>,Confidence Level=<fld22>,severity=<severity>,Protection Type=<fld23>,malware_rule_id=<fld24>,protection_id=<fld24>,log_id=<id>,scope=<stransaddr>,packet_capture_unique_id=<id1>,packet_capture_time=<fld86>,packet_capture_name=<fld27>,Application=<application>,product=<product>,message_info=<info>,rule=<rule>,rule_uid=<rule_uid>,rule_name=<rulename>,xlatesrc=<stransaddr>,xlatedst=<dtransaddr>,xlatesport=<stransport>,xlatedport=<dtransport>,policy_name=<policyname>,ICMP Type=<icmptype>,ICMP Code=<icmpcode>,inzone=<fld1>,outzone=<fld1>,service_id=<fld20>,NAT_rulenum=<fld15>,NAT_addtnl_rulenum=<fld14>,SmartDefense profile=<fld19>,ICMP=<network_service>,srckeyid=<src_spi>,dstkeyid=<dst_spi>,peer gateway=<peer>,msgid=<fld3>,user=<username>,community=<fld9>,CookieI=<ike_cookie1>,CookieR=<ike_cookie2>,fw_subproduct=<product>,vpn_feature_name=<fld5>,scheme:=<scheme>,methods:=<encryption_type>,IKE:=<ike>,ike_ids=<peer_id>,IKE IDs:=<peer_id>,session_id:=<sessionid>,
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "time=%{fld85},action=%{action},Origin=%{hostname},i/f_dir=%{direction},i/f_name=%{interface},has_accounting=%{fld50},logId=%{id},log_sequence_num=%{serial_number},is_first_for_luuid=%{fld1},product=%{product},src=%{saddr},s_port=%{sport},dst=%{daddr},service=%{network_service},d_port=%{dport},appi_name=%{application},app_desc=%{fld2},app_id=%{fld3},app_category=%{category},matched_category=%{fld4},app_properties=%{fld5},app_risk=%{fld6},app_rule_id=%{rule_uid},app_rule_name=%{rulename},app_sig_id=%{sigid},proxy_src_ip=%{stransaddr},__policy_id_tag=%{fld6},origin_sic_name=%{fld7},bytes=%{bytes},sent_bytes=%{sbytes},received_bytes=%{rbytes},browse_time=%{fld10},Suppressed logs=%{fld11},LastUpdateTime=%{fld30},log_type=%{event_log},log_version=%{version},proto=%{protocol},session_id=%{sessionid},Protection name=%{threat_name},malware_family=%{context},malware_action=%{action},Confidence Level=%{fld22},severity=%{severity},Protection Type=%{fld23},malware_rule_id=%{fld24},protection_id=%{fld24},log_id=%{id},scope=%{stransaddr},packet_capture_unique_id=%{id1},packet_capture_time=%{fld86},packet_capture_name=%{fld27},Application=%{application},product=%{product},message_info=%{info},rule=%{rule},rule_uid=%{rule_uid},rule_name=%{rulename},xlatesrc=%{stransaddr},xlatedst=%{dtransaddr},xlatesport=%{stransport},xlatedport=%{dtransport},policy_name=%{policyname},ICMP Type=%{icmptype},ICMP Code=%{icmpcode},inzone=%{fld1},outzone=%{fld1},service_id=%{fld20},NAT_rulenum=%{fld15},NAT_addtnl_rulenum=%{fld14},SmartDefense profile=%{fld19},ICMP=%{network_service},srckeyid=%{src_spi},dstkeyid=%{dst_spi},peer gateway=%{peer},msgid=%{fld3},user=%{username},community=%{fld9},CookieI=%{ike_cookie1},CookieR=%{ike_cookie2},fw_subproduct=%{product},vpn_feature_name=%{fld5},scheme:=%{scheme},methods:=%{encryption_type},IKE:=%{ike},ike_ids=%{peer_id},IKE IDs:=%{peer_id},session_id:=%{sessionid}," }
				id => "message-089999:01"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999:01"
					"[rsa][message][id1]" => "089999:01"
					"[event][categoryid]" => "1605000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
		# MESSAGE 089999
		# line in RSA: <msg>
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{msg}" }
				id => "message-089999"
				add_field => {
				"level" => "%{hlevel}"
					"[event][id]" => "089999"
					"[rsa][message][id1]" => "089999"
					"[event][categoryid]" => "1801000000"
					"[logstash][fullDateTimeString]" => "%{month} %{day} %{year} %{time}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "MMM d yyyy HH:m:s" ] }
			}
		}
	}
	# PARSER msgParserId211
	# line in RSA: __nsons=<fld1>,__p_dport=<fld2>,__pos=<fld3>,action=<action>,Administrator=<administrator>,agent=<agent>,alert=<event_type>,Application=<application>,attack=<context>,attack_info=<fld_ch_ai>,bytes=<bytes>,Category=<category>,Changes=<change_new>,client_inbound_bytes=<fld5>,client_inbound_interface=<sinterface>,client_inbound_packets=<fld6>,client_outbound_bytes=<fld7>,client_outbound_interface=<dinterface>,client_outbound_packets=<fld8>,Client=<shost>,community=<fld9>,connection_state=<fld10>,CookieI=<ike_cookie1>,CookieR=<ike_cookie2>,d_port=<dport>,decryption_failure=<fld11>,dst=<daddr>,dstkeyid=<dst_spi>,elapsed=<duration>,encryption_fail_reason=<fld12>,encryption_failure=<fld13>,fileid=<doc_number>,filename=<filename>,from=<trans_from>,has_accounting=<recordnum>,i/f_dir=<direction>,i/f_name=<interface>,icmp_type=<icmptype>,icmp_code=<icmpcode>,ike_ids=<peer_id>,ike=<ike>,ip_pool=<fld14>,loc=<fld15>,log_sys_message=<fld16>,message_info=<info>,methods=<encryption_type>,iName=<obj_name>,NAT_addtnl_rulenum=<fld14>,NAT_rulenum=<fld15>,Operation=<fld>,orig_from=<from>,orig_name=<vsys>,orig_to=<to>,orig=<event_computer>,origin_sic_name=<fld40>,packet_origin=<fld24>,packets=<packets>,peer_gateway=<peer>,product=<product>,proto=<protocol>,reason=<result>,res_action=<protocol_detail>,resource=<url>,rule_name=<rulename>,rule_uid=<rule_uid>,rule=<rule>,s_port=<sport>,scheme=<scheme>,server_inbound_bytes=<rbytes>,server_inbound_interface=<fld16>,server_inbound_packets=<fld17>,server_outbound_bytes=<sbytes>,server_outbound_interface=<fld18>,server_outbound_packets=<fld19>,service_id=<fld20>,service=<network_service>,Severity=<severity>,src=<saddr>,srckeyid=<src_spi>,start_time=<fld21>,sys_msgs=<fld28>,system_alert_message=<fld22>,tcp_flags=<fld25>,tcp_packet_out_of_state=<fld23>,tcp_sequence_validator=<fld24>,segment_time=<fld26>,time=<fld27>,to=<trans_to>,Type=<obj_type>,Uid=<uid>,user=<username>,vpn_user=<c_username>,xlatedport=<dtransport>,xlatedst=<dtransaddr>,xlatesport=<stransport>,xlatesrc=<stransaddr>,esod_associated_policies=<policyname>,policy_name=<policyname>,Policy_Name=<policyname>,policy=<policyname>,confidence_level=<fld_ch_cl>,industry_reference=<fld_ch_ir>,performance_impact=<fld_ch_pi>,protection_type=<fld_ch_pt>,client_type=<fld_ch_ct>,smartdefense_profile=<profile>,ips_profile=<profile>,app_risk=<risk>,confidential=<context>,dst_machine_name=<dhost>,dstname=<dhost>,malware_action=<forensic_info>,malware_family=<context>,protection_name=<threat_name>,proxy_src_ip=<saddr>,received_bytes=<rbytes>,sent_bytes=<sbytes>,site_name=<location_desc>,src_mach_name=<node>,src_user_name=<username>,installed_prod=<product>,host_type=<host.type>,https_insp_act=<https.insact>,https_validate=<https.valid>,os_name=<os>,TCP packet out of state=<fld29>,inzone=<fld30>,outzone=<fld31>,app_desc=<info>,default_device_message=<msg>,web_server_type=<fld37>,app_properties=<fld35>,log_version=<version>,logId=<id>,matched_category=<fld36>,web_client_type=<fld37>,O=<fld39>,app_id=<fld41>,appi_name=<application>,app_rule_id=<rule_uid>,log_type=<fld42>,log_sequence_num=<serial_number>,app_sig_id=<sigid>,__policy_id_tag=<fld43>,syslog_severity=<severity>,is_first_for_luuid=<fld44>,facility=<fld46>,app_category=<category>,Origin=<hostname>
	else if [logstash][msgparser][id] == "msgParserId211" {
		dissect {
			mapping => { "message" => "__nsons=%{fld1},__p_dport=%{fld2},__pos=%{fld3},action=%{action},Administrator=%{administrator},agent=%{agent},alert=%{event_type},Application=%{application},attack=%{context},attack_info=%{fld_ch_ai},bytes=%{bytes},Category=%{category},Changes=%{change_new},client_inbound_bytes=%{fld5},client_inbound_interface=%{sinterface},client_inbound_packets=%{fld6},client_outbound_bytes=%{fld7},client_outbound_interface=%{dinterface},client_outbound_packets=%{fld8},Client=%{shost},community=%{fld9},connection_state=%{fld10},CookieI=%{ike_cookie1},CookieR=%{ike_cookie2},d_port=%{dport},decryption_failure=%{fld11},dst=%{daddr},dstkeyid=%{dst_spi},elapsed=%{duration},encryption_fail_reason=%{fld12},encryption_failure=%{fld13},fileid=%{doc_number},filename=%{filename},from=%{trans_from},has_accounting=%{recordnum},i/f_dir=%{direction},i/f_name=%{interface},icmp_type=%{icmptype},icmp_code=%{icmpcode},ike_ids=%{peer_id},ike=%{ike},ip_pool=%{fld14},loc=%{fld15},log_sys_message=%{fld16},message_info=%{info},methods=%{encryption_type},iName=%{obj_name},NAT_addtnl_rulenum=%{fld14},NAT_rulenum=%{fld15},Operation=%{fld},orig_from=%{from},orig_name=%{vsys},orig_to=%{to},orig=%{event_computer},origin_sic_name=%{fld40},packet_origin=%{fld24},packets=%{packets},peer_gateway=%{peer},product=%{product},proto=%{protocol},reason=%{result},res_action=%{protocol_detail},resource=%{url},rule_name=%{rulename},rule_uid=%{rule_uid},rule=%{rule},s_port=%{sport},scheme=%{scheme},server_inbound_bytes=%{rbytes},server_inbound_interface=%{fld16},server_inbound_packets=%{fld17},server_outbound_bytes=%{sbytes},server_outbound_interface=%{fld18},server_outbound_packets=%{fld19},service_id=%{fld20},service=%{network_service},Severity=%{severity},src=%{saddr},srckeyid=%{src_spi},start_time=%{fld21},sys_msgs=%{fld28},system_alert_message=%{fld22},tcp_flags=%{fld25},tcp_packet_out_of_state=%{fld23},tcp_sequence_validator=%{fld24},segment_time=%{fld26},time=%{fld27},to=%{trans_to},Type=%{obj_type},Uid=%{uid},user=%{username},vpn_user=%{c_username},xlatedport=%{dtransport},xlatedst=%{dtransaddr},xlatesport=%{stransport},xlatesrc=%{stransaddr},esod_associated_policies=%{policyname},policy_name=%{policyname},Policy_Name=%{policyname},policy=%{policyname},confidence_level=%{fld_ch_cl},industry_reference=%{fld_ch_ir},performance_impact=%{fld_ch_pi},protection_type=%{fld_ch_pt},client_type=%{fld_ch_ct},smartdefense_profile=%{profile},ips_profile=%{profile},app_risk=%{risk},confidential=%{context},dst_machine_name=%{dhost},dstname=%{dhost},malware_action=%{forensic_info},malware_family=%{context},protection_name=%{threat_name},proxy_src_ip=%{saddr},received_bytes=%{rbytes},sent_bytes=%{sbytes},site_name=%{location_desc},src_mach_name=%{node},src_user_name=%{username},installed_prod=%{product},host_type=%{host.type},https_insp_act=%{https.insact},https_validate=%{https.valid},os_name=%{os},TCP packet out of state=%{fld29},inzone=%{fld30},outzone=%{fld31},app_desc=%{info},default_device_message=%{msg},web_server_type=%{fld37},app_properties=%{fld35},log_version=%{version},logId=%{id},matched_category=%{fld36},web_client_type=%{fld37},O=%{fld39},app_id=%{fld41},appi_name=%{application},app_rule_id=%{rule_uid},log_type=%{fld42},log_sequence_num=%{serial_number},app_sig_id=%{sigid},__policy_id_tag=%{fld43},syslog_severity=%{severity},is_first_for_luuid=%{fld44},facility=%{fld46},app_category=%{category},Origin=%{hostname}" }
			id => "msgParserId211"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld27}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dMMMyyyy H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}

# Enrich events using VALUEMAP
filter {
	translate {
		field => "[inout]"
		destination => "[ntype]"
		dictionary => {
			"0" => "6"
			"1" => "7"
		}
		fallback => "0"
		override => true
	}
}
filter {
	translate {
		field => "[action]"
		destination => "[event_cat]"
		dictionary => {
			"accept" => "1801020000"
			"reject" => "1803000000"
			"drop" => "1803000000"
			"Deny" => "1803000000"
		}
		fallback => "1901000000"
		override => true
	}
}
filter {
	translate {
		field => "[event_cat]"
		destination => "[event_cat_name]"
		dictionary => {
			"1801020000" => "Network.Connections.Successful"
			"1803000000" => "Network.Denied Connections"
		}
		fallback => "Other.Default"
		override => true
	}
}

# Rename fields
filter {
	mutate {
		rename => {
			"host.type" => "host_type"
			"https.insact" => "https_insact"
			"https.valid" => "https_valid"
		}
	}
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_checkpointfw1msg.json"
#			template_name => "checkpointfw1_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
