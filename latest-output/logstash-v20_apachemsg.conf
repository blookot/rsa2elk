# Config file generated by RSA2ELK, see https://github.com/blookot/rsa2elk 
# Author: Vincent Maury
# Check all Netwitness parsers: https://github.com/netwitness/nw-logparsers/tree/master/devices/ (license: Apache 2.0)
# Check this link to search for source configuration guides: https://rsa.jiveon.com/community/products/netwitness/integrations/event-sources

##########
# CAUTION: check the "path" in input and "dictionary_path" in filter, as well as the "template" path in the elasticsearch output or "path" in the file output
##########

input {
#	syslog {
#		port => 514
#	}
#	file {
#		path => "/var/log/example.log"
#		start_position => "beginning"
#		sincedb_path => "/dev/null"
#	}
	generator {
		count => 1
		message => "a log line to test out"
	}
#	kafka {
#		codec => "json"
#		bootstrap_servers => "192.168.30.13:9092"
#		topics => ["mytopic"]
#		security_protocol => "SSL"
#		ssl_key_password => "{ssl_password}"
#		ssl_keystore_location => "/{keystore-absolute-path}"
#		ssl_keystore_password => "{keystore_password}"
#		ssl_truststore_location => "/{truststore-absolute-path}"
#		ssl_truststore_password => "{truststore_password}"
#	}
}

# Renaming a couple of fields
filter {
	mutate {
		rename => {
			"message" => "[event][original]"
			"host" => "[logstash][host]"
		}
	}
}

# Setting the device name and group
filter {
	mutate {
		add_field => {
			"[observer][product]" => "apache"
			"[observer][name]" => "Apache Web Server"
			"[observer][type]" => "Web Logs"
		}
	}
}


# One single filter block for all headers and messages
filter {

################## HEADERS ##################

	# HEADER 0001
	# line in RSA: %APACHE-<level>-"<messageid>": <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%APACHE-%{level}-\"%{messageid}\": %{message}" }
			id => "header-0001"
			add_field => {
				"[rsa][header][id]" => "0001"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0002
	# line in RSA: %APACHE-<level>-"<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%APACHE-%{level}-\"%{messageid}: %{message}" }
			id => "header-0002"
			add_field => {
				"[rsa][header][id]" => "0002"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0003
	# line in RSA: %APACHE-<level>-<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%APACHE-%{level}-%{messageid}: %{message}" }
			id => "header-0003"
			add_field => {
				"[rsa][header][id]" => "0003"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0004
	# line in RSA: %APACHE-<level>-<hfld1>: <hsaddr> <hfld2> <husername> [<hfld3> <htimezone>] "<messageid> <!payload:hsaddr>
	if ![logstash][headerfound] {
		grok {
			match => { "[event][original]" => "^%APACHE\-(?<level>[^\-]*)\-(?<hfld1>[^:]*):[\s]+(?<message>(?<hsaddr>[^\s]*)[\s]+(?<hfld2>[^\s]*)[\s]+(?<husername>[^\s]*)[\s]+\[(?<hfld3>[^\s]*)[\s]+(?<htimezone>[^\]]*)\][\s]+\"(?<messageid>[^\s]*)[\s]+(?<payload>.*))$" }
			id => "header-0004"
			add_field => {
				"[rsa][header][id]" => "0004"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}
	# HEADER 0005
	# line in RSA: <hmonth> <hday> <htime> <hostname> %APACHE- "<messageid>: <!payload>
	if ![logstash][headerfound] {
		dissect {
			mapping => { "[event][original]" => "%{hmonth} %{hday} %{htime} %{hostname} %APACHE- \"%{messageid}: %{message}" }
			id => "header-0005"
			add_field => {
				"[rsa][header][id]" => "0005"
				"[rsa][message][id2]" => "%{messageid}"
				"[logstash][headerfound]" => true
			}
		}
	}



################## MsgId2 to Parser ##################

	translate {
		field => "[rsa][message][id2]"
		destination => "[logstash][msgparser][id]"
		dictionary_path => "msgid2parserid-v20_apachemsg.json"
		fallback => ""
		override => true
	}


################## MESSAGES ##################

	if [logstash][msgparser][id] == "ABCD" {
		# MESSAGE ABCD
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-ABCD"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "ABCD"
					"[rsa][message][id1]" => "ABCD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00010
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00010"
				add_field => {
					"[event][id]" => "00010"
					"[rsa][message][id1]" => "00010"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId1
	# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes> 
	else if [logstash][msgparser][id] == "msgParserId1" {
		dissect {
			mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes}" }
			id => "msgParserId1"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld7}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
		}
	}
	else if [logstash][msgparser][id] == "BADMETHOD" {
		# MESSAGE BADMETHOD
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-BADMETHOD"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "BADMETHOD"
					"[rsa][message][id1]" => "BADMETHOD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00020
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00020"
				add_field => {
					"[event][id]" => "00020"
					"[rsa][message][id1]" => "00020"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "BADMTHD" {
		# MESSAGE BADMTHD
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-BADMTHD"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "BADMTHD"
					"[rsa][message][id1]" => "BADMTHD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00022
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00022"
				add_field => {
					"[event][id]" => "00022"
					"[rsa][message][id1]" => "00022"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "BDMTHD" {
		# MESSAGE BDMTHD
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-BDMTHD"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "BDMTHD"
					"[rsa][message][id1]" => "BDMTHD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00024
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00024"
				add_field => {
					"[event][id]" => "00024"
					"[rsa][message][id1]" => "00024"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "CFYZ" {
		# MESSAGE CFYZ
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-CFYZ"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "CFYZ"
					"[rsa][message][id1]" => "CFYZ"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00030
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00030"
				add_field => {
					"[event][id]" => "00030"
					"[rsa][message][id1]" => "00030"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "CONNECT" {
		# MESSAGE CONNECT
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-CONNECT"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "CONNECT"
					"[rsa][message][id1]" => "CONNECT"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00032
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00032"
				add_field => {
					"[event][id]" => "00032"
					"[rsa][message][id1]" => "00032"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "DELETE" {
		# MESSAGE DELETE
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-DELETE"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "DELETE"
					"[rsa][message][id1]" => "DELETE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00040
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes}" }
				id => "message-00040"
				add_field => {
					"[event][id]" => "00040"
					"[rsa][message][id1]" => "00040"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "DETECT_METHOD_TYPE" {
		# MESSAGE DETECT_METHOD_TYPE
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-DETECT_METHOD_TYPE"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "DETECT_METHOD_TYPE"
					"[rsa][message][id1]" => "DETECT_METHOD_TYPE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00050
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00050"
				add_field => {
					"[event][id]" => "00050"
					"[rsa][message][id1]" => "00050"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "FGET" {
		# MESSAGE FGET
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-FGET"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "FGET"
					"[rsa][message][id1]" => "FGET"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00070
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00070"
				add_field => {
					"[event][id]" => "00070"
					"[rsa][message][id1]" => "00070"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "GET" {
		# MESSAGE GET
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-GET"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "GET"
					"[rsa][message][id1]" => "GET"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00100:03
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> <process_id> <fld8> <duration> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} %{process_id} %{fld8} %{duration} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00100:03"
				add_field => {
					"[event][id]" => "00100:03"
					"[rsa][message][id1]" => "00100:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00100:02
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00100:02"
				add_field => {
					"[event][id]" => "00100:02"
					"[rsa][message][id1]" => "00100:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00100
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00100"
				add_field => {
					"[event][id]" => "00100"
					"[rsa][message][id1]" => "00100"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00100:01
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00100:01"
				add_field => {
					"[event][id]" => "00100:01"
					"[rsa][message][id1]" => "00100:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "get" {
		# MESSAGE get
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-get"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "get"
					"[rsa][message][id1]" => "get"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00101
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> " <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} \" %{resultcode} %{sbytes}" }
				id => "message-00101"
				add_field => {
					"[event][id]" => "00101"
					"[rsa][message][id1]" => "00101"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "HEAD" {
		# MESSAGE HEAD
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-HEAD"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "HEAD"
					"[rsa][message][id1]" => "HEAD"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00110:02
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> <process_id> <fld8> <duration> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} %{process_id} %{fld8} %{duration} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00110:02"
				add_field => {
					"[event][id]" => "00110:02"
					"[rsa][message][id1]" => "00110:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00110
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00110"
				add_field => {
					"[event][id]" => "00110"
					"[rsa][message][id1]" => "00110"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00110:01
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00110:01"
				add_field => {
					"[event][id]" => "00110:01"
					"[rsa][message][id1]" => "00110:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "id" {
		# MESSAGE id
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-id"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "id"
					"[rsa][message][id1]" => "id"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE id:01
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes}" }
				id => "message-id:01"
				add_field => {
					"[event][id]" => "id:01"
					"[rsa][message][id1]" => "id:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "INDEX" {
		# MESSAGE INDEX
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-INDEX"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "INDEX"
					"[rsa][message][id1]" => "INDEX"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00120
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> <fld1> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} %{fld1}" }
				id => "message-00120"
				add_field => {
					"[event][id]" => "00120"
					"[rsa][message][id1]" => "00120"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "LOCK" {
		# MESSAGE LOCK
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-LOCK"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "LOCK"
					"[rsa][message][id1]" => "LOCK"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00125
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00125"
				add_field => {
					"[event][id]" => "00125"
					"[rsa][message][id1]" => "00125"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "MKCOL" {
		# MESSAGE MKCOL
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-MKCOL"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "MKCOL"
					"[rsa][message][id1]" => "MKCOL"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00130
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00130"
				add_field => {
					"[event][id]" => "00130"
					"[rsa][message][id1]" => "00130"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "NCIRCLE" {
		# MESSAGE NCIRCLE
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-NCIRCLE"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "NCIRCLE"
					"[rsa][message][id1]" => "NCIRCLE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00190
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00190"
				add_field => {
					"[event][id]" => "00190"
					"[rsa][message][id1]" => "00190"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "OPTIONS" {
		# MESSAGE OPTIONS
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-OPTIONS"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "OPTIONS"
					"[rsa][message][id1]" => "OPTIONS"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00200:02
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> <process_id> <fld8> <duration> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} %{process_id} %{fld8} %{duration} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00200:02"
				add_field => {
					"[event][id]" => "00200:02"
					"[rsa][message][id1]" => "00200:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00200
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00200"
				add_field => {
					"[event][id]" => "00200"
					"[rsa][message][id1]" => "00200"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00200:01
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00200:01"
				add_field => {
					"[event][id]" => "00200:01"
					"[rsa][message][id1]" => "00200:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "POST" {
		# MESSAGE POST
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-POST"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "POST"
					"[rsa][message][id1]" => "POST"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00300:02
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> <process_id> <fld8> <duration> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} %{process_id} %{fld8} %{duration} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00300:02"
				add_field => {
					"[event][id]" => "00300:02"
					"[rsa][message][id1]" => "00300:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00300:03
		# line in RSA: <saddr> - {-|<username>} [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			grok {
				match => { "message" => "^(?<saddr>[^\s]*)[\s]+\-[\s]+(\-|(?<username>[^\s]*))[\s]+\[(?<fld7>[^\s]*)[\s]+(?<timezone>[^\]]*)\][\s]+\"(?<web_method>[^\s]*)[\s]+(?<webpage>[^\s]*)[\s]+(?<network_service>[^\"]*)\"[\s]+(?<resultcode>[^\s]*)[\s]+(?<sbytes>[^\s]*)[\s]+\"(?<referer>[^\"]*)\"[\s]+\"(?<user_agent>[^\"]*)\"$" }
				id => "message-00300:03"
				add_field => {
					"[event][id]" => "00300:03"
					"[rsa][message][id1]" => "00300:03"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00300
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00300"
				add_field => {
					"[event][id]" => "00300"
					"[rsa][message][id1]" => "00300"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00300:01
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00300:01"
				add_field => {
					"[event][id]" => "00300:01"
					"[rsa][message][id1]" => "00300:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PRONECT" {
		# MESSAGE PRONECT
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-PRONECT"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "PRONECT"
					"[rsa][message][id1]" => "PRONECT"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00395
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00395"
				add_field => {
					"[event][id]" => "00395"
					"[rsa][message][id1]" => "00395"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PROPFIND" {
		# MESSAGE PROPFIND
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-PROPFIND"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "PROPFIND"
					"[rsa][message][id1]" => "PROPFIND"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00400:02
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes> <process_id> <fld8> <duration> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes} %{process_id} %{fld8} %{duration} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00400:02"
				add_field => {
					"[event][id]" => "00400:02"
					"[rsa][message][id1]" => "00400:02"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00400
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00400"
				add_field => {
					"[event][id]" => "00400"
					"[rsa][message][id1]" => "00400"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00400:01
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00400:01"
				add_field => {
					"[event][id]" => "00400:01"
					"[rsa][message][id1]" => "00400:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "PUT" {
		# MESSAGE PUT
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-PUT"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "PUT"
					"[rsa][message][id1]" => "PUT"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00402
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00402"
				add_field => {
					"[event][id]" => "00402"
					"[rsa][message][id1]" => "00402"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "QUALYS" {
		# MESSAGE QUALYS
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-QUALYS"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "QUALYS"
					"[rsa][message][id1]" => "QUALYS"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00450
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00450"
				add_field => {
					"[event][id]" => "00450"
					"[rsa][message][id1]" => "00450"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "SEARCH" {
		# MESSAGE SEARCH
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-SEARCH"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "SEARCH"
					"[rsa][message][id1]" => "SEARCH"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00460
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes> <fld1> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes} %{fld1}" }
				id => "message-00460"
				add_field => {
					"[event][id]" => "00460"
					"[rsa][message][id1]" => "00460"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "TRACE" {
		# MESSAGE TRACE
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-TRACE"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "TRACE"
					"[rsa][message][id1]" => "TRACE"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00470
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] <web_method> <webpage> <network_service> <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] %{web_method} %{webpage} %{network_service} %{resultcode} %{sbytes}" }
				id => "message-00470"
				add_field => {
					"[event][id]" => "00470"
					"[rsa][message][id1]" => "00470"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "TRACK" {
		# MESSAGE TRACK
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-TRACK"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "TRACK"
					"[rsa][message][id1]" => "TRACK"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00475
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00475"
				add_field => {
					"[event][id]" => "00475"
					"[rsa][message][id1]" => "00475"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "uGET" {
		# MESSAGE uGET
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
				id => "message-uGET"
				add_field => {
				"fqdn" => "%{web_host}"
					"[event][id]" => "uGET"
					"[rsa][message][id1]" => "uGET"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00480
		# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
				id => "message-00480"
				add_field => {
					"[event][id]" => "00480"
					"[rsa][message][id1]" => "00480"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	else if [logstash][msgparser][id] == "-" {
		# MESSAGE 00408:01
		# line in RSA:  <fld9> <fld5> <fld10> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes> <process_id> <fld8> <duration> "<referer>" "<user_agent>"
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{fld9} %{fld5} %{fld10} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes} %{process_id} %{fld8} %{duration} \"%{referer}\" \"%{user_agent}\"" }
				id => "message-00408:01"
				add_field => {
					"[event][id]" => "00408:01"
					"[rsa][message][id1]" => "00408:01"
					"[event][categoryid]" => "1204000000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
		# MESSAGE 00408
		# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes> 
		if ![logstash][messagefound] {
			dissect {
				mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes}" }
				id => "message-00408"
				add_field => {
					"[event][id]" => "00408"
					"[rsa][message][id1]" => "00408"
					"[event][categoryid]" => "1801010000"
					"[logstash][fullDateTimeString]" => "%{fld7}"
					"[logstash][messagefound]" => true
				}
			}
			if [logstash][fullDateTimeString] {
				date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
			}
		}
	}
	# PARSER msgParserId5
	# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes> <fld1> 
	else if [logstash][msgparser][id] == "msgParserId5" {
		dissect {
			mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes} %{fld1}" }
			id => "msgParserId5"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld7}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
		}
	}
	# PARSER msgParserId3
	# line in RSA: <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> <webpage> <network_service>" <resultcode> <sbytes>  
	else if [logstash][msgparser][id] == "msgParserId3" {
		dissect {
			mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} %{webpage} %{network_service}\" %{resultcode} %{sbytes}" }
			id => "msgParserId3"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld7}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
		}
	}
	# PARSER msgParserId4
	# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method>" <resultcode> <sbytes>  
	else if [logstash][msgparser][id] == "msgParserId4" {
		dissect {
			mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method}\" %{resultcode} %{sbytes}" }
			id => "msgParserId4"
			add_field => {
				"[logstash][fullDateTimeString]" => "%{fld7}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
		}
	}
	# PARSER msgParserId0
	# line in RSA:  <saddr> <fld5> <username> [<fld7> <timezone>] "<web_method> "<web_host>" "<webpage>" "<web_query>" <network_service>" <resultcode> <sbytes> "<web_referer>" "<user_agent>" "<web_cookie>"  
	else if [logstash][msgparser][id] == "msgParserId0" {
		dissect {
			mapping => { "message" => "%{saddr} %{fld5} %{username} [%{fld7} %{timezone}] \"%{web_method} \"%{web_host}\" \"%{webpage}\" \"%{web_query}\" %{network_service}\" %{resultcode} %{sbytes} \"%{web_referer}\" \"%{user_agent}\" \"%{web_cookie}\"" }
			id => "msgParserId0"
			add_field => {
				"fqdn" => "%{web_host}"
				"[logstash][fullDateTimeString]" => "%{fld7}"
				"[logstash][messagefound]" => true
			}
		}
		if [logstash][fullDateTimeString] {
			date { match => [ "[logstash][fullDateTimeString]", "dd/MMM/yyyy:H:m:s" ] }
		}
	}


################## END OF MESSAGES ##################

# End of the filter block
}


output {
#	if [logstash][headerfound] and [logstash][messagefound] {
#		elasticsearch {
#			hosts => ["https://elasticxxxxxx"]
#			index => "%{[observer][product]}-%{+YYYY.MM.dd}"
#			user => "logstash"
#			password => "abc"	# Better use keystore, cf https://www.elastic.co/guide/en/logstash/master/keystore.html
#			manage_template => true
#			template => "es-mapping-v20_apachemsg.json"
#			template_name => "apache_template"
#			template_overwrite => true
#		}
#	} else {
#		# using a file output for logs that were not parsed correctly
#		# should you chose to send it to elasticsearch, please read https://discuss.elastic.co/t/latency-with-2-elasticsearch-systems/170074/2
#		file { path => "failed_logs-%{[observer][product]}-%{+YYYY-MM-dd}" }
#	}
	stdout {
		codec => rubydebug
	}
}
