
# enrich public ips with asn
filter {
	if [saddr] {
		geoip {
			source => "saddr"
			target => "[source][geo]"
			default_database_type => "ASN"
		}
	}
}
filter {
	if [daddr] {
		geoip {
			source => "daddr"
			target => "[destination][geo]"
			default_database_type => "ASN"
		}
	}
}
filter {
	if [devicehostip] {
		geoip {
			source => "devicehostip"
			target => "[host][geo]"
			default_database_type => "ASN"
		}
	}
}
filter {
	if [device.ip] {
		geoip {
			source => "device.ip"
			target => "[observer][geo]"
			default_database_type => "ASN"
		}
	}
}
